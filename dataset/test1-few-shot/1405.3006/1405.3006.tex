\begin{isabellebody}\def\isabellecontext{KnowledgeKeysSecrets}\isamarkupheader{Knowledge of Keys and Secrets}
\isamarkuptrue \isadelimtheory
\endisadelimtheory
\isatagtheory
\isacommand{theory}\isamarkupfalse \ KnowledgeKeysSecrets\isanewline
\isakeyword{imports}\ CompLocalSecrets\ \isanewline
\isakeyword{begin}\endisatagtheory
{\isafoldtheory}\isadelimtheory
\endisadelimtheory
~\\
An component  knows a secret  (or some secret expression )  that does not belong to its local secrets , if
\begin{itemize}
	\item   may eventually get the secret ,
	\item 
	 belongs to the set  of its local secrets, 
	\item  knows some list of expressions  which is an concatenations of  and some list of expressions ,
	\item  is a concatenation of some lists of secrets  and , and  knows both these secrets,
	\item  knows some secret key  and the result of the encryption of the  with the corresponding public key,
	\item  knows some public key  and the result of the signature creation of the  with the corresponding private key,\item  is an encryption of some secret  with a public key , and  knows both  and ,
	\item  is the result of the signature creation of the  with the key , and  knows both  and .
\end{itemize}
\isacommand{primrec}\isamarkupfalse \isanewline
\ \ know\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}specID\ {\isasymRightarrow}\ KS\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\isanewline
\isakeyword{where}\ \isanewline
\ {\isachardoublequoteopen}know\ A\ {\isacharparenleft}kKS\ m{\isacharparenright}\ {\isacharequal}\ \isanewline
\ \ {\isacharparenleft}{\isacharparenleft}ine\ A\ {\isacharparenleft}kE\ m{\isacharparenright}{\isacharparenright}\ {\isasymor}\ {\isacharparenleft}{\isacharparenleft}kKS\ m{\isacharparenright}\ {\isasymin}\ {\isacharparenleft}LocalSecrets\ A{\isacharparenright}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\ {\isacharbar}\ \isanewline
\ {\isachardoublequoteopen}know\ A\ {\isacharparenleft}sKS\ m{\isacharparenright}\ {\isacharequal}\ \isanewline
\ \ {\isacharparenleft}{\isacharparenleft}ine\ A\ {\isacharparenleft}sE\ m{\isacharparenright}{\isacharparenright}\ {\isasymor}\ {\isacharparenleft}{\isacharparenleft}sKS\ m{\isacharparenright}\ {\isasymin}\ {\isacharparenleft}LocalSecrets\ A{\isacharparenright}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{axiomatization}\isamarkupfalse \isanewline
\ \ knows\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}specID\ {\isasymRightarrow}\ Expression\ list\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\isanewline
\isakeyword{where}\isanewline
knows{\isacharunderscore}emptyexpression{\isacharcolon}\isanewline
\ \ {\isachardoublequoteopen}knows\ C\ {\isacharbrackleft}{\isacharbrackright}\ {\isacharequal}\ True{\isachardoublequoteclose}\ \isakeyword{and}\isanewline
know{\isadigit{1}}k{\isacharcolon}\ \isanewline
\ \ {\isachardoublequoteopen}knows\ C\ {\isacharbrackleft}KS{\isadigit{2}}Expression\ {\isacharparenleft}kKS\ m{\isadigit{1}}{\isacharparenright}{\isacharbrackright}\ {\isacharequal}\ know\ C\ {\isacharparenleft}kKS\ m{\isadigit{1}}{\isacharparenright}{\isachardoublequoteclose}\ \isakeyword{and}\isanewline
know{\isadigit{1}}s{\isacharcolon}\isanewline
\ \ {\isachardoublequoteopen}knows\ C\ {\isacharbrackleft}KS{\isadigit{2}}Expression\ {\isacharparenleft}sKS\ m{\isadigit{2}}{\isacharparenright}{\isacharbrackright}\ {\isacharequal}\ know\ C\ {\isacharparenleft}sKS\ m{\isadigit{2}}{\isacharparenright}{\isachardoublequoteclose}\ \isakeyword{and}\isanewline
knows{\isadigit{2}}a{\isacharcolon}\ \isanewline
\ \ {\isachardoublequoteopen}knows\ A\ {\isacharparenleft}e{\isadigit{1}}\ {\isacharat}\ e{\isacharparenright}\ {\isasymlongrightarrow}\ knows\ A\ e{\isachardoublequoteclose}\ \isakeyword{and}\isanewline
knows{\isadigit{2}}b{\isacharcolon}\ \isanewline
\ \ {\isachardoublequoteopen}knows\ A\ {\isacharparenleft}e\ {\isacharat}\ e{\isadigit{1}}{\isacharparenright}\ {\isasymlongrightarrow}\ knows\ A\ e{\isachardoublequoteclose}\ \isakeyword{and}\isanewline
knows{\isadigit{3}}{\isacharcolon}\ \isanewline
\ \ {\isachardoublequoteopen}{\isacharparenleft}knows\ A\ e{\isadigit{1}}{\isacharparenright}\ {\isasymand}\ {\isacharparenleft}knows\ A\ e{\isadigit{2}}{\isacharparenright}\ {\isasymlongrightarrow}\ knows\ A\ {\isacharparenleft}e{\isadigit{1}}\ {\isacharat}\ e{\isadigit{2}}{\isacharparenright}{\isachardoublequoteclose}\ \isakeyword{and}\isanewline
knows{\isadigit{4}}{\isacharcolon}\ \isanewline
\ \ {\isachardoublequoteopen}{\isacharparenleft}IncrDecrKeys\ k{\isadigit{1}}\ k{\isadigit{2}}{\isacharparenright}\ {\isasymand}\ {\isacharparenleft}know\ A\ {\isacharparenleft}kKS\ k{\isadigit{2}}{\isacharparenright}{\isacharparenright}\ {\isasymand}\ {\isacharparenleft}knows\ A\ {\isacharparenleft}Enc\ k{\isadigit{1}}\ e{\isacharparenright}{\isacharparenright}\isanewline
\ \ \ {\isasymlongrightarrow}\ knows\ A\ e{\isachardoublequoteclose}\ \isanewline
\isakeyword{and}\isanewline
knows{\isadigit{5}}{\isacharcolon}\ \isanewline
\ \ {\isachardoublequoteopen}{\isacharparenleft}IncrDecrKeys\ k{\isadigit{1}}\ k{\isadigit{2}}{\isacharparenright}\ {\isasymand}\ {\isacharparenleft}know\ A\ {\isacharparenleft}kKS\ k{\isadigit{1}}{\isacharparenright}{\isacharparenright}\ {\isasymand}\ {\isacharparenleft}knows\ A\ {\isacharparenleft}Sign\ k{\isadigit{2}}\ e{\isacharparenright}{\isacharparenright}\isanewline
\ \ \ {\isasymlongrightarrow}\ knows\ A\ e{\isachardoublequoteclose}\isanewline
\isakeyword{and}\isanewline
knows{\isadigit{6}}{\isacharcolon}\ \isanewline
\ \ {\isachardoublequoteopen}{\isacharparenleft}know\ A\ {\isacharparenleft}kKS\ k{\isacharparenright}{\isacharparenright}\ {\isasymand}\ {\isacharparenleft}knows\ A\ e{\isadigit{1}}{\isacharparenright}\ {\isasymlongrightarrow}\ knows\ A\ {\isacharparenleft}Enc\ k\ e{\isadigit{1}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isakeyword{and}\isanewline
knows{\isadigit{7}}{\isacharcolon}\ \isanewline
\ \ {\isachardoublequoteopen}{\isacharparenleft}know\ A\ {\isacharparenleft}kKS\ k{\isacharparenright}{\isacharparenright}\ {\isasymand}\ {\isacharparenleft}knows\ A\ e{\isadigit{1}}{\isacharparenright}\ {\isasymlongrightarrow}\ knows\ A\ {\isacharparenleft}Sign\ k\ e{\isadigit{1}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{primrec}\isamarkupfalse \ \ eoutKnowCorrect\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}specID\ {\isasymRightarrow}\ KS\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\isanewline
\isakeyword{where}\isanewline
eout{\isacharunderscore}know{\isacharunderscore}k{\isacharcolon}\ \isanewline
\ \ {\isachardoublequoteopen}eoutKnowCorrect\ C\ {\isacharparenleft}kKS\ m{\isacharparenright}\ {\isacharequal}\ \isanewline
\ \ {\isacharparenleft}{\isacharparenleft}eout\ \ C\ {\isacharparenleft}kE\ m{\isacharparenright}{\isacharparenright}\ {\isasymlongleftrightarrow}\ {\isacharparenleft}m\ {\isasymin}\ {\isacharparenleft}specKeys\ C{\isacharparenright}\ {\isasymor}\ {\isacharparenleft}know\ C\ {\isacharparenleft}kKS\ m{\isacharparenright}{\isacharparenright}{\isacharparenright}\ {\isacharparenright}{\isachardoublequoteclose}\ \ {\isacharbar}\isanewline
eout{\isacharunderscore}know{\isacharunderscore}s{\isacharcolon}\ \isanewline
\ \ \ {\isachardoublequoteopen}eoutKnowCorrect\ C\ {\isacharparenleft}sKS\ m{\isacharparenright}\ {\isacharequal}\ \isanewline
\ \ {\isacharparenleft}{\isacharparenleft}eout\ \ C\ {\isacharparenleft}sE\ m{\isacharparenright}{\isacharparenright}\ {\isasymlongleftrightarrow}\ \ {\isacharparenleft}m\ {\isasymin}\ {\isacharparenleft}specSecrets\ C{\isacharparenright}\ {\isasymor}\ {\isacharparenleft}know\ C\ {\isacharparenleft}sKS\ m{\isacharparenright}{\isacharparenright}{\isacharparenright}\ {\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse \ eoutKnowsECorrect\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}specID\ {\isasymRightarrow}\ Expression\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\isanewline
\isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}eoutKnowsECorrect\ C\ e\ {\isasymequiv}\isanewline
\ \ \ {\isacharparenleft}{\isacharparenleft}eout\ \ C\ e{\isacharparenright}\ {\isasymlongleftrightarrow}\isanewline
\ \ \ {\isacharparenleft}{\isacharparenleft}{\isasymexists}\ k{\isachardot}\ e\ {\isacharequal}\ {\isacharparenleft}kE\ k{\isacharparenright}\ {\isasymand}\ {\isacharparenleft}k\ {\isasymin}\ specKeys\ C{\isacharparenright}{\isacharparenright}\ {\isasymor}\ \isanewline
\ \ \ \ {\isacharparenleft}{\isasymexists}\ s{\isachardot}\ e\ {\isacharequal}\ {\isacharparenleft}sE\ s{\isacharparenright}\ {\isasymand}\ {\isacharparenleft}s\ {\isasymin}\ specSecrets\ C{\isacharparenright}{\isacharparenright}\ {\isasymor}\isanewline
\ \ \ \ {\isacharparenleft}knows\ C\ {\isacharbrackleft}e{\isacharbrackright}{\isacharparenright}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse \ eoutKnowCorrect{\isacharunderscore}L{\isadigit{1}}k{\isacharcolon}\isanewline
\isakeyword{assumes}\ {\isachardoublequoteopen}eoutKnowCorrect\ C\ {\isacharparenleft}kKS\ m{\isacharparenright}{\isachardoublequoteclose}\ \ \isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}eout\ \ C\ {\isacharparenleft}kE\ m{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isakeyword{shows}\ \ \ \ {\isachardoublequoteopen}m\ {\isasymin}\ {\isacharparenleft}specKeys\ C{\isacharparenright}\ {\isasymor}\ {\isacharparenleft}know\ C\ {\isacharparenleft}kKS\ m{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\ \isanewline
\isadelimproof
\endisadelimproof
\isatagproof
\isacommand{using}\isamarkupfalse \ assms\ \isacommand{by}\isamarkupfalse \ {\isacharparenleft}metis\ eout{\isacharunderscore}know{\isacharunderscore}k{\isacharparenright}\endisatagproof
{\isafoldproof}\isadelimproof
\isanewline
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse \ eoutKnowCorrect{\isacharunderscore}L{\isadigit{1}}s{\isacharcolon}\isanewline
\isakeyword{assumes}\ {\isachardoublequoteopen}eoutKnowCorrect\ C\ {\isacharparenleft}sKS\ m{\isacharparenright}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}eout\ \ C\ {\isacharparenleft}sE\ m{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isakeyword{shows}\ \ \ \ {\isachardoublequoteopen}m\ {\isasymin}\ {\isacharparenleft}specSecrets\ C{\isacharparenright}\ {\isasymor}\ {\isacharparenleft}know\ C\ {\isacharparenleft}sKS\ m{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\ \isanewline
\isadelimproof
\endisadelimproof
\isatagproof
\isacommand{using}\isamarkupfalse \ assms\ \isacommand{by}\isamarkupfalse \ {\isacharparenleft}metis\ eout{\isacharunderscore}know{\isacharunderscore}s{\isacharparenright}\endisatagproof
{\isafoldproof}\isadelimproof
\isanewline
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse \ eoutKnowsECorrect{\isacharunderscore}L{\isadigit{1}}{\isacharcolon}\isanewline
\isakeyword{assumes}\ {\isachardoublequoteopen}eoutKnowsECorrect\ C\ e{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}eout\ \ C\ e{\isachardoublequoteclose}\isanewline
\isakeyword{shows}\ {\isachardoublequoteopen}{\isacharparenleft}{\isasymexists}\ k{\isachardot}\ e\ {\isacharequal}\ {\isacharparenleft}kE\ k{\isacharparenright}\ {\isasymand}\ {\isacharparenleft}k\ {\isasymin}\ specKeys\ C{\isacharparenright}{\isacharparenright}\ {\isasymor}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\isasymexists}\ s{\isachardot}\ e\ {\isacharequal}\ {\isacharparenleft}sE\ s{\isacharparenright}\ {\isasymand}\ {\isacharparenleft}s\ {\isasymin}\ specSecrets\ C{\isacharparenright}{\isacharparenright}\ {\isasymor}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}knows\ C\ {\isacharbrackleft}e{\isacharbrackright}{\isacharparenright}{\isachardoublequoteclose}\ \isanewline
\isadelimproof
\endisadelimproof
\isatagproof
\isacommand{using}\isamarkupfalse \ assms\ \isacommand{by}\isamarkupfalse \ {\isacharparenleft}metis\ eoutKnowsECorrect{\isacharunderscore}def{\isacharparenright}\endisatagproof
{\isafoldproof}\isadelimproof
\isanewline
\endisadelimproof
\ \isanewline
\isacommand{lemma}\isamarkupfalse \ know{\isadigit{2}}knows{\isacharunderscore}k{\isacharcolon}\ \isanewline
\isakeyword{assumes}\ {\isachardoublequoteopen}know\ A\ {\isacharparenleft}kKS\ m{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isakeyword{shows}\ \ \ \ {\isachardoublequoteopen}knows\ A\ {\isacharbrackleft}kE\ m{\isacharbrackright}{\isachardoublequoteclose}\ \isanewline
\isadelimproof
\endisadelimproof
\isatagproof
\isacommand{using}\isamarkupfalse \ assms\isanewline
\isacommand{by}\isamarkupfalse \ {\isacharparenleft}metis\ KS{\isadigit{2}}Expression{\isachardot}simps{\isacharparenleft}{\isadigit{1}}{\isacharparenright}\ know{\isadigit{1}}k{\isacharparenright}\endisatagproof
{\isafoldproof}\isadelimproof
\isanewline
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse \ knows{\isadigit{2}}know{\isacharunderscore}k{\isacharcolon}\ \isanewline
\isakeyword{assumes}\ {\isachardoublequoteopen}knows\ A\ {\isacharbrackleft}kE\ m{\isacharbrackright}{\isachardoublequoteclose}\ \isanewline
\isakeyword{shows}\ \ \ \ {\isachardoublequoteopen}know\ A\ {\isacharparenleft}kKS\ m{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isadelimproof
\endisadelimproof
\isatagproof
\isacommand{using}\isamarkupfalse \ assms\isanewline
\isacommand{by}\isamarkupfalse \ {\isacharparenleft}metis\ KS{\isadigit{2}}Expression{\isachardot}simps{\isacharparenleft}{\isadigit{1}}{\isacharparenright}\ know{\isadigit{1}}k{\isacharparenright}\endisatagproof
{\isafoldproof}\isadelimproof
\isanewline
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse \ know{\isadigit{2}}knowsPQ{\isacharunderscore}k{\isacharcolon}\ \isanewline
\isakeyword{assumes}\ {\isachardoublequoteopen}know\ P\ {\isacharparenleft}kKS\ m{\isacharparenright}\ {\isasymor}\ know\ Q\ {\isacharparenleft}kKS\ m{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isakeyword{shows}\ \ \ \ {\isachardoublequoteopen}knows\ P\ {\isacharbrackleft}kE\ m{\isacharbrackright}\ {\isasymor}\ knows\ Q\ {\isacharbrackleft}kE\ m{\isacharbrackright}{\isachardoublequoteclose}\ \isanewline
\isadelimproof
\endisadelimproof
\isatagproof
\isacommand{using}\isamarkupfalse \ assms\ \isacommand{by}\isamarkupfalse \ {\isacharparenleft}metis\ know{\isadigit{2}}knows{\isacharunderscore}k{\isacharparenright}\endisatagproof
{\isafoldproof}\isadelimproof
\isanewline
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse \ knows{\isadigit{2}}knowPQ{\isacharunderscore}k{\isacharcolon}\ \isanewline
\isakeyword{assumes}\ {\isachardoublequoteopen}knows\ P\ {\isacharbrackleft}kE\ m{\isacharbrackright}\ {\isasymor}\ knows\ Q\ {\isacharbrackleft}kE\ m{\isacharbrackright}{\isachardoublequoteclose}\isanewline
\isakeyword{shows}\ \ \ \ \ {\isachardoublequoteopen}know\ P\ {\isacharparenleft}kKS\ m{\isacharparenright}\ {\isasymor}\ know\ Q\ {\isacharparenleft}kKS\ m{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isadelimproof
\endisadelimproof
\isatagproof
\isacommand{using}\isamarkupfalse \ assms\ \ \isacommand{by}\isamarkupfalse \ {\isacharparenleft}metis\ knows{\isadigit{2}}know{\isacharunderscore}k{\isacharparenright}\endisatagproof
{\isafoldproof}\isadelimproof
\isanewline
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse \ knows{\isadigit{1}}k{\isacharcolon}\ \isanewline
\ {\isachardoublequoteopen}know\ A\ {\isacharparenleft}kKS\ m{\isacharparenright}\ {\isacharequal}\ knows\ A\ {\isacharbrackleft}kE\ m{\isacharbrackright}{\isachardoublequoteclose}\isanewline
\isadelimproof
\endisadelimproof
\isatagproof
\isacommand{by}\isamarkupfalse \ {\isacharparenleft}metis\ know{\isadigit{2}}knows{\isacharunderscore}k\ knows{\isadigit{2}}know{\isacharunderscore}k{\isacharparenright}\endisatagproof
{\isafoldproof}\isadelimproof
\ \isanewline
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse \ know{\isadigit{2}}knows{\isacharunderscore}neg{\isacharunderscore}k{\isacharcolon}\ \isanewline
\isakeyword{assumes}\ \ {\isachardoublequoteopen}{\isasymnot}\ know\ A\ {\isacharparenleft}kKS\ m{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isakeyword{shows}\ \ \ \ \ {\isachardoublequoteopen}{\isasymnot}\ knows\ A\ {\isacharbrackleft}kE\ m{\isacharbrackright}{\isachardoublequoteclose}\isanewline
\isadelimproof
\endisadelimproof
\isatagproof
\isacommand{using}\isamarkupfalse \ assms\ \isacommand{by}\isamarkupfalse \ {\isacharparenleft}metis\ knows{\isadigit{1}}k{\isacharparenright}\endisatagproof
{\isafoldproof}\isadelimproof
\ \isanewline
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse \ knows{\isadigit{2}}know{\isacharunderscore}neg{\isacharunderscore}k{\isacharcolon}\ \isanewline
\isakeyword{assumes}\ {\isachardoublequoteopen}{\isasymnot}\ knows\ A\ {\isacharbrackleft}kE\ m{\isacharbrackright}{\isachardoublequoteclose}\ \isanewline
\isakeyword{shows}\ \ \ \ {\isachardoublequoteopen}{\isasymnot}\ know\ A\ {\isacharparenleft}kKS\ m{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isadelimproof
\endisadelimproof
\isatagproof
\isacommand{using}\isamarkupfalse \ assms\ \isacommand{by}\isamarkupfalse \ {\isacharparenleft}metis\ know{\isadigit{2}}knowsPQ{\isacharunderscore}k{\isacharparenright}\endisatagproof
{\isafoldproof}\isadelimproof
\isanewline
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse \ know{\isadigit{2}}knows{\isacharunderscore}s{\isacharcolon}\ \isanewline
\isakeyword{assumes}\ {\isachardoublequoteopen}know\ A\ {\isacharparenleft}sKS\ m{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isakeyword{shows}\ \ \ \ {\isachardoublequoteopen}knows\ A\ {\isacharbrackleft}sE\ m{\isacharbrackright}{\isachardoublequoteclose}\isanewline
\isadelimproof
\endisadelimproof
\isatagproof
\isacommand{using}\isamarkupfalse \ assms\isanewline
\isacommand{by}\isamarkupfalse \ {\isacharparenleft}metis\ KS{\isadigit{2}}Expression{\isachardot}simps{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ know{\isadigit{1}}s{\isacharparenright}\endisatagproof
{\isafoldproof}\isadelimproof
\ \isanewline
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse \ knows{\isadigit{2}}know{\isacharunderscore}s{\isacharcolon}\ \isanewline
\isakeyword{assumes}\ {\isachardoublequoteopen}knows\ A\ {\isacharbrackleft}sE\ m{\isacharbrackright}{\isachardoublequoteclose}\ \isanewline
\isakeyword{shows}\ \ \ \ {\isachardoublequoteopen}know\ A\ {\isacharparenleft}sKS\ m{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isadelimproof
\endisadelimproof
\isatagproof
\isacommand{using}\isamarkupfalse \ assms\isanewline
\isacommand{by}\isamarkupfalse \ {\isacharparenleft}metis\ KS{\isadigit{2}}Expression{\isachardot}simps{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ know{\isadigit{1}}s{\isacharparenright}\endisatagproof
{\isafoldproof}\isadelimproof
\ \isanewline
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse \ know{\isadigit{2}}knowsPQ{\isacharunderscore}s{\isacharcolon}\ \isanewline
\isakeyword{assumes}\ {\isachardoublequoteopen}know\ P\ {\isacharparenleft}sKS\ m{\isacharparenright}\ {\isasymor}\ know\ Q\ {\isacharparenleft}sKS\ m{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isakeyword{shows}\ \ \ \ {\isachardoublequoteopen}knows\ P\ {\isacharbrackleft}sE\ m{\isacharbrackright}\ {\isasymor}\ knows\ Q\ {\isacharbrackleft}sE\ m{\isacharbrackright}{\isachardoublequoteclose}\ \isanewline
\isadelimproof
\endisadelimproof
\isatagproof
\isacommand{using}\isamarkupfalse \ assms\ \isacommand{by}\isamarkupfalse \ {\isacharparenleft}metis\ know{\isadigit{2}}knows{\isacharunderscore}s{\isacharparenright}\endisatagproof
{\isafoldproof}\isadelimproof
\isanewline
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse \ knows{\isadigit{2}}knowPQ{\isacharunderscore}s{\isacharcolon}\ \isanewline
\isakeyword{assumes}\ {\isachardoublequoteopen}knows\ P\ {\isacharbrackleft}sE\ m{\isacharbrackright}\ {\isasymor}\ knows\ Q\ {\isacharbrackleft}sE\ m{\isacharbrackright}{\isachardoublequoteclose}\isanewline
\isakeyword{shows}\ \ \ \ {\isachardoublequoteopen}know\ P\ {\isacharparenleft}sKS\ m{\isacharparenright}\ {\isasymor}\ know\ Q\ {\isacharparenleft}sKS\ m{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isadelimproof
\endisadelimproof
\isatagproof
\isacommand{using}\isamarkupfalse \ assms\ \isacommand{by}\isamarkupfalse \ {\isacharparenleft}metis\ knows{\isadigit{2}}know{\isacharunderscore}s{\isacharparenright}\endisatagproof
{\isafoldproof}\isadelimproof
\isanewline
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse \ knows{\isadigit{1}}s{\isacharcolon}\isanewline
\ \ {\isachardoublequoteopen}know\ A\ {\isacharparenleft}sKS\ m{\isacharparenright}\ {\isacharequal}\ knows\ A\ {\isacharbrackleft}sE\ m{\isacharbrackright}{\isachardoublequoteclose}\isanewline
\isadelimproof
\endisadelimproof
\isatagproof
\isacommand{by}\isamarkupfalse \ {\isacharparenleft}metis\ know{\isadigit{2}}knows{\isacharunderscore}s\ knows{\isadigit{2}}know{\isacharunderscore}s{\isacharparenright}\endisatagproof
{\isafoldproof}\isadelimproof
\ \isanewline
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse \ know{\isadigit{2}}knows{\isacharunderscore}neg{\isacharunderscore}s{\isacharcolon}\ \isanewline
\isakeyword{assumes}\ {\isachardoublequoteopen}{\isasymnot}\ know\ A\ {\isacharparenleft}sKS\ m{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isakeyword{shows}\ \ \ \ {\isachardoublequoteopen}{\isasymnot}\ knows\ A\ {\isacharbrackleft}sE\ m{\isacharbrackright}{\isachardoublequoteclose}\ \isanewline
\isadelimproof
\endisadelimproof
\isatagproof
\isacommand{using}\isamarkupfalse \ assms\ \isacommand{by}\isamarkupfalse \ {\isacharparenleft}metis\ knows{\isadigit{2}}know{\isacharunderscore}s{\isacharparenright}\endisatagproof
{\isafoldproof}\isadelimproof
\ \isanewline
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse \ knows{\isadigit{2}}know{\isacharunderscore}neg{\isacharunderscore}s{\isacharcolon}\ \isanewline
\isakeyword{assumes}\ {\isachardoublequoteopen}{\isasymnot}\ knows\ A\ {\isacharbrackleft}sE\ m{\isacharbrackright}{\isachardoublequoteclose}\ \isanewline
\isakeyword{shows}\ \ \ \ {\isachardoublequoteopen}{\isasymnot}\ know\ A\ {\isacharparenleft}sKS\ m{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isadelimproof
\endisadelimproof
\isatagproof
\isacommand{using}\isamarkupfalse \ assms\ \isacommand{by}\isamarkupfalse \ {\isacharparenleft}metis\ \ know{\isadigit{2}}knows{\isacharunderscore}s{\isacharparenright}\endisatagproof
{\isafoldproof}\isadelimproof
\isanewline
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse \ knows{\isadigit{2}}{\isacharcolon}\ \isanewline
\isakeyword{assumes}\ {\isachardoublequoteopen}e{\isadigit{2}}\ {\isacharequal}\ e{\isadigit{1}}\ {\isacharat}\ e\ {\isasymor}\ e{\isadigit{2}}\ {\isacharequal}\ e\ {\isacharat}\ e{\isadigit{1}}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}knows\ A\ e{\isadigit{2}}{\isachardoublequoteclose}\ \isanewline
\isakeyword{shows}\ \ \ \ {\isachardoublequoteopen}knows\ A\ e{\isachardoublequoteclose}\isanewline
\isadelimproof
\endisadelimproof
\isatagproof
\isacommand{using}\isamarkupfalse \ assms\ \isacommand{by}\isamarkupfalse \ {\isacharparenleft}metis\ knows{\isadigit{2}}a\ knows{\isadigit{2}}b{\isacharparenright}\endisatagproof
{\isafoldproof}\isadelimproof
\isanewline
\endisadelimproof
\ \isanewline
\isacommand{lemma}\isamarkupfalse \ correctCompositionInLoc{\isacharunderscore}exprChannel{\isacharcolon}\isanewline
\isakeyword{assumes}\ {\isachardoublequoteopen}subcomponents\ PQ\ {\isacharequal}\ {\isacharbraceleft}P{\isacharcomma}\ Q{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}correctCompositionIn\ PQ{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}ch\ {\isacharcolon}\ ins\ P{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}exprChannel\ ch\ m{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}{\isasymforall}\ x{\isachardot}\ x\ {\isasymin}\ ins\ PQ\ {\isasymlongrightarrow}\ {\isasymnot}\ exprChannel\ x\ m{\isachardoublequoteclose}\isanewline
\isakeyword{shows}\ \ \ \ {\isachardoublequoteopen}ch\ {\isacharcolon}\ loc\ PQ{\isachardoublequoteclose}\isanewline
\isadelimproof
\endisadelimproof
\isatagproof
\isacommand{using}\isamarkupfalse \ assms\ \isacommand{by}\isamarkupfalse \ {\isacharparenleft}simp\ add{\isacharcolon}\ correctCompositionIn{\isacharunderscore}def{\isacharcomma}\ auto{\isacharparenright}\endisatagproof
{\isafoldproof}\isadelimproof
\isanewline
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse \ eout{\isacharunderscore}know{\isacharunderscore}nonKS{\isacharunderscore}k{\isacharcolon}\ \isanewline
\isakeyword{assumes}\ {\isachardoublequoteopen}m\ {\isasymnotin}\ specKeys\ A{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}eout\ A\ {\isacharparenleft}kE\ m{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}eoutKnowCorrect\ A\ {\isacharparenleft}kKS\ m{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isakeyword{shows}\ \ \ \ \ {\isachardoublequoteopen}know\ A\ {\isacharparenleft}kKS\ m{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isadelimproof
\endisadelimproof
\isatagproof
\isacommand{using}\isamarkupfalse \ assms\ \isacommand{by}\isamarkupfalse \ {\isacharparenleft}metis\ eoutKnowCorrect{\isacharunderscore}L{\isadigit{1}}k{\isacharparenright}\endisatagproof
{\isafoldproof}\isadelimproof
\isanewline
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse \ \ eout{\isacharunderscore}know{\isacharunderscore}nonKS{\isacharunderscore}s{\isacharcolon}\isanewline
\isakeyword{assumes}\ {\isachardoublequoteopen}m\ {\isasymnotin}\ specSecrets\ A{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}eout\ A\ {\isacharparenleft}sE\ m{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}eoutKnowCorrect\ A\ {\isacharparenleft}sKS\ m{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isakeyword{shows}\ \ \ \ {\isachardoublequoteopen}know\ A\ {\isacharparenleft}sKS\ m{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isadelimproof
\endisadelimproof
\isatagproof
\isacommand{using}\isamarkupfalse \ assms\ \isacommand{by}\isamarkupfalse \ {\isacharparenleft}metis\ eoutKnowCorrect{\isacharunderscore}L{\isadigit{1}}s{\isacharparenright}\endisatagproof
{\isafoldproof}\isadelimproof
\isanewline
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse \ not{\isacharunderscore}know{\isacharunderscore}k{\isacharunderscore}not{\isacharunderscore}ine{\isacharcolon}\isanewline
\isakeyword{assumes}\ {\isachardoublequoteopen}{\isasymnot}\ know\ A\ {\isacharparenleft}kKS\ m{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isakeyword{shows}\ \ \ \ {\isachardoublequoteopen}{\isasymnot}\ ine\ A\ {\isacharparenleft}kE\ m{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isadelimproof
\endisadelimproof
\isatagproof
\isacommand{using}\isamarkupfalse \ assms\ \isacommand{by}\isamarkupfalse \ simp\endisatagproof
{\isafoldproof}\isadelimproof
\isanewline
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse \ not{\isacharunderscore}know{\isacharunderscore}s{\isacharunderscore}not{\isacharunderscore}ine{\isacharcolon}\isanewline
\isakeyword{assumes}\ {\isachardoublequoteopen}{\isasymnot}\ know\ A\ {\isacharparenleft}sKS\ m{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isakeyword{shows}\ \ \ \ {\isachardoublequoteopen}{\isasymnot}\ ine\ A\ {\isacharparenleft}sE\ m{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isadelimproof
\endisadelimproof
\isatagproof
\isacommand{using}\isamarkupfalse \ assms\ \isacommand{by}\isamarkupfalse \ simp\endisatagproof
{\isafoldproof}\isadelimproof
\isanewline
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse \ not{\isacharunderscore}know{\isacharunderscore}k{\isacharunderscore}not{\isacharunderscore}eout{\isacharcolon}\isanewline
\isakeyword{assumes}\ {\isachardoublequoteopen}m\ {\isasymnotin}\ specKeys\ A{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}{\isasymnot}\ know\ A\ {\isacharparenleft}kKS\ m{\isacharparenright}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}eoutKnowCorrect\ A\ {\isacharparenleft}kKS\ m{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isakeyword{shows}\ \ \ \ \ {\isachardoublequoteopen}{\isasymnot}\ eout\ A\ {\isacharparenleft}kE\ m{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isadelimproof
\endisadelimproof
\isatagproof
\isacommand{using}\isamarkupfalse \ assms\ \isacommand{by}\isamarkupfalse \ {\isacharparenleft}metis\ eout{\isacharunderscore}know{\isacharunderscore}k{\isacharparenright}\endisatagproof
{\isafoldproof}\isadelimproof
\isanewline
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse \ not{\isacharunderscore}know{\isacharunderscore}s{\isacharunderscore}not{\isacharunderscore}eout{\isacharcolon}\isanewline
\isakeyword{assumes}\ {\isachardoublequoteopen}m\ {\isasymnotin}\ specSecrets\ A{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}{\isasymnot}\ know\ A\ {\isacharparenleft}sKS\ m{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}eoutKnowCorrect\ A\ {\isacharparenleft}sKS\ m{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isakeyword{shows}\ \ \ \ \ {\isachardoublequoteopen}{\isasymnot}\ eout\ A\ {\isacharparenleft}sE\ m{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isadelimproof
\endisadelimproof
\isatagproof
\isacommand{using}\isamarkupfalse \ assms\ \isacommand{by}\isamarkupfalse \ {\isacharparenleft}metis\ eout{\isacharunderscore}know{\isacharunderscore}nonKS{\isacharunderscore}s{\isacharparenright}\endisatagproof
{\isafoldproof}\isadelimproof
\isanewline
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse \ adv{\isacharunderscore}not{\isacharunderscore}know{\isadigit{1}}{\isacharcolon}\isanewline
\isakeyword{assumes}\ {\isachardoublequoteopen}out\ P\ {\isasymsubseteq}\ ins\ A{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}{\isasymnot}\ know\ A\ {\isacharparenleft}kKS\ m{\isacharparenright}{\isachardoublequoteclose}\ \isanewline
\isakeyword{shows}\ \ \ \ {\isachardoublequoteopen}{\isasymnot}\ eout\ P\ {\isacharparenleft}kE\ m{\isacharparenright}{\isachardoublequoteclose}\ \isanewline
\isadelimproof
\endisadelimproof
\isatagproof
\isacommand{using}\isamarkupfalse \ assms\isanewline
\isacommand{by}\isamarkupfalse \ {\isacharparenleft}metis\ {\isacharparenleft}full{\isacharunderscore}types{\isacharparenright}\ eout{\isacharunderscore}def\ ine{\isacharunderscore}ins{\isacharunderscore}neg{\isadigit{1}}\ not{\isacharunderscore}know{\isacharunderscore}k{\isacharunderscore}not{\isacharunderscore}ine\ set{\isacharunderscore}rev{\isacharunderscore}mp{\isacharparenright}\endisatagproof
{\isafoldproof}\isadelimproof
\isanewline
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse \ \ adv{\isacharunderscore}not{\isacharunderscore}know{\isadigit{2}}{\isacharcolon}\isanewline
\isakeyword{assumes}\ {\isachardoublequoteopen}out\ P\ {\isasymsubseteq}\ ins\ A{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}{\isasymnot}\ know\ A\ {\isacharparenleft}sKS\ m{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isakeyword{shows}\ \ \ \ {\isachardoublequoteopen}{\isasymnot}\ eout\ P\ {\isacharparenleft}sE\ m{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isadelimproof
\endisadelimproof
\isatagproof
\isacommand{using}\isamarkupfalse \ assms\isanewline
\isacommand{by}\isamarkupfalse \ {\isacharparenleft}metis\ {\isacharparenleft}full{\isacharunderscore}types{\isacharparenright}\ eout{\isacharunderscore}def\ ine{\isacharunderscore}ins{\isacharunderscore}neg{\isadigit{1}}\ not{\isacharunderscore}know{\isacharunderscore}s{\isacharunderscore}not{\isacharunderscore}ine\ set{\isacharunderscore}rev{\isacharunderscore}mp{\isacharparenright}\endisatagproof
{\isafoldproof}\isadelimproof
\isanewline
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse \ LocalSecrets{\isacharunderscore}L{\isadigit{1}}{\isacharcolon}\isanewline
\isakeyword{assumes}\ {\isachardoublequoteopen}{\isacharparenleft}kKS{\isacharparenright}\ key\ {\isasymin}\ LocalSecrets\ P{\isachardoublequoteclose}\ \ \isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}{\isacharparenleft}kKS\ key{\isacharparenright}\ {\isasymnotin}\ {\isasymUnion}{\isacharparenleft}LocalSecrets\ {\isacharbackquote}\ subcomponents\ P{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isakeyword{shows}\ \ \ \ {\isachardoublequoteopen}kKS\ key\ {\isasymnotin}\ specKeysSecrets\ P{\isachardoublequoteclose}\isanewline
\isadelimproof
\endisadelimproof
\isatagproof
\isacommand{using}\isamarkupfalse \ assms\ \isacommand{by}\isamarkupfalse \ {\isacharparenleft}simp\ only{\isacharcolon}\ LocalSecretsDef{\isacharcomma}\ auto{\isacharparenright}\endisatagproof
{\isafoldproof}\isadelimproof
\isanewline
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse \ LocalSecrets{\isacharunderscore}L{\isadigit{2}}{\isacharcolon}\isanewline
\isakeyword{assumes}\ {\isachardoublequoteopen}kKS\ key\ {\isasymin}\ LocalSecrets\ P{\isachardoublequoteclose}\ \ \isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}kKS\ key\ {\isasymin}\ specKeysSecrets\ P{\isachardoublequoteclose}\isanewline
\isakeyword{shows}\ \ \ \ {\isachardoublequoteopen}kKS\ key\ {\isasymin}\ {\isasymUnion}{\isacharparenleft}LocalSecrets\ {\isacharbackquote}\ subcomponents\ P{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isadelimproof
\endisadelimproof
\isatagproof
\isacommand{using}\isamarkupfalse \ assms\ \isacommand{by}\isamarkupfalse \ {\isacharparenleft}simp\ only{\isacharcolon}\ LocalSecretsDef{\isacharcomma}\ auto{\isacharparenright}\endisatagproof
{\isafoldproof}\isadelimproof
\isanewline
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse \ know{\isacharunderscore}composition{\isadigit{1}}{\isacharcolon}\isanewline
\isakeyword{assumes}\ notKSP{\isacharcolon}{\isachardoublequoteopen}m\ {\isasymnotin}\ specKeysSecrets\ P{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ notKSQ{\isacharcolon}{\isachardoublequoteopen}m\ {\isasymnotin}\ specKeysSecrets\ Q{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}know\ P\ m{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ subPQ{\isacharcolon}{\isachardoublequoteopen}subcomponents\ PQ\ {\isacharequal}\ {\isacharbraceleft}P{\isacharcomma}Q{\isacharbraceright}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ cCompI{\isacharcolon}{\isachardoublequoteopen}correctCompositionIn\ PQ{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ cCompKS{\isacharcolon}{\isachardoublequoteopen}correctCompositionKS\ PQ{\isachardoublequoteclose}\isanewline
\isakeyword{shows}\ \ \ \ {\isachardoublequoteopen}know\ PQ\ m{\isachardoublequoteclose}\isanewline
\isadelimproof
\endisadelimproof
\isatagproof
\isacommand{proof}\isamarkupfalse \ {\isacharparenleft}cases\ m{\isacharparenright}\isanewline
\ \ \isacommand{fix}\isamarkupfalse \ key\isanewline
\ \ \isacommand{assume}\isamarkupfalse \ a{\isadigit{1}}{\isacharcolon}{\isachardoublequoteopen}m\ {\isacharequal}\ kKS\ key{\isachardoublequoteclose}\isanewline
\ \ \isacommand{show}\isamarkupfalse \ {\isacharquery}thesis\isanewline
\ \ \isacommand{proof}\isamarkupfalse \ {\isacharparenleft}cases\ \ {\isachardoublequoteopen}ine\ P\ {\isacharparenleft}kE\ key{\isacharparenright}{\isachardoublequoteclose}{\isacharparenright}\ \isanewline
\ \ \ \ \ \isacommand{assume}\isamarkupfalse \ a{\isadigit{1}}{\isadigit{1}}{\isacharcolon}{\isachardoublequoteopen}ine\ P\ {\isacharparenleft}kE\ key{\isacharparenright}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \isacommand{from}\isamarkupfalse \ this\ \isacommand{have}\isamarkupfalse \ a{\isadigit{1}}{\isadigit{1}}ext{\isacharcolon}{\isachardoublequoteopen}ine\ P\ {\isacharparenleft}kE\ key{\isacharparenright}\ {\isacharbar}\ ine\ Q\ {\isacharparenleft}kE\ key{\isacharparenright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse \ simp\isanewline
\ \ \ \ \ \isacommand{from}\isamarkupfalse \ subPQ\ \isakeyword{and}\ cCompKS\ \isakeyword{and}\ notKSP\ \isakeyword{and}\ notKSQ\ \isacommand{have}\isamarkupfalse \ {\isachardoublequoteopen}m\ {\isasymnotin}\ specKeysSecrets\ PQ{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse \ {\isacharparenleft}rule\ correctCompositionKS{\isacharunderscore}neg{\isadigit{1}}{\isacharparenright}\ \isanewline
\ \ \ \ \ \isacommand{from}\isamarkupfalse \ this\ \isakeyword{and}\ a{\isadigit{1}}\ \isacommand{have}\isamarkupfalse \ sg{\isadigit{1}}{\isacharcolon}{\isachardoublequoteopen}kKS\ key\ {\isasymnotin}\ specKeysSecrets\ PQ{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse \ simp\isanewline
\ \ \ \ \ \isacommand{from}\isamarkupfalse \ a{\isadigit{1}}\ \isakeyword{and}\ a{\isadigit{1}}{\isadigit{1}}ext\ \isakeyword{and}\ cCompKS\ \ \isacommand{show}\isamarkupfalse \ {\isacharquery}thesis\isanewline
\ \ \ \ \ \isacommand{proof}\isamarkupfalse \ {\isacharparenleft}cases\ {\isachardoublequoteopen}loc\ PQ\ {\isacharequal}\ {\isacharbraceleft}{\isacharbraceright}{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \isacommand{assume}\isamarkupfalse \ a{\isadigit{1}}{\isadigit{1}}locE{\isacharcolon}{\isachardoublequoteopen}loc\ PQ\ {\isacharequal}\ {\isacharbraceleft}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isacommand{from}\isamarkupfalse \ a{\isadigit{1}}{\isadigit{1}}ext\ \isakeyword{and}\ subPQ\ \isakeyword{and}\ cCompI\ \isakeyword{and}\ a{\isadigit{1}}{\isadigit{1}}locE\ \isacommand{have}\isamarkupfalse \ {\isachardoublequoteopen}ine\ PQ\ {\isacharparenleft}kE\ key{\isacharparenright}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse \ {\isacharparenleft}rule\ TBtheorem{\isadigit{4}}a{\isacharunderscore}empty{\isacharparenright}\ \isanewline
\ \ \ \ \ \ \ \isacommand{from}\isamarkupfalse \ this\ \isakeyword{and}\ a{\isadigit{1}}\ \isacommand{show}\isamarkupfalse \ {\isacharquery}thesis\ \isacommand{by}\isamarkupfalse \ auto\isanewline
\ \ \ \ \ \isacommand{next}\isamarkupfalse \ \isanewline
\ \ \ \ \ \ \ \isacommand{assume}\isamarkupfalse \ a{\isadigit{1}}{\isadigit{1}}locNE{\isacharcolon}{\isachardoublequoteopen}loc\ PQ\ {\isasymnoteq}\ {\isacharbraceleft}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isacommand{from}\isamarkupfalse \ a{\isadigit{1}}\ \isakeyword{and}\ a{\isadigit{1}}{\isadigit{1}}\ \isakeyword{and}\ sg{\isadigit{1}}\ \isakeyword{and}\ assms\ \isacommand{show}\isamarkupfalse \ {\isacharquery}thesis\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse \ {\isacharparenleft}simp\ add{\isacharcolon}\ ine{\isacharunderscore}def{\isacharcomma}\ auto{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse \ {\isacharparenleft}simp\ add{\isacharcolon}\ correctCompositionKS{\isacharunderscore}exprChannel{\isacharunderscore}k{\isacharunderscore}Pex{\isacharparenright}\ \isanewline
\ \ \ \ \ \isacommand{qed}\isamarkupfalse \isanewline
\ \ \ \isacommand{next}\isamarkupfalse \isanewline
\ \ \ \ \ \isacommand{assume}\isamarkupfalse \ a{\isadigit{1}}{\isadigit{2}}{\isacharcolon}{\isachardoublequoteopen}{\isasymnot}\ ine\ P\ {\isacharparenleft}kE\ key{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \isacommand{from}\isamarkupfalse \ this\ \isakeyword{and}\ a{\isadigit{1}}\ \isakeyword{and}\ assms\ \isacommand{show}\isamarkupfalse \ {\isacharquery}thesis\isanewline
\ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse \ {\isacharparenleft}auto{\isacharcomma}\ simp\ add{\isacharcolon}\ \ LocalSecretsComposition{\isadigit{1}}{\isacharparenright}\isanewline
\ \ \ \isacommand{qed}\isamarkupfalse \isanewline
\ \isacommand{next}\isamarkupfalse \isanewline
\ \ \isacommand{fix}\isamarkupfalse \ secret\isanewline
\ \ \isacommand{assume}\isamarkupfalse \ a{\isadigit{2}}{\isacharcolon}{\isachardoublequoteopen}m\ {\isacharequal}\ sKS\ secret{\isachardoublequoteclose}\isanewline
\ \ \isacommand{show}\isamarkupfalse \ {\isacharquery}thesis\isanewline
\ \ \isacommand{proof}\isamarkupfalse \ {\isacharparenleft}cases\ \ {\isachardoublequoteopen}ine\ P\ {\isacharparenleft}sE\ secret{\isacharparenright}{\isachardoublequoteclose}{\isacharparenright}\ \isanewline
\ \ \ \ \ \isacommand{assume}\isamarkupfalse \ a{\isadigit{2}}{\isadigit{1}}{\isacharcolon}{\isachardoublequoteopen}ine\ P\ {\isacharparenleft}sE\ secret{\isacharparenright}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \isacommand{from}\isamarkupfalse \ this\ \isacommand{have}\isamarkupfalse \ a{\isadigit{2}}{\isadigit{1}}ext{\isacharcolon}{\isachardoublequoteopen}ine\ P\ {\isacharparenleft}sE\ secret{\isacharparenright}\ {\isacharbar}\ ine\ Q\ {\isacharparenleft}sE\ secret{\isacharparenright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse \ simp\isanewline
\ \ \ \ \ \isacommand{from}\isamarkupfalse \ subPQ\ \isakeyword{and}\ cCompKS\ \isakeyword{and}\ notKSP\ \isakeyword{and}\ notKSQ\ \isacommand{have}\isamarkupfalse \ {\isachardoublequoteopen}m\ {\isasymnotin}\ specKeysSecrets\ PQ{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse \ {\isacharparenleft}rule\ correctCompositionKS{\isacharunderscore}neg{\isadigit{1}}{\isacharparenright}\ \isanewline
\ \ \ \ \ \isacommand{from}\isamarkupfalse \ this\ \isakeyword{and}\ a{\isadigit{2}}\ \isacommand{have}\isamarkupfalse \ sg{\isadigit{2}}{\isacharcolon}{\isachardoublequoteopen}sKS\ secret\ {\isasymnotin}\ specKeysSecrets\ PQ{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse \ simp\isanewline
\ \ \ \ \ \isacommand{from}\isamarkupfalse \ a{\isadigit{2}}\ \isakeyword{and}\ a{\isadigit{2}}{\isadigit{1}}ext\ \isakeyword{and}\ cCompKS\ \ \isacommand{show}\isamarkupfalse \ {\isacharquery}thesis\isanewline
\ \ \ \ \ \isacommand{proof}\isamarkupfalse \ {\isacharparenleft}cases\ {\isachardoublequoteopen}loc\ PQ\ {\isacharequal}\ {\isacharbraceleft}{\isacharbraceright}{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \isacommand{assume}\isamarkupfalse \ a{\isadigit{2}}{\isadigit{1}}locE{\isacharcolon}{\isachardoublequoteopen}loc\ PQ\ {\isacharequal}\ {\isacharbraceleft}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isacommand{from}\isamarkupfalse \ a{\isadigit{2}}{\isadigit{1}}ext\ \isakeyword{and}\ subPQ\ \isakeyword{and}\ cCompI\ \isakeyword{and}\ a{\isadigit{2}}{\isadigit{1}}locE\ \isacommand{have}\isamarkupfalse \ {\isachardoublequoteopen}ine\ PQ\ {\isacharparenleft}sE\ secret{\isacharparenright}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse \ {\isacharparenleft}rule\ TBtheorem{\isadigit{4}}a{\isacharunderscore}empty{\isacharparenright}\ \isanewline
\ \ \ \ \ \ \ \isacommand{from}\isamarkupfalse \ this\ \isakeyword{and}\ a{\isadigit{2}}\ \isacommand{show}\isamarkupfalse \ {\isacharquery}thesis\ \isacommand{by}\isamarkupfalse \ auto\isanewline
\ \ \ \ \ \isacommand{next}\isamarkupfalse \ \isanewline
\ \ \ \ \ \ \ \isacommand{assume}\isamarkupfalse \ a{\isadigit{2}}{\isadigit{1}}locNE{\isacharcolon}{\isachardoublequoteopen}loc\ PQ\ {\isasymnoteq}\ {\isacharbraceleft}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isacommand{from}\isamarkupfalse \ a{\isadigit{2}}\ \isakeyword{and}\ a{\isadigit{2}}{\isadigit{1}}\ \isakeyword{and}\ sg{\isadigit{2}}\ \isakeyword{and}\ assms\ \isacommand{show}\isamarkupfalse \ {\isacharquery}thesis\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse \ {\isacharparenleft}simp\ add{\isacharcolon}\ ine{\isacharunderscore}def{\isacharcomma}\ auto{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse \ {\isacharparenleft}simp\ add{\isacharcolon}\ correctCompositionKS{\isacharunderscore}exprChannel{\isacharunderscore}s{\isacharunderscore}Pex{\isacharparenright}\ \isanewline
\ \ \ \ \ \isacommand{qed}\isamarkupfalse \isanewline
\ \ \ \isacommand{next}\isamarkupfalse \isanewline
\ \ \ \ \ \isacommand{assume}\isamarkupfalse \ a{\isadigit{1}}{\isadigit{2}}{\isacharcolon}{\isachardoublequoteopen}{\isasymnot}\ ine\ P\ {\isacharparenleft}sE\ secret{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \isacommand{from}\isamarkupfalse \ this\ \isakeyword{and}\ a{\isadigit{2}}\ \isakeyword{and}\ assms\ \isacommand{show}\isamarkupfalse \ {\isacharquery}thesis\isanewline
\ \ \ \ \ \isacommand{by}\isamarkupfalse \ {\isacharparenleft}metis\ LocalSecretsComposition{\isadigit{1}}\ know{\isachardot}simps{\isacharparenleft}{\isadigit{2}}{\isacharparenright}{\isacharparenright}\isanewline
\ \ \ \isacommand{qed}\isamarkupfalse \isanewline
\isacommand{qed}\isamarkupfalse \endisatagproof
{\isafoldproof}\isadelimproof
\isanewline
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse \ know{\isacharunderscore}composition{\isadigit{2}}{\isacharcolon}\isanewline
\isakeyword{assumes}\ {\isachardoublequoteopen}m\ {\isasymnotin}\ specKeysSecrets\ P{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}m\ {\isasymnotin}\ specKeysSecrets\ Q{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}know\ Q\ m{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}subcomponents\ PQ\ {\isacharequal}\ {\isacharbraceleft}P{\isacharcomma}Q{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}correctCompositionIn\ PQ{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}correctCompositionKS\ PQ{\isachardoublequoteclose}\isanewline
\isakeyword{shows}\ \ \ \ {\isachardoublequoteopen}know\ PQ\ m{\isachardoublequoteclose}\isanewline
\isadelimproof
\endisadelimproof
\isatagproof
\isacommand{using}\isamarkupfalse \ assms\ \isacommand{by}\isamarkupfalse \ {\isacharparenleft}metis\ insert{\isacharunderscore}commute\ know{\isacharunderscore}composition{\isadigit{1}}{\isacharparenright}\endisatagproof
{\isafoldproof}\isadelimproof
\isanewline
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse \ know{\isacharunderscore}composition{\isacharcolon}\isanewline
\isakeyword{assumes}\ {\isachardoublequoteopen}m\ {\isasymnotin}\ specKeysSecrets\ P{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}m\ {\isasymnotin}\ specKeysSecrets\ Q{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}know\ P\ m\ {\isasymor}\ know\ Q\ m{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}subcomponents\ PQ\ {\isacharequal}\ {\isacharbraceleft}P{\isacharcomma}Q{\isacharbraceright}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}correctCompositionIn\ PQ{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}correctCompositionKS\ PQ{\isachardoublequoteclose}\isanewline
\isakeyword{shows}\ \ \ \ {\isachardoublequoteopen}know\ PQ\ m{\isachardoublequoteclose}\isanewline
\isadelimproof
\endisadelimproof
\isatagproof
\isacommand{using}\isamarkupfalse \ assms\ \isacommand{by}\isamarkupfalse \ {\isacharparenleft}metis\ know{\isacharunderscore}composition{\isadigit{1}}\ know{\isacharunderscore}composition{\isadigit{2}}{\isacharparenright}\endisatagproof
{\isafoldproof}\isadelimproof
\isanewline
\endisadelimproof
\isanewline
\isacommand{theorem}\isamarkupfalse \ know{\isacharunderscore}composition{\isacharunderscore}neg{\isacharunderscore}ine{\isacharunderscore}k{\isacharcolon}\isanewline
\isakeyword{assumes}\ {\isachardoublequoteopen}{\isasymnot}\ know\ P\ {\isacharparenleft}kKS\ key{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}{\isasymnot}\ know\ Q\ {\isacharparenleft}kKS\ key{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}subcomponents\ PQ\ {\isacharequal}\ {\isacharbraceleft}P{\isacharcomma}Q{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}correctCompositionIn\ PQ{\isachardoublequoteclose}\isanewline
\isakeyword{shows}\ \ \ \ {\isachardoublequoteopen}{\isasymnot}\ {\isacharparenleft}ine\ PQ\ {\isacharparenleft}kE\ key{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isadelimproof
\endisadelimproof
\isatagproof
\isacommand{using}\isamarkupfalse \ assms\ \isacommand{by}\isamarkupfalse \ {\isacharparenleft}metis\ TBtheorem{\isadigit{3}}a\ not{\isacharunderscore}know{\isacharunderscore}k{\isacharunderscore}not{\isacharunderscore}ine{\isacharparenright}\endisatagproof
{\isafoldproof}\isadelimproof
\isanewline
\endisadelimproof
\isanewline
\isacommand{theorem}\isamarkupfalse \ know{\isacharunderscore}composition{\isacharunderscore}neg{\isacharunderscore}ine{\isacharunderscore}s{\isacharcolon}\isanewline
\isakeyword{assumes}\ {\isachardoublequoteopen}{\isasymnot}\ know\ P\ {\isacharparenleft}sKS\ secret{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}{\isasymnot}\ know\ Q\ {\isacharparenleft}sKS\ secret{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}subcomponents\ PQ\ {\isacharequal}\ {\isacharbraceleft}P{\isacharcomma}Q{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}correctCompositionIn\ PQ{\isachardoublequoteclose}\isanewline
\isakeyword{shows}\ \ \ \ {\isachardoublequoteopen}{\isasymnot}\ {\isacharparenleft}ine\ PQ\ {\isacharparenleft}sE\ secret{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isadelimproof
\endisadelimproof
\isatagproof
\isacommand{using}\isamarkupfalse \ assms\ \isacommand{by}\isamarkupfalse \ {\isacharparenleft}metis\ TBtheorem{\isadigit{3}}a\ not{\isacharunderscore}know{\isacharunderscore}s{\isacharunderscore}not{\isacharunderscore}ine{\isacharparenright}\endisatagproof
{\isafoldproof}\isadelimproof
\isanewline
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse \ know{\isacharunderscore}composition{\isacharunderscore}neg{\isadigit{1}}{\isacharcolon}\isanewline
\isakeyword{assumes}\ notknowP{\isacharcolon}{\isachardoublequoteopen}{\isasymnot}\ know\ P\ m{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ notknowQ{\isacharcolon}{\isachardoublequoteopen}{\isasymnot}\ know\ Q\ m{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ subPQ{\isacharcolon}{\isachardoublequoteopen}subcomponents\ PQ\ {\isacharequal}\ {\isacharbraceleft}P{\isacharcomma}Q{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ cCompLoc{\isacharcolon}{\isachardoublequoteopen}correctCompositionLoc\ PQ{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ cCompI{\isacharcolon}{\isachardoublequoteopen}correctCompositionIn\ PQ{\isachardoublequoteclose}\isanewline
\isakeyword{shows}\ \ \ \ {\isachardoublequoteopen}{\isasymnot}\ know\ PQ\ m{\isachardoublequoteclose}\isanewline
\isadelimproof
\endisadelimproof
\isatagproof
\isacommand{proof}\isamarkupfalse \ {\isacharparenleft}cases\ m{\isacharparenright}\isanewline
\ \ \isacommand{fix}\isamarkupfalse \ key\isanewline
\ \ \isacommand{assume}\isamarkupfalse \ a{\isadigit{1}}{\isacharcolon}{\isachardoublequoteopen}m\ {\isacharequal}\ kKS\ key{\isachardoublequoteclose}\isanewline
\ \ \isacommand{from}\isamarkupfalse \ notknowP\ \isakeyword{and}\ a{\isadigit{1}}\ \isacommand{have}\isamarkupfalse \ sg{\isadigit{1}}{\isacharcolon}{\isachardoublequoteopen}{\isasymnot}\ know\ P\ {\isacharparenleft}kKS\ key{\isacharparenright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse \ simp\isanewline
\ \ \isacommand{then}\isamarkupfalse \ \isacommand{have}\isamarkupfalse \ sg{\isadigit{1}}a{\isacharcolon}{\isachardoublequoteopen}{\isasymnot}\ ine\ P\ {\isacharparenleft}kE\ key{\isacharparenright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse \ simp\isanewline
\ \ \isacommand{from}\isamarkupfalse \ sg{\isadigit{1}}\ \isacommand{have}\isamarkupfalse \ sg{\isadigit{1}}b{\isacharcolon}{\isachardoublequoteopen}kKS\ key\ {\isasymnotin}\ LocalSecrets\ P{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse \ simp\isanewline
\ \ \isacommand{from}\isamarkupfalse \ notknowQ\ \isakeyword{and}\ a{\isadigit{1}}\ \isacommand{have}\isamarkupfalse \ sg{\isadigit{2}}{\isacharcolon}{\isachardoublequoteopen}{\isasymnot}\ know\ Q\ {\isacharparenleft}kKS\ key{\isacharparenright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse \ simp\isanewline
\ \ \isacommand{then}\isamarkupfalse \ \ \isacommand{have}\isamarkupfalse \ sg{\isadigit{2}}a{\isacharcolon}{\isachardoublequoteopen}{\isasymnot}\ ine\ Q\ {\isacharparenleft}kE\ key{\isacharparenright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse \ simp\isanewline
\ \ \isacommand{from}\isamarkupfalse \ sg{\isadigit{2}}\ \isacommand{have}\isamarkupfalse \ sg{\isadigit{2}}b{\isacharcolon}{\isachardoublequoteopen}kKS\ key\ {\isasymnotin}\ LocalSecrets\ Q{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse \ simp\isanewline
\ \ \isacommand{from}\isamarkupfalse \ sg{\isadigit{1}}\ \isakeyword{and}\ sg{\isadigit{2}}\ \isakeyword{and}\ subPQ\ \isakeyword{and}\ cCompI\ \isacommand{have}\isamarkupfalse \ sg{\isadigit{3}}{\isacharcolon}{\isachardoublequoteopen}{\isasymnot}\ ine\ PQ\ {\isacharparenleft}kE\ key{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse \ {\isacharparenleft}rule\ know{\isacharunderscore}composition{\isacharunderscore}neg{\isacharunderscore}ine{\isacharunderscore}k{\isacharparenright}\isanewline
\ \ \isacommand{from}\isamarkupfalse \ subPQ\ \isakeyword{and}\ cCompLoc\ \isakeyword{and}\ sg{\isadigit{1}}a\ \isakeyword{and}\ sg{\isadigit{2}}a\ \isakeyword{and}\ sg{\isadigit{1}}b\ \isakeyword{and}\ sg{\isadigit{2}}b\ \isacommand{have}\isamarkupfalse \ sg{\isadigit{4}}{\isacharcolon}\isanewline
\ \ {\isachardoublequoteopen}kKS\ key\ {\isasymnotin}\ LocalSecrets\ PQ{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse \ {\isacharparenleft}rule\ LocalSecretsComposition{\isacharunderscore}neg{\isadigit{1}}{\isacharunderscore}k{\isacharparenright}\isanewline
\ \ \isacommand{from}\isamarkupfalse \ sg{\isadigit{3}}\ \isakeyword{and}\ sg{\isadigit{4}}\ \isakeyword{and}\ a{\isadigit{1}}\ \isacommand{show}\isamarkupfalse \ {\isacharquery}thesis\ \isacommand{by}\isamarkupfalse \ simp\isanewline
\isacommand{next}\isamarkupfalse \ \isanewline
\ \ \isacommand{fix}\isamarkupfalse \ secret\isanewline
\ \ \isacommand{assume}\isamarkupfalse \ a{\isadigit{2}}{\isacharcolon}{\isachardoublequoteopen}m\ {\isacharequal}\ sKS\ secret{\isachardoublequoteclose}\isanewline
\ \ \isacommand{from}\isamarkupfalse \ notknowP\ \isakeyword{and}\ a{\isadigit{2}}\ \isacommand{have}\isamarkupfalse \ sg{\isadigit{1}}{\isacharcolon}{\isachardoublequoteopen}{\isasymnot}\ know\ P\ {\isacharparenleft}sKS\ secret{\isacharparenright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse \ simp\isanewline
\ \ \isacommand{then}\isamarkupfalse \ \isacommand{have}\isamarkupfalse \ sg{\isadigit{1}}a{\isacharcolon}{\isachardoublequoteopen}{\isasymnot}\ ine\ P\ {\isacharparenleft}sE\ secret{\isacharparenright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse \ simp\isanewline
\ \ \isacommand{from}\isamarkupfalse \ sg{\isadigit{1}}\ \isacommand{have}\isamarkupfalse \ sg{\isadigit{1}}b{\isacharcolon}{\isachardoublequoteopen}sKS\ secret\ {\isasymnotin}\ LocalSecrets\ P{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse \ simp\isanewline
\ \ \isacommand{from}\isamarkupfalse \ notknowQ\ \isakeyword{and}\ a{\isadigit{2}}\ \isacommand{have}\isamarkupfalse \ sg{\isadigit{2}}{\isacharcolon}{\isachardoublequoteopen}{\isasymnot}\ know\ Q\ {\isacharparenleft}sKS\ secret{\isacharparenright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse \ simp\isanewline
\ \ \isacommand{then}\isamarkupfalse \ \isacommand{have}\isamarkupfalse \ sg{\isadigit{2}}a{\isacharcolon}{\isachardoublequoteopen}{\isasymnot}\ ine\ Q\ {\isacharparenleft}sE\ secret{\isacharparenright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse \ simp\isanewline
\ \ \isacommand{from}\isamarkupfalse \ sg{\isadigit{2}}\ \isacommand{have}\isamarkupfalse \ sg{\isadigit{2}}b{\isacharcolon}{\isachardoublequoteopen}sKS\ secret\ {\isasymnotin}\ LocalSecrets\ Q{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse \ simp\isanewline
\ \ \isacommand{from}\isamarkupfalse \ sg{\isadigit{1}}\ \isakeyword{and}\ sg{\isadigit{2}}\ \isakeyword{and}\ subPQ\ \isakeyword{and}\ cCompI\ \isacommand{have}\isamarkupfalse \ sg{\isadigit{3}}{\isacharcolon}{\isachardoublequoteopen}{\isasymnot}\ ine\ PQ\ {\isacharparenleft}sE\ secret{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse \ {\isacharparenleft}rule\ know{\isacharunderscore}composition{\isacharunderscore}neg{\isacharunderscore}ine{\isacharunderscore}s{\isacharparenright}\ \isanewline
\ \ \isacommand{from}\isamarkupfalse \ subPQ\ \isakeyword{and}\ cCompLoc\ \isakeyword{and}\ sg{\isadigit{1}}a\ \isakeyword{and}\ sg{\isadigit{2}}a\ \isakeyword{and}\ sg{\isadigit{1}}b\ \isakeyword{and}\ sg{\isadigit{2}}b\ \isacommand{have}\isamarkupfalse \ sg{\isadigit{4}}{\isacharcolon}\isanewline
\ \ {\isachardoublequoteopen}sKS\ secret\ {\isasymnotin}\ LocalSecrets\ PQ{\isachardoublequoteclose}\ \ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse \ {\isacharparenleft}rule\ LocalSecretsComposition{\isacharunderscore}neg{\isadigit{1}}{\isacharunderscore}s{\isacharparenright}\isanewline
\ \ \isacommand{from}\isamarkupfalse \ sg{\isadigit{3}}\ \isakeyword{and}\ sg{\isadigit{4}}\ \isakeyword{and}\ a{\isadigit{2}}\ \isacommand{show}\isamarkupfalse \ {\isacharquery}thesis\ \isacommand{by}\isamarkupfalse \ simp\isanewline
\isacommand{qed}\isamarkupfalse \endisatagproof
{\isafoldproof}\isadelimproof
\isanewline
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse \ know{\isacharunderscore}decomposition{\isacharcolon}\isanewline
\isakeyword{assumes}\ knowPQ{\isacharcolon}{\isachardoublequoteopen}know\ PQ\ m{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ subPQ{\isacharcolon}{\isachardoublequoteopen}subcomponents\ PQ\ {\isacharequal}\ {\isacharbraceleft}P{\isacharcomma}Q{\isacharbraceright}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ cCompI{\isacharcolon}{\isachardoublequoteopen}correctCompositionIn\ PQ{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ cCompLoc{\isacharcolon}{\isachardoublequoteopen}correctCompositionLoc\ PQ{\isachardoublequoteclose}\isanewline
\isakeyword{shows}\ {\isachardoublequoteopen}know\ P\ m\ {\isasymor}\ know\ Q\ m{\isachardoublequoteclose}\isanewline
\isadelimproof
\endisadelimproof
\isatagproof
\isacommand{proof}\isamarkupfalse \ {\isacharparenleft}cases\ m{\isacharparenright}\isanewline
\ \ \isacommand{fix}\isamarkupfalse \ key\isanewline
\ \ \isacommand{assume}\isamarkupfalse \ a{\isadigit{1}}{\isacharcolon}{\isachardoublequoteopen}m\ {\isacharequal}\ kKS\ key{\isachardoublequoteclose}\isanewline
\ \ \isacommand{from}\isamarkupfalse \ this\ \isacommand{show}\isamarkupfalse \ {\isacharquery}thesis\isanewline
\ \ \isacommand{proof}\isamarkupfalse \ {\isacharparenleft}cases\ {\isachardoublequoteopen}ine\ PQ\ {\isacharparenleft}kE\ key{\isacharparenright}{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse \ a{\isadigit{1}}{\isadigit{1}}{\isacharcolon}{\isachardoublequoteopen}ine\ PQ\ {\isacharparenleft}kE\ key{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{from}\isamarkupfalse \ this\ \isakeyword{and}\ subPQ\ \isakeyword{and}\ cCompI\ \isakeyword{and}\ a{\isadigit{1}}\ \isacommand{have}\isamarkupfalse \ \isanewline
\ \ \ \ \ {\isachardoublequoteopen}ine\ P\ {\isacharparenleft}kE\ key{\isacharparenright}\ \ {\isasymor}\ ine\ Q\ {\isacharparenleft}kE\ key{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse \ {\isacharparenleft}simp\ add{\isacharcolon}\ TBtheorem{\isadigit{1}}a{\isacharparenright}\isanewline
\ \ \ \ \isacommand{from}\isamarkupfalse \ this\ \isakeyword{and}\ a{\isadigit{1}}\ \isacommand{show}\isamarkupfalse \ {\isacharquery}thesis\ \isacommand{by}\isamarkupfalse \ auto\isanewline
\ \ \isacommand{next}\isamarkupfalse \isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse \ a{\isadigit{1}}{\isadigit{2}}{\isacharcolon}{\isachardoublequoteopen}{\isasymnot}\ ine\ PQ\ {\isacharparenleft}kE\ key{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{from}\isamarkupfalse \ this\ \isakeyword{and}\ knowPQ\ \isakeyword{and}\ a{\isadigit{1}}\ \isacommand{have}\isamarkupfalse \ sg{\isadigit{2}}{\isacharcolon}{\isachardoublequoteopen}kKS\ key\ {\isasymin}\ LocalSecrets\ PQ{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse \ auto\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse \ {\isacharquery}thesis\ \isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse \ {\isacharparenleft}cases\ {\isachardoublequoteopen}know\ Q\ m{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{assume}\isamarkupfalse \ {\isachardoublequoteopen}know\ Q\ m{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{from}\isamarkupfalse \ this\ \isacommand{show}\isamarkupfalse \ {\isacharquery}thesis\ \isacommand{by}\isamarkupfalse \ simp\isanewline
\ \ \ \ \isacommand{next}\isamarkupfalse \ \isanewline
\ \ \ \ \ \ \isacommand{assume}\isamarkupfalse \ not{\isacharunderscore}knowQm{\isacharcolon}{\isachardoublequoteopen}{\isasymnot}\ know\ Q\ m{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{from}\isamarkupfalse \ not{\isacharunderscore}knowQm\ \isakeyword{and}\ a{\isadigit{1}}\ \isacommand{have}\isamarkupfalse \ sg{\isadigit{3}}a{\isacharcolon}{\isachardoublequoteopen}{\isasymnot}\ ine\ Q\ {\isacharparenleft}kE\ key{\isacharparenright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse \ simp\isanewline
\ \ \ \ \ \ \isacommand{from}\isamarkupfalse \ not{\isacharunderscore}knowQm\ \isakeyword{and}\ a{\isadigit{1}}\ \isacommand{have}\isamarkupfalse \ sg{\isadigit{3}}b{\isacharcolon}{\isachardoublequoteopen}kKS\ key\ {\isasymnotin}\ LocalSecrets\ Q{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse \ simp\isanewline
\ \ \ \ \ \ \isacommand{show}\isamarkupfalse \ {\isacharquery}thesis\isanewline
\ \ \ \ \ \ \isacommand{proof}\isamarkupfalse \ {\isacharparenleft}cases\ {\isachardoublequoteopen}kKS\ key\ {\isasymin}\ LocalSecrets\ P{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \isacommand{assume}\isamarkupfalse \ {\isachardoublequoteopen}kKS\ key\ {\isasymin}\ LocalSecrets\ P{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{from}\isamarkupfalse \ this\ \isakeyword{and}\ a{\isadigit{1}}\ \isacommand{show}\isamarkupfalse \ {\isacharquery}thesis\ \isacommand{by}\isamarkupfalse \ simp\isanewline
\ \ \ \ \ \ \isacommand{next}\isamarkupfalse \isanewline
\ \ \ \ \ \ \ \ \isacommand{assume}\isamarkupfalse \ {\isachardoublequoteopen}kKS\ key\ {\isasymnotin}\ LocalSecrets\ P{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{from}\isamarkupfalse \ sg{\isadigit{2}}\ \isakeyword{and}\ subPQ\ \isakeyword{and}\ cCompLoc\ \isakeyword{and}\ sg{\isadigit{3}}a\ \isakeyword{and}\ this\ \isakeyword{and}\ sg{\isadigit{3}}b\ \isacommand{have}\isamarkupfalse \ {\isachardoublequoteopen}ine\ P\ {\isacharparenleft}kE\ key{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse \ {\isacharparenleft}simp\ add{\isacharcolon}\ LocalSecretsComposition{\isacharunderscore}ine{\isadigit{1}}{\isacharunderscore}k{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \isacommand{from}\isamarkupfalse \ this\ \isakeyword{and}\ a{\isadigit{1}}\ \isacommand{show}\isamarkupfalse \ {\isacharquery}thesis\ \isacommand{by}\isamarkupfalse \ simp\isanewline
\ \ \ \ \ \ \isacommand{qed}\isamarkupfalse \isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse \isanewline
\ \ \isacommand{qed}\isamarkupfalse \isanewline
\isacommand{next}\isamarkupfalse \isanewline
\ \ \isacommand{fix}\isamarkupfalse \ secret\isanewline
\ \ \isacommand{assume}\isamarkupfalse \ a{\isadigit{2}}{\isacharcolon}{\isachardoublequoteopen}m\ {\isacharequal}\ sKS\ secret{\isachardoublequoteclose}\isanewline
\ \ \isacommand{from}\isamarkupfalse \ this\ \isacommand{show}\isamarkupfalse \ {\isacharquery}thesis\isanewline
\ \ \isacommand{proof}\isamarkupfalse \ {\isacharparenleft}cases\ {\isachardoublequoteopen}ine\ PQ\ {\isacharparenleft}sE\ secret{\isacharparenright}{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse \ a{\isadigit{2}}{\isadigit{1}}{\isacharcolon}{\isachardoublequoteopen}ine\ PQ\ {\isacharparenleft}sE\ secret{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{from}\isamarkupfalse \ this\ \isakeyword{and}\ subPQ\ \isakeyword{and}\ cCompI\ \isakeyword{and}\ a{\isadigit{2}}\ \isacommand{have}\isamarkupfalse \isanewline
\ \ \ \ \ {\isachardoublequoteopen}ine\ P\ {\isacharparenleft}sE\ secret{\isacharparenright}\ \ {\isasymor}\ ine\ Q\ {\isacharparenleft}sE\ secret{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse \ {\isacharparenleft}simp\ add{\isacharcolon}\ TBtheorem{\isadigit{1}}a{\isacharparenright}\isanewline
\ \ \ \ \isacommand{from}\isamarkupfalse \ this\ \isakeyword{and}\ a{\isadigit{2}}\ \isacommand{show}\isamarkupfalse \ {\isacharquery}thesis\ \isacommand{by}\isamarkupfalse \ auto\isanewline
\ \ \isacommand{next}\isamarkupfalse \isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse \ a{\isadigit{2}}{\isadigit{2}}{\isacharcolon}{\isachardoublequoteopen}{\isasymnot}\ ine\ PQ\ {\isacharparenleft}sE\ secret{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{from}\isamarkupfalse \ this\ \isakeyword{and}\ knowPQ\ \isakeyword{and}\ a{\isadigit{2}}\ \isacommand{have}\isamarkupfalse \ sg{\isadigit{5}}{\isacharcolon}\isanewline
\ \ \ \ \ {\isachardoublequoteopen}sKS\ secret\ {\isasymin}\ LocalSecrets\ PQ{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse \ auto\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse \ {\isacharquery}thesis\ \isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse \ {\isacharparenleft}cases\ {\isachardoublequoteopen}know\ Q\ m{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{assume}\isamarkupfalse \ {\isachardoublequoteopen}know\ Q\ m{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{from}\isamarkupfalse \ this\ \isacommand{show}\isamarkupfalse \ {\isacharquery}thesis\ \isacommand{by}\isamarkupfalse \ simp\isanewline
\ \ \ \ \isacommand{next}\isamarkupfalse \ \isanewline
\ \ \ \ \ \ \isacommand{assume}\isamarkupfalse \ not{\isacharunderscore}knowQm{\isacharcolon}{\isachardoublequoteopen}{\isasymnot}\ know\ Q\ m{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{from}\isamarkupfalse \ not{\isacharunderscore}knowQm\ \isakeyword{and}\ a{\isadigit{2}}\ \isacommand{have}\isamarkupfalse \ sg{\isadigit{6}}a{\isacharcolon}{\isachardoublequoteopen}{\isasymnot}\ ine\ Q\ {\isacharparenleft}sE\ secret{\isacharparenright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse \ simp\isanewline
\ \ \ \ \ \ \isacommand{from}\isamarkupfalse \ not{\isacharunderscore}knowQm\ \isakeyword{and}\ a{\isadigit{2}}\ \isacommand{have}\isamarkupfalse \ sg{\isadigit{6}}b{\isacharcolon}{\isachardoublequoteopen}sKS\ secret\ {\isasymnotin}\ LocalSecrets\ Q{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse \ simp\isanewline
\ \ \ \ \ \ \isacommand{show}\isamarkupfalse \ {\isacharquery}thesis\isanewline
\ \ \ \ \ \ \isacommand{proof}\isamarkupfalse \ {\isacharparenleft}cases\ {\isachardoublequoteopen}sKS\ secret\ {\isasymin}\ LocalSecrets\ P{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \isacommand{assume}\isamarkupfalse \ {\isachardoublequoteopen}sKS\ secret\ {\isasymin}\ LocalSecrets\ P{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{from}\isamarkupfalse \ this\ \isakeyword{and}\ a{\isadigit{2}}\ \isacommand{show}\isamarkupfalse \ {\isacharquery}thesis\ \isacommand{by}\isamarkupfalse \ simp\isanewline
\ \ \ \ \ \ \isacommand{next}\isamarkupfalse \isanewline
\ \ \ \ \ \ \ \ \isacommand{assume}\isamarkupfalse \ {\isachardoublequoteopen}sKS\ secret\ {\isasymnotin}\ LocalSecrets\ P{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{from}\isamarkupfalse \ sg{\isadigit{5}}\ \isakeyword{and}\ subPQ\ \isakeyword{and}\ cCompLoc\ \isakeyword{and}\ sg{\isadigit{6}}a\ \isakeyword{and}\ this\ \isakeyword{and}\ sg{\isadigit{6}}b\ \isacommand{have}\isamarkupfalse \ \isanewline
\ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}ine\ P\ {\isacharparenleft}sE\ secret{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse \ {\isacharparenleft}simp\ add{\isacharcolon}\ LocalSecretsComposition{\isacharunderscore}ine{\isadigit{1}}{\isacharunderscore}s{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \isacommand{from}\isamarkupfalse \ this\ \isakeyword{and}\ a{\isadigit{2}}\ \isacommand{show}\isamarkupfalse \ {\isacharquery}thesis\ \isacommand{by}\isamarkupfalse \ simp\isanewline
\ \ \ \ \ \ \isacommand{qed}\isamarkupfalse \isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse \isanewline
\ \ \isacommand{qed}\isamarkupfalse \isanewline
\isacommand{qed}\isamarkupfalse \endisatagproof
{\isafoldproof}\isadelimproof
\isanewline
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse \ eout{\isacharunderscore}knows{\isacharunderscore}nonKS{\isacharunderscore}k{\isacharcolon}\isanewline
\ \isakeyword{assumes}\ {\isachardoublequoteopen}m\ {\isasymnotin}\ {\isacharparenleft}specKeys\ A{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}eout\ A\ {\isacharparenleft}kE\ m{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}eoutKnowsECorrect\ A\ {\isacharparenleft}kE\ m{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \isakeyword{shows}\ {\isachardoublequoteopen}knows\ A\ {\isacharbrackleft}kE\ m{\isacharbrackright}{\isachardoublequoteclose}\isanewline
\isadelimproof
\endisadelimproof
\isatagproof
\isacommand{using}\isamarkupfalse \ assms\isanewline
\isacommand{by}\isamarkupfalse \ {\isacharparenleft}metis\ Expression{\isachardot}distinct{\isacharparenleft}{\isadigit{1}}{\isacharparenright}\ Expression{\isachardot}inject{\isacharparenleft}{\isadigit{1}}{\isacharparenright}\ eoutKnowsECorrect{\isacharunderscore}L{\isadigit{1}}{\isacharparenright}\endisatagproof
{\isafoldproof}\isadelimproof
\isanewline
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse \ eout{\isacharunderscore}knows{\isacharunderscore}nonKS{\isacharunderscore}s{\isacharcolon}\isanewline
\ \isakeyword{assumes}\ h{\isadigit{1}}{\isacharcolon}{\isachardoublequoteopen}m\ {\isasymnotin}\ specSecrets\ A{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \isakeyword{and}\ h{\isadigit{2}}{\isacharcolon}{\isachardoublequoteopen}eout\ A\ {\isacharparenleft}sE\ m{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \isakeyword{and}\ h{\isadigit{3}}{\isacharcolon}{\isachardoublequoteopen}eoutKnowsECorrect\ A\ {\isacharparenleft}sE\ m{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \isakeyword{shows}\ {\isachardoublequoteopen}knows\ A\ {\isacharbrackleft}sE\ m{\isacharbrackright}{\isachardoublequoteclose}\isanewline
\isadelimproof
\endisadelimproof
\isatagproof
\isacommand{using}\isamarkupfalse \ assms\isanewline
\isacommand{by}\isamarkupfalse \ {\isacharparenleft}metis\ Expression{\isachardot}distinct{\isacharparenleft}{\isadigit{1}}{\isacharparenright}\ Expression{\isachardot}inject{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ eoutKnowsECorrect{\isacharunderscore}def{\isacharparenright}\endisatagproof
{\isafoldproof}\isadelimproof
\isanewline
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse \ not{\isacharunderscore}knows{\isacharunderscore}k{\isacharunderscore}not{\isacharunderscore}ine{\isacharcolon}\isanewline
\isakeyword{assumes}\ {\isachardoublequoteopen}{\isasymnot}\ knows\ A\ {\isacharbrackleft}kE\ m{\isacharbrackright}{\isachardoublequoteclose}\isanewline
\isakeyword{shows}\ \ \ \ {\isachardoublequoteopen}{\isasymnot}\ ine\ A\ {\isacharparenleft}kE\ m{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isadelimproof
\endisadelimproof
\isatagproof
\isacommand{using}\isamarkupfalse \ assms\ \isacommand{by}\isamarkupfalse \ {\isacharparenleft}metis\ knows{\isadigit{2}}know{\isacharunderscore}neg{\isacharunderscore}k\ not{\isacharunderscore}know{\isacharunderscore}k{\isacharunderscore}not{\isacharunderscore}ine{\isacharparenright}\endisatagproof
{\isafoldproof}\isadelimproof
\ \isanewline
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse \ not{\isacharunderscore}knows{\isacharunderscore}s{\isacharunderscore}not{\isacharunderscore}ine{\isacharcolon}\isanewline
\isakeyword{assumes}\ {\isachardoublequoteopen}{\isasymnot}\ knows\ A\ {\isacharbrackleft}sE\ m{\isacharbrackright}{\isachardoublequoteclose}\isanewline
\isakeyword{shows}\ \ \ \ {\isachardoublequoteopen}{\isasymnot}\ ine\ A\ {\isacharparenleft}sE\ m{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isadelimproof
\endisadelimproof
\isatagproof
\isacommand{using}\isamarkupfalse \ assms\ \isacommand{by}\isamarkupfalse \ {\isacharparenleft}metis\ knows{\isadigit{2}}know{\isacharunderscore}neg{\isacharunderscore}s\ not{\isacharunderscore}know{\isacharunderscore}s{\isacharunderscore}not{\isacharunderscore}ine{\isacharparenright}\endisatagproof
{\isafoldproof}\isadelimproof
\ \isanewline
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse \ not{\isacharunderscore}knows{\isacharunderscore}k{\isacharunderscore}not{\isacharunderscore}eout{\isacharcolon}\isanewline
\isakeyword{assumes}\ {\isachardoublequoteopen}m\ {\isasymnotin}\ specKeys\ A{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}{\isasymnot}\ knows\ A\ {\isacharbrackleft}kE\ m{\isacharbrackright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}eoutKnowsECorrect\ A\ {\isacharparenleft}kE\ m{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isakeyword{shows}\ \ \ \ {\isachardoublequoteopen}{\isasymnot}\ eout\ A\ {\isacharparenleft}kE\ m{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isadelimproof
\endisadelimproof
\isatagproof
\isacommand{using}\isamarkupfalse \ assms\ \isacommand{by}\isamarkupfalse \ {\isacharparenleft}metis\ eout{\isacharunderscore}knows{\isacharunderscore}nonKS{\isacharunderscore}k{\isacharparenright}\endisatagproof
{\isafoldproof}\isadelimproof
\isanewline
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse \ not{\isacharunderscore}knows{\isacharunderscore}s{\isacharunderscore}not{\isacharunderscore}eout{\isacharcolon}\isanewline
\isakeyword{assumes}\ {\isachardoublequoteopen}m\ {\isasymnotin}\ specSecrets\ A{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}{\isasymnot}\ knows\ A\ {\isacharbrackleft}sE\ m{\isacharbrackright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}eoutKnowsECorrect\ A\ {\isacharparenleft}sE\ m{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isakeyword{shows}\ \ \ \ {\isachardoublequoteopen}{\isasymnot}\ eout\ A\ {\isacharparenleft}sE\ m{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isadelimproof
\endisadelimproof
\isatagproof
\isacommand{using}\isamarkupfalse \ assms\ \isacommand{by}\isamarkupfalse \ {\isacharparenleft}metis\ eout{\isacharunderscore}knows{\isacharunderscore}nonKS{\isacharunderscore}s{\isacharparenright}\endisatagproof
{\isafoldproof}\isadelimproof
\ \isanewline
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse \ \ adv{\isacharunderscore}not{\isacharunderscore}knows{\isadigit{1}}{\isacharcolon}\isanewline
\isakeyword{assumes}\ {\isachardoublequoteopen}out\ P\ {\isasymsubseteq}\ ins\ A{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}{\isasymnot}\ knows\ A\ {\isacharbrackleft}kE\ m{\isacharbrackright}{\isachardoublequoteclose}\isanewline
\isakeyword{shows}\ \ \ \ {\isachardoublequoteopen}{\isasymnot}\ eout\ P\ {\isacharparenleft}kE\ m{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isadelimproof
\endisadelimproof
\isatagproof
\isacommand{using}\isamarkupfalse \ assms\ \isacommand{by}\isamarkupfalse \ {\isacharparenleft}metis\ adv{\isacharunderscore}not{\isacharunderscore}know{\isadigit{1}}\ knows{\isadigit{2}}know{\isacharunderscore}neg{\isacharunderscore}k{\isacharparenright}\endisatagproof
{\isafoldproof}\isadelimproof
\isanewline
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse \ adv{\isacharunderscore}not{\isacharunderscore}knows{\isadigit{2}}{\isacharcolon}\isanewline
\isakeyword{assumes}\ {\isachardoublequoteopen}out\ P\ \ {\isasymsubseteq}\ ins\ A{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}{\isasymnot}\ knows\ A\ {\isacharbrackleft}sE\ m{\isacharbrackright}{\isachardoublequoteclose}\ \isanewline
\isakeyword{shows}\ \ \ \ {\isachardoublequoteopen}{\isasymnot}\ eout\ P\ {\isacharparenleft}sE\ m{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isadelimproof
\endisadelimproof
\isatagproof
\isacommand{using}\isamarkupfalse \ assms\ \isacommand{by}\isamarkupfalse \ {\isacharparenleft}metis\ adv{\isacharunderscore}not{\isacharunderscore}know{\isadigit{2}}\ knows{\isadigit{2}}know{\isacharunderscore}neg{\isacharunderscore}s{\isacharparenright}\endisatagproof
{\isafoldproof}\isadelimproof
\isanewline
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse \ knows{\isacharunderscore}decomposition{\isacharunderscore}{\isadigit{1}}{\isacharunderscore}k{\isacharcolon}\isanewline
\isakeyword{assumes}\ {\isachardoublequoteopen}kKS\ a\ {\isasymnotin}\ specKeysSecrets\ P{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}kKS\ a\ {\isasymnotin}\ specKeysSecrets\ Q{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}subcomponents\ PQ\ {\isacharequal}\ {\isacharbraceleft}P{\isacharcomma}\ Q{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}knows\ PQ\ {\isacharbrackleft}kE\ a{\isacharbrackright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}correctCompositionIn\ PQ{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}correctCompositionLoc\ PQ{\isachardoublequoteclose}\isanewline
\isakeyword{shows}\ {\isachardoublequoteopen}knows\ P\ {\isacharbrackleft}kE\ a{\isacharbrackright}\ {\isasymor}\ knows\ Q\ {\isacharbrackleft}kE\ a{\isacharbrackright}{\isachardoublequoteclose}\isanewline
\isadelimproof
\endisadelimproof
\isatagproof
\isacommand{using}\isamarkupfalse \ assms\ \isacommand{by}\isamarkupfalse \ {\isacharparenleft}metis\ know{\isacharunderscore}decomposition\ knows{\isadigit{1}}k{\isacharparenright}\endisatagproof
{\isafoldproof}\isadelimproof
\isanewline
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse \ knows{\isacharunderscore}decomposition{\isacharunderscore}{\isadigit{1}}{\isacharunderscore}s{\isacharcolon}\isanewline
\isakeyword{assumes}\ {\isachardoublequoteopen}sKS\ a\ {\isasymnotin}\ specKeysSecrets\ P{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}sKS\ a\ {\isasymnotin}\ specKeysSecrets\ Q{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}subcomponents\ PQ\ {\isacharequal}\ {\isacharbraceleft}P{\isacharcomma}\ Q{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}knows\ PQ\ {\isacharbrackleft}sE\ a{\isacharbrackright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}correctCompositionIn\ PQ{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}correctCompositionLoc\ PQ{\isachardoublequoteclose}\isanewline
\isakeyword{shows}\ {\isachardoublequoteopen}knows\ P\ {\isacharbrackleft}sE\ a{\isacharbrackright}\ {\isasymor}\ knows\ Q\ {\isacharbrackleft}sE\ a{\isacharbrackright}{\isachardoublequoteclose}\isanewline
\isadelimproof
\endisadelimproof
\isatagproof
\isacommand{using}\isamarkupfalse \ assms\ \isacommand{by}\isamarkupfalse \ {\isacharparenleft}metis\ know{\isacharunderscore}decomposition\ knows{\isadigit{1}}s{\isacharparenright}\endisatagproof
{\isafoldproof}\isadelimproof
\isanewline
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse \ knows{\isacharunderscore}decomposition{\isacharunderscore}{\isadigit{1}}{\isacharcolon}\isanewline
\isakeyword{assumes}\ {\isachardoublequoteopen}subcomponents\ PQ\ {\isacharequal}\ {\isacharbraceleft}P{\isacharcomma}\ Q{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}knows\ PQ\ {\isacharbrackleft}a{\isacharbrackright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}correctCompositionIn\ PQ{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}correctCompositionLoc\ PQ{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}{\isacharparenleft}{\isasymexists}\ z{\isachardot}\ a\ {\isacharequal}\ kE\ z{\isacharparenright}\ {\isasymor}\ {\isacharparenleft}{\isasymexists}\ z{\isachardot}\ a\ {\isacharequal}\ sE\ z{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}{\isasymforall}\ z{\isachardot}\ a\ {\isacharequal}\ kE\ z\ {\isasymlongrightarrow}\ \isanewline
\ \ \ \ \ \ \ \ \ kKS\ z\ {\isasymnotin}\ specKeysSecrets\ P\ {\isasymand}\ kKS\ z\ {\isasymnotin}\ specKeysSecrets\ Q{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ h{\isadigit{7}}{\isacharcolon}{\isachardoublequoteopen}{\isasymforall}\ z{\isachardot}\ a\ {\isacharequal}\ sE\ z\ {\isasymlongrightarrow}\ \isanewline
\ \ \ \ \ \ \ \ \ sKS\ z\ {\isasymnotin}\ specKeysSecrets\ P\ {\isasymand}\ sKS\ z\ {\isasymnotin}\ specKeysSecrets\ Q{\isachardoublequoteclose}\isanewline
\isakeyword{shows}\ {\isachardoublequoteopen}knows\ P\ {\isacharbrackleft}a{\isacharbrackright}\ {\isasymor}\ knows\ Q\ {\isacharbrackleft}a{\isacharbrackright}{\isachardoublequoteclose}\isanewline
\isadelimproof
\endisadelimproof
\isatagproof
\isacommand{using}\isamarkupfalse \ assms\isanewline
\isacommand{by}\isamarkupfalse \ {\isacharparenleft}metis\ knows{\isacharunderscore}decomposition{\isacharunderscore}{\isadigit{1}}{\isacharunderscore}k\ knows{\isacharunderscore}decomposition{\isacharunderscore}{\isadigit{1}}{\isacharunderscore}s{\isacharparenright}\endisatagproof
{\isafoldproof}\isadelimproof
\ \isanewline
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse \ knows{\isacharunderscore}composition{\isadigit{1}}{\isacharunderscore}k{\isacharcolon}\isanewline
\isakeyword{assumes}\ {\isachardoublequoteopen}{\isacharparenleft}kKS\ m{\isacharparenright}\ {\isasymnotin}\ specKeysSecrets\ P{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}{\isacharparenleft}kKS\ m{\isacharparenright}\ {\isasymnotin}\ specKeysSecrets\ Q{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}knows\ P\ {\isacharbrackleft}kE\ m{\isacharbrackright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}subcomponents\ PQ\ {\isacharequal}\ {\isacharbraceleft}P{\isacharcomma}Q{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}correctCompositionIn\ PQ{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}correctCompositionKS\ PQ{\isachardoublequoteclose}\isanewline
\isakeyword{shows}\ {\isachardoublequoteopen}knows\ PQ\ {\isacharbrackleft}kE\ m{\isacharbrackright}{\isachardoublequoteclose}\isanewline
\isadelimproof
\endisadelimproof
\isatagproof
\isacommand{using}\isamarkupfalse \ assms\ \isacommand{by}\isamarkupfalse \ {\isacharparenleft}metis\ know{\isacharunderscore}composition\ knows{\isadigit{1}}k{\isacharparenright}\endisatagproof
{\isafoldproof}\isadelimproof
\isanewline
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse \ knows{\isacharunderscore}composition{\isadigit{1}}{\isacharunderscore}s{\isacharcolon}\isanewline
\isakeyword{assumes}\ {\isachardoublequoteopen}{\isacharparenleft}sKS\ m{\isacharparenright}\ {\isasymnotin}\ specKeysSecrets\ P{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}{\isacharparenleft}sKS\ m{\isacharparenright}\ {\isasymnotin}\ specKeysSecrets\ Q{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}knows\ P\ {\isacharbrackleft}sE\ m{\isacharbrackright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}subcomponents\ PQ\ {\isacharequal}\ {\isacharbraceleft}P{\isacharcomma}Q{\isacharbraceright}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}correctCompositionIn\ PQ{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}correctCompositionKS\ PQ{\isachardoublequoteclose}\isanewline
\isakeyword{shows}\ {\isachardoublequoteopen}knows\ PQ\ {\isacharbrackleft}sE\ m{\isacharbrackright}{\isachardoublequoteclose}\isanewline
\isadelimproof
\endisadelimproof
\isatagproof
\isacommand{using}\isamarkupfalse \ assms\ \isacommand{by}\isamarkupfalse \ {\isacharparenleft}metis\ know{\isacharunderscore}composition\ knows{\isadigit{1}}s{\isacharparenright}\endisatagproof
{\isafoldproof}\isadelimproof
\isanewline
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse \ knows{\isacharunderscore}composition{\isadigit{2}}{\isacharunderscore}k{\isacharcolon}\isanewline
\isakeyword{assumes}\ {\isachardoublequoteopen}{\isacharparenleft}kKS\ m{\isacharparenright}\ {\isasymnotin}\ specKeysSecrets\ P{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}{\isacharparenleft}kKS\ m{\isacharparenright}\ {\isasymnotin}\ specKeysSecrets\ Q{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}knows\ Q\ {\isacharbrackleft}kE\ m{\isacharbrackright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}subcomponents\ PQ\ {\isacharequal}\ {\isacharbraceleft}P{\isacharcomma}Q{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}correctCompositionIn\ PQ{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}correctCompositionKS\ PQ{\isachardoublequoteclose}\isanewline
\isakeyword{shows}\ {\isachardoublequoteopen}knows\ PQ\ {\isacharbrackleft}kE\ m{\isacharbrackright}{\isachardoublequoteclose}\isanewline
\isadelimproof
\endisadelimproof
\isatagproof
\isacommand{using}\isamarkupfalse \ assms\isanewline
\isacommand{by}\isamarkupfalse \ {\isacharparenleft}metis\ know{\isadigit{2}}knowsPQ{\isacharunderscore}k\ know{\isacharunderscore}composition\ knows{\isadigit{2}}know{\isacharunderscore}k{\isacharparenright}\endisatagproof
{\isafoldproof}\isadelimproof
\isanewline
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse \ knows{\isacharunderscore}composition{\isadigit{2}}{\isacharunderscore}s{\isacharcolon}\isanewline
\isakeyword{assumes}\ {\isachardoublequoteopen}{\isacharparenleft}sKS\ m{\isacharparenright}\ {\isasymnotin}\ specKeysSecrets\ P{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}{\isacharparenleft}sKS\ m{\isacharparenright}\ {\isasymnotin}\ specKeysSecrets\ Q{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}knows\ Q\ {\isacharbrackleft}sE\ m{\isacharbrackright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}subcomponents\ PQ\ {\isacharequal}\ {\isacharbraceleft}P{\isacharcomma}Q{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}correctCompositionIn\ PQ{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}correctCompositionKS\ PQ{\isachardoublequoteclose}\ \isanewline
\isakeyword{shows}\ {\isachardoublequoteopen}knows\ PQ\ {\isacharbrackleft}sE\ m{\isacharbrackright}{\isachardoublequoteclose}\isanewline
\isadelimproof
\endisadelimproof
\isatagproof
\isacommand{using}\isamarkupfalse \ assms\isanewline
\isacommand{by}\isamarkupfalse \ {\isacharparenleft}metis\ know{\isadigit{2}}knowsPQ{\isacharunderscore}s\ know{\isacharunderscore}composition\ knows{\isadigit{2}}know{\isacharunderscore}s{\isacharparenright}\endisatagproof
{\isafoldproof}\isadelimproof
\isanewline
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse \ knows{\isacharunderscore}composition{\isacharunderscore}neg{\isadigit{1}}{\isacharunderscore}k{\isacharcolon}\isanewline
\isakeyword{assumes}\ {\isachardoublequoteopen}kKS\ m\ {\isasymnotin}\ specKeysSecrets\ P{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}kKS\ m\ {\isasymnotin}\ specKeysSecrets\ Q{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}{\isasymnot}\ knows\ P\ {\isacharbrackleft}kE\ m{\isacharbrackright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}{\isasymnot}\ knows\ Q\ {\isacharbrackleft}kE\ m{\isacharbrackright}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}subcomponents\ PQ\ {\isacharequal}\ {\isacharbraceleft}P{\isacharcomma}Q{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}correctCompositionLoc\ PQ{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}correctCompositionIn\ PQ{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}correctCompositionKS\ PQ{\isachardoublequoteclose}\ \isanewline
\isakeyword{shows}\ {\isachardoublequoteopen}{\isasymnot}\ knows\ PQ\ {\isacharbrackleft}kE\ m{\isacharbrackright}{\isachardoublequoteclose}\isanewline
\isadelimproof
\endisadelimproof
\isatagproof
\isacommand{using}\isamarkupfalse \ assms\ \isacommand{by}\isamarkupfalse \ {\isacharparenleft}metis\ know{\isacharunderscore}decomposition\ knows{\isadigit{1}}k{\isacharparenright}\endisatagproof
{\isafoldproof}\isadelimproof
\isanewline
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse \ knows{\isacharunderscore}composition{\isacharunderscore}neg{\isadigit{1}}{\isacharunderscore}s{\isacharcolon}\isanewline
\isakeyword{assumes}\ {\isachardoublequoteopen}sKS\ m\ {\isasymnotin}\ specKeysSecrets\ P{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}sKS\ m\ {\isasymnotin}\ specKeysSecrets\ Q{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}{\isasymnot}\ knows\ P\ {\isacharbrackleft}sE\ m{\isacharbrackright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}{\isasymnot}\ knows\ Q\ {\isacharbrackleft}sE\ m{\isacharbrackright}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}subcomponents\ PQ\ {\isacharequal}\ {\isacharbraceleft}P{\isacharcomma}Q{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}correctCompositionLoc\ PQ{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}correctCompositionIn\ PQ{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}correctCompositionKS\ PQ{\isachardoublequoteclose}\ \isanewline
\isakeyword{shows}\ {\isachardoublequoteopen}{\isasymnot}\ knows\ PQ\ {\isacharbrackleft}sE\ m{\isacharbrackright}{\isachardoublequoteclose}\isanewline
\isadelimproof
\endisadelimproof
\isatagproof
\isacommand{using}\isamarkupfalse \ assms\ \isacommand{by}\isamarkupfalse \ {\isacharparenleft}metis\ knows{\isacharunderscore}decomposition{\isacharunderscore}{\isadigit{1}}{\isacharunderscore}s{\isacharparenright}\endisatagproof
{\isafoldproof}\isadelimproof
\isanewline
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse \ knows{\isacharunderscore}concat{\isacharunderscore}{\isadigit{1}}{\isacharcolon}\isanewline
\isakeyword{assumes}\ {\isachardoublequoteopen}knows\ P\ {\isacharparenleft}a\ {\isacharhash}\ e{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isakeyword{shows}\ \ \ \ {\isachardoublequoteopen}knows\ P\ {\isacharbrackleft}a{\isacharbrackright}{\isachardoublequoteclose}\isanewline
\isadelimproof
\endisadelimproof
\isatagproof
\isacommand{using}\isamarkupfalse \ assms\ \isacommand{by}\isamarkupfalse \ {\isacharparenleft}metis\ append{\isacharunderscore}Cons\ append{\isacharunderscore}Nil\ knows{\isadigit{2}}{\isacharparenright}\endisatagproof
{\isafoldproof}\isadelimproof
\isanewline
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse \ knows{\isacharunderscore}concat{\isacharunderscore}{\isadigit{2}}{\isacharcolon}\isanewline
\isakeyword{assumes}\ {\isachardoublequoteopen}knows\ P\ {\isacharparenleft}a\ {\isacharhash}\ e{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isakeyword{shows}\ \ \ \ {\isachardoublequoteopen}knows\ P\ e{\isachardoublequoteclose}\isanewline
\isadelimproof
\endisadelimproof
\isatagproof
\isacommand{using}\isamarkupfalse \ assms\ \isacommand{by}\isamarkupfalse \ {\isacharparenleft}metis\ append{\isacharunderscore}Cons\ append{\isacharunderscore}Nil\ knows{\isadigit{2}}a{\isacharparenright}\endisatagproof
{\isafoldproof}\isadelimproof
\isanewline
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse \ knows{\isacharunderscore}concat{\isacharunderscore}{\isadigit{3}}{\isacharcolon}\isanewline
\isakeyword{assumes}\ {\isachardoublequoteopen}knows\ P\ {\isacharbrackleft}a{\isacharbrackright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}knows\ P\ e{\isachardoublequoteclose}\isanewline
\isakeyword{shows}\ {\isachardoublequoteopen}knows\ P\ {\isacharparenleft}a\ {\isacharhash}\ e{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isadelimproof
\endisadelimproof
\isatagproof
\isacommand{using}\isamarkupfalse \ assms\ \isacommand{by}\isamarkupfalse \ {\isacharparenleft}metis\ append{\isacharunderscore}Cons\ append{\isacharunderscore}Nil\ knows{\isadigit{3}}{\isacharparenright}\endisatagproof
{\isafoldproof}\isadelimproof
\isanewline
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse \ not{\isacharunderscore}knows{\isacharunderscore}conc{\isacharunderscore}knows{\isacharunderscore}elem{\isacharunderscore}not{\isacharunderscore}knows{\isacharunderscore}tail{\isacharcolon}\isanewline
\isakeyword{assumes}\ {\isachardoublequoteopen}{\isasymnot}\ knows\ P\ {\isacharparenleft}a\ {\isacharhash}\ e{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}knows\ P\ {\isacharbrackleft}a{\isacharbrackright}{\isachardoublequoteclose}\isanewline
\isakeyword{shows}\ {\isachardoublequoteopen}{\isasymnot}\ knows\ P\ e{\isachardoublequoteclose}\isanewline
\isadelimproof
\endisadelimproof
\isatagproof
\isacommand{using}\isamarkupfalse \ assms\ \isacommand{by}\isamarkupfalse \ {\isacharparenleft}metis\ knows{\isacharunderscore}concat{\isacharunderscore}{\isadigit{3}}{\isacharparenright}\endisatagproof
{\isafoldproof}\isadelimproof
\isanewline
\endisadelimproof
\ \ \ \ \isanewline
\isacommand{lemma}\isamarkupfalse \ not{\isacharunderscore}knows{\isacharunderscore}conc{\isacharunderscore}not{\isacharunderscore}knows{\isacharunderscore}elem{\isacharunderscore}tail{\isacharcolon}\isanewline
\isakeyword{assumes}\ {\isachardoublequoteopen}{\isasymnot}\ knows\ P\ {\isacharparenleft}a{\isacharhash}e{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isakeyword{shows}\ \ \ \ {\isachardoublequoteopen}{\isasymnot}\ knows\ P\ {\isacharbrackleft}a{\isacharbrackright}\ {\isasymor}\ {\isasymnot}\ knows\ P\ e{\isachardoublequoteclose}\isanewline
\isadelimproof
\endisadelimproof
\isatagproof
\isacommand{using}\isamarkupfalse \ assms\ \isacommand{by}\isamarkupfalse \ {\isacharparenleft}metis\ append{\isacharunderscore}Cons\ append{\isacharunderscore}Nil\ knows{\isadigit{3}}{\isacharparenright}\endisatagproof
{\isafoldproof}\isadelimproof
\isanewline
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse \ not{\isacharunderscore}knows{\isacharunderscore}elem{\isacharunderscore}not{\isacharunderscore}knows{\isacharunderscore}conc{\isacharcolon}\isanewline
\isakeyword{assumes}\ {\isachardoublequoteopen}{\isasymnot}\ knows\ P\ {\isacharbrackleft}a{\isacharbrackright}{\isachardoublequoteclose}\isanewline
\isakeyword{shows}\ \ \ \ {\isachardoublequoteopen}{\isasymnot}\ knows\ P\ {\isacharparenleft}a\ {\isacharhash}\ e{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isadelimproof
\endisadelimproof
\isatagproof
\isacommand{using}\isamarkupfalse \ assms\ \isacommand{by}\isamarkupfalse \ {\isacharparenleft}metis\ knows{\isacharunderscore}concat{\isacharunderscore}{\isadigit{1}}{\isacharparenright}\endisatagproof
{\isafoldproof}\isadelimproof
\isanewline
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse \ not{\isacharunderscore}knows{\isacharunderscore}tail{\isacharunderscore}not{\isacharunderscore}knows{\isacharunderscore}conc{\isacharcolon}\isanewline
\isakeyword{assumes}\ {\isachardoublequoteopen}{\isasymnot}\ knows\ P\ e{\isachardoublequoteclose}\isanewline
\isakeyword{shows}\ \ \ \ {\isachardoublequoteopen}{\isasymnot}\ knows\ P\ {\isacharparenleft}a\ {\isacharhash}\ e{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isadelimproof
\endisadelimproof
\isatagproof
\isacommand{using}\isamarkupfalse \ assms\ \isacommand{by}\isamarkupfalse \ {\isacharparenleft}metis\ knows{\isacharunderscore}concat{\isacharunderscore}{\isadigit{2}}{\isacharparenright}\endisatagproof
{\isafoldproof}\isadelimproof
\isanewline
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse \ knows{\isacharunderscore}composition{\isadigit{3}}{\isacharcolon}\isanewline
\ \isakeyword{fixes}\ e{\isacharcolon}{\isacharcolon}{\isachardoublequoteopen}Expression\ list{\isachardoublequoteclose}\isanewline
\ \isakeyword{assumes}\ {\isachardoublequoteopen}knows\ P\ e{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \isakeyword{and}\ subPQ{\isacharcolon}{\isachardoublequoteopen}subcomponents\ PQ\ {\isacharequal}\ {\isacharbraceleft}P{\isacharcomma}Q{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \isakeyword{and}\ cCompI{\isacharcolon}{\isachardoublequoteopen}correctCompositionIn\ PQ{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \isakeyword{and}\ cCompKS{\isacharcolon}{\isachardoublequoteopen}correctCompositionKS\ PQ{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}{\isasymforall}\ {\isacharparenleft}m{\isacharcolon}{\isacharcolon}Expression{\isacharparenright}{\isachardot}\ {\isacharparenleft}{\isacharparenleft}m\ mem\ e{\isacharparenright}\ {\isasymlongrightarrow}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\isacharparenleft}{\isasymexists}\ z{\isadigit{1}}{\isachardot}\ m\ {\isacharequal}\ {\isacharparenleft}kE\ z{\isadigit{1}}{\isacharparenright}{\isacharparenright}\ {\isasymor}\ {\isacharparenleft}{\isasymexists}\ z{\isadigit{2}}{\isachardot}\ m\ {\isacharequal}\ {\isacharparenleft}sE\ z{\isadigit{2}}{\isacharparenright}{\isacharparenright}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}notSpecKeysSecretsExpr\ P\ e{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}notSpecKeysSecretsExpr\ Q\ e{\isachardoublequoteclose}\ \isanewline
\ \isakeyword{shows}\ {\isachardoublequoteopen}knows\ PQ\ e{\isachardoublequoteclose}\isanewline
\isadelimproof
\endisadelimproof
\isatagproof
\isacommand{using}\isamarkupfalse \ assms\isanewline
\isacommand{proof}\isamarkupfalse \ {\isacharparenleft}induct\ e{\isacharparenright}\isanewline
\ \ \isacommand{case}\isamarkupfalse \ Nil\ \isanewline
\ \ \isacommand{from}\isamarkupfalse \ this\ \isacommand{show}\isamarkupfalse \ {\isacharquery}case\ \isacommand{by}\isamarkupfalse \ {\isacharparenleft}simp\ only{\isacharcolon}\ knows{\isacharunderscore}emptyexpression{\isacharparenright}\isanewline
\isacommand{next}\isamarkupfalse \isanewline
\ \ \isacommand{fix}\isamarkupfalse \ a\ l\ \isanewline
\ \ \isacommand{case}\isamarkupfalse \ {\isacharparenleft}Cons\ a\ l{\isacharparenright}\isanewline
\ \ \isacommand{from}\isamarkupfalse \ Cons\ \isacommand{have}\isamarkupfalse \ sg{\isadigit{1}}{\isacharcolon}{\isachardoublequoteopen}knows\ P\ {\isacharbrackleft}a{\isacharbrackright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse \ {\isacharparenleft}simp\ add{\isacharcolon}\ knows{\isacharunderscore}concat{\isacharunderscore}{\isadigit{1}}{\isacharparenright}\isanewline
\ \ \isacommand{from}\isamarkupfalse \ Cons\ \isacommand{have}\isamarkupfalse \ sg{\isadigit{2}}{\isacharcolon}{\isachardoublequoteopen}knows\ P\ l{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse \ {\isacharparenleft}simp\ only{\isacharcolon}\ knows{\isacharunderscore}concat{\isacharunderscore}{\isadigit{2}}{\isacharparenright}\isanewline
\ \ \isacommand{from}\isamarkupfalse \ sg{\isadigit{1}}\ \isacommand{have}\isamarkupfalse \ sg{\isadigit{3}}{\isacharcolon}{\isachardoublequoteopen}a\ mem\ {\isacharparenleft}a\ {\isacharhash}\ l{\isacharparenright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse \ simp\isanewline
\ \ \isacommand{from}\isamarkupfalse \ Cons\ \isakeyword{and}\ sg{\isadigit{2}}\ \isacommand{have}\isamarkupfalse \ sg{\isadigit{2}}a{\isacharcolon}{\isachardoublequoteopen}knows\ PQ\ l{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse \ {\isacharparenleft}simp\ add{\isacharcolon}\ notSpecKeysSecretsExpr{\isacharunderscore}L{\isadigit{2}}{\isacharparenright}\isanewline
\ \ \isacommand{from}\isamarkupfalse \ Cons\ \isakeyword{and}\ sg{\isadigit{1}}\ \isakeyword{and}\ sg{\isadigit{2}}\ \isakeyword{and}\ sg{\isadigit{3}}\ \isacommand{show}\isamarkupfalse \ {\isacharquery}case\isanewline
\ \ \isacommand{proof}\isamarkupfalse \ {\isacharparenleft}cases\ {\isachardoublequoteopen}{\isasymexists}\ z{\isadigit{1}}{\isachardot}\ a\ {\isacharequal}\ kE\ z{\isadigit{1}}{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse \ {\isachardoublequoteopen}{\isasymexists}\ z{\isadigit{1}}{\isachardot}\ a\ {\isacharequal}\ {\isacharparenleft}kE\ z{\isadigit{1}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{from}\isamarkupfalse \ this\ \isacommand{obtain}\isamarkupfalse \ z\ \isakeyword{where}\ a{\isadigit{1}}{\isacharcolon}{\isachardoublequoteopen}a\ {\isacharequal}\ {\isacharparenleft}kE\ z{\isacharparenright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse \ auto\isanewline
\ \ \ \ \isacommand{from}\isamarkupfalse \ a{\isadigit{1}}\ \isakeyword{and}\ Cons\ \isacommand{have}\isamarkupfalse \ sg{\isadigit{4}}{\isacharcolon}{\isachardoublequoteopen}{\isacharparenleft}kKS\ z{\isacharparenright}\ {\isasymnotin}\ specKeysSecrets\ P{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse \ {\isacharparenleft}simp\ add{\isacharcolon}\ notSpecKeysSecretsExpr{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \ \ \isacommand{from}\isamarkupfalse \ a{\isadigit{1}}\ \isakeyword{and}\ Cons\ \isacommand{have}\isamarkupfalse \ sg{\isadigit{5}}{\isacharcolon}{\isachardoublequoteopen}{\isacharparenleft}kKS\ z{\isacharparenright}\ {\isasymnotin}\ specKeysSecrets\ Q{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse \ {\isacharparenleft}simp\ add{\isacharcolon}\ notSpecKeysSecretsExpr{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \ \ \isacommand{from}\isamarkupfalse \ sg{\isadigit{1}}\ \isakeyword{and}\ a{\isadigit{1}}\ \isacommand{have}\isamarkupfalse \ sg{\isadigit{6}}{\isacharcolon}{\isachardoublequoteopen}knows\ P\ {\isacharbrackleft}kE\ z{\isacharbrackright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse \ simp\isanewline
\ \ \ \ \isacommand{from}\isamarkupfalse \ sg{\isadigit{4}}\ \isakeyword{and}\ sg{\isadigit{5}}\ \isakeyword{and}\ sg{\isadigit{6}}\ \isakeyword{and}\ subPQ\ \isakeyword{and}\ cCompI\ \isakeyword{and}\ cCompKS\ \ \isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse \ {\isachardoublequoteopen}knows\ PQ\ {\isacharbrackleft}kE\ z{\isacharbrackright}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse \ {\isacharparenleft}rule\ knows{\isacharunderscore}composition{\isadigit{1}}{\isacharunderscore}k{\isacharparenright}\isanewline
\ \ \ \ \isacommand{from}\isamarkupfalse \ this\ \isakeyword{and}\ sg{\isadigit{2}}a\ \isakeyword{and}\ a{\isadigit{1}}\ \isacommand{show}\isamarkupfalse \ {\isacharquery}case\ \isacommand{by}\isamarkupfalse \ {\isacharparenleft}simp\ add{\isacharcolon}\ knows{\isacharunderscore}concat{\isacharunderscore}{\isadigit{3}}{\isacharparenright}\isanewline
\ \ \isacommand{next}\isamarkupfalse \ \isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse \ {\isachardoublequoteopen}{\isasymnot}\ {\isacharparenleft}{\isasymexists}z{\isadigit{1}}{\isachardot}\ a\ {\isacharequal}\ kE\ z{\isadigit{1}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{from}\isamarkupfalse \ this\ \isakeyword{and}\ Cons\ \isakeyword{and}\ sg{\isadigit{3}}\ \isacommand{have}\isamarkupfalse \ {\isachardoublequoteopen}{\isasymexists}\ z{\isadigit{2}}{\isachardot}\ a\ {\isacharequal}\ {\isacharparenleft}sE\ z{\isadigit{2}}{\isacharparenright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse \ auto\isanewline
\ \ \ \ \isacommand{from}\isamarkupfalse \ this\ \isacommand{obtain}\isamarkupfalse \ z\ \isakeyword{where}\ a{\isadigit{2}}{\isacharcolon}{\isachardoublequoteopen}a\ {\isacharequal}\ {\isacharparenleft}sE\ z{\isacharparenright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse \ auto\isanewline
\ \ \ \ \isacommand{from}\isamarkupfalse \ a{\isadigit{2}}\ \isakeyword{and}\ Cons\ \isacommand{have}\isamarkupfalse \ sg{\isadigit{8}}{\isacharcolon}{\isachardoublequoteopen}{\isacharparenleft}sKS\ z{\isacharparenright}\ {\isasymnotin}\ specKeysSecrets\ P{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse \ {\isacharparenleft}simp\ add{\isacharcolon}\ notSpecKeysSecretsExpr{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \ \ \isacommand{from}\isamarkupfalse \ a{\isadigit{2}}\ \isakeyword{and}\ Cons\ \isacommand{have}\isamarkupfalse \ sg{\isadigit{9}}{\isacharcolon}{\isachardoublequoteopen}{\isacharparenleft}sKS\ z{\isacharparenright}\ {\isasymnotin}\ specKeysSecrets\ Q{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse \ {\isacharparenleft}simp\ add{\isacharcolon}\ notSpecKeysSecretsExpr{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \ \ \isacommand{from}\isamarkupfalse \ sg{\isadigit{1}}\ \isakeyword{and}\ a{\isadigit{2}}\ \isacommand{have}\isamarkupfalse \ sg{\isadigit{1}}{\isadigit{0}}{\isacharcolon}{\isachardoublequoteopen}knows\ P\ {\isacharbrackleft}sE\ z{\isacharbrackright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse \ simp\ \isanewline
\ \ \ \ \isacommand{from}\isamarkupfalse \ sg{\isadigit{8}}\ \isakeyword{and}\ sg{\isadigit{9}}\ \isakeyword{and}\ sg{\isadigit{1}}{\isadigit{0}}\ \isakeyword{and}\ subPQ\ \isakeyword{and}\ cCompI\ \isakeyword{and}\ cCompKS\ \ \isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse \ {\isachardoublequoteopen}knows\ PQ\ {\isacharbrackleft}sE\ z{\isacharbrackright}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse \ {\isacharparenleft}rule\ knows{\isacharunderscore}composition{\isadigit{1}}{\isacharunderscore}s{\isacharparenright}\isanewline
\ \ \ \ \isacommand{from}\isamarkupfalse \ this\ \isakeyword{and}\ sg{\isadigit{2}}a\ \isakeyword{and}\ a{\isadigit{2}}\ \isacommand{show}\isamarkupfalse \ {\isacharquery}case\ \isacommand{by}\isamarkupfalse \ {\isacharparenleft}simp\ add{\isacharcolon}\ knows{\isacharunderscore}concat{\isacharunderscore}{\isadigit{3}}{\isacharparenright}\isanewline
\ \ \isacommand{qed}\isamarkupfalse \ \isanewline
\isacommand{qed}\isamarkupfalse \endisatagproof
{\isafoldproof}\isadelimproof
\ \isanewline
\endisadelimproof
\ \isanewline
\isacommand{lemma}\isamarkupfalse \ knows{\isacharunderscore}composition{\isadigit{4}}{\isacharcolon}\isanewline
\ \isakeyword{assumes}\ {\isachardoublequoteopen}knows\ Q\ e{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \isakeyword{and}\ subPQ{\isacharcolon}{\isachardoublequoteopen}subcomponents\ PQ\ {\isacharequal}\ {\isacharbraceleft}P{\isacharcomma}Q{\isacharbraceright}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \isakeyword{and}\ cCompI{\isacharcolon}{\isachardoublequoteopen}correctCompositionIn\ PQ{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \isakeyword{and}\ cCompKS{\isacharcolon}{\isachardoublequoteopen}correctCompositionKS\ PQ{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}{\isasymforall}\ m{\isachardot}\ m\ mem\ e\ {\isasymlongrightarrow}\ {\isacharparenleft}{\isacharparenleft}{\isasymexists}\ z{\isachardot}\ m\ {\isacharequal}\ kE\ z{\isacharparenright}\ {\isasymor}\ {\isacharparenleft}{\isasymexists}\ z{\isachardot}\ m\ {\isacharequal}\ sE\ z{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}notSpecKeysSecretsExpr\ P\ e{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}notSpecKeysSecretsExpr\ Q\ e{\isachardoublequoteclose}\ \isanewline
\ \isakeyword{shows}\ {\isachardoublequoteopen}knows\ PQ\ e{\isachardoublequoteclose}\isanewline
\isadelimproof
\endisadelimproof
\isatagproof
\isacommand{using}\isamarkupfalse \ assms\isanewline
\isacommand{proof}\isamarkupfalse \ {\isacharparenleft}induct\ e{\isacharparenright}\isanewline
\ \ \isacommand{case}\isamarkupfalse \ Nil\ \isanewline
\ \ \isacommand{from}\isamarkupfalse \ this\ \isacommand{show}\isamarkupfalse \ {\isacharquery}case\ \isacommand{by}\isamarkupfalse \ {\isacharparenleft}simp\ only{\isacharcolon}\ knows{\isacharunderscore}emptyexpression{\isacharparenright}\isanewline
\isacommand{next}\isamarkupfalse \isanewline
\ \ \isacommand{fix}\isamarkupfalse \ a\ l\ \isanewline
\ \ \isacommand{case}\isamarkupfalse \ {\isacharparenleft}Cons\ a\ l{\isacharparenright}\isanewline
\ \ \isacommand{from}\isamarkupfalse \ Cons\ \isacommand{have}\isamarkupfalse \ sg{\isadigit{1}}{\isacharcolon}{\isachardoublequoteopen}knows\ Q\ {\isacharbrackleft}a{\isacharbrackright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse \ {\isacharparenleft}simp\ add{\isacharcolon}\ knows{\isacharunderscore}concat{\isacharunderscore}{\isadigit{1}}{\isacharparenright}\isanewline
\ \ \isacommand{from}\isamarkupfalse \ Cons\ \isacommand{have}\isamarkupfalse \ sg{\isadigit{2}}{\isacharcolon}{\isachardoublequoteopen}knows\ Q\ l{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse \ {\isacharparenleft}simp\ only{\isacharcolon}\ knows{\isacharunderscore}concat{\isacharunderscore}{\isadigit{2}}{\isacharparenright}\isanewline
\ \ \isacommand{from}\isamarkupfalse \ sg{\isadigit{1}}\ \isacommand{have}\isamarkupfalse \ sg{\isadigit{3}}{\isacharcolon}{\isachardoublequoteopen}a\ mem\ {\isacharparenleft}a\ {\isacharhash}\ l{\isacharparenright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse \ simp\isanewline
\ \ \isacommand{from}\isamarkupfalse \ Cons\ \isakeyword{and}\ sg{\isadigit{2}}\ \isacommand{have}\isamarkupfalse \ sg{\isadigit{2}}a{\isacharcolon}{\isachardoublequoteopen}knows\ PQ\ l{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse \ {\isacharparenleft}simp\ add{\isacharcolon}\ notSpecKeysSecretsExpr{\isacharunderscore}L{\isadigit{2}}{\isacharparenright}\isanewline
\ \ \isacommand{from}\isamarkupfalse \ Cons\ \isakeyword{and}\ sg{\isadigit{1}}\ \isakeyword{and}\ sg{\isadigit{2}}\ \isakeyword{and}\ sg{\isadigit{3}}\ \isacommand{show}\isamarkupfalse \ {\isacharquery}case\isanewline
\ \ \isacommand{proof}\isamarkupfalse \ {\isacharparenleft}cases\ {\isachardoublequoteopen}{\isasymexists}\ z{\isadigit{1}}{\isachardot}\ a\ {\isacharequal}\ kE\ z{\isadigit{1}}{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse \ {\isachardoublequoteopen}{\isasymexists}\ z{\isadigit{1}}{\isachardot}\ a\ {\isacharequal}\ {\isacharparenleft}kE\ z{\isadigit{1}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{from}\isamarkupfalse \ this\ \isacommand{obtain}\isamarkupfalse \ z\ \isakeyword{where}\ a{\isadigit{1}}{\isacharcolon}{\isachardoublequoteopen}a\ {\isacharequal}\ {\isacharparenleft}kE\ z{\isacharparenright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse \ auto\isanewline
\ \ \ \ \isacommand{from}\isamarkupfalse \ a{\isadigit{1}}\ \isakeyword{and}\ Cons\ \isacommand{have}\isamarkupfalse \ sg{\isadigit{4}}{\isacharcolon}{\isachardoublequoteopen}{\isacharparenleft}kKS\ z{\isacharparenright}\ {\isasymnotin}\ specKeysSecrets\ P{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse \ {\isacharparenleft}simp\ add{\isacharcolon}\ notSpecKeysSecretsExpr{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \ \ \isacommand{from}\isamarkupfalse \ a{\isadigit{1}}\ \isakeyword{and}\ Cons\ \isacommand{have}\isamarkupfalse \ sg{\isadigit{5}}{\isacharcolon}{\isachardoublequoteopen}{\isacharparenleft}kKS\ z{\isacharparenright}\ {\isasymnotin}\ specKeysSecrets\ Q{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse \ {\isacharparenleft}simp\ add{\isacharcolon}\ notSpecKeysSecretsExpr{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \ \ \isacommand{from}\isamarkupfalse \ sg{\isadigit{1}}\ \isakeyword{and}\ a{\isadigit{1}}\ \isacommand{have}\isamarkupfalse \ sg{\isadigit{6}}{\isacharcolon}{\isachardoublequoteopen}knows\ Q\ {\isacharbrackleft}kE\ z{\isacharbrackright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse \ simp\isanewline
\ \ \ \ \isacommand{from}\isamarkupfalse \ sg{\isadigit{4}}\ \isakeyword{and}\ sg{\isadigit{5}}\ \isakeyword{and}\ sg{\isadigit{6}}\ \isakeyword{and}\ subPQ\ \isakeyword{and}\ cCompI\ \isakeyword{and}\ cCompKS\ \isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse \ {\isachardoublequoteopen}knows\ PQ\ {\isacharbrackleft}kE\ z{\isacharbrackright}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse \ {\isacharparenleft}rule\ knows{\isacharunderscore}composition{\isadigit{2}}{\isacharunderscore}k{\isacharparenright}\isanewline
\ \ \ \ \isacommand{from}\isamarkupfalse \ this\ \isakeyword{and}\ sg{\isadigit{2}}a\ \isakeyword{and}\ a{\isadigit{1}}\ \isacommand{show}\isamarkupfalse \ {\isacharquery}case\ \isacommand{by}\isamarkupfalse \ {\isacharparenleft}simp\ add{\isacharcolon}\ knows{\isacharunderscore}concat{\isacharunderscore}{\isadigit{3}}{\isacharparenright}\isanewline
\ \ \isacommand{next}\isamarkupfalse \ \isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse \ {\isachardoublequoteopen}{\isasymnot}\ {\isacharparenleft}{\isasymexists}z{\isadigit{1}}{\isachardot}\ a\ {\isacharequal}\ kE\ z{\isadigit{1}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{from}\isamarkupfalse \ this\ \isakeyword{and}\ Cons\ \isakeyword{and}\ sg{\isadigit{3}}\ \isacommand{have}\isamarkupfalse \ {\isachardoublequoteopen}{\isasymexists}\ z{\isadigit{2}}{\isachardot}\ a\ {\isacharequal}\ {\isacharparenleft}sE\ z{\isadigit{2}}{\isacharparenright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse \ auto\isanewline
\ \ \ \ \isacommand{from}\isamarkupfalse \ this\ \isacommand{obtain}\isamarkupfalse \ z\ \isakeyword{where}\ a{\isadigit{2}}{\isacharcolon}{\isachardoublequoteopen}a\ {\isacharequal}\ {\isacharparenleft}sE\ z{\isacharparenright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse \ auto\isanewline
\ \ \ \ \isacommand{from}\isamarkupfalse \ a{\isadigit{2}}\ \isakeyword{and}\ Cons\ \isacommand{have}\isamarkupfalse \ sg{\isadigit{8}}{\isacharcolon}{\isachardoublequoteopen}{\isacharparenleft}sKS\ z{\isacharparenright}\ {\isasymnotin}\ specKeysSecrets\ P{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse \ {\isacharparenleft}simp\ add{\isacharcolon}\ notSpecKeysSecretsExpr{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \ \ \isacommand{from}\isamarkupfalse \ a{\isadigit{2}}\ \isakeyword{and}\ Cons\ \isacommand{have}\isamarkupfalse \ sg{\isadigit{9}}{\isacharcolon}{\isachardoublequoteopen}{\isacharparenleft}sKS\ z{\isacharparenright}\ {\isasymnotin}\ specKeysSecrets\ Q{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse \ {\isacharparenleft}simp\ add{\isacharcolon}\ notSpecKeysSecretsExpr{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \ \ \isacommand{from}\isamarkupfalse \ sg{\isadigit{1}}\ \isakeyword{and}\ a{\isadigit{2}}\ \isacommand{have}\isamarkupfalse \ sg{\isadigit{1}}{\isadigit{0}}{\isacharcolon}{\isachardoublequoteopen}knows\ Q\ {\isacharbrackleft}sE\ z{\isacharbrackright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse \ simp\ \isanewline
\ \ \ \ \isacommand{from}\isamarkupfalse \ sg{\isadigit{8}}\ \isakeyword{and}\ sg{\isadigit{9}}\ \isakeyword{and}\ sg{\isadigit{1}}{\isadigit{0}}\ \isakeyword{and}\ subPQ\ \isakeyword{and}\ cCompI\ \isakeyword{and}\ cCompKS\ \ \isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse \ {\isachardoublequoteopen}knows\ PQ\ {\isacharbrackleft}sE\ z{\isacharbrackright}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse \ {\isacharparenleft}rule\ knows{\isacharunderscore}composition{\isadigit{2}}{\isacharunderscore}s{\isacharparenright}\isanewline
\ \ \ \ \isacommand{from}\isamarkupfalse \ this\ \isakeyword{and}\ sg{\isadigit{2}}a\ \isakeyword{and}\ a{\isadigit{2}}\ \isacommand{show}\isamarkupfalse \ {\isacharquery}case\ \isacommand{by}\isamarkupfalse \ {\isacharparenleft}simp\ add{\isacharcolon}\ knows{\isacharunderscore}concat{\isacharunderscore}{\isadigit{3}}{\isacharparenright}\isanewline
\ \ \isacommand{qed}\isamarkupfalse \ \isanewline
\isacommand{qed}\isamarkupfalse \endisatagproof
{\isafoldproof}\isadelimproof
\isanewline
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse \ knows{\isacharunderscore}composition{\isadigit{5}}{\isacharcolon}\isanewline
\isakeyword{assumes}\ {\isachardoublequoteopen}knows\ P\ e\ {\isasymor}\ knows\ Q\ e{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}subcomponents\ PQ\ {\isacharequal}\ {\isacharbraceleft}P{\isacharcomma}Q{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}correctCompositionIn\ PQ{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}correctCompositionKS\ PQ{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}{\isasymforall}\ m{\isachardot}\ m\ mem\ e\ {\isasymlongrightarrow}\ {\isacharparenleft}{\isacharparenleft}{\isasymexists}\ z{\isachardot}\ m\ {\isacharequal}\ kE\ z{\isacharparenright}\ {\isasymor}\ {\isacharparenleft}{\isasymexists}\ z{\isachardot}\ m\ {\isacharequal}\ sE\ z{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}notSpecKeysSecretsExpr\ P\ e{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}notSpecKeysSecretsExpr\ Q\ e{\isachardoublequoteclose}\ \isanewline
\isakeyword{shows}\ {\isachardoublequoteopen}knows\ PQ\ e{\isachardoublequoteclose}\isanewline
\isadelimproof
\endisadelimproof
\isatagproof
\isacommand{using}\isamarkupfalse \ assms\ \isacommand{by}\isamarkupfalse \ {\isacharparenleft}metis\ knows{\isacharunderscore}composition{\isadigit{3}}\ knows{\isacharunderscore}composition{\isadigit{4}}{\isacharparenright}\endisatagproof
{\isafoldproof}\isadelimproof
\isanewline
\endisadelimproof
\isadelimtheory
\isanewline
\endisadelimtheory
\isatagtheory
\isacommand{end}\isamarkupfalse \endisatagtheory
{\isafoldtheory}\isadelimtheory
\endisadelimtheory
\ \end{isabellebody}