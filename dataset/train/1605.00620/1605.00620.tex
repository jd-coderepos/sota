





\documentclass[12pt, draftclsnofoot,onecolumn]{IEEEtran}
\usepackage{graphicx,float}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage[hang]{subfigure}
\usepackage{epsfig}
\usepackage{xr}
\usepackage{float}
\usepackage{xspace}
\usepackage{bm}
\usepackage{algorithm,algpseudocode}
\usepackage{epstopdf}

\usepackage[font={small}]{caption}
\usepackage{url}
\usepackage{lipsum,multicol}
\usepackage{xcolor}
\usepackage{dsfont}
\usepackage{soul}
\usepackage[compress]{cite}
\usepackage{linegoal}
\usepackage{array}
\usepackage{soul}
\usepackage{multibib}
\newcites{latex}{REFERENCE}






\makeatletter
\newcommand{\algmargin}{\the\ALG@thistlm}
\makeatother
\newlength{\whilewidth}
\settowidth{\whilewidth}{\algorithmicwhile\ }
\algdef{SE}[parWHILE]{parWhile}{EndparWhile}[1]
  {\parbox[t]{\dimexpr\linewidth-\algmargin}{\hangindent\whilewidth\strut\algorithmicwhile\ #1\ \algorithmicdo\strut}}{\algorithmicend\ \algorithmicwhile}\algnewcommand{\parState}[1]{\State \parbox[t]{\dimexpr\linewidth-\algmargin}{\strut #1\strut}}

\newlength{\indexwidth}
\settowidth{\indexwidth}{(1)}

\algnewcommand{\parNumState}[2]{\State{#1}\parbox[t]{\dimexpr\linewidth-\algmargin-\dimexpr \indexwidth}{\strut #2\strut}}



\algdef{SE}[SUBALG]{Indent}{EndIndent}{}{\algorithmicend\ }\algtext*{Indent}
\algtext*{EndIndent}

\newcommand\MyLBrace[2]{\left.\rule{0pt}{#1}\right\}\text{#2}}
\newcommand\MyRBrace[2]{\text{#2}\left\{\rule{0pt}{#1}\right.}







\ifCLASSOPTIONtwocolumn
\newcommand{\commwidth}{2.6in}
\newcommand{\eqratio}{0.42}
\newcommand{\auswidth}{3.3in}
\newcommand{\auswidthb}{3.5in}
\newcommand{\curvewidth}{3.3in}
\newcommand{\figfourwidth}{3.5in}
\else
\newcommand{\commwidth}{3.2in}
\newcommand{\eqratio}{0.55}
\newcommand{\auswidth}{4in}
\newcommand{\auswidthb}{4.5in}
\newcommand{\curvewidth}{3.5in}
\newcommand{\figfourwidth}{4in}
\fi

\begin{document}
\title{Game-Theoretic Multi-Agent Control and Network Cost Allocation under Communication Constraints}
\author{Feier Lian, Aranya Chakrabortty~\IEEEmembership{Senior Member,~IEEE} and Alexandra Duel-Hallen~\IEEEmembership{Fellow,~IEEE}\thanks{The authors are with the Department of Electrical and Computer Engineering, North Carolina State University, Raleigh, NC 27695 USA (e-mail: flian2@ncsu.edu; aranya.chakrabortty@ncsu.edu; sasha@ncsu.edu)} \thanks{Manuscript received May 1, 2016; revised Sept 30, 2016 and Dec 15, 2016. This paper was presented in part at the American Control Conference, Boston Marriott Copley Place, MA, USA, July 6--8, 2016. Financial support from the NSF Grant EECS 1544871 is gratefully acknowledged.}}



















\maketitle
\vspace{-10ex}
\begin{abstract}
Multi-agent networked linear dynamic systems have attracted attention of researchers in power systems, intelligent transportation, and industrial automation. The agents might cooperatively optimize a global performance objective, resulting in social optimization, or try to satisfy their own selfish objectives using a noncooperative differential game. However, in these solutions, large volumes of data must be sent from system states to possibly distant control inputs, thus resulting in high cost of the underlying communication network. To enable economically-viable communication, a game-theoretic framework is proposed under the \textit{communication cost}, or \textit{sparsity}, constraint, given by the number of communicating state/control input pairs. As this constraint tightens, the system transitions from dense to sparse communication, providing the trade-off between dynamic system performance and information exchange. Moreover, using the proposed sparsity-constrained distributed social optimization and noncooperative game algorithms, we develop a method to allocate the costs of the communication infrastructure fairly and according to the agents' diverse needs for feedback and cooperation. Numerical results illustrate utilization of the proposed algorithms to enable and ensure economic fairness of wide-area control among power companies. 
\end{abstract}

\begin{IEEEkeywords}
Game Theory, Cost Allocation, Smart Grid, Sparsity, Distributed Optimization, Multi-Agent Systems
\end{IEEEkeywords}


\IEEEpeerreviewmaketitle

\section{Introduction}








Multi-agent networked dynamic systems arise in many practical scenarios where the communicating entities are spatially separated or have different economic priorities, e.g., in cyber-physical power networks, multi-vehicle formation, intelligent transportation, industrial automation, etc \cite{sztipanovits2012toward}. Social optimization can be performed when all agents aim to jointly optimize a system-wide objective while a noncooperative differential game is suitable when their objectives are different \cite{basar85}. The linear-quadratic regulator (LQR) optimization objectives are frequently employed in the literature due to their tractability, feasibility of distributed implementation, and broad applicability of the quadratic utility function \cite{basar85,lewis1995optimal,LUKES197196,Mukaidani2006}.

\begin{figure}[!b]
  	\centering
  	\includegraphics[width=\commwidth]{commu_diagram}
  	\caption{The communication structure of the multi-agent system.}
  	\label{comm:fig}
  \end{figure}

A networked multi-agent dynamic system with multiple nodes is illustrated in Fig.\ref{comm:fig}. Every agent owns a subset of nodes, where each node contains several states and control inputs. To achieve a desired performance objective, it is often necessary to employ state or output feedback. In this paper, frequently used assumptions of LQR optimization and static state feedback are employed \cite{lewis1995optimal}. Without loss of generality, we define the feedback links from states to control inputs within one node as {\it local feedback links}, which incur negligible expense, and the feedback links across different nodes as {\it communication links}. The traditional state-feedback centralized LQR optimization \cite{lewis1995optimal} and the linear-quadratic games \cite{basar85,LUKES197196,Mukaidani2006} require a dense feedback matrix and, thus, communication links from every state to every control input, which necessitates significant information exchange among the system nodes, and, thus, large communication infrastructure investment to assure desired rate and delay constraints. Due to wide applicability of proposed methods, we do not assume specific communication medium or network topology. Instead, we address the following question: how to reduce the {\it communication cost}, given by the number of communication links (see Fig.\ref{comm:fig}), while maintaining desired control objectives? To answer this question, we develop a family of {\it sparse} designs, which provide a trade-off between the communication cost and control performance, and reveal the most critical communication links. By limiting the number of communicating state/control input pairs, we reduce the overall bill for leasing bandwidth in an existing network or investment in a dedicated communication infrastructure. However, computation of the actual economic benefit depends on specific communication technology and application and is beyond the scope of this paper. 

Sparsity-constrained optimization has been investigated in \cite{bahmani2013greedy,beck2013sparsity}, and state-feedback optimal-control LQR algorithms for sparsity promotion were addressed in \cite{dorjovchebulTPS14,lin2013design}. However, these methods employ global optimization objectives and centralized implementation, which limit their applicability to multi-agent systems. Moreover, distributed approaches in the literature \cite{lamperski2015optimal,mota2013d} cannot accommodate specified sparsity constraints and different optimization objectives of the agents.


In this paper, we investigate LQR optimization for dynamic systems with linear state feedback {\it under the constraint on the communication cost}, i.e. the {\it sparsity} constraint, given by the number of communication links, expressed in terms of the off-diagonal cardinality of the state feedback matrix. First, to solve the {\it centralized} sparsity-constrained optimization problem, we employ the greedy Gradient Support Pursuit (GraSP) algorithm \cite{bahmani2013greedy}, which was shown to provide accurate approximations to sparsity-constrained solutions for a wide class of optimization functions. The proposed method also utilizes the restricted Newton step \cite{fardad2009optimal} to speed up convergence. Second, we develop a {\it noncooperative linear-quadratic game} among the agents, under the global communication cost constraint. To compute a Nash equilibrium of this game, we combine the ideas of GraSP and iterative gradient descent approaches \cite{ratliff2013characterization,li2013designing}. In the resulting algorithm, the computation of the players' (agents') utilities is {\it distributed} and requires limited information exchange. Third, we convert the proposed noncooperative game into a potential game \cite{li2013designing} where the players' utilities agree, thus producing a sparsity-constrained {\it distributed social optimization}. The games developed in this paper can be viewed as {\it Network Formation Games} (NFGs) \cite{van2005models} since players take strategic moves to form a network from states to control inputs. Moreover, using the above algorithms, we apply cooperative NFG theory \cite{van2005models} and the Nash Bargaining Solution (NBS) \cite{Avrachenkov2015265,kawamori2016nash} to allocate the costs of communication among the agents proportionally to the benefits they derive from sparsity-constrained feedback and cooperation. This {\it network cost allocation method} improves on our previous WAC cost allocation approaches \cite{Lian:2014aa,lianensuring}, which employed heuristics, relied on the centralized optimization in \cite{dorjovchebulTPS14}, and extrapolated the costs of a dense network \cite{Mukaidani2006} to sparse scenarios. Finally, we present numerical results for an example of wide-area control (WAC) of power systems, which helps in suppression of inter-area power oscillations, but potentially requires a substantial investment in the communication network needed to exchange state feedback information \cite{naspinet,pramod,lianensuring,dorjovchebulTPS14,deng2012communication,chenine2009survey,pthorp}. These results are shown vs. the sparsity constraint, from dense feedback \cite{Mukaidani2006} to the decentralized implementation \cite{lianensuring}, thus illustrating the trade-off between the communication cost and the control performance.


{\it The main contributions of this paper are:}
\begin{itemize}
\item Development and analysis of centralized and distributed social optimization algorithms and a noncooperative linear-quadratic game for multi-agent LQR optimal control with static linear state feedback under the constraint on the number of communicating state-control input pairs;
\item Development of fair network cost allocation algorithm under sparsity constraints;
\item Enabling sparsity-constrained designs and network cost allocation for a multi-area power system that employs wide-area control.
\end{itemize}


This paper is organized as follows. The system model and the communication-cost-constrained social optimization is presented in Section II. In Section III, the multi-agent system model is developed, and the sparsity-constrained distributed differential games are discussed. Section IV describes the proposed network cost allocation algorithm. In Section V, we present an example of utilizing the proposed methods for WAC of power systems. Numerical results and discussion for the Australian power system example are contained in Section VI. Finally, some concluding remarks are made in Section VII.  




\section{System Model and the Communication-Cost-Constrained Centralized Optimization}
\label{cent_sparse:sec}

The linear dynamic system with  nodes illustrated in Fig.\ref{comm:fig} is described by the following state-space equation. 

\noindent where  is the vector of states,  is the vector of states for node ,  is the number of states in node , ,  is the vector of control inputs,  is the the vector of control input of node ,  is the number of control inputs in node , ,  is a scalar impulse disturbance input, and  are matrices with appropriate dimensions, among which matrix  determines the physical topology of the system \cite{lewis1995optimal}.




We assume linear static feedback is employed, and thus the control input satisfies

\noindent where  is the feedback gain matrix, with , and . If the coefficient , the system (shown in Fig.\ref{comm:fig}) contains a communication link that delivers the data of state  to control input . We will refer to the tuple  where , and , as a
{\it state-control input link} in the rest of the paper. Since the states  and the control inputs  are organized according to their physical locations, the matrix  is in the form

where the block  represents feedback of the states of node  to the control inputs of node , with  corresponding to local feedback and  --- to communication links (see Fig.\ref{comm:fig}). Without loss of generality, we define the communication cost as the number of communication links associated with the off-diagonal blocks of , given by

\noindent where  operator counts the number of nonzero elements in a matrix. The proposed algorithms can be easily adapted to other sparsity criteria. Additional notation used in the algorithms is described in Table I.

\begin{table}[!b]
\centering
\caption{Notation used in the Algorithms 1 and 2.}
\begin{tabular}{p{0.15\columnwidth}p{0.75\columnwidth}}
\hline
{\bf Term} & {\bf Definition}\\
\hline
 & Frobenius norm of the matrix , defined by . \\
\hline
 & The support set of the matrix , i.e., the set of indices of the nonzero entries of matrix  \cite{bahmani2013greedy}.\\
\hline
 & The matrix obtained by preserving only the  largest-magnitude entries of the matrix , and setting all other entries to zero. \\
\hline 
 & The matrix obtained by preserving only the off-diagonal blocks of the matrix  (see (\ref{Kblock:eq})) and setting all other entries to zero. \\
\hline
 & The matrix obtained by preserving the diagonal blocks of the matrix  and setting all other entries to zero.\\
\hline
 & The gradient of the scalar function  with respect to the matrix  \cite{rautert1997computational}. Assuming ,  is given by a  matrix with the elements  .\\ 
\hline
 & The gradient of the scalar function  with respect to the matrix  projected onto the index set . The matrix  is obtained by preserving only the entries of  with indices in the set  and setting other entries to zero. \\
\hline
 & The restricted Newton step of function  at matrix  under the structural constraint . First, the  vector  is computed by stacking the columns of , and the function  is defined as . Then the  restricted Newton step vector  of  at  \cite{bahmani2013greedy} is computed using the conjugate gradient (CG) method \cite{lin2013design}. The vector  is then converted into an  matrix by stacking the consecutive  segments of .\\
\hline
\end{tabular}
\label{notation:tb}
\end{table}



For the model (\ref{short:eq}, \ref{feedback:eq}), the {\it social global} LQR objective function is given by \cite{lewis1995optimal}

\noindent where  and  are the positive semidefinite and positive definite design matrices with dimensions  and , respectively. The minimization of (\ref{J:eq}) with respect to  results in dense feedback, i.e., communication links from every state to every control input.

Next, we formulate the {\it social optimization under the communication cost constraint }: 

\noindent
The optimization (\ref{sparse_cent:eq}) produces a system with at most  state-control input links. Direct solution of (\ref{sparse_cent:eq}) can have combinatorial complexity \cite{bahmani2013greedy}, so we utilize a numerically efficient {\it GraSP} method \cite{bahmani2013greedy} in the proposed {\it centralized Algorithm \ref{cent:alg}}. Given the overall sparsity constraint , in each iteration of Step 2(1--4), the algorithm extends the matrix  along its steepest  gradient-descent directions. In Step 2(1), the gradient of  over  is computed as \cite{fardad2009optimal} 

\noindent where the matrices  and  are the unique solutions of the following Lyaponuv equations

\noindent In Step 2(4), the matrix  is updated using the restricted Newton step, and the step size  is chosen via the Armijo line search \cite{Boyd:2004aa}. In Step 2(5), pruning is performed to impose the constraint . To guarantee stability of the feedback matrix after pruning, we provide a backtracking option to return to a previously found stable solution, which has  or fewer communication links. (The stopping criterion in Step 2(6) was also used to determine convergence in the sparsity-promotion algorithm \cite{dorjovchebulTPS14}.) Note that in Step 2(6),  is the total number of control inputs, and  is the total number of states. Note also that as  grows, the algorithm retains the links that are the most {\it critical} for minimizing the objective (\ref{J:eq}).



\begin{algorithm}[!t]
	 \caption{Minimizing the centralized LQR objective under the global communication cost constraint .}
	 \label{cent:alg}
	\begin{algorithmic}
	\State 1 {\it Initialization} 
	\State 
	\State 2 {\it Iteration} 
	\While {stopping criteria are not met}
	\parNumState {(0) }{}
	\parNumState {(1) } {Compute gradient of  w.r.t : }
	\parNumState {(2) }{Identify up to  off-diagonal block directions: }
	\parNumState {(3) } {Merge support: }
	\parNumState {(4) }{Descend using the Newton step of  restricted to : }
	\parNumState {(5) } {Prune communication links: }
    \parNumState {(6) } {Stopping criterion: \\}
    \EndWhile
	\State 3 {\it Polishing}
	\State {} 
	\While{not  }
\State Descend using the Newton step of  restricted to : \\
	\EndWhile
	 \end{algorithmic}
\end{algorithm}


\section{Multi-Agent System Model and Communication-Cost-Constrained Linear-Quadratic Games}
\label{densegame:sec}
Suppose that there are  agents, where the agent  owns  nodes in the system (\ref{short:eq}) as shown in Fig.\ref{comm:fig}. Without loss of generality, the nodes are partitioned as follows

 

We can rewrite the states and control inputs of each agent  in (\ref{short:eq}) as follows:


\noindent where  is the vector of states for agent , with ;  is the vector of control inputs for agent , with ,  is the submatrix of  associated with the control inputs of the agent ,  is the control matrix for the disturbance input that enters agent , and .


Next, we briefly summarize results on linear-quadratic games for this system \cite{basar85,Mukaidani2006}. The agents in (\ref{partition:eq}) are viewed as players that optimize their individual, or selfish, objectives  by selecting their control inputs , for . The {\it selfish} objective of the player  is given by


\noindent where , and  are positive semidefinite and positive definite matrices, respectively, chosen to improve the  user's objective. A {\it Nash Equilibrium (NE)} is achieved when it is impossible for any player to improve its objective function by unilaterally changing its strategy. At a given NE, the players employ Nash strategies  defined as \cite{basar85}

\noindent for , where  is the tuple of strategies formed by all players except for the player . When state feedback is employed (\ref{K^i:eq}), the Nash strategies  in eq.(\ref{NE:eq}) can be determined by solving the cross-coupled algebraic Riccati equations (CARE) (eq.(8) in \cite{Mukaidani2006}), where the solution to CARE exists and is unique when the system is weakly coupled. However, CARE produces a dense feedback matrix \cite{Mukaidani2006}, and, thus, communication links from every state to every control input.

To limit the communication cost in a noncooperative scenario, we formulate a {\it linear-quadratic noncooperative NFG} where the players can establish at most  state-control input communication links (see Fig.\ref{comm:fig}) while each player aims to minimize its selfish LQR objective (\ref{Ji:eq}). A Nash Equilibrium of this game results in a communication network with cost bounded by . Thus, Nash strategies  satisfy for 

\noindent Equivalently, since linear static feedback (\ref{K^i:eq}) is employed, the strategy of player  is given by the submatrix  in (\ref{K^i:eq}), and Nash strategies are expressed as , which satisfy for each 

\noindent where the tuple  represents the strategies of all other players except . In this case, as  increases, the optimization (\ref{NE_sparseK:eq}) retains the most critical state-control input links needed for the noncooperative optimization, characterized by the set of selfish objectives (\ref{Ji:eq}).

The proposed game is described in {\it Algorithm \ref{graspNE:alg}}. It is inspired by the iterative gradient descent methods in \cite{ratliff2013characterization,li2013designing}, where each player takes a small step towards minimizing its own objective while other players' strategies are fixed. In each step associated with player , we use the GraSP algorithm \cite{bahmani2013greedy} to update the strategic variable  while maintaining the overall sparsity constraint. Thus, in the submatrix  (\ref{K^i:eq}), the elements representing local feedback, i.e., those in the blocks  in (\ref{Kblock:eq}) for , are free variables while the off-diagonal blocks in (\ref{Kblock:eq}) are subject to the sparsity constraint. The computation of the gradient of  w.r.t. player 's strategy  is similar to that in (\ref{gradJ:eq}--\ref{lyapJ:eq}).

\noindent where  and  are the unique solutions of the following Lyapunov equations

\noindent and , .

\begin{algorithm}[!b]
	 \caption{Noncooperative game under the global communication cost constraint .}
	\begin{algorithmic}
	\State {1 {\it Initialization}} 
\parState{}
\parState{Initialize the link constraint  for each player .}
\State 2 {\it Iteration} 
	\While {stopping criteria are not met}
	\State{}
	\For { = }
\parNumState {(1) } {if , .}
	\parNumState {(2) } {Compute gradient of  in (\ref{Ji:eq}) w.r.t :\\  }
	\parNumState {(3) } {Identify up to  off-diagonal block directions: }
	\parNumState {(4) } {Merge support: }
	\parNumState {(5) } {Descend using the Newton step of  restricted to : }
	\parNumState {(6) } {Prune among the off-diagonal block elements: }
	\EndFor
	\parState {Construct global feedback matrix: .}
    \parState {Stopping criteria: \\.}
    \EndWhile
	\State 3 {\it Polishing}
	\State , for .
	\While{not  }
	\For{}
	\parState {Descend using the Newton step of  restricted to : }
	\EndFor
	\EndWhile
\end{algorithmic}
	 \label{graspNE:alg}
\end{algorithm}

Algorithm \ref{graspNE:alg} is {\it distributed} in the sense that player  individually updates its strategic variable . Each player has prior knowledge of the underlying physical system (i.e., the matrices  in (\ref{short:eq})) and broadcasts its strategic move (the submatrix ) after its strategy is updated at the completion of Step 2(6) and each inner loop of Step 3. 

Finally, note that the social optimization under the sparsity constraint (\ref{sparse_cent:eq}) can also be implemented in a distributed fashion using a potential game \cite{li2013designing}, obtained from (\ref{NE_sparseK:eq}) by replacing the individual objectives in (\ref{NE_sparseK:eq}) with the common social objective (\ref{J:eq}) while the players' strategies are still defined as their control vectors. We refer to this game as {\it distributed social optimization}, and its equilibria are defined as

\noindent To compute (\ref{NE_J:eq}), we use Algorithm 2, where the social objective  replaces  in Step 2(2) and in the Polishing Step 3. 


Finally, we discuss the NEs of the proposed games. Since the LQR objective (\ref{J:eq}) is not convex in the feedback matrix  in general \cite{rautert1997computational}, the noncooperative game (\ref{sparse_NE:eq}, \ref{NE_sparseK:eq}) is not guaranteed to admit a pure-strategy NE \cite{pang2011nonconvex}. On the other hand, the distributed social optimization (\ref{NE_J:eq}) is an exact potential game, and, thus, a pure NE exists for this game \cite{li2013designing}. Moreover, the optimal solution of the social optimization problem (\ref{sparse_cent:eq}) constitutes a NE of (\ref{NE_J:eq}) although the converse does not necessarily hold due to nonconvexity of the LQR objective. Finally, while CARE has a unique NE under the weakly-coupled system assumption \cite{Mukaidani2006}, the cost-constrained games (\ref{sparse_NE:eq}), (\ref{NE_J:eq}) can have multiple NEs.

 \section{Network Cost Allocation}
\label{network:sec}

\begin{algorithm}[!b]
	 \caption{Network Cost Allocation under the Communication Cost Constraint .}
	 \label{alg3:alg}
	\begin{algorithmic}
	\State 1 {\it Find social optimized objective } 
	\Indent
	\parState { is the optimized objective of (\ref{sparse_cent:eq}) or (\ref{NE_J:eq}) under constraint ;}
\EndIndent
	\State 2 {\it Find decoupled optimized objectives at DNE.} 
	\Indent
	\parNumState{(1) } {The NE (\ref{NE_sparseK:eq}) for  is the {\it decoupled} NE (DNE);}

	\parNumState{(2) } {{\it Optimized selfish objective} at {\it DNE}:}
	\parNumState{(3) } {{\it Total objective at DNE:} .}

	\EndIndent
	\State 	3 {\it Find coupled optimized objectives at CNE}
	\Indent
	\parNumState{(1) } {The NE (\ref{NE_sparseK:eq}) under constraint  is {\it coupled} NE ();}

	\parNumState{(2) } {{\it Optimized selfish objective at CNE}:
	}

	\parNumState{(3) } {{\it Total objective at }: }

	\EndIndent
	\State 4 {\it Compute and allocate payoffs and network costs} 
	\Indent
	\parNumState{(1) } {The {\it social payoff}: }

	\parNumState{(2) } {The {\it selfish payoffs} (the {\it disagreement point}):\\
	 ;}

    \parNumState{(3) } {The {\it allocated payoffs}:\\
     }

     \parNumState{(4) } {{\it Proportional allocation of the network cost}:\\ }
   
    \EndIndent
	 \end{algorithmic}
\end{algorithm}

First, we review relevant results for cooperative NFGs with transferable utility \cite{Peters2008} where the utility of a coalition is viewed as monetary value, which is distributed among the players. Suppose  players cooperatively form a network with the objective of maximizing their payoffs. Several approaches to fair payoff allocation have been proposed in the literature \cite{saad2009distributed,myerson1980conference,Avrachenkov2015265,kawamori2016nash}. We employ the Nash Bargaining Solution (NBS) due to its computational efficiency in NFGs \cite{Avrachenkov2015265,kawamori2016nash}. The NBS payoff allocation algorithm proceeds in {\it three steps} based on \cite{kawamori2016nash}: 

(1) The players cooperate to construct a network that maximizes the {\it global social payoff} ; 

(2) The {\it disagreement point} is computed as

\noindent where the {\it selfish payoff}  is the minimum payoff that the  player is willing to accept. For example, (\ref{dis:eq}) can be computed as a NE of a noncooperative NFG where each player aims to satisfy its own selfish objective; 

(3) The overall payoff  is split among the players, with the {\it allocated payoff} of player  given by \cite{kawamori2016nash}
	

\noindent Note that bargaining is successful when the payoff of the social network is at least as large as the sum of the selfish payoffs, i.e.,

\noindent or equivalently, each player's allocated payoff is at least as large as its selfish payoff:

\noindent From (\ref{delta:eq}), all players benefit equally by forming the social network.

Next, we describe the proposed {\it network cost allocation method for sparsity-constrained multi-agent dynamic systems}, which is summarized in {\it Algorithm \ref{alg3:alg}}. Given the global communication cost constraint , in steps 1--3, three different scenarios are analyzed, depending on whether the agents employ: {\it (i)} non-local feedback, i.e., {\it communication bounded by cost }; and {\it (ii) cooperation}. In Step 1, both {\it(i)} and {\it(ii)} are assumed, resulting in the social optimization, implemented using Algorithm \ref{cent:alg} or \ref{graspNE:alg} under the constraint . In contrast, in Step 2 neither {\it (i)} nor {\it (ii)} are employed, and thus the agents play the {\it decoupled} noncooperative game, i.e., (\ref{sparse_NE:eq}) with , which results in a {\it decentralized} system using the Polishing Step 3 of Algorithm \ref{graspNE:alg} (see \cite{lianensuring}). Finally, in Step 3, only {\it (i)} is employed, resulting in the {\it coupled} game, i.e., (\ref{sparse_NE:eq}) with the global constraint , implemented using Algorithm \ref{graspNE:alg}. Note that Steps 1 and 3 optimize systems with (at most)  communication links (see Fig.\ref{comm:fig}), while Step 2 restricts communication to local feedback links.  

In Steps 4(1) and 4(2), the {\it payoffs}  and  represent the improvement in control performance, or {\it objective reduction}, provided by communication bounded by cost  with (in Step 1) and without (in Step 3) cooperation, respectively, relative to the decentralized implementation (Step 2). It is reasonable to model the minimum payoff an agent  expects from communication by its selfish objective reduction, or {\it selfish payoff}, , thus forming the {\it disagreement point}. The {\it allocated payoffs}  are computed in Step 4(3). Note that the NBS algorithm interprets the {\it payoffs}  and  as {\it values} (e.g., monetary payoffs) that agent  derives from communication with and without cooperation, respectively (see (\ref{dis:eq}, \ref{nbs:eq})). If cooperation does not degrade the minimum acceptable value , i.e., if (\ref{eqB:eq}, \ref{delta:eq}) hold, then bargaining is successful, and the agents agree to use the links formed by the social optimization found in Step 1, which provides them with the social payoff  and the individual payoffs . The latter condition is satisfied for a practical scenario where, in (\ref{J:eq}) and (\ref{Ji:eq}), the matrix  is block-diagonal with diagonal blocks given by , , and

\noindent
In this case, J_i(\boldsymbol{K})\boldsymbol{u}(t) = -\boldsymbol {Kx}(t)J_i(\boldsymbol{u}_1, {\boldsymbol u}_2,..., {\boldsymbol u}_r)\boldsymbol{K}J_i(\boldsymbol{K}), and thus a NE of the noncooperative game (\ref{NE:eq}) is a feasible solution of the social optimization (\ref{sparse_cent:eq}) for the same value of constraint , resulting in  (see Step 1 and 3(3)), which is equivalent to (\ref{eqB:eq}). 

We assume that the grand coalition forms in the proposed cooperative game among the agents. This assumption justifies Step 1 in Alg. 3, where all players cooperate. A sufficient condition for this assumption is efficiency of the grand coalition \cite{Hafalir2007242}. We show in \cite{Lian:aa} that a practical coalition-level identity similar to (\ref{sumQ:eq}) guarantees efficiency of the grand coalition.

If cooperation is successful, the feedback data required for implementing the {\it social control strategy} (as specified by the optimal feedback matrix in (\ref{sparse_cent:eq}) or (\ref{NE_J:eq})) will be delivered by the communication network specific to the given medium and application, where {\it the constraint  is chosen based on the desired performance/cost tradeoff}. In the final Step 4(4), we compute each agent's share of the cost of this network proportionally to the allocated payoffs . Note that if  in (\ref{delta:eq}) is small relative to the average of the selfish payoffs  (or ), the benefit of cooperation {\it (ii)} is small relative to that of communication {\it (i)}, and the agents' costs  can vary significantly due to the agents' diverse needs for feedback and cooperation as is illustrated in Section \ref{num:sec} and in \cite{lianensuring}. On the other hand, when  is relatively large, i.e.,  for all , the payoffs equalize (\ref{delta:eq}), resulting in equally split cost of the communication network among the agents.


\section{Example: Sparsity-Constrained Wide-Area Control of Power Systems}

\label{WAC:sec}
We validate our algorithms using the example of wide-area control (WAC) of large-scale power system networks. In recent literature such as \cite{dorjovchebulTPS14,pramod}, WAC has been shown to be very useful for suppressing low-frequency oscillations following small-signal disturbances in large power grids, at the cost of communicating real-time data from sensors at one operating region to controllers at others. The sensors are referred to as Phasor Measurement Units (PMUs), all of which are synchronized to each other via GPS. The envisioned architecture for PMU data exchange in the US power grid, also referred to as the North American Synchrophasor Initiative Network, or NASPInet \cite{naspinet}, involves PMUs located at substations of different utility companies sending their measurements to controllers at remote generators through a wide-area communication network such as the Internet. To reduce the cost of this communication, sparsity promotion for WAC was studied in \cite{dorjovchebulTPS14,lin2013design}. However, these designs employed social centralized implementation. In contrast, our approach is to design distributed controllers for WAC that are efficient with respect to communication costs. Moreover, we address the question posed in \cite{naspinet} on financing the communication network among the power companies. While the envisioned NASPInet has many functions beyond WAC, fair allocation of network costs associated with delivery of feedback data is necessary to develop its overall pricing scheme.





We model a power transmission system using (\ref{short:eq},\ref{partition:eq}--\ref{K^i:eq}) and as in Fig.\ref{comm:fig}, where a node represents a {\it generator} while an agent (player) represents the operating territory ({\it area}) owned by a utility company. Following \cite{dorjovchebulTPS14,lianensuring}, we express WAC as an LQR problem for minimizing the closed-loop energy of the system states, which equivalently translates into reducing the oscillations in their dynamic response. The LQR objective in (\ref{J:eq}) aims to damp the power oscillations captured by the small-signal changes around the nominal values while spending a reasonable amount of control effort \cite{dorjovchebulTPS14}, where the matrices  and  in (\ref{J:eq}) are chosen to reduce the energies of the state and control vectors, respectively. Therefore, in the rest of this paper we will refer to the objective (e.g., in (\ref{J:eq}), (\ref{Ji:eq}), Algorithm \ref{alg3:alg}, etc.) as {\it energy} and to the payoffs  and  in Algorithm \ref{alg3:alg} (Step 4 (1 and 2)) as {\it energy savings}. 
 










Typically a -order model of synchronous generators, including two swing states and one excitation state (for details, please see \cite{pramod}) suffices for solving most WAC problems since the goal is to influence the electro-mechanical dynamics of these generators. Note that the -order model indicates  and  in the general state-space model ({\ref{short:eq}}). We consider a power system with  synchronous generators, divided into  non-overlapping areas, and define the states of the  generator accordingly as

\noindent where the elements represent small-signal changes in phase angle, frequency, and excitation voltage, respectively. If higher-order models are considered, then the last term can be simply replaced by a vector  that collects all states except for the phase and the frequency. We assume full state availability, which can be achieved by placing PMUs at every generator bus, or by running a prior state estimation loop. We assume the matrix  in (\ref{short:eq}) to be an indicator matrix with all elements zero except for the one corresponding to the acceleration equation of the generator at which the fault  happens.



Next, we describe the choice of matrices in the social (\ref{J:eq}) and the selfish (\ref{Ji:eq}) energy optimization. We set  in (\ref{J:eq}) and  (\ref{Ji:eq}) as the identity matrix as to achieve the same weight for the energy of every control input. The matrix  in (\ref{J:eq}) is chosen so that all generators arrive at a consensus in their small-signal changes in phase angles and frequencies, as dictated by the physical topology of the network \cite{lianensuring,dorjovchebulTPS14}. Considering the small-signal-model in Kron-reduced form \cite{pramod}, for the  order model,  in (\ref{J:eq}) is determined from (\ref{Qwac:eq})


\noindent where  is a permutation matrix that rearranges the state vector  in (\ref{short:eq}) by stacking all the angles first, then all the frequencies, then the excitation voltages. For the general case (\ref{short:eq}), the  term in (\ref{Qwac:eq}) is replaced by , where the latter is obtained by stacking the terms . The matrix  \cite{Lian:aa}, where  is the column vector of all ones, and  is the identity matrix.

To quantify the  player's selfish objective (\ref{Ji:eq}), we define two quantities, namely, {\it intra-area energy} and {\it inter-area energy}, from the perspective of the  player as follows:
 
\vspace{-9pt}
 

\noindent
It can be seen that the intra-area energy of area  is designed for the consensus in the phase angle and frequency states of the generators in area . The inter-area energy is modeled by collecting the power transfer terms associated with a generator in area  and a generator in another area, and attributing 1/2 of this energy to area .
\noindent The total {\it state energy} associated with area  is 


\noindent where , since (\ref{Qi_cross:eq}) is the quadratic form of the states. Detailed derivations of  and  can be found in \cite{Lian:aa}. It is easy to show that the resulting LQR objectives (\ref{J:eq}) and (\ref{Ji:eq}) satisfy (\ref{sumQ:eq}), thus assuring successful cooperation among the power companies. We illustrate this fact in the next section by numerical simulation of a 50-bus power system model.




\section{Numerical Results and Performance Analysis for the Australian Power System Model}

\label{num:sec}

\begin{figure}[!t]
  	\centering
  	\subfigure[Line diagram of the Australian 50-bus system.]{\includegraphics[width=\auswidthb]{Aus_Model}}
  	\subfigure[Simplified Australian power system with feedback links.]{\includegraphics[width=\auswidth]{aus}}
  	\caption{A simplified 50-bus representation of the southeast Australian power system \cite{Gibbard:2010aa}.}
  	\label{aus:fig}
  \end{figure}

We validate our results using a 50-bus Australian power system model shown in Fig.\ref{aus:fig}(a), which consists of 14 synchronous generators, divided into 4 coherent areas, and is a reasonably accurate representation of the power grid in south-eastern Australia \cite{Gibbard:2010aa}. The area distribution is shown in different colors in Fig.\ref{aus:fig}(b), with the red dots denoting generator buses. Generators 1 to 5 belong to area 1, 6 and 7 -- to area 2, 8 to 11 -- to area 3, and 12 to 14 -- to area 4. Each generator is modeled by up to 17 states, namely the generator phase angle, the generator speed, direct and quadrature axis components of the internal voltage of the generator, direct and quadrature axis components of the internal flux of the generator, the field excitation voltage, three states contributed by the automatic voltage regulator (AVR), three states contributed by the power system stabilizer (PSS), one state contributed by the stabilizing transformer, and finally three states contributed by supporting induction generators. The small-signal linearized model is extracted using the MATLAB PST toolbox \cite{Chow:1992aa}. However, since we are primarily interested in the electro-mechanical states, we perform an initial round of model reduction using singular perturbation and thereby eliminate the non-electromechanical states with very low participation in the swing dynamics. The exact expressions of the model matrices are not included in the paper for brevity and are provided in \cite{Lian:aa}. The small-signal model is excited by impulsive disturbance inputs entering through the acceleration equation of the generators, and the proposed LQR controller is actuated through the field excitation voltages, using state feedback from all generators. Fig.\ref{aus:fig}(b) also illustrates the communication and local feedback links between the generators. 



\subsection{Global Energies}
\label{alg_pfm:sec}


\begin{figure}[!t]
\centering 
\includegraphics[width=\curvewidth]{figure3}
\caption{Global energies of social optimization and noncooperative games vs. communication cost constraint.}
\label{J:fig}
\end{figure}

Fig.\ref{J:fig} shows the global closed-loop energies for the 50-bus system with respect to the communication cost constraints for the various centralized and distributed algorithms discussed in the previous sections. Global energies of the centralized optimization (\ref{sparse_cent:eq}) using Algorithm \ref{cent:alg}, the coupled noncooperative game (CNE) in Step 3 of Algorithm \ref{alg3:alg}, the social distributed optimization (\ref{NE_J:eq}) using Algorithm 2, and of the decoupled game (DNE) in Step 2 of Algorithm \ref{alg3:alg} are included. We also show the global energy of the iterative dense-feedback method that solves CARE \cite{Mukaidani2006} (note that our system satisfies the weakly coupled condition in \cite{Mukaidani2006}) and of the centralized sparsity-promoting ADMM method \cite{dorjovchebulTPS14}, modified to satisfy the sparsity constraint. Since the energy of the method in \cite{dorjovchebulTPS14} is nondecreasing with the sparsity parameter , a bisection search on  yields the smallest value of  for which the off-diagonal cardinality of the feedback matrix produced by the ADMM algorithm satisfies the constraint. The choice of the -metric weights for this ADMM implementation is described in \cite{lianensuring}.

The figure shows that the global closed-loop energies resulting from the social optimization using Algorithm {\ref{cent:alg}} or {\ref{graspNE:alg}} are smaller than those of the noncooperative game (CNE using Algorithm \ref{graspNE:alg}) for any value of . This testifies to the fact that the dynamic performance of the grid improves when companies cooperate with each other to jointly design the controller, which constitutes a sufficient condition for the cooperation to form according to ({\ref{eqB:eq}}). We also observe that the global CNE objective (Algorithm \ref{alg3:alg}, Step 3(3)) tends to those of the DNE (Algorithm \ref{alg3:alg}, Step 2(3)) and CARE as  approaches 0 and its largest value , respectively. The former corresponds to the decentralized case \cite{lianensuring} while the latter requires dense communication \cite{Mukaidani2006}.   



Moreover, the energy  of the distributed social optimization (using Algorithm 2) closely approximates that of the centralized Algorithm 1 for most of the -range. We also observe that the closed-loop energy of social optimization using Algorithms {\ref{cent:alg}} or {\ref{graspNE:alg}} is smaller than that using the sparsity-promoting algorithm in a moderately sparse region, thus providing better reduction of both intra- and inter-area oscillations when given an exact communication cost constraint.



While the global energies of all sparsity-constrained methods are theoretically nonincreasing with , the social algorithms might occasionally produce a larger energy as  increases. This happens when an algorithm converges to a local minimum since the optimization objective (\ref{J:eq}) is locally, but not necessarily globally, convex in  \cite{rautert1997computational}. If the algorithm results in  for , we choose a suboptimal solution  (see Algorithm \ref{alg3:alg}, Step 1), which produces a nonincreasing . Finally, note that the global objectives (energies) of all algorithms saturate to the same asymptotic value when  exceeds 740, implying that the communication cost can be reduced by a factor of 3 relative to the cost of the dense LQR network without compromising the control performance. Thus, in the next figure, we show results only for small and moderate values of , where the energies vary significantly.


\subsection{Selfish Energies and Cost Allocation}
\label{cost_alloc:sec}

\begin{figure}[!t]
\centering 
\includegraphics[width=\figfourwidth]{figure4}
\caption{Selfish energies (objectives), payoffs and cost allocation in Algorithm \ref{alg3:alg} vs. communication cost constraint . (a) Selfish energies of noncooperative games for areas 1--4. (b) The energy savings (payoffs)  and  and payoff increase . (c) Proportional cost allocation.}
\label{payoff:fig}
\end{figure}

In Fig.\ref{payoff:fig}, we show performance of {\it noncooperative} games, as well as payoffs and costs in Algorithm \ref{alg3:alg}. Fig.\ref{payoff:fig}(a) shows the individual energy objectives of the four areas at CNE (Step 3(2)). In Fig.\ref{payoff:fig}(b), the selfish energy savings  (Step 4(2)) for each company, their sum, the social energy savings  (Step 4(1)), and the payoff increase  (\ref{delta:eq}) are illustrated. We observe that bargaining is successful (see (\ref{eqB:eq})), and there is modest payoff increase due to cooperation. 

Note that while the overall global CNE objective  (Step 3(3)) is theoretically nonincreasing with , this is not necessarily true for individual selfish energies  in Step 3(2), which means that increasing the overall communication budget might degrade some areas' energies when they act noncooperatively. This phenomenon can result in decreasing and possibly negative payoffs  and  over some regions of the constraint , which might dissatisfy the affected players and would require a revision of the proposed cost allocation method in Step 4(4) of Algorithm \ref{alg3:alg}. See, e.g., slightly increasing selfish objective  and negative selfish payoff  of area 3 in Fig.{\ref{payoff:fig}} (a) and (b), respectively, for small values of . Nevertheless, the allocated payoffs  in Algorithm \ref{alg3:alg} (Step 4(3)) are nonnegative for all companies for the Australian power system scenario due to sufficient cooperation gain . A slightly modified payoff computation method that guarantees nondecreasing payoffs is presented in Appendix \ref{B:appendix}.

Fig.\ref{payoff:fig} demonstrates significant disparity in the selfish energies , the  values, and the allocated proportional costs  among the areas, which is due to the grid topology. For example, large selfish energy and allocated cost of area 1 can be explained by its large number of generators. However, area size is not the only indicator, e.g., area 4 has fewer generators than area 3, but much larger selfish energy , energy savings , and allocated cost , which even exceed those of area 1 for smaller values of . In summary, areas 1 and 4 pay a much greater share of the overall network cost than areas 2 and 3 due to the former areas' greater needs for feedback and cooperation, which is consistent with relatively steep decline of their selfish energies with  in Fig.\ref{payoff:fig}(a) and with the fact that in the social optimization, links among the generators in these areas are the first to be added as  increases. Thus, these links are the most valuable for achieving energy reduction when using WAC \cite{dorjovchebulTPS14}.


\subsection{Algorithm Convergence and Implementation Issues}
\label{convergence:sec}


First, we focus on the numerical properties of Algorithms 1 and 2. Since the LQR objective does not satisfy the Stable Restricted Hessian condition \cite{bahmani2013greedy}, convergence of these algorithms is not assured in general. However, if Step 2 of Algorithm 1 converges and yields a stabilizing feedback matrix , then Step 3 will also converge due to the local convexity of . At convergence, Step 3 produces a feedback matrix  that satisfies the basic feasibility property , which is a weak necessary condition for the optimality of problem (\ref{sparse_cent:eq}) \cite{beck2013sparsity}. Similar arguments demonstrate that Algorithm 2 produces a feedback matrix that satisfies the basic feasibility property of each individual minimization in the CNE problem (\ref{NE_sparseK:eq}) (or (\ref{NE_J:eq}) for social optimization). Note that the decoupled game in Step 2 of Algorithm {\ref{alg3:alg}} represents an unconstrained optimization with respect to each player's strategy, which is given by its local feedback matrix \cite{lianensuring}. This game is implemented using the polishing Step 3 of Algorithm {\ref{graspNE:alg}}. When this implementation converges, the resulting equilibrium point is a local NE \cite{ratliff2013characterization} due to local convexity of the LQR objective \cite{rautert1997computational}, i.e., the strategy of each player is a local optimum given other players' strategies. From these observations, we conclude that convergence properties of proposed algorithms resemble those of the ADMM-based methods \cite{dorjovchebulTPS14}. In both cases, while theoretical guarantees are not always feasible, extensive numerical experience demonstrates that the algorithms converge and provide desirable minimization solutions over a range of sparsity parameters. We found that the proposed sparsity-constrained algorithms also converge and exhibit similar performance and complexity trends to those shown in this paper for the New England power system model used in \cite{dorjovchebulTPS14}.

Next, we describe the algorithm implementation details for the results shown in Fig.\ref{J:fig}--\ref{payoff:fig}. We found that the proposed algorithms can converge to different stabilizing feedback matrices given different initial settings. Moreover, for , the energies of these solutions can differ significantly. However, we found that the energies of different equilibria were very similar to each other for the decoupled game implemented using Algorithm \ref{alg3:alg} (Step 2). We have employed  and  and  in Algorithms 1 and 2, respectively, to achieve comparable performance for distributed and centralized social optimizations. For , both algorithms were initialized with a stabilizing matrix  obtained by preserving the block-diagonal entries of the dense LQR feedback matrix that optimizes (\ref{J:eq}) and setting other entries to zero. For larger ,  was chosen as the optimized feedback matrix obtained in a previous computation for a smaller value of . We found that this initialization produced the lowest energies over the entire -range. If a stable block-diagonal matrix cannot be found,  can be obtained using the sparsity-promotion algorithm \cite{dorjovchebulTPS14} with the largest  that produces a stabilizing feedback matrix (Similarly, stabilizing feedback might not exist for small values of the constraint ). Moreover, Algorithm 2 had the best performance when the initial link settings  were chosen proportionally to the number of nodes  in (\ref{partition:eq}).  


Finally, we found that the computational load of the polishing step dominates the overall runtime for both algorithms, and the Newton step using the CG method (see Table \ref{notation:tb}, last entry) is the most computation-intensive operation, which has polynomial complexity in  and the number of states \cite{lin2013design}. In our experiments, all algorithms in Fig.\ref{J:fig} converged in less than  seconds for any value of  although this did not include the bisection search time for the modified ADMM method \cite{dorjovchebulTPS14}, which is very computation-intensive. Moreover, the distributed social implementation using Algorithm 2 converged much faster than the centralized method (Algorithm 1)\footnote{The experiments are run using MATLAB on a MacBook Pro with Yosemite operating system, 2.6 GHz Intel core i5 processor, and 8 GB 1600 MHz DDR3 memory.}. 

 
 




























																									















\section{Conclusion}

LQR optimization under the communication-cost constraint was investigated for multi-agent dynamic systems with linear static state feedback. First, a communication-cost-constrained centralized social optimization algorithm was developed. Second, distributed game-theoretic algorithms were investigated for both selfish and social optimization under the sparsity constraint. Finally, cooperative NFG theory was employed to allocate the costs of the communication infrastructure in a multi-agent dynamic system. Using a 50-bus power system model divided into 4 areas, we demonstrated convergence of proposed algorithms and desirable performance and complexity features of distributed methods over the range of the sparsity constraint, thus providing a trade-off between the communication cost and the control performance. Furthermore, we discussed the relationship between the proportionally allocated costs and power companies' needs for feedback and cooperation, and showed that the proposed cost allocation algorithm is rooted in the physical topology of the power grid. Our current research focuses on applying proposed algorithms to systems with uncertainty and communication delays. Moreover, we plan to extend the concepts of this paper to diverse multi-agent dynamic system applications, robust optimization objectives, output feedback, and different communication network architectures.





















\section*{Acknowledgment}
The authors would like to thank the editors and reviewers for their valuable comments, which improved the paper significantly.















\bibliographystyle{IEEEtran}
\bibliography{ref}



















\appendices


\section{Definition of Nondecreasing Selfish Payoffs for Algorithm \ref{alg3:alg}}

\label{B:appendix}
In Section \ref{cost_alloc:sec}, we comment that it is possible to define nondecreasing selfish payoffs in Step 4(2) of Algorithm \ref{alg3:alg}. Given a cost constraint , such alternative definition is 


\noindent which is the maximum objective improvement an agent  can obtain by searching over the set of its selfish objectives  with constraints  that do not exceed . If there exists some  such that , the agent  might argue that the smaller selfish objective , not , should be used to compute its payoff since it also satisfies the constraint (). It is easy to show that  in (\ref{vi_star:eq}) is non-decreasing with  and . 



 Note that the disagreement point (\ref{vi_star:eq}) is hypothetical in a sense that a communication network with the energies  in (\ref{vi_star:eq}) might not be feasible (different agents might have different  values in (\ref{vi_star:eq}) for a fixed constraint ). However, noncompatible selfish payoffs are often employed in the literature to reflect the player's subjective preferences and are not required to represent a feasible scenario \cite{Avrachenkov2015265,kawamori2016nash}. Moreover, successful cooperation ({\ref{eqB:eq}}) is not guaranteed for the payoffs (\ref{vi_star:eq}). However, we found that bargaining was successful for the power system example in Section \ref{num:sec}, and the payoffs ({\ref{vi_star:eq}}) were very similar to the payoffs  defined in Algorithm {\ref{alg3:alg}} (Step 4(2)), which were shown in Fig.{\ref{payoff:fig}}(b).


\newpage
\section{Derivations of  and  matrices in Section \ref{WAC:sec}, eq. (\ref{Qwac:eq},\ref{Qi_cross:eq})}


 \subsection{Matrix  in eq. (\ref{Qwac:eq})}

The permutation matrix  in eq. (\ref{Qwac:eq}) is

\noindent where

\noindent and

\noindent Recall that  is the number of nodes in the system,  is the number of states belonging to node ,  is the total number of states in the network in (\ref{short:eq}), and  is the Kronecker delta function.

The phase angle terms in (\ref{Qwac:eq}) are given by

\noindent Thus 
 



\subsection{Matrix  in eq. (\ref{Qi_cross:eq})}

In eq.(24), the intra-area energy for agent 


\noindent where  is a block diagonal matrix with the identity matrix  at the  diagonal block, and zeros elsewhere.

\noindent where  represents the block-diagonal matrix with matrices  on the diagonal blocks. The phase angle terms of (\ref{Ei_intra:eq}) are given by


\noindent where
 
\noindent Thus



In eq.(\ref{Ei_inter:eq}), the inter-area energy for agent 


\noindent The phase angle terms of (\ref{Ei_inter:eq}) are given by

\noindent We express the LHS as
 
\noindent with


Thus, according to eq.(\ref{Qi_cross:eq}),

\noindent and




\section{Efficiency of the grand coalition}



Consider a coalitional game where the players within each coalition cooperate while different coalitions compete. Given a coalitional structure  and a set of players ,  is defined as a {\it partition} if , , and  \citelatex{Saad:2010aa}. In the multi-agent control problem, the control objective of each coalition  is denoted as , given by

\noindent where  is the submatrix of the feedback matrix  that represents the strategy of the coalition  and is given by the union of the submatrices  in (\ref{K^i:eq}) associated with agents . Under the sparsity constraint , the Nash strategies of the coalitions in  are expressed as 


\noindent Suppose  is the feedback matrix when the strategies of the coalitions in  are at a Nash Equilibrium.

The value of a coalition  in the partition  is defined as the objective reduction of , with respect to the decoupled game, i.e.


\noindent The above coalitional game is in partition form \cite{Hafalir2007242} since the value of each coalition depends on the composition of other coalitions. It is shown in \cite{Hafalir2007242} that for coalitonal games in partition form, the grand coalition  forms when it is efficient, i.e., for any partition , the value of  is not exceeded by the combined values of the coalitions in :


\noindent Next, suppose the matrices  in (\ref{Jsi:eq}) satisfy

\noindent which is a coalition-level equivalent of (\ref{sumQ:eq}). Then, for any partition  of , the sum of the values of the coalitions in 


\noindent where  is the feedback matrix that satisfies the social optimization (\ref{sparse_cent:eq}). To prove (\ref{ineq:eq}), note that  when (\ref{Qs:eq}) holds, and thus  represents a suboptimal solution to (\ref{sparse_cent:eq}) under the constraint , resulting in . Therefore, for any partition , the value of the grand coalition is at least as large as the sum of the values of the coalitions in , i.e., (\ref{eff:eq}) holds, and the grand coalition is efficient, which guarantees the formation of the grand coalition in the cooperative game and justifies Step 1 of Alg. 3 (social optimization) under the assumption (\ref{Qs:eq}).

\bibliographystylelatex{apalike}
\bibliographylatex{ref}



\end{document}
