\documentclass{article}


\PassOptionsToPackage{numbers, compress}{natbib}









\usepackage[final]{neurips_2022}





\usepackage[utf8]{inputenc} \usepackage[T1]{fontenc}    \usepackage{hyperref}       \usepackage{url}            \usepackage{booktabs}       \usepackage{amsfonts}       \usepackage{nicefrac}       \usepackage{microtype}      \usepackage{xcolor, color, colortbl}         



\usepackage[leqno]{amsmath}
\usepackage{amssymb}
\usepackage{mathtools}
\usepackage{amsthm}
\usepackage{bm}
\usepackage{pifont}\usepackage{xcolor}
\usepackage{calc}
\usepackage{enumitem}
\usepackage{mathtools}

\usepackage{subcaption}
\usepackage{graphics}
\usepackage{graphicx}
\usepackage{caption}
\usepackage{wrapfig}
\usepackage{minitoc}
\usepackage{adjustbox}
\usepackage{algorithm}
\usepackage{algpseudocode}
\usepackage{multirow}
\usepackage{threeparttable}





\newtheorem{theorem}{Theorem}\newtheorem{proposition}{Proposition}
\newtheorem{lemma}{Lemma}
\newtheorem{corollary}{Corollary}
\theoremstyle{definition}
\newtheorem{definition}{Definition}
\newtheorem{assumption}[theorem]{Assumption}
\theoremstyle{remark}
\newtheorem{remark}{Remark}

\DeclareMathOperator*{\argmin}{arg\,min}
\DeclareMathOperator*{\argmax}{arg\,max}
\newcommand\numberthis{\addtocounter{equation}{1}\tag{\theequation}}
\newcommand*\diff{\mathop{}\!\mathrm{d}}
\newsavebox{\leftbox}
\newsavebox{\rightbox}
\newcommand{\cmark}{\ding{51}}\newcommand{\xmark}{\ding{55}}\definecolor{Gray}{gray}{0.9}
\newcommand{\mc}[2]{\multicolumn{#1}{c}{#2}}
\newcommand{\mr}[2]{\multirow{#1}{*}{#2}}
\newcommand{\cc}[1]{\cellcolor{gray!#1}}
\bibliographystyle{unsrtnat}
\hypersetup{colorlinks}
\allowdisplaybreaks
\makeatletter
\newcommand{\printfnsymbol}[1]{\textsuperscript{\@fnsymbol{#1}}}
\newcommand{\leqnomode}{\tagsleft@true}\newcommand{\reqnomode}{\tagsleft@false}


\title{Maximum Likelihood Training of\\Implicit Nonlinear Diffusion Models}





\author{Dongjun Kim\\KAIST \\
	\texttt{dongjoun57@kaist.ac.kr} \\
	\And
	Byeonghu Na\\
	KAIST \\
	\texttt{wp03052@kaist.ac.kr} \\
	\And
	Se Jung Kwon \\
	NAVER CLOVA \\
	\And
	Dongsoo Lee \\
	NAVER CLOVA \\
	\And
	Wanmo Kang \\
	KAIST \\
	\And
	Il-Chul Moon \\
	KAIST / Summary.AI \\
}


\begin{document}
	
	
	\maketitle
	\doparttoc
	\parttoc
	\def\thefootnote{*}\footnotetext{Equal contribution}
	\def\thefootnote{\arabic{footnote}}
	
	\begin{abstract}
		Whereas diverse variations of diffusion models exist, extending the linear diffusion into a nonlinear diffusion process is investigated by very few works. The nonlinearity effect has been hardly understood, but intuitively, there would be promising diffusion patterns to efficiently train the generative distribution towards the data distribution. This paper introduces a data-adaptive nonlinear diffusion process for score-based diffusion models. The proposed Implicit Nonlinear Diffusion Model (INDM) learns by combining a normalizing flow and a diffusion process. Specifically, INDM implicitly constructs a nonlinear diffusion on the \textit{data space} by leveraging a linear diffusion on the \textit{latent space} through a flow network. This flow network is key to forming a nonlinear diffusion, as the nonlinearity depends on the flow network. This flexible nonlinearity improves the learning curve of INDM to nearly Maximum Likelihood Estimation (MLE) against the non-MLE curve of DDPM++, which turns out to be an inflexible version of INDM with the flow fixed as an identity mapping. Also, the discretization of INDM shows the sampling robustness. In experiments, INDM achieves the state-of-the-art FID of 1.75 on CelebA. We release our code at \url{https://github.com/byeonghu-na/INDM}.
	\end{abstract}
	
	\reqnomode
	
	\section{Introduction}
	\label{sec:Introduction}
	
	Diffusion models have recently achieved success on the task of sample generation, and some works \cite{song2020score, dhariwal2021diffusion} claim state-of-the-art performance over Generative Adversarial Networks (GAN) \citep{karras2019style}. This success is highlighted particularly in likelihood-based models, including normalizing flows \citep{grcic2021densely}, autoregressive models \citep{parmar2018image}, and Variational Auto-Encoders (VAE) \citep{vahdat2020nvae}. Moreover, this success is noteworthy because it is achieved merely using linear diffusion processes, such as Variance Exploding (VE) Stochastic Differential Equation (SDE) \citep{song2020improved}, and Variance Preserving (VP) SDE \citep{ho2020denoising}.
	
	This paper extends linear diffusions of VE/VP SDEs to a data-adaptive trainable nonlinear diffusion. To motivate the extension, though there are structural similarities between diffusion models and VAEs, the inference part of a linear diffusion process has not been trained while its counterpart of VAE (the encoder) has been trained. We introduce Implicit Nonlinear Diffusion Models (INDM) to train its \textit{forward} SDE, the inference part in diffusion models. INDM constructs the nonlinearity of the data diffusion by transforming a linear \textit{latent} diffusion back to the data space.
	
	We implement the transformation between the data and latent spaces with a normalizing flow. The invertibility of the flow mapping is key to learning a nonlinear inference part. Invertibility is necessary for constructing the nonlinearity, and we clarify this by comparing INDM with LSGM \cite{vahdat2021score}, a latent diffusion model with VAE. Altogether, INDM provides the following advantages over the existing models.
	\vspace{-2mm}
	\begin{itemize}\setlength\itemsep{0.2em}
	\item INDM achieves fast and tractable optimization with \textit{implicit} modeling.
	\item INDM learns not only drift but \textit{volatility} coefficients of the forward SDE.
	\item INDM trains its network with \textit{Maximum Likelihood Estimation} (MLE).
	\item INDM is \textit{robust} on the sampling discretization.
	\end{itemize}
	\vspace{-2mm}
	
	\section{Preliminary}\label{preliminary}
	
	A diffusion model is constructed with bidirectional \textit{forward} and \textit{reverse} stochastic processes. 
	
	\textbf{Forward and Reverse Diffusions} A forward diffusion process diffuses an input data variable, , to a noise variable, and the corresponding reverse diffusion process \cite{anderson1982reverse} of this forward diffusion denoises a noise variable to regenerate the input variable. The forward diffusion is fully described by an SDE of , and the corresponding reverse SDE becomes . Here,  is an abstraction of a random walk process with independent increments, where  is the data dimension, and  is the standard Wiener processes with backwards in time. 
	
	\textbf{Generative Diffusion} Having that the drift () and the volatility () terms are given a-priori, diffusion models \citep{song2020score} estimate the data score, , with the score network, . By plugging the score network in the data score, we obtain another diffusion process, called the \textit{generative} SDE, described by . Starting from a prior distribution of  and solving the SDE time backwards, \citet{song2020score} construct the generative stochastic process of  that perfectly reconstructs the reverse process of  under two conditions: 1)  and 2) . We define a generative distribution, , as the distribution of .
	
	\begin{figure*}[t]
\centering
		\includegraphics[width=\linewidth]{thumbnail_icml_ver2.png}
		\caption{Examples of linear (top row) and nonlinear (middle/bottom rows) diffusion processes.}
		\label{fig:thumbnail_icml}
\end{figure*}
	
	\textbf{Score Estimation} The diffusion model estimates the data score with the score network by minimizing the denoising score loss \citep{song2020score}, given by , where  is a transition probability of  given ; and  is the weighting function that determines the level of contribution for each diffusion time. When , \citet{song2021maximum, huang2021variational} proved that this loss with the likelihood weighting () turns out to be a variational bound of the negative log-likelihood: , up to a constant, see Appendix \ref{appendix:derivation_of_variational_bound} for a detailed discussion.
	
	\textbf{Choice of Drift () and Volatility () Terms} The original diffusion model strictly limits the scope of diffusion process to be a family of linear diffusions that  is a linear function of  and  is an identity matrix multiplied by a -function. For instance, VESDE \citep{song2020score, song2020improved} satisfies  with  and VPSDE \citep{song2020score, ho2020denoising} satisfies  with . Few concurrent works have extended linear diffusions to nonlinear diffusions by 1) applyng a latent diffusion using VAE in LSGM \cite{vahdat2021score}, 2) applying a flow network to nonlinearize the drift term in DiffFlow \cite{zhang2021diffusion}, and 3) reformulating the diffusion model into a Schrodinger Bridge Problem (SBP) \cite{vargas2021solving,de2021diffusion,chen2021likelihood}. We further analyze these approaches in Section \ref{sec:related_work}. 
	
	\section{Motivation of Nonlinear Diffusion Process}\label{sec:motivation}
	
	Figure \ref{fig:thumbnail_icml} illustrates various diffusion processes on a spiral toy dataset. In the top row, the diffusion path of VPSDE keeps its overall structure of the initial data manifold during the data deformation procedure to . The drift vector field illustrated in Figure \ref{fig:spiral}-(a) as black arrows presents that VPSDE \textit{linearly} deforms its data distribution.
	
	
	
	\begin{wrapfigure}{r}{0.5\textwidth}
		\vskip -0.18in
		\centering
		\begin{subfigure}{0.32\linewidth}
			\includegraphics[width=\linewidth]{spiral_f_linear.pdf}
			\subcaption{Linear }
		\end{subfigure}
		\hfill
		\begin{subfigure}{0.32\linewidth}
			\includegraphics[width=\linewidth]{spiral_f_nonlinear.pdf}
			\subcaption{Nonlinear }
		\end{subfigure}
		\hfill
		\begin{subfigure}{0.32\linewidth}
			\includegraphics[width=\linewidth]{spiral_G_nonlinear_ver2.png}
			\subcaption{Nonlinear }
		\end{subfigure}
		\vskip -0.05in
		\caption{Vector fields on various SDEs at .}
		\label{fig:spiral}
		\vskip -0.15in
	\end{wrapfigure}
	Unlike the linear diffusion, the middle row of Figure \ref{fig:thumbnail_icml} with a nonlinear drift shows that the data is not linearly deformed to . Figure \ref{fig:spiral}-(b) illustrates the corresponding vector field, in which two distinctive components (orange/blue) are forced to separate each other. The nonlinearity of the drift term represented as rotating black arrows is the source of such nonlinear deformation at the intermediate steps, . When it comes to the volatility term, the last row of Figure \ref{fig:thumbnail_icml} presents the process with nonlinear . Figure \ref{fig:spiral}-(c) illustrates the covariance matrices of the perturbation distribution at  with linear and nonlinear volatility terms, where the perturbation distribution induced by the volatility term is \footnote{The covariance is .}. It shows the non-diagonal and data-dependent covariances of  in red ellipses of a nonlinear volatility term, and the isotropic blue circles of linear diffusions.
	
	\begin{figure*}[t]
		\vskip -0.05in
		\centering
		\includegraphics[width=\linewidth]{PDM_GM_extended_ver6_ver2.pdf}
		\caption{INDM attains a ladder structure between the data space and the latent space. The latent vector is visualized by normalizing the latent value, see Appendix \ref{appendix:visualization} for further visualization.}
		\label{fig:pdm_gm}
		\vskip -0.1in
	\end{figure*}
	
	\leqnomode
	
	\section{Implicit Nonlinear Diffusion Model}\label{sec:methodology}
	
	There are two ways to nonlinearize the drift and volatility coefficients in SDE: explicit and implicit parametrizations. While explicit is a straightforward way to model the nonlinearity, it becomes impractical particularly in the training procedure. Concretely, in each of the training iteration, the denoising loss  requires 1) the perturbed samples  from  and 2) the calculation of , and these two steps require long execution time because the transition probability  is intractable for nonlinear diffusions in general. Therefore, we parametrize  and  \textit{implicitly} for fast and tractable optimization. As visualized in Figure \ref{fig:pdm_gm}, we impose a linear diffusion model on the latent space, and connect this latent variable with the data variable through a normalizing flow. The nonlinear diffusion on the data space, then, is induced from the latent diffusion leveraged to the data space.
	
	\subsection{Data and Latent Diffusion Processes}
	
	\textbf{Latent Diffusion Processes} Let us define  to be a transformed latent variable , where  is a transformation of the normalizing flow. Then, a forward linear diffusion
	
	starting at  with , describes the forward diffusion process on the latent space (blue diffusion path in Figure \ref{fig:pdm_gm}). The corresponding reverse latent diffusion is given by , where  is the probability of .
	
	\textbf{Forward Data Diffusion} We have not defined the data diffusion process yet. We build the data diffusion from the latent diffusion and the normalizing flow. From the invertibility, we define random variables on the data space by transforming the latent linear diffusion back to the data space:  for any . Then, from the Ito's formula \citep{oksendal2013stochastic}, the process  follows

starting with . From , we call this process by \textit{induced diffusion} that permeates the data variable on the data space. We emphasize that this induced diffusion collapses to a linear diffusion if . See Appendix \ref{appendix:derivation_of_diffusion} for details on drift and volatility terms.


	\textbf{Generative Data Diffusion} A diffusion model estimates the forward latent score  with the score network, , to mimic the forward linear diffusion on the latent space. Then, the generative SDE on the latent space becomes 
	
	with a starting variable . Thus, the process  of  becomes a generative data diffusion (purple path in Figure \ref{fig:pdm_gm}) with SDE of
	 
	
	
	
	\subsection{Model Training and Sampling}
	
	\textbf{Likelihood Training} Theorem \ref{thm:1} estimates Negative Evidence Lower Bound (NELBO) of Negaitve Log-Likelihood (NLL). For the notational simplicity, we define the targetted score function by
	
	Also, suppose , where  is the transition probability of the latent forward diffusion. In Theorem \ref{thm:1}, we drop the constant terms that do not hurt the essence of the theorem to keep the simplicity. See full details and the proof in Appendix \ref{appendix:proofs}.
	\reqnomode
	\begin{theorem}\label{thm:1}
		Suppose that  is the likelihood of a generative random variable . Then, the negative log-likelihood is upper bounded by
		
		where
		1ex]
		&=-\mathbb{E}_{\mathbf{x}_{0}}\big[\log{\big\vert\det\big(\nabla\mathbf{h}_{\bm{\phi}}(\mathbf{x}_{0})\big)\big\vert}\big]+\mathcal{L}\big(\{\mathbf{z}_{t}^{\bm{\phi}}\}_{t=0}^{T},g^{2};\bm{\theta}\big)-\mathbb{E}_{\mathbf{z}_{T}^{\bm{\phi}}}\big[\log{\pi(\mathbf{z}_{T}^{\bm{\phi}})}\big].\label{main_eq:training_loss}
		
	\mathbf{\tilde{z}}_{t_{k-1}}=\mathbf{\tilde{z}}_{t_{k}}+\gamma_{k}\bigg(\frac{1}{2}\beta(t_{k})\mathbf{\tilde{z}}_{t_{k}}+g^{2}(t_{k})\mathbf{s}_{\bm{\theta}}(\mathbf{\tilde{z}}_{t_{k}},t_{k})\bigg)+g(t_{k})\sqrt{\gamma_{k}}\bm{\epsilon},
	
		\Vert p_{r}-(\mathbf{h}_{\bm{\phi}}^{-1})_{\#}\circ p_{0,N}^{\bm{\theta}}\Vert_{TV}\le E_{pri}(\bm{\phi})+E_{dis}(\bm{\phi})+E_{est}(\bm{\phi},\bm{\theta})+o(\sqrt{\delta}+e^{-T}),
		\label{eq:nll_computation}
	\text{NLL}=\mathbb{E}_{\mathbf{x}_{0}}[-\log{p_{0}^{m}(\mathbf{x}_{0})}]\le\mathbb{E}_{\mathbf{x}_{0},\mathbf{x}_{\epsilon}}\bigg[-\log{p_{\epsilon}^{m}(\mathbf{x}_{\epsilon})}+\log{\frac{p_{\epsilon 0}^{m}(\mathbf{x}_{0}\vert\mathbf{x}_{\epsilon})}{p_{0\epsilon}(\mathbf{x}_{\epsilon}\vert\mathbf{x}_{0})}}\bigg].
	
	\underbrace{D_{KL}(\bm{\mu}_{\bm{\phi}}\Vert\bm{\nu}_{\bm{\phi},\bm{\theta}})}_{\text{INDM NELBO}}+\underbrace{D_{KL}(p_{r}^{(2)}\Vert p_{\bm{\phi}})}_{\text{Interpolation Loss}},
	\label{eq:general_reverse}
	\diff\mathbf{x}_{t}=\big[\mathbf{f}(\mathbf{x}_{t},t)-\text{div}(\mathbf{G}\mathbf{G}^{T})-\mathbf{G}\mathbf{G}^{T}\nabla\log{p_{t}(\mathbf{x}_{t})}\big]\diff \bar{t}+\mathbf{G}(\mathbf{x}_{t},t)\diff\mathbf{\bar{w}}_{t},
	
	\diff\mathbf{x}_{t}=\big[\mathbf{f}(\mathbf{x}_{t},t)-\text{div}(\mathbf{G}\mathbf{G}^{T})-\mathbf{G}\mathbf{G}^{T}\mathbf{s}(\mathbf{x}_{t},t)\big]\diff \bar{t}+\mathbf{G}(\mathbf{x}_{t},t)\diff\mathbf{\bar{w}}_{t}.\label{eq:general_generative}
	
	\begin{split}\label{eq:generalized_diffusion_loss}
	&D_{KL}(\bm{\mu}\Vert\bm{\nu})=D_{KL}(p_{T}(\mathbf{x}_{T})\Vert \pi(\mathbf{x}_{T}))\\
	&\quad+\frac{1}{2}\int_{0}^{T}\mathbb{E}_{\mathbf{x}_{t}}\Big[\big(\mathbf{s}(\mathbf{x}_{t},t)-\nabla\log{p_{t}(\mathbf{x}_{t})}\big)^{T}\mathbf{G}\mathbf{G}^{T}\big(\mathbf{s}(\mathbf{x}_{t},t)-\nabla\log{p_{t}(\mathbf{x}_{t})}\big)\Big]\diff t,
	\end{split}
	
		\lefteqn{D_{KL}(p_{r}\Vert p)\le D_{KL}(\bm{\mu}\Vert\bm{\nu})=D_{KL}(p_{T}(\mathbf{x}_{T})\Vert \pi(\mathbf{x}_{T}))}&\\
		&&+\frac{1}{2}\int_{0}^{T}\mathbb{E}_{\mathbf{x}_{t}}\Big[\big(\mathbf{s}(\mathbf{x}_{t},t)-\nabla\log{p_{t}(\mathbf{x}_{t})}\big)^{T}\mathbf{G}\mathbf{G}^{T}\big(\mathbf{s}(\mathbf{x}_{t},t)-\nabla\log{p_{t}(\mathbf{x}_{t})}\big)\Big]\diff t,
	
	\frac{\partial p_{t}}{\partial t}=-\sum_{j}\frac{\partial}{\partial x_{t,j}}\Big[f_{j}(\mathbf{x}_{t},t)p_{t}(\mathbf{x}_{t})-\sum_{i}\frac{\partial}{\partial x_{t,j}}(H_{ij}(\mathbf{x}_{t},t)p_{t}(\mathbf{x}_{t}))\Big],
	
		\lefteqn{\mathcal{H}(p_{r})-\mathcal{H}(p_{T})=-\int_{0}^{T}\frac{\partial}{\partial t}\mathcal{H}(p_{t})\diff t}&\\
		&&=\int_{0}^{T}\int\frac{\partial p_{t}}{\partial t}\log{p_{t}(\mathbf{x}_{t})}\diff \mathbf{x}_{t}\diff t\\
		&&=-\int_{0}^{T}\int\sum_{j}\frac{\partial}{\partial x_{t,j}}\Big[f_{j}(\mathbf{x}_{t},t)p_{t}(\mathbf{x}_{t})-\sum_{i}\frac{\partial}{\partial x_{t,i}}(H_{ij}(\mathbf{x}_{t},t)p_{t}(\mathbf{x}_{t}))\Big]\log{p_{t}(\mathbf{x}_{t})}\diff\mathbf{x}_{t}\diff t\\
		&&=\int_{0}^{T}\int \sum_{j}\Big[f_{j}(\mathbf{x}_{t},t)p_{t}(\mathbf{x}_{t})-\sum_{i}\frac{\partial}{\partial x_{t,i}}(H_{ij}(\mathbf{x}_{t},t)p_{t}(\mathbf{x}_{t}))\Big]\frac{\partial \log{p_{t}(\mathbf{x}_{t})}}{\partial x_{t,j}}\diff\mathbf{x}_{t}\diff t\\
		&&=\int_{0}^{T}\int p_{t}(\mathbf{x}_{t})\sum_{j} f_{j}(\mathbf{x}_{t},t)\frac{\partial\log{p_{t}(\mathbf{x}_{t})}}{\partial x_{t,j}}\diff\mathbf{x}_{t}\diff t\\
		&&\quad-\int_{0}^{T}\int \sum_{j}\sum_{i}\bigg(\frac{\partial H_{ij}}{\partial x_{t,i}}p_{t}+H_{ij}\frac{\partial p_{t}}{\partial x_{t,i}}\bigg)\frac{\partial\log{p_{t}}}{\partial x_{t,j}}\diff\mathbf{x}_{t}\diff t\\
		&&=-\int_{0}^{T}\mathbb{E}_{\mathbf{x}_{t}}[\text{div}(\mathbf{f}(\mathbf{x}_{t},t))]\diff t\\
		&&\quad-\int_{0}^{T}\mathbb{E}_{\mathbf{x}_{t}}[\text{div}(\mathbf{H}(\mathbf{x}_{t},t))^{T}\nabla\log{p_{t}(\mathbf{x}_{t})}]+\mathbb{E}_{\mathbf{x}_{t}}[\nabla\log{p_{t}(\mathbf{x}_{t})}^{T}\mathbf{H}(\mathbf{x}_{t},t)\nabla\log{p_{t}(\mathbf{x}_{t})}]\diff t\\
		&&=-\frac{1}{2}\int_{0}^{T}\mathbb{E}_{\mathbf{x}_{t}}\Big[ 2\text{div}(\mathbf{f}(\mathbf{x}_{t},t))+\text{div}(\mathbf{G}(\mathbf{x}_{t},t)\mathbf{G}(\mathbf{x}_{t},t)^{T})^{T}\nabla\log{p_{t}(\mathbf{x}_{t})}\\
		&&\quad\quad\quad\quad\quad\quad\quad\quad+\nabla\log{p_{t}(\mathbf{x}_{t})}^{T}\mathbf{G}(\mathbf{x}_{t},t)\mathbf{G}(\mathbf{x}_{t},t)^{T}\nabla\log{p_{t}(\mathbf{x}_{t})} \Big]\diff t.
	
		\lefteqn{\mathbb{E}_{p_{r}(\mathbf{x}_{0})}\big[-\log{p(\mathbf{x}_{0})}\big]=D_{KL}(p_{r}\Vert p)+\mathcal{H}(p_{r})\le D_{KL}(\bm{\mu}\Vert\bm{\nu})+\mathcal{H}(p_{r})}&\\
		&&=\frac{1}{2}\int_{0}^{T}\mathbb{E}_{\mathbf{x}_{t}}\big[(\nabla\log{p_{t}(\mathbf{x}_{t})}-\mathbf{s}(\mathbf{x}_{t},t))^{T}\mathbf{G}\mathbf{G}^{T}(\nabla\log{p_{t}(\mathbf{x}_{t})}-\mathbf{s}(\mathbf{x}_{t},t))\big]\diff t\\
		&&\quad+\mathbb{E}_{\mathbf{x}_{T}}\big[-\log{\pi(\mathbf{x}_{T})}\big]+\mathcal{H}(p_{r})-\mathcal{H}(p_{T})\\
		&&=\frac{1}{2}\int_{0}^{T}\mathbb{E}_{\mathbf{x}_{t}}\Big[\big(\mathbf{s}(\mathbf{x}_{t},t)-\nabla\log{p_{t}(\mathbf{x}_{t})}\big)^{T}\mathbf{G}\mathbf{G}^{T}\big(\mathbf{s}(\mathbf{x}_{t},t)-\nabla\log{p_{t}(\mathbf{x}_{t})}\big)\\
		&&\quad-\nabla\log{p_{t}(\mathbf{x}_{t})}^{T}\mathbf{G}\mathbf{G}^{T}\nabla\log{p_{t}(\mathbf{x}_{t})}-\text{div}(\mathbf{G}\mathbf{G}^{T})^{T}\nabla\log{p_{t}(\mathbf{x}_{t})}-2\text{div}(\mathbf{f}(\mathbf{x}_{t},t))\Big]\diff t\\
		&&\quad+\mathbb{E}_{\mathbf{x}_{T}}\big[-\log{\pi(\mathbf{x}_{T})}\big].
	
	\mathbb{E}_{p_{r}(\mathbf{x}_{0})}\big[-\log{p_{\bm{\theta}}(\mathbf{x}_{0})}\big]\le&\frac{1}{2}\int_{0}^{T}\mathbb{E}_{\mathbf{x}_{t}}\Big[\mathbf{s}^{T}\mathbf{G}\mathbf{G}^{T}\mathbf{s}+2\text{div}(\mathbf{G}\mathbf{G}^{T}\mathbf{s})\\
	&-\text{div}(\mathbf{G}\mathbf{G}^{T})\nabla\log{p_{t}}-2\text{div}(\mathbf{f})\Big]\diff t+\mathbb{E}_{\mathbf{x}_{T}}\big[-\log{\pi(\mathbf{x}_{T})}\big]
	
	&\mathbb{E}_{p_{r}(\mathbf{x}_{0})}\big[-\log{p(\mathbf{x}_{0})}\big]\\
	&\quad\le \frac{1}{2}\int_{0}^{T}\mathbb{E}_{\mathbf{x}_{0},\mathbf{x}_{t}}\Big[\big(\mathbf{s}(\mathbf{x}_{t},t)-\nabla\log{p_{0t}(\mathbf{x}_{t}\vert\mathbf{x}_{0})}\big)^{T}\mathbf{G}\mathbf{G}^{T}\big(\mathbf{s}(\mathbf{x}_{t},t)-\nabla\log{p_{0t}(\mathbf{x}_{t}\vert\mathbf{x}_{0})}\big)\\
	&\quad\quad-\nabla\log{p_{0t}(\mathbf{x}_{t}\vert\mathbf{x}_{0})}^{T}\mathbf{G}\mathbf{G}^{T}\nabla\log{p_{0t}(\mathbf{x}_{t}\vert\mathbf{x}_{0})}-\text{div}(\mathbf{G}\mathbf{G}^{T})^{T}\nabla\log{p_{0t}(\mathbf{x}_{t}\vert\mathbf{x}_{0})}-2\text{div}(\mathbf{f})\Big]\diff t\\
	&\quad\quad+\mathbb{E}_{\mathbf{x}_{T}}\big[-\log{\pi(\mathbf{x}_{T})}\big].
	\label{eq:linear_diffusion_ap}
	\diff\mathbf{z}_{t}=-\frac{1}{2}\beta(t)\mathbf{z}_{t}\diff t+g(t)\diff \mathbf{w}_{t},\quad\mathbf{z}_{0}=\mathbf{h}(\mathbf{x}_{0})\text{ with }\mathbf{x}_{0}\sim p_{r},
	\label{eq:ito_ap}
	\diff \mathrm{x}_{t,k}= \frac{\partial \mathrm{h}_{k}^{-1}}{\partial t} \diff t + \big[\nabla_{\mathbf{z}_{t}}\mathrm{h}_{k}^{-1}(\mathbf{z}_{t})\big]^{T} \diff\mathbf{z}_{t}+ \frac{1}{2} \text{tr} \left ( \nabla_{\mathbf{z}_{t}}^{2} \mathrm{h}_{k}^{-1}(\mathbf{z}_{t})\diff\mathbf{z}_{t}\diff\mathbf{z}_{t}^{T}  \right )
	\label{eq:derived_ito_ap}
	\begin{split}
	\diff\mathrm{x}_{t,k} &= \big[\nabla_{\mathbf{z}_t}\mathrm{h}_{k}^{-1}(\mathbf{z}_{t})\big]^{T} \left \{ -\frac{1}{2}\beta(t)\mathbf{z}_{t}\diff t+g(t)\diff \mathbf{w}_{t} \right \} + \frac{1}{2} g^{2}(t)\text{tr} \left ( \nabla_{\mathbf{z}_{t}}^{2} \mathrm{h}_{k}^{-1}(\mathbf{z}_{t})   \right )\diff t \\
	&= \left \{ -\frac{1}{2} \beta(t) \big[\nabla_{\mathbf{z}_{t}}\mathrm{h}_{k}^{-1}(\mathbf{z}_{t})\big]^{T}\mathbf{z}_{t} + \frac{1}{2} g^{2}(t) \text{tr} \left ( \nabla_{\mathbf{z}_{t}}^{2} \mathrm{h}_{k}^{-1}(\mathbf{z}_{t})    \right ) \right \} \diff t + g(t) \big[\nabla_{\mathbf{z}_t}\mathrm{h}_{k}^{-1}(\mathbf{z}_{t})\big]^{T} \diff \mathbf{w}_{t},
	\end{split}
	
	\diff\mathbf{x}_{t}=\mathbf{f}(\mathbf{x}_{t},t)\diff t+\mathbf{G}(\mathbf{x}_{t},t)\diff\mathbf{w}_{t},
	\label{eq:drift_ap}
	\begin{split}
	\left\{\begin{array}{ll}
	\mathbf{f}(\mathbf{x}_{t},t)=-\frac{1}{2} \beta(t) \nabla_{\mathbf{z}_{t}}\mathbf{h}^{-1}(\mathbf{z}_{t}) \mathbf{z}_{t} + \frac{1}{2} g^{2}(t) \text{tr} \left ( \nabla_{\mathbf{z}_{t}}^{2} \mathbf{h}^{-1}(\mathbf{z}_{t})    \right )\
	Here,  is a 3-dimensional tensor with -th element to be , and the trace operator applied on this tensor is defined as a vector of . From the inverse function theorem \citep{rudin1964principles}, the Jacobian of the inverse function  equals to the inverse Jacobian . Therefore, Eq. \eqref{eq:drift_ap} is transformed to
	0.1cm]
	\mathbf{G}(\mathbf{x}_{t},t)=g(t) \big[\nabla_{\mathbf{x}_{t}}\mathbf{h}(\mathbf{x}_{t})\big]^{-1}.
	\end{array}\right.
	\end{split}
	
	\sum_{k} \left \{  \frac{\partial}{\partial \mathrm{x}_{t,l}} \left ( \frac{\partial \mathrm{h}^{-1}_{i}}{\partial \mathrm{z}_{t,k}} \right ) \right \} \frac{\partial \mathrm{h}_{k}}{\partial \mathrm{x}_{t,j}} + \frac{\partial \mathrm{h}^{-1}_{i}}{\partial \mathrm{z}_{t,k}} \left \{  \frac{\partial}{\partial \mathrm{x}_{t,l}} \left (\frac{\partial \mathrm{h}_{k}}{\partial \mathrm{x}_{t,j}} \right ) \right \}=0,
	
	\sum_{k,m} \frac{\partial \mathrm{h}_{m}}{\partial \mathrm{x}_{t,l}} \left \{  \frac{\partial}{\partial \mathrm{z}_{t,m}} \left ( \frac{\partial \mathrm{h}^{-1}_{i}}{\partial \mathrm{z}_{t,k}} \right ) \right \} \frac{\partial \mathrm{h}_{k}}{\partial \mathrm{x}_{t,j}} = \sum_{k,m} \big( \nabla_{\mathbf{x}_{t}} \mathbf{h}(\mathbf{x}_{t}) \big)^{T}_{l,m} \big( \nabla_{\mathbf{z}_{t}}^{2} \mathbf{h}_{i}^{-1}(\mathbf{z}_{t}) \big)_{m,k} \big(\nabla_{\mathbf{x}_{t}} \mathbf{h}(\mathbf{x}_{t})\big)_{k,j},
	
	\sum_{k}\frac{\partial \mathrm{h}^{-1}_{i}}{\partial \mathrm{z}_{t,k}} \left \{  \frac{\partial}{\partial \mathrm{x}_{t,l}} \left (\frac{\partial \mathrm{h}_{k}}{\partial \mathrm{x}_{t,j}} \right ) \right \} =  \sum_{k} \big(\nabla_{\mathbf{z}_{t}} \mathbf{h}^{-1}(\mathbf{z}_{t})\big)_{i,k} \big(\nabla_{\mathbf{x}_{t}}^{2} \mathbf{h}_{k}(\mathbf{x}_{t})\big)_{l,j}.
	
	\text{tr} \left ( \nabla_{\mathbf{z}_{t}}^{2} \mathbf{h}^{-1}(\mathbf{z}_{t})    \right ) = - \text{tr}  \left (  \big[ \nabla_{\mathbf{x}_{t}}\mathbf{h}(\mathbf{x}_{t})\big]^{-T} \left ( \big[\nabla_{\mathbf{x}_{t}}\mathbf{h}(\mathbf{x}_{t})\big]^{-1} * \nabla_{\mathbf{x}_{t}}^{2}\mathbf{h}(\mathbf{x}_{t})  \right )  \big[ \nabla_{\mathbf{x}_{t}}\mathbf{h}(\mathbf{x}_{t})\big]^{-1} \right ),
	
	\Big(\big[\nabla_{\mathbf{x}_{t}}\mathbf{h}(\mathbf{x}_{t})\big]^{-1} * \nabla_{\mathbf{x}_{t}}^{2}\mathbf{h}(\mathbf{x}_{t})\Big)_{i,j}:=\nabla_{\mathbf{x}_{t}}\big[\mathbf{h}(\mathbf{x}_{t})\big]^{-1}\Big(\nabla_{\mathbf{x}_{t}}^{2}\mathbf{h}(\mathbf{x}_{t})\Big)_{i,j}.
	
	\mathbf{f}(\mathbf{x}_{t},t)=&-\frac{1}{2} \beta(t) \big[\nabla_{\mathbf{x}_{t}}\mathbf{h}(\mathbf{x}_{t})\big]^{-1} \mathbf{h}(\mathbf{x}_{t})\\
	& - \frac{1}{2} g^{2}(t) \text{tr}  \left (  \big[ \nabla_{\mathbf{x}_{t}}\mathbf{h}(\mathbf{x}_{t})\big]^{-T} \left ( \big[\nabla_{\mathbf{x}_{t}}\mathbf{h}(\mathbf{x}_{t})\big]^{-1} * \nabla_{\mathbf{x}_{t}}^{2}\mathbf{h}(\mathbf{x}_{t})  \right )  \big[ \nabla_{\mathbf{x}_{t}}\mathbf{h}(\mathbf{x}_{t})\big]^{-1} \right ).
	\label{eq:full_score}
	\diff\mathbf{z}_{t}=\left[\mathbf{f}(\mathbf{z}_{t},t)-g^{2}(t)\mathbf{s}_{\bm{\theta}}(\mathbf{z}_{t},t)\right]\diff\bar{t}+g(t)\diff\mathbf{\bar{w}}_{t}
	\label{eq:rotation_free_score}
	\diff\mathbf{z}_{t}=\left[\mathbf{f}(\mathbf{z}_{t},t)-g^{2}(t)\nabla\log{p_{t}^{\bm{\theta}}(\mathbf{z}_{t})}\right]\diff\bar{t}+g(t)\diff\mathbf{\bar{w}}_{t}
	
	\begin{split}\label{eq:u_t}
	D_{KL}(\bm{\nu}_{\bm{\theta}}\Vert\bm{\rho}_{\bm{\theta}})=&\frac{1}{2}\int_{0}^{T}g^{2}(t)\mathbb{E}_{\mathbf{z}_{t}\sim\bm{\nu}_{\bm{\theta}}\vert_{t}}\left[\Vert \nabla\log{p_{t}^{\bm{\theta}}(\mathbf{z}_{t})}-\mathbf{s}_{\bm{\theta}}(\mathbf{z}_{t},t) \Vert_{2}^{2}\right]\diff t\\
	=&\frac{1}{2}\int_{0}^{T}g^{2}(t)\mathbb{E}_{\mathbf{z}_{t}\sim\bm{\nu}_{\bm{\theta}}\vert_{t}}\left[\Vert \mathbf{u}_{\bm{\theta}}(\mathbf{z}_{t},t) \Vert_{2}^{2}\right]\diff t.
	\end{split}
	
	\diff\mathbf{z}_{t}=\mathbf{f}(\mathbf{z}_{t},t)\diff t+g(t)\diff\mathbf{w}_{t},
	\label{eq:nelbo_score}
	D_{KL}(\bm{\mu}_{\bm{\phi}}\Vert\bm{\nu}_{\bm{\phi},\bm{\theta}})=\frac{1}{2}\int_{0}^{T}g^{2}(t)\mathbb{E}_{p_{t}^{\bm{\phi}}(\mathbf{z}_{t})}\left[\Vert\mathbf{s}_{\bm{\theta}}(\mathbf{z}_{t},t)-\nabla\log{p_{t}^{\bm{\phi}}(\mathbf{z}_{t})}\Vert_{2}^{2}\right]\diff t+D_{KL}\big(p_{T}^{\bm{\phi}}(\mathbf{z}_{T})\Vert\pi(\mathbf{z}_{T})\big),
	
		\textup{Gap}\big(\bm{\mu}_{\bm{\phi}}(\{\mathbf{x}_{t}\}),\bm{\nu}_{\bm{\phi},\bm{\theta}}(\{\mathbf{x}_{t}\})\big):=&D_{KL}\big(\bm{\mu}_{\bm{\phi}}(\{\mathbf{x}_{t}\})\Vert\bm{\nu}_{\bm{\phi},\bm{\theta}}(\{\mathbf{x}_{t}\})\big)-D_{KL}\big(p_{0}^{\bm{\phi}}(\mathbf{x}_{0})\Vert q_{0}^{\bm{\theta}}(\mathbf{x}_{0})\big)\\
		=&\frac{1}{2}\int_{0}^{T}g^{2}(t)\mathbb{E}_{p_{t}^{\bm{\phi}}(\mathbf{z}_{t})}\big[\underbrace{\Vert\nabla\log{q_{t}^{\bm{\theta}}(\mathbf{z}_{t})}-\mathbf{s}_{\bm{\theta}}(\mathbf{z}_{t},t)\Vert_{2}^{2}}_{\text{Score-only error}}\big]\diff t.
		
	\lefteqn{\textup{Gap}\big(\bm{\mu}_{\bm{\phi}},\bm{\nu}_{\bm{\phi},\bm{\theta}}\big)=\frac{1}{2}\int_{0}^{T}g^{2}(t)\mathbb{E}_{p_{t}^{\bm{\phi}}(\mathbf{z}_{t})}\big[\Vert\nabla\log{q_{t}^{\bm{\theta}}(\mathbf{z}_{t})}-\mathbf{s}_{\bm{\theta}}(\mathbf{z}_{t},t)\Vert_{2}^{2}\big]\diff t}&\label{eq:gap_decomposition}\\
	&&\le\frac{1}{2}\int_{0}^{T}g^{2}(t)\mathbb{E}_{p_{t}^{\bm{\phi}}(\mathbf{z}_{t})}\Big[\big\Vert\nabla\log{q_{t}^{\bm{\theta}}(\mathbf{z}_{t})}-\nabla\log{p_{t}^{\bm{\theta}}(\mathbf{z}_{t})}\big\Vert_{2}^{2}+\big\Vert\nabla\log{p_{t}^{\bm{\theta}}(\mathbf{z}_{t})}-\mathbf{s}_{\bm{\theta}}(\mathbf{z}_{t},t)\big\Vert_{2}^{2}\Big]\diff t.\notag\\
	&&=\frac{1}{2}\int_{0}^{T}g^{2}(t)\mathbb{E}_{p_{t}^{\bm{\phi}}(\mathbf{z}_{t})}\Big[\underbrace{\big\Vert\nabla\log{q_{t}^{\bm{\theta}}(\mathbf{z}_{t})}-\nabla\log{p_{t}^{\bm{\theta}}(\mathbf{z}_{t})}\big\Vert_{2}^{2}}_{\text{How close is  to forward measure}}+\underbrace{\big\Vert\mathbf{u}_{t}^{\bm{\theta}}(\mathbf{z}_{t})\big\Vert_{2}^{2}}_{\text{How close is  to zero}}\Big]\diff t.\notag
	
	\mathbf{S}_{div}:=\{\mathbf{s}:\mathbb{R}^{d}\rightarrow\mathbb{R}^{d}\vert\text{ the rotation term of  is zero}\}.
	
	\nabla\log{q_{t}(\mathbf{z}_{t})}=\nabla\log{q_{t}^{\bm{\theta}}(\mathbf{z}_{t})}\text{ is equivalent to }\nabla\log{q_{t}(\mathbf{z}_{t})}=\nabla\log{p_{t}^{\bm{\theta}}(\mathbf{z}_{t})},
	\label{eq:symmetric}
	\mathbb{E}_{\bm{\epsilon}_{1},\bm{\epsilon}_{2}}\left[\Big(\bm{\epsilon}_{2}^{T}\big(\nabla\mathbf{s}_{\bm{\theta}}(\mathbf{z}_{t},t)-(\nabla\mathbf{s}_{\bm{\theta}})^{T}(\mathbf{z}_{t},t)\big)\bm{\epsilon}_{1}\Big)^{2}\right]=0
	
		\mathbb{E}_{\bm{\epsilon}_{1},\bm{\epsilon}_{2}}[(\bm{\epsilon}_{2}^{T}(A-A^{T})\bm{\epsilon}_{1})^{2}]=\mathbb{E}_{U}[U^{2}]^{2}\Vert A-A^{T}\Vert_{F}^{2}
		
		&\text{Var}\Big(\big(\bm{\epsilon}_{2}^{T}(A-A^{T})\bm{\epsilon}_{1}\big)^{2}\Big)=\text{Var}(U^{2})\Big(\text{Var}(U^{2})+2\big(\text{Var}(U)+\mathbb{E}_{U}[U]^{2}\big)^{2}\Big)\sum_{a,b}(\Delta A)_{ab}^{4}\\
		&\quad+2\big(\text{Var}(U)+\mathbb{E}_{U}[U]^{2}\big)^{2}\Big(3\text{Var}(U^{2})+2\big(\text{Var}(U)+\mathbb{E}_{U}[U]^{2}\big)^{2}\Big)\sum_{a}\sum_{b\ne d}(\Delta A)_{ab}^{2}(\Delta A)_{ad}^{2}\\
		&\quad+2\big(\text{Var}(U)+\mathbb{E}_{U}[U]^{2}\big)^{4}\Big(\sum_{a\neq c}\sum_{b\neq d}(\Delta A)_{ab}^{2}(\Delta A)_{cd}^{2}\\
		&\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad+3\sum_{a\ne c}\sum_{b\ne d}(\Delta A)_{ab}(\Delta A)_{ad}(\Delta A)_{cb}(\Delta A)_{cd}\Big),
		\label{eq:sde_solution}
	\mathbf{x}_{t}=\underbrace{e^{-\frac{1}{2}\int_{0}^{t}\beta(s)\diff s}\mathbf{x}_{0}}_{\text{linearly contraction mapping}}+\underbrace{\sqrt{1-e^{-\int_{0}^{t}\beta(s)\diff s}}\bm{\epsilon}}_{\text{random perturbation}},
	
		\lefteqn{D_{KL}(p_{r}\Vert p_{\bm{\theta},\bm{\psi}})\le D_{KL}\big(p_{r}(\mathbf{x}_{0})q_{\bm{\phi}}(\mathbf{z}_{0}\vert\mathbf{x}_{0})\Vert p_{\bm{\theta}}(\mathbf{z}_{0})p_{\bm{\psi}}(\mathbf{x}_{0}\vert\mathbf{z}_{0})\big)}&\\
		&&= D_{KL}\big(p_{r}(\mathbf{x}_{0})q_{\bm{\phi}}(\mathbf{z}_{0}\vert\mathbf{x}_{0})\Vert q_{\bm{\phi}}(\mathbf{z}_{0})p_{\bm{\psi}}(\mathbf{x}_{0}\vert\mathbf{z}_{0})\big)+D_{KL}\big(q_{\bm{\phi}}(\mathbf{z}_{0})\Vert p_{\bm{\theta}}(\mathbf{z}_{0})\big)\\
		&&\le D_{KL}\big(p_{r}(\mathbf{x}_{0})q_{\bm{\phi}}(\mathbf{z}_{0}\vert\mathbf{x}_{0})\Vert q_{\bm{\phi}}(\mathbf{z}_{0})p_{\bm{\psi}}(\mathbf{x}_{0}\vert\mathbf{z}_{0})\big)+D_{KL}\big(\bm{\mu}_{\bm{\phi}}(\{\mathbf{z}_{t}\}_{t=0}^{T})\Vert \bm{\nu}_{\bm{\theta}}(\{\mathbf{z}_{t}\}_{t=0}^{T})\big)\\
		&&=\mathcal{L}_{LSGM}(\bm{\theta},\bm{\phi},\bm{\psi})
	\label{eq:ncsn_loss}
	D_{KL}(p_{r}\Vert p_{\bm{\theta}})\le \frac{1}{2}\int_{0}^{T}g^{2}(t)\mathbb{E}_{p_{r}(\mathbf{x}_{0})}\mathbb{E}_{p_{0t}(\mathbf{x}_{t}\vert\mathbf{x}_{0})}\big[\Vert\mathbf{s}_{\bm{\theta}}(\mathbf{x}_{t},t)-\nabla_{\mathbf{x}_{t}}\log{p_{0t}(\mathbf{x}_{t}\vert\mathbf{x}_{0})}\Vert_{2}^{2}\big]\diff t+D_{KL}(p_{T}\Vert\pi).
	\label{eq:ddpm_loss}
	\int_{0}^{T}\tilde{\lambda}(t)\mathbb{E}_{p_{r}(\mathbf{x}_{0})}\mathbb{E}_{\bm{\epsilon}\sim\mathcal{N}(0,\mathbf{I})}\big[\Vert\bm{\epsilon}-\bm{\hat{\epsilon}}_{\bm{\theta}}(\mathbf{x}_{t},t)\Vert_{2}^{2}\big]\diff t,
	\label{eq:approximate_diffflow}
	\mathbf{x}_{t_{i}}^{\bm{\phi}}-\mathbf{x}_{t_{i-1}}^{\bm{\phi},\text{EM}}=&\int_{t_{i-1}}^{t_{i}}\mathbf{f}_{\bm{\phi}}(\mathbf{x}_{t}^{\bm{\phi}},t)\diff t+\int_{t_{i-1}}^{t_{i}}g(t)\diff\mathbf{w}_{t}.
	
	\int_{t_{i-1}}^{t_{i}}\mathbf{f}_{\bm{\phi}}(\mathbf{x}_{t}^{\bm{\phi}},t)\diff t=&\int_{t_{i-1}}^{t_{i}}\mathbf{f}_{\bm{\phi}}\big(\mathbf{x}_{t_{i-1}}^{\bm{\phi},\text{EM}}+(\mathbf{x}_{t}^{\bm{\phi}}-\mathbf{x}_{t_{i-1}}^{\bm{\phi},\text{EM}}),t_{i-1}+(t-t_{i-1})\big)\diff t\\
	=&\int_{t_{i-1}}^{t_{i}}\mathbf{f}_{\bm{\phi}}(\mathbf{x}_{t_{i-1}}^{\bm{\phi},\text{EM}},t_{i-1})\diff t+O(\Delta t_{i}^{3/2})\\
	=&\mathbf{f}_{\bm{\phi}}(\mathbf{x}_{t_{i-1}}^{\bm{\phi},\text{EM}},t_{i-1})\Delta t_{i}+O(\Delta t_{i}^{3/2}),
	
	\int_{t_{i-1}}^{t_{i}}g(t)\diff\mathbf{w}_{t}=g(t_{i-1})(\mathbf{w}_{t_{i}}-\mathbf{w}_{t_{i-1}})+O(\Delta t_{i}^{3/2})=g(t_{i-1})\bm{\epsilon}\sqrt{\Delta t_{i}}+O(\Delta t_{i}^{3/2}),
	
	\mathbf{x}_{t_{i}}^{\bm{\phi}}=&\mathbf{x}_{t_{i-1}}^{{\bm{\phi}},\text{EM}}+\mathbf{f}_{\bm{\phi}}(\mathbf{x}_{t_{i-1}}^{{\bm{\phi}},\text{EM}},t_{i-1})\Delta t_{i}+g(t_{i-1})\bm{\epsilon}\sqrt{\Delta t_{i}}+O(\Delta t_{i}^{2/3})\\
	\approx&\mathbf{x}_{t_{i-1}}^{{\bm{\phi}},\text{EM}}+\mathbf{f}_{\bm{\phi}}(\mathbf{x}_{t_{i-1}}^{{\bm{\phi}},\text{EM}},t_{i-1})\Delta t_{i}+g(t_{i-1})\bm{\epsilon}\sqrt{\Delta t_{i}}\\
	=&\mathbf{x}_{t_{i}}^{{\bm{\phi}},\text{EM}},
	
	\mathbf{x}_{t_{i-1}}^{\bm{\theta}}=\mathbf{x}_{t_{i}}^{\bm{\theta}}-\big[\mathbf{f}_{\bm{\phi}}(\mathbf{x}_{t_{i}}^{\bm{\phi}},t_{i})-g^{2}(t_{i})\mathbf{s}_{\bm{\theta}}(\mathbf{x}_{t_{i}}^{\bm{\phi}},t_{i})\big]\Delta t_{i}+g(t_{i})\bm{\epsilon}\sqrt{\Delta t_{i}}.
	\label{eq:discrete_ddpm_loss}
	D_{KL}(p_{r}\Vert p_{\bm{\phi},\bm{\theta}})\le\sum_{i=1}^{N-1}\mathbb{E}_{p_{r}(\mathbf{x}_{t_{0}}^{\text{EM}})}\mathbb{E}_{p_{\bm{\phi}}(\mathbf{x}_{t_{i}}^{\text{EM}},\mathbf{x}_{t_{i-1}}^{\text{EM}}\vert\mathbf{x}_{t_{0}}^{\text{EM}})}\big[D_{KL}(p_{\bm{\phi}}(\mathbf{x}_{t_{i-1}}^{\text{EM}}\vert\mathbf{x}_{t_{i}}^{\text{EM}},\mathbf{x}_{t_{0}}^{\text{EM}})\Vert p_{\bm{\theta}}(\mathbf{x}_{t_{i-1}}^{\text{EM}}\vert\mathbf{x}_{t_{i}}^{\text{EM}}))\big].
	\label{eq:ddpm_style_loss}
	\begin{split}
	D_{KL}(p_{r}\Vert p_{\bm{\phi},\bm{\theta}})&\le\sum_{i=1}^{N-1}\mathbb{E}_{p_{r}(\mathbf{x}_{t_{0}}^{\text{EM}})}\mathbb{E}_{p_{\bm{\phi}}(\mathbf{x}_{t_{i}}^{\text{EM}},\mathbf{x}_{t_{i-1}}^{\text{EM}}\vert\mathbf{x}_{t_{0}}^{\text{EM}})}\big[D_{KL}(p_{\bm{\phi}}(\mathbf{x}_{t_{i-1}}^{\text{EM}}\vert\mathbf{x}_{t_{i}}^{\text{EM}},\mathbf{x}_{t_{0}}^{\text{EM}})\Vert p_{\bm{\theta}}(\mathbf{x}_{t_{i-1}}^{\text{EM}}\vert\mathbf{x}_{t_{i}}^{\text{EM}}))\big]\\
	&=\frac{1}{2}\sum_{i=1}^{N-1}\mathbb{E}_{p_{r}(\mathbf{x}_{t_{0}}^{\text{EM}})}\mathbb{E}_{p_{\bm{\phi}}(\mathbf{x}_{t_{i}}^{\text{EM}},\mathbf{x}_{t_{i-1}}^{\text{EM}}\vert\mathbf{x}_{t_{0}}^{\text{EM}})}\bigg[\frac{1}{g^{2}(t_{i})\Delta t_{i}}\Big\Vert\mathbf{x}_{t_{i-1}}^{\text{EM}}-\mathbf{x}_{t_{i}}^{\text{EM}}\\
	&\quad\quad\quad\quad\quad\quad\quad+\big[\mathbf{f}_{\bm{\phi}}(\mathbf{x}_{t_{i}}^{\text{EM}},t_{i})-g^{2}(t_{i})\mathbf{s}_{\bm{\theta}}(\mathbf{x}_{t_{i}}^{\text{EM}},t_{i})\big]\Delta t_{i}\Big\Vert_{2}^{2}\bigg]\\
	&=\mathcal{L}_{\text{DiffFlow}}(\bm{\phi},\bm{\theta})
	\end{split}
	
	\begin{split}\label{eq:exchange_sum_and_expectation}
	&\mathcal{L}_{\text{DiffFlow}}(\bm{\phi},\bm{\theta})=\frac{1}{2}\mathbb{E}_{\{\mathbf{x}_{t_{i}}\}_{i=0}^{N-1}\sim p_{\bm{\phi}}(\mathbf{x}_{t_{0}},...,\mathbf{x}_{t_{N-1}})}\bigg[\sum_{i=1}^{N-1}\frac{1}{g^{2}(t_{i})\Delta t_{i}}\Big\Vert\mathbf{x}_{t_{i-1}}-\mathbf{x}_{t_{i}}\\
	&\quad\quad\quad\quad\quad\quad\quad+\big[\mathbf{f}_{\bm{\phi}}(\mathbf{x}_{t_{i}},t_{i})-g^{2}(t_{i})\mathbf{s}_{\bm{\theta}}(\mathbf{x}_{t_{i}},t_{i})\big]\Delta t_{i}\Big\Vert_{2}^{2}\bigg].
	\end{split}
	\label{eq:error}
	\mathbb{E}\big[\Vert\mathbf{x}_{t}-\mathbf{x}_{t}^{\text{EM}}\Vert_{2}\big]\le C\sqrt{\Delta t_{i}},
	
	\Vert\mathbf{f}_{\bm{\phi}}(\mathbf{x},t)-\mathbf{f}_{\bm{\phi}}(\mathbf{y},t)\Vert_{2}\le K\Vert\mathbf{x}-\mathbf{y}\Vert_{2}
	
	\Vert\mathbf{f}_{\bm{\phi}}(\mathbf{x},t)\Vert_{2}+\vert g(t)\vert\le K(1+\Vert\mathbf{x}\Vert_{2})
	\label{eq:approximate_}
	\mathbf{x}_{t_{i}}-\mathbf{x}_{t_{i-1}}^{\text{EM}}=&\int_{t_{i-1}}^{t_{i}}\mathbf{f}_{\bm{\phi}}(\mathbf{x}_{t},t)\diff t+\int_{t_{i-1}}^{t_{i}}\mathbf{G}_{\bm{\phi}}(\mathbf{x}_{t},t)\diff\mathbf{w}_{t}.
	
	\int_{t_{i-1}}^{t_{i}}\mathbf{G}_{\bm{\phi}}(\mathbf{x}_{t},t)\diff\mathbf{w}_{t}=\int_{t_{i-1}}^{t_{i}}\mathbf{G}_{\bm{\phi}}\big(\mathbf{x}_{t_{i-1}}^{\text{EM}}+(\mathbf{x}_{t}-\mathbf{x}_{t_{i-1}}^{\text{EM}}),t_{i-1}+(t-t_{i-1})\big)\diff\mathbf{w}_{t}
	
		\lefteqn{\int_{t_{i-1}}^{t_{i}}\mathbf{G}_{\bm{\phi}}(\mathbf{x}_{t},t)\diff\mathbf{w}_{t}}&\\
		&&=\mathbf{G}_{\bm{\phi}}(\mathbf{x}_{t_{i-1}}^{\text{EM}},t_{i-1})(\mathbf{w}_{t_{i}}-\mathbf{w}_{t_{i-1}})\\
		&&\quad+\mathbf{G}_{\bm{\phi}}(\mathbf{x}_{t_{i-1}}^{\text{EM}},t_{i-1})\frac{\partial\mathbf{G}_{\bm{\phi}}(\mathbf{x}_{t},t)}{\partial\mathbf{x}_{t}}\vert_{\mathbf{x}_{t_{i-1}}^{\text{EM}}}\int_{t_{i-1}}^{t_{i}}\mathbf{w}_{t}-\mathbf{w}_{t_{i-1}}\diff\mathbf{w}_{t}+O(\Delta t_{i}^{2})\\
		&&=\mathbf{G}_{\bm{\phi}}(\mathbf{x}_{t_{i-1}}^{\text{EM}},t_{i-1})(\mathbf{w}_{t_{i}}-\mathbf{w}_{t_{i-1}})\\
		&&\quad+\mathbf{G}_{\bm{\phi}}(\mathbf{x}_{t_{i-1}}^{\text{EM}},t_{i-1})\nabla_{\mathbf{x}_{t_{i-1}}^{\text{EM}}}\mathbf{G}_{\bm{\phi}}(\mathbf{x}_{t_{i-1}}^{\text{EM}},t_{i-1})\frac{1}{2}\big((\mathbf{w}_{t_{i}}-\mathbf{w}_{t_{i-1}})^{2}-\Delta t_{i}\big)+O(\Delta t_{i}^{2})\\
		&&=\mathbf{G}_{\bm{\phi}}(\mathbf{x}_{t_{i-1}}^{\text{EM}},t_{i-1})\bm{\epsilon}\sqrt{\Delta t_{i}}\\
		&&\quad+\frac{1}{2}\mathbf{G}_{\bm{\phi}}(\mathbf{x}_{t_{i-1}}^{\text{EM}},t_{i-1})\nabla_{\mathbf{x}_{t_{i-1}}^{\text{EM}}}\mathbf{G}_{\bm{\phi}}(\mathbf{x}_{t_{i-1}}^{\text{EM}},t_{i-1})\big(\bm{\epsilon}^{2}-1\big)\Delta t_{i}+O(\Delta t_{i}^{2}),
	\label{eq:exact_discretization}
	\begin{split}
	\mathbf{x}_{t_{i}}=&\mathbf{x}_{t_{i-1}}^{\text{EM}}+\mathbf{f}_{\bm{\phi}}(\mathbf{x}_{t_{i-1}}^{\text{EM}},t_{i-1})\Delta t_{i}+\mathbf{G}_{\bm{\phi}}(\mathbf{x}_{t_{i-1}}^{\text{EM}},t_{i-1})\bm{\epsilon}\sqrt{\Delta t_{i}}\\
	&+\frac{1}{2}\mathbf{G}_{\bm{\phi}}(\mathbf{x}_{t_{i-1}}^{\text{EM}},t_{i-1})\nabla_{\mathbf{x}_{t_{i-1}}^{\text{EM}}}\mathbf{G}_{\bm{\phi}}(\mathbf{x}_{t_{i-1}}^{\text{EM}},t_{i-1})\big(\bm{\epsilon}^{2}-1\big)\Delta t_{i}+O(\Delta t_{i}^{3/2})\\
	\approx&\mathbf{x}_{t_{i-1}}^{\text{EM}}+\mathbf{f}_{\bm{\phi}}(\mathbf{x}_{t_{i-1}}^{\text{EM}},t_{i-1})\Delta t_{i}+\mathbf{G}(\mathbf{x}_{t_{i-1}}^{\text{EM}},t_{i-1})\bm{\epsilon}\sqrt{\Delta t_{i}}\\
	&+\frac{1}{2}\mathbf{G}_{\bm{\phi}}(\mathbf{x}_{t_{i-1}}^{\text{EM}},t_{i-1})\nabla_{\mathbf{x}_{t_{i-1}}^{\text{EM}}}\mathbf{G}_{\bm{\phi}}(\mathbf{x}_{t_{i-1}}^{\text{EM}},t_{i-1})\big(\bm{\epsilon}^{2}-1\big)\Delta t_{i}\\
	:=&\mathbf{x}_{t_{i}}^{\text{EM}}.
	\end{split}
	
	\frac{1}{2}\text{Var}\Big(\sum X_{i}\Big)=\frac{1}{2}\Big[\sum\text{Var}(X_{i})+2\sum\text{Cov}(X_{i},X_{j})\Big],
	
	\text{Ratio}:=\frac{\text{Var}(\sum X_{i})}{\sum\text{Var}(X_{i})}=\frac{\sum\text{Var}(X_{i})+2\sum\text{Cov}(X_{i},X_{j})}{\sum\text{Var}(X_{i})}=1+2\frac{\sum\text{Cov}(X_{i},X_{j})}{\sum\text{Var}(X_{i})},
	
	\min_{\bm{\rho}\in\mathcal{P}(p_{r},\pi)}D_{KL}(\bm{\rho}\Vert\bm{\mu}),
	\label{eq:reference_SDE}
	\diff\mathbf{x}_{t}=\mathbf{f}(\mathbf{x}_{t},t)\diff t+g(t)\diff\mathbf{w}_{t}, \quad\mathbf{x}_{0}\sim p_{r}.
	
	\min_{\bm{\rho}\in\mathcal{P}(p_{r},\pi)}D_{KL}(\bm{\rho}\Vert\bm{\mu})=\min_{\bm{\rho}_{\mathbf{v}}\in\mathcal{P}(p_{r},\pi)}D_{KL}(\bm{\rho}_{\mathbf{v}}\Vert\bm{\mu}),
	\label{eq:forward_SDE_SBP}
	\diff\mathbf{x}_{t}=\big[\mathbf{f}(\mathbf{x}_{t},t)+g^{2}(t)\mathbf{v}(\mathbf{x}_{t},t)\big]\diff t+g(t)\mathbf{w}_{t}.
	
	D_{KL}(\bm{\rho}_{\mathbf{v}}\Vert\bm{\mu})=\frac{1}{2}\int_{0}^{T}g^{2}(t)\mathbb{E}_{\bm{\rho}_{\mathbf{v}}}[\Vert\mathbf{v}(\mathbf{x}_{t},t)\Vert_{2}^{2}]\diff t+D_{KL}(\pi\Vert p_{T}),
	\label{eq:SBP_equivalent}
	\min_{\bm{\nu}\in\mathcal{P}(p_{r},\pi)}D_{KL}(\bm{\nu}\Vert\bm{\mu})=\min_{\mathbf{v}\in\mathcal{V}(p_{r},\pi)}\frac{1}{2}\int_{0}^{T}g^{2}(t)\mathbb{E}_{\bm{\rho}_{\mathbf{v}}}[\Vert\mathbf{v}(\mathbf{x}_{t},t)\Vert_{2}^{2}]\diff t,
	
	\diff\mathbf{x}_{t}=\big[\mathbf{f}(\mathbf{x}_{t},t)+g^{2}(t)\nabla_{\mathbf{x}_{t}}\log{\Psi(\mathbf{x}_{t},t)}\big]\diff t+g(t)\diff\mathbf{w}_{t}, \quad\mathbf{x}_{0}\sim p_{r},
	
	\diff\mathbf{x}_{t}=\big[\mathbf{f}(\mathbf{x}_{t},t)-g^{2}(t)\nabla_{\mathbf{x}_{t}}\log{\hat{\Psi}(\mathbf{x}_{t},t)}\big]\diff \bar{t}+g(t)\diff\mathbf{\bar{w}}_{t}, \quad\mathbf{x}_{T}\sim \pi,
	\label{eq:hopf_cole_transform}
	\begin{split}
	\frac{\partial\Psi}{\partial t}=&-\nabla_{\mathbf{x}_{t}}\Psi^{T}\mathbf{f}-\frac{1}{2}\text{tr}(g^{2}\nabla_{\mathbf{x}_{t}}^{2}\Psi)\\
	\frac{\partial\hat{\Psi}}{\partial t}=&-\text{div}(\hat{\Psi}\mathbf{f})+\frac{1}{2}\text{tr}(g^{2}\nabla_{\mathbf{x}_{t}}^{2}\hat{\Psi}),
	\end{split}
	\label{eq:FBSDE}
	\left\{\begin{array}{l}
	\diff\mathbf{x}_{t}=\big[\mathbf{f}(\mathbf{x}_{t},t)+g(t)\mathbf{z}_{t}(\mathbf{x}_{t},t)\big]\diff t+g(t)\diff\mathbf{w}_{t}\0.5em]
	\diff\mathbf{\hat{y}}_{t}=\Big[\frac{1}{2}(\mathbf{\hat{z}}_{t}^{T}\mathbf{\hat{z}}_{t})(\mathbf{x}_{t},t)+\text{div}\big(g(t)\mathbf{\hat{z}}_{t}(\mathbf{x}_{t},t)-\mathbf{f}(\mathbf{x}_{t},t)\big)+(\mathbf{\hat{z}}_{t}^{T}\mathbf{z}_{t})(\mathbf{x}_{t},t)\Big]\diff t+\mathbf{\hat{z}}_{t}^{T}(\mathbf{x}_{t},t)\diff\mathbf{w}_{t},
	\end{array}\right.
	\label{eq:forward_SBP}
	\diff\mathbf{x}_{t}^{\bm{\phi}}=\big[\mathbf{f}(\mathbf{x}_{t}^{\bm{\phi}},t)+g^{2}(t)\mathbf{s}_{\bm{\phi}}(\mathbf{x}_{t}^{\bm{\phi}},t)\big]\diff t+g(t)\diff\mathbf{w}_{t}, \quad\mathbf{x}_{0}^{\bm{\phi}}\sim p_{r},
	
	\diff\mathbf{x}_{t}^{\bm{\theta}}=\big[\mathbf{f}(\mathbf{x}_{t}^{\bm{\theta}},t)-g^{2}(t)\mathbf{s}_{\bm{\theta}}(\mathbf{x}_{t}^{\bm{\theta}},t)\big]\diff \bar{t}+g^{2}(t)\mathbf{\bar{w}}_{t},\quad\mathbf{x}_{T}^{\bm{\theta}}\sim\pi,
	
	\bm{\nu}_{\bm{\phi}_{n}}=&\argmin_{\bm{\nu}_{\bm{\phi}}\in\mathcal{P}(p_{r},\cdot)}D_{KL}(\bm{\nu}_{\bm{\phi}}\Vert\bm{\nu}_{\bm{\theta}_{n-1}}),\label{eq:SBP1}\\
	\bm{\nu}_{\bm{\theta}_{n}}=&\argmin_{\bm{\nu}_{\bm{\theta}}\in\mathcal{P}(\cdot,\pi)}D_{KL}(\bm{\nu}_{\bm{\theta}}\Vert\bm{\nu}_{\bm{\phi}_{n}}),\label{eq:SBP2}
	
	\frac{\partial p_{t}^{\lambda}(\mathbf{x}_{t},t)}{\partial t}=&-\sum_{i=1}^{d}\frac{\partial}{\partial x_{i}}\left(\left[ f_{i}(\mathbf{x}_{t},t)-\frac{1+\lambda^{2}}{2}g^{2}(t)\big(\nabla_{\mathbf{x}_{t}}\log{p_{t}^{\lambda}(\mathbf{x}_{t},t)}\big)_{i} \right]p_{t}^{\lambda}(\mathbf{x}_{t},t)\right)\\
	&-\frac{\lambda^{2}g^{2}(t)}{2}\sum_{i=1}^{d}\frac{\partial^{2}}{\partial x_{i}^{2}}\big[p_{t}^{\lambda}(\mathbf{x}_{t},t)\big]\\
	=&-\sum_{i=1}^{d}\frac{\partial}{\partial x_{i}}\left( f_{i}(\mathbf{x}_{t},t)p_{t}^{\lambda}(\mathbf{x}_{t},t)-\frac{1+\lambda^{2}}{2}g^{2}(t)\frac{\partial p_{t}^{\lambda}(\mathbf{x}_{t},t)}{\partial x_{i}} \right)\\
	&-\frac{\lambda^{2}g^{2}(t)}{2}\sum_{i=1}^{d}\frac{\partial^{2}}{\partial x_{i}^{2}}\big[p_{t}^{\lambda}(\mathbf{x}_{t},t)\big]\\
	=&-\sum_{i=1}^{d}\frac{\partial}{\partial x_{i}}\big[f_{i}(\mathbf{x}_{t},t)p_{t}^{\lambda}(\mathbf{x}_{t},t)\big]+\frac{1}{2}g^{2}(t)\sum_{i=1}^{d}\frac{\partial^{2}}{\partial x_{i}^{2}}\big[p_{t}^{\lambda}(\mathbf{x}_{t},t)\big],
	
		\lefteqn{\log{p_{0}^{\lambda,\bm{\theta}}(\mathbf{x}_{0})}=\log{\int p_{0}^{\lambda,\bm{\theta}}(\mathbf{x}_{0},\mathbf{x}_{\epsilon}) \diff\mathbf{x}_{\epsilon}}}&\\
		&&\ge \int p_{0\epsilon}(\mathbf{x}_{\epsilon}\vert\mathbf{x}_{0})\log{\frac{p_{\epsilon}^{\lambda,\bm{\theta}}(\mathbf{x}_{\epsilon})p_{\epsilon 0}^{\bm{\theta}}(\mathbf{x}_{0}\vert\mathbf{x}_{\epsilon})}{p_{0\epsilon}(\mathbf{x}_{\epsilon}\vert\mathbf{x}_{0})}}\diff\mathbf{x}_{\epsilon}\\
		&&=\mathbb{E}_{p_{0\epsilon}(\mathbf{x}_{\epsilon}\vert\mathbf{x}_{0})}\big[\log{p_{\epsilon}^{\lambda,\bm{\theta}}(\mathbf{x}_{\epsilon})}\big]+\mathbb{E}_{p_{0\epsilon}(\mathbf{x}_{\epsilon}\vert\mathbf{x}_{0})}\bigg[\log{\frac{p_{\epsilon 0}^{\bm{\theta}}(\mathbf{x}_{0}\vert\mathbf{x}_{\epsilon})}{p_{0\epsilon}(\mathbf{x}_{\epsilon}\vert\mathbf{x}_{0})}}\bigg],
	
		\lefteqn{\mathbb{E}_{p_{r}(\mathbf{x}_{0})}[-\log{p_{0}^{\lambda,\bm{\theta}}(\mathbf{x}_{0})}]\le\mathbb{E}_{\mathbf{x}_{\epsilon}}\big[-\log{p_{\epsilon}^{\lambda,\bm{\theta}}(\mathbf{x}_{\epsilon})}\big]-\mathbb{E}_{\mathbf{x}_{0},\mathbf{x}_{\epsilon}}\bigg[\log{\frac{p_{\epsilon 0}^{\bm{\theta}}(\mathbf{x}_{0}\vert\mathbf{x}_{\epsilon})}{p_{0\epsilon}(\mathbf{x}_{\epsilon}\vert\mathbf{x}_{0})}}\bigg]}&\\
		&&=D_{KL}(p_{\epsilon}\Vert p_{\epsilon}^{\lambda,\bm{\theta}})-\mathbb{E}_{\mathbf{x}_{0},\mathbf{x}_{\epsilon}}\bigg[\log{\frac{p_{\epsilon 0}^{\bm{\theta}}(\mathbf{x}_{0}\vert\mathbf{x}_{\epsilon})}{p_{0\epsilon}(\mathbf{x}_{\epsilon}\vert\mathbf{x}_{0})}}\bigg]+\mathcal{H}(p_{\epsilon}),
	
		\lefteqn{D_{KL}(p_{r}\Vert p_{0}^{\lambda,\bm{\theta}})\le D_{KL}(p_{\epsilon}\Vert p_{\epsilon}^{\lambda,\bm{\theta}})-\mathbb{E}_{\mathbf{x}_{0},\mathbf{x}_{\epsilon}}\bigg[\log{\frac{p_{\epsilon 0}^{\bm{\theta}}(\mathbf{x}_{0}\vert\mathbf{x}_{\epsilon})}{p_{0\epsilon}(\mathbf{x}_{\epsilon}\vert\mathbf{x}_{0})}}\bigg]+\mathcal{H}(p_{\epsilon})-\mathcal{H}(p_{r})}&\\
		&&=D_{KL}(p_{\epsilon}\Vert p_{\epsilon}^{\lambda,\bm{\theta}})+D_{KL}\big(p_{r}(\mathbf{x}_{0})p_{0\epsilon}(\mathbf{x}_{\epsilon}\vert\mathbf{x}_{0})\Vert p_{\epsilon}(\mathbf{x}_{\epsilon})p_{\epsilon 0}^{\bm{\theta}}(\mathbf{x}_{0}\vert\mathbf{x}_{\epsilon})\big).
	
		\lefteqn{\mathbb{E}_{p_{r}(\mathbf{x}_{0})}\big[-\log{p_{0}^{\lambda,\bm{\theta}}(\mathbf{x}_{0})}\big]\le D_{KL}(p_{\epsilon}\Vert p_{\epsilon}^{\lambda,\bm{\theta}})-\mathbb{E}_{\mathbf{x}_{0},\mathbf{x}_{\epsilon}}\bigg[\log{\frac{p_{\epsilon 0}^{\bm{\theta}}(\mathbf{x}_{0}\vert\mathbf{x}_{\epsilon})}{p_{0\epsilon}(\mathbf{x}_{\epsilon}\vert\mathbf{x}_{0})}}\bigg]+\mathcal{H}(p_{\epsilon})}&\\
		&&\le D_{KL}(\bm{\mu}_{\epsilon}\Vert \bm{\nu}_{\bm{\theta},\epsilon}^{\lambda})-\mathbb{E}_{\mathbf{x}_{0},\mathbf{x}_{\epsilon}}\bigg[\log{\frac{p_{\epsilon 0}^{\bm{\theta}}(\mathbf{x}_{0}\vert\mathbf{x}_{\epsilon})}{p_{0\epsilon}(\mathbf{x}_{\epsilon}\vert\mathbf{x}_{0})}}\bigg]+\mathcal{H}(p_{\epsilon})\\
		&&=\frac{1}{2}\frac{(1+\lambda^{2})^{2}}{4\lambda^{2}}\int_{\epsilon}^{T}g^{2}(t)\mathbb{E}_{\mathbf{x}_{t}}\big[\Vert\mathbf{s}_{\bm{\theta}}(\mathbf{x}_{t},t)-\log{p_{t}(\mathbf{x}_{t})}\Vert_{2}^{2}\big]\diff t-\mathbb{E}_{\mathbf{x}_{T}}\big[\log{\pi(\mathbf{x}_{T})}\big]\\
		&&\quad-\mathbb{E}_{\mathbf{x}_{0},\mathbf{x}_{\epsilon}}\bigg[\log{\frac{p_{\epsilon 0}^{\bm{\theta}}(\mathbf{x}_{0}\vert\mathbf{x}_{\epsilon})}{p_{0\epsilon}(\mathbf{x}_{\epsilon}\vert\mathbf{x}_{0})}}\bigg]+\mathcal{H}(p_{\epsilon})-\mathcal{H}(p_{T})\\
		&&=\frac{1}{2}\int_{\epsilon}^{T}\mathbb{E}_{\mathbf{x}_{0},\mathbf{x}_{t}}\bigg[\frac{(1+\lambda^{2})^{2}}{4\lambda^{2}}g^{2}(t)\Vert\log{p_{0t}(\mathbf{x}_{t}\vert\mathbf{x}_{0})}-\mathbf{s}_{\bm{\theta}}(\mathbf{x}_{t},t)\Vert_{2}^{2}-g^{2}(t)\Vert\nabla_{\mathbf{x}_{t}}\log{p_{0t}(\mathbf{x}_{t}\vert\mathbf{x}_{0})}\Vert_{2}^{2}\\
		&&\quad\quad\quad\quad\quad\quad\quad-2\nabla_{\mathbf{x}_{t}}\cdot \mathbf{f}(\mathbf{x}_{t},t)\bigg]\diff t-\mathbb{E}_{\mathbf{x}_{T}}\big[\log{\pi(\mathbf{x}_{T})}\big]-\mathbb{E}_{\mathbf{x}_{0},\mathbf{x}_{\epsilon}}\bigg[\log{\frac{p_{\epsilon 0}^{\bm{\theta}}(\mathbf{x}_{0}\vert\mathbf{x}_{\epsilon})}{p_{0\epsilon}(\mathbf{x}_{\epsilon}\vert\mathbf{x}_{0})}}\bigg],
	\label{eq:feynman-kac_formula}
	p_{\bm{\theta},\epsilon}^{\lambda}(\mathbf{x}_{\epsilon})=\mathbb{E}_{\{\mathbf{x}_{t}\}_{t>\epsilon}\vert\mathbf{x}_{\epsilon}}\bigg[\pi(\mathbf{x}_{T})\exp{\bigg(-\int_{\epsilon}^{T} \text{tr}\Big( \nabla_{\mathbf{x}_{t}}\Big[\mathbf{f}(\mathbf{x}_{t},t) - \frac{1+\lambda^{2}}{2}g^{2}(t)\mathbf{s}_{\bm{\theta}}(\mathbf{x}_{t},t)\Big] \Big) \diff t\bigg)}\bigg].
	
	\diff\mathbf{x}_{t}=\bigg[\mathbf{f}(\mathbf{x}_{t},t)-\frac{1}{2}g^{2}(t)\mathbf{s}_{\bm{\theta}}(\mathbf{x}_{t},t)\bigg]\diff \bar{t},
	\label{eq:generative_ode_forward}
	\diff\mathbf{x}_{t}=\bigg[\mathbf{f}(\mathbf{x}_{t},t)-\frac{1}{2}g^{2}(t)\mathbf{s}_{\bm{\theta}}(\mathbf{x}_{t},t)\bigg]\diff t.
	\label{eq:instantaneous_change_of_variable_ode}
	\frac{\diff \log{p_{t}^{0,\bm{\theta}}(\mathbf{y}_{t})}}{\diff t}=-\text{tr}\bigg(\nabla_{\mathbf{y}_{t}}\Big[\mathbf{f}(\mathbf{y}_{t},t)-\frac{1}{2}g^{2}(t)\mathbf{s}_{\bm{\theta}}(\mathbf{y}_{t},t)\Big]\bigg).
	
	\frac{\diff \log{p_{t}^{0,\bm{\theta}}(\mathbf{y}_{t})}}{\diff t}=-\text{tr}\bigg(\nabla_{\mathbf{y}_{t}}\Big[\mathbf{f}(\mathbf{y}_{t},t)-\frac{1}{2}g^{2}(t)\mathbf{s}_{\bm{\theta}}(\mathbf{y}_{t},t)\Big]\bigg),
	\label{eq:modified_ode}
	\frac{\diff \log{p_{t}^{0,\bm{\theta}}}}{\diff t}=-\text{tr}\bigg(\nabla_{\mathbf{y}_{t}}\Big[\mathbf{f}(\mathbf{y}_{t},t)-\frac{1}{2}g^{2}(t)\mathbf{s}_{\bm{\theta}}(\mathbf{y}_{t},t)\Big]\bigg),
	
	\mathbb{E}_{\mathbf{x}_{\epsilon}}\big[-\log{p_{\epsilon}^{0,\bm{\theta}}(\mathbf{x}_{\epsilon})}\big]-\mathbb{E}_{\mathbf{x}_{0},\mathbf{x}_{\epsilon}}\bigg[\log{\frac{p_{\epsilon 0}^{\bm{\theta}}(\mathbf{x}_{0}\vert\mathbf{x}_{\epsilon})}{p_{0\epsilon}(\mathbf{x}_{\epsilon}\vert\mathbf{x}_{0})}}\bigg],
	
	\mu(\epsilon)=e^{-\frac{1}{2}\int_{0}^{\epsilon}\beta(s)\diff s}\text{ and }\sigma^{2}(\epsilon)=\Big(\frac{g^{2}(t)}{\beta(t)}-\frac{g^{2}(0)}{\beta(0)}+1-e^{-\int_{0}^{t}\beta(s)\diff s}\Big),
	
		\lefteqn{\mathbb{E}_{p_{0\epsilon}(\mathbf{x}_{\epsilon}\vert\mathbf{x}_{0})}\bigg[\log{\frac{p_{\epsilon 0}^{\bm{\theta}}(\mathbf{x}_{0}\vert\mathbf{x}_{\epsilon})}{p_{0\epsilon}(\mathbf{x}_{\epsilon}\vert\mathbf{x}_{0})}}\bigg]}&\\
		&&=\log{\mu(\epsilon)}-\frac{1}{2\sigma_{\bm{\theta},\epsilon 0}^{2}(\epsilon)}\mathbb{E}_{p_{0\epsilon}(\mathbf{x}_{\epsilon}\vert\mathbf{x}_{0})}\bigg[\Big\Vert\mathbf{x}_{0}-\frac{1}{\mu(\epsilon)}\Big(\mathbf{x}_{t}+\sigma^{2}(\epsilon)\mathbf{s}_{\bm{\theta}}(\mathbf{x}_{\epsilon},\epsilon)\Big)\Big\Vert_{2}^{2}\bigg]+\frac{1}{2}.
	
		\lefteqn{p(\mathbf{x}_{0},\mathbf{x}_{\epsilon})=p(\mathbf{x}_{0})p_{0\epsilon}(\mathbf{x}_{\epsilon}\vert\mathbf{x}_{0})}&\\
		&&\propto\exp{\left( -\frac{\Vert\mathbf{x}_{0}\Vert_{2}^{2}}{2\sigma^{2}} - \frac{\Vert\mathbf{x}_{\epsilon}-\mu(\epsilon)\mathbf{x}_{0}\Vert_{2}^{2}}{2\sigma^{2}(\epsilon)} \right)}\\
		&&=\exp{\left( -\frac{1}{2}\left( \frac{1}{\sigma^{2}}+\frac{\mu^{2}(\epsilon)}{\sigma^{2}(\epsilon)} \right) \left\Vert\mathbf{x}_{0}-\frac{\mu(\epsilon)\sigma^{2}}{\sigma^{2}(\epsilon)+\mu^{2}(\epsilon)\sigma^{2}}\mathbf{x}_{\epsilon}\right\Vert_{2}^{2}+O(\Vert\mathbf{x}_{\epsilon}\Vert_{2}^{2}) \right)}.
	
	\mathcal{L}\big(\{\mathbf{z}_{t}\}_{t=0}^{T},g^{2};\bm{\theta}\big)=\frac{1}{2}\int_{0}^{T}g^{2}(t)\mathbb{E}_{\mathbf{z}_{0},\mathbf{z}_{t}}\big[\Vert\mathbf{s}_{\bm{\theta}}(\mathbf{z}_{t},t)\big]\diff t,
	\label{eq:inverse_cdf}
	\begin{split}
	&t=F^{-1}(u)\\
	\iff &u=F(t)=\frac{1}{Z}\int_{\epsilon}^{t}\frac{g^{2}(s)}{\sigma^{2}(s)}\diff s=\frac{1}{Z}\big(\mathcal{F}(t)-\mathcal{F}(\epsilon)\big),
	\end{split}
	
	Z=&\int_{\epsilon}^{T}\frac{g^{2}(t)}{\sigma^{2}(t)}\diff t\\
	=&\Big[\log{(1-e^{-0.5 t^{2}(\beta_{max}-\beta_{min})-t\beta_{min}})}+0.5t^{2}(\beta_{max}-\beta_{min})+t\beta_{min}\Big]_{\epsilon}^{T}\\
	=&\log{(1-e^{-0.5T^{2}(\beta_{max}-\beta_{min})-T\beta_{min}})}-\log{(1-e^{-0.5\epsilon^{2}(\beta_{max}-\beta_{min})-\epsilon\beta_{min}})}\\
	&+0.5(T^{2}-\epsilon^{2})(\beta_{max}-\beta_{min})+(T-\epsilon)\beta_{min}\\
	\approx&23.86
	
	&e^{\int_{0}^{t}\beta(s)\diff s}=1+\exp{(Zu+\mathcal{F}(\epsilon))}\\
	&\iff \int_{0}^{t}\beta(s)\diff s=\frac{1}{2}(\beta_{max}-\beta_{min})t^{2}+\beta_{min}t=\log{(1+\exp{(Zu+\mathcal{F}(\epsilon))})}\\
	&\iff t=\frac{-\beta_{min}+\sqrt{\beta_{min}^{2}+2(\beta_{max}-\beta_{min})\log{\big(1+\exp{(Zu+\mathcal{F}(\epsilon))}\big)}}}{\beta_{max}-\beta_{min}}.
	
	&\int_{0}^{t}\beta(s)\diff s=\log{\bigg(\frac{1-\sigma_{min}^{2}}{1-\sigma_{min}^{2}\big(\frac{\sigma_{max}}{\sigma_{min}}\big)^{t}}\bigg)}=\log{\big(1+\exp{(Zu+\mathcal{F}(\epsilon))}\big)}\\
	&\iff 1-\sigma_{min}^{2}\Big( \frac{\sigma_{max}}{\sigma_{min}} \Big)^{t}=\frac{1-\sigma_{min}^{2}}{1+e^{Zu+\mathcal{F}(\epsilon)}}\\
	&\iff \sigma_{min}^{2}\Big(\frac{\sigma_{max}^{2}}{\sigma_{min}^{2}}\Big)^{t}=\frac{e^{Zu+\mathcal{F}(\epsilon)}+\sigma_{min}^{2}}{1+e^{Zu+\mathcal{F}(\epsilon)}}\\
	&\iff t\log{\frac{\sigma_{max}^{2}}{\sigma_{min}^{2}}}=\log{\Big( e^{Zu+\mathcal{F}(\epsilon)}+\sigma_{min}^{2} \Big)}-\log{\Big(1+e^{Zu+\mathcal{F}(\epsilon)}\Big)}-\log{\sigma_{min}^{2}}.
	\label{eq:vesde_variance}
	\sigma^{2}(t)=\int_{t_{0}}^{t}g^{2}(s)\diff s=\sigma_{min}^{2}\Big(\frac{\sigma_{max}^{2}}{\sigma_{min}^{2}}\Big)^{2t}
	\label{eq:Euler-Maruyama_discretization}
	\mathbf{z}_{t_{i}}\leftarrow\mathbf{z}_{t_{i+1}}+g^{2}(t_{i+1})(t_{i}-t_{i+1})\mathbf{s}_{\bm{\theta}}(\mathbf{z}_{t_{i+1}},t_{i+1})+\sqrt{\sigma(t_{i+1})^{2}-\sigma(t_{i})^{2}}\bm{\epsilon},
	\label{eq:reverse_diffusion_discretization}
	\mathbf{z}_{\sigma^{-1}(\sigma_{i})}\leftarrow\mathbf{z}_{\sigma^{-1}(\sigma_{i+1})}+(\sigma_{i+1}^{2}-\sigma_{i}^{2})\mathbf{s}_{\bm{\theta}}(\mathbf{z}_{\sigma^{-1}(\sigma_{i+1})},\sigma_{i+1})+\sqrt{\sigma_{i+1}^{2}-\sigma_{i}^{2}}\bm{\epsilon},
	\mathbf{z}_{-\infty}\leftarrow\mathbf{z}_{\epsilon}+\sigma_{min}^{2}\mathbf{s}_{\bm{\theta}}(\mathbf{z}_{\epsilon},\sigma_{min})+\sigma_{min}\bm{\epsilon},
	\mathbf{z}_{\epsilon-\delta}=\mathbf{z}_{\epsilon}+\frac{1}{2}\Big(\sigma^{2}(\epsilon)-\sigma^{2}(\epsilon-\delta)\Big)\mathbf{s}_{\bm{\theta}}(\mathbf{z}_{\epsilon},\sigma_{min}),
	
		\mathbb{E}_{p_{r}(\mathbf{x}_{0})}\big[-\log{p_{\bm{\phi},\bm{\theta}}(\mathbf{x}_{0})}\big]\le\mathcal{L}\big(\{\mathbf{x}_{t}\}_{t=0}^{T},g^{2};\{\bm{\phi},\bm{\theta}\}\big),
		
		\begin{split}
		&\mathcal{L}\big(\{\mathbf{x}_{t}\}_{t=0}^{T},g^{2};\{\bm{\phi},\bm{\theta}\}\big)=-\mathbb{E}_{p_{r}(\mathbf{x}_{0})}\big[\log{\big\vert\det\big(\nabla_{\mathbf{x}_{0}}\mathbf{h}_{\bm{\phi}}\big)\big\vert}\big]\\
		&\quad\quad\quad\quad\quad+\mathcal{L}\big(\{\mathbf{z}_{t}\}_{t=0}^{T},g^{2};\bm{\theta}\big)-\mathbb{E}_{\mathbf{z}_{T}}\big[\log{\pi(\mathbf{z}_{T})}\big]+\frac{d}{2}\int_{0}^{T}\beta(t)-\frac{g^{2}(t)}{\sigma^{2}(t)}\diff t,
		\end{split}
		
		p_{r}(\mathbf{x}_{0})=\frac{p_{0}(\mathbf{z}_{0})}{\Big\vert\det\Big(\frac{\partial\mathbf{h}_{\bm{\phi}}}{\partial\mathbf{x}_{0}}\Big)\Big\vert^{-1}},
		
			\lefteqn{\mathcal{H}(p_{r})=-\int p_{r}(\mathbf{x}_{0})\log{p_{r}(\mathbf{x}_{0})}\diff\mathbf{x}_{0}}\\
			&&=-\int p_{0}(\mathbf{z}_{0})\log{\frac{p_{0}(\mathbf{z}_{0})}{\Big\vert\det\Big(\frac{\partial\mathbf{h}_{\bm{\phi}}}{\partial\mathbf{x}_{0}}\Big)\Big\vert^{-1}}}\diff\mathbf{z}_{0}\\
			&&=-\int p_{r}(\mathbf{x}_{0})\log{\Big\vert\det\Big(\frac{\partial\mathbf{h}_{\bm{\phi}}}{\partial\mathbf{x}_{0}}\Big)\Big\vert}\diff\mathbf{x}_{0}-\int p_{0}(\mathbf{z}_{0})\log{p_{0}(\mathbf{z}_{0})}\diff\mathbf{z}_{0}\\
			&&=-\mathbb{E}_{p_{r}(\mathbf{x}_{0})}\Big[\log{\Big\vert\det\Big(\frac{\partial\mathbf{h}_{\bm{\phi}}}{\partial\mathbf{x}_{0}}\Big)\Big\vert}\Big]-\int p_{0}(\mathbf{z}_{0})\log{p_{0}(\mathbf{z}_{0})}\diff\mathbf{z}_{0}\\
			&&=-\mathbb{E}_{p_{r}(\mathbf{x}_{0})}\Big[\log{\Big\vert\det\Big(\frac{\partial\mathbf{h}_{\bm{\phi}}}{\partial\mathbf{x}_{0}}\Big)\Big\vert}\Big]+\mathcal{H}(p_{0}).
		
		\mathcal{H}(p_{0})=\mathcal{H}(p_{T})-\frac{1}{2}\int_{0}^{T}\mathbb{E}_{p_{t}(\mathbf{z}_{t})}\big[2\nabla_{\mathbf{z}_{t}}\cdot\mathbf{f}(\mathbf{z}_{t},t)+g^{2}(t)\Vert\nabla_{\mathbf{z}_{t}}\log{p_{t}(\mathbf{z}_{t})}\Vert_{2}^{2}\big]\diff t,
		
			\lefteqn{-\mathbb{E}_{p_{r}(\mathbf{x}_{0})}\big[\log{p_{\bm{\phi},\bm{\theta}}(\mathbf{x}_{0})}\big]=D_{KL}(p_{r}\Vert p_{\bm{\phi},\bm{\theta}})+\mathcal{H}(p_{r})}\\
			&&\le D_{KL}(\bm{\mu}_{\bm{\phi}}(\{\mathbf{x}_{t}\})\Vert\bm{\nu}_{\bm{\phi},\bm{\theta}}(\{\mathbf{x}_{t}\}))+\mathcal{H}(p_{r})\\
			&&= D_{KL}(\bm{\mu}_{\bm{\phi}}(\{\mathbf{x}_{t}\})\Vert\bm{\nu}_{\bm{\phi},\bm{\theta}}(\{\mathbf{x}_{t}\}))-\mathbb{E}_{p_{r}(\mathbf{x}_{0})}\Big[\log{\Big\vert\det\Big(\frac{\partial\mathbf{h}_{\bm{\phi}}}{\partial\mathbf{x}_{0}}\Big)\Big\vert}\Big]+\mathcal{H}(p_{0})\\
			&&= D_{KL}(\bm{\mu}_{\bm{\phi}}(\{\mathbf{z}_{t}\})\Vert\bm{\nu}_{\bm{\theta}}(\{\mathbf{z}_{t}\}))-\mathbb{E}_{p_{r}(\mathbf{x}_{0})}\Big[\log{\Big\vert\det\Big(\frac{\partial\mathbf{h}_{\bm{\phi}}}{\partial\mathbf{x}_{0}}\Big)\Big\vert}\Big]+\mathcal{H}(p_{T})\\
			&&\quad-\frac{1}{2}\int_{0}^{T}\mathbb{E}_{\mathbf{z}_{t}^{\bm{\phi}}}\big[-d\beta(t)+g^{2}(t)\Vert\nabla_{\mathbf{z}_{t}}\log{p_{t}(\mathbf{z}_{t})}\Vert_{2}^{2}\big]\diff t.
		\label{eq:nelbo}
		D_{KL}(\bm{\mu}_{\bm{\phi}}(\{\mathbf{z}_{t}\})\Vert\bm{\nu}_{\bm{\theta}}(\{\mathbf{z}_{t}\}))&=D_{KL}(p_{T}(\mathbf{z}_{T})\Vert\pi(\mathbf{z}_{T}))\\
		&\quad+\frac{1}{2}\int_{0}^{T}g^{2}(t)\mathbb{E}_{p_{t}(\mathbf{z}_{t})}\big[\Vert\mathbf{s}_{\bm{\theta}}(\mathbf{z}_{t},t)-\nabla_{\mathbf{z}_{t}}\log{p_{t}(\mathbf{z}_{t})}\Vert_{2}^{2}\big]\diff t,
		
			\lefteqn{-\mathbb{E}_{p_{r}(\mathbf{x}_{0})}\big[\log{p_{\bm{\phi},\bm{\theta}}(\mathbf{x}_{0})}\big]}\\
			&&\le -\mathbb{E}_{p_{r}(\mathbf{x}_{0})}\Big[\log{\Big\vert\det\Big(\frac{\partial\mathbf{h}_{\bm{\phi}}}{\partial\mathbf{x}_{0}}\Big)\Big\vert}\Big] + \frac{1}{2}\int_{0}^{T}g^{2}(t)\mathbb{E}_{\mathbf{z}_{t}}\big[\Vert\mathbf{s}_{\bm{\theta}}(\mathbf{z}_{t},t)-\nabla_{\mathbf{z}_{t}}\log{p_{t}(\mathbf{z}_{t})}\Vert_{2}^{2}\big]\diff t\\
			&&\quad +D_{KL}(p_{T}\Vert\pi) +\mathcal{H}(p_{T})-\frac{1}{2}\int_{0}^{T}\mathbb{E}_{\mathbf{z}_{t}}\big[-d\beta(t)+g^{2}(t)\Vert\nabla_{\mathbf{z}_{t}}\log{p_{t}(\mathbf{z}_{t})}\Vert_{2}^{2}\big]\diff t\\
			&&= -\mathbb{E}_{p_{r}(\mathbf{x}_{0})}\Big[\log{\Big\vert\det\Big(\frac{\partial\mathbf{h}_{\bm{\phi}}}{\partial\mathbf{x}_{0}}\Big)\Big\vert}\Big] -\mathbb{E}_{\mathbf{z}_{T}}\big[\log{\pi(\mathbf{z}_{T})}\big] +\frac{d}{2}\int_{0}^{T}\beta(t)\diff t\\
			&&\quad+\frac{1}{2}\int_{0}^{T}g^{2}(t)\mathbb{E}_{\mathbf{z}_{t}}\big[\Vert\mathbf{s}_{\bm{\theta}}(\mathbf{z}_{t},t)-\nabla_{\mathbf{z}_{t}}\log{p_{t}(\mathbf{z}_{t})}\Vert_{2}^{2}-\Vert\nabla_{\mathbf{z}_{t}}\log{p_{t}(\mathbf{z}_{t})}\Vert_{2}^{2} \big]\diff t
		
			\lefteqn{\mathbb{E}_{\mathbf{z}_{t}}\big[\mathbf{s}_{\bm{\theta}}(\mathbf{z}_{t},t)\cdot\nabla_{\mathbf{z}_{t}}\log{p_{t}(\mathbf{z}_{t})}\big]=\int p_{t}(\mathbf{z}_{t})\mathbf{s}_{\bm{\theta}}(\mathbf{z}_{t},t)\cdot\nabla_{\mathbf{z}_{t}}\log{p_{t}(\mathbf{z}_{t})}\diff\mathbf{z}_{t}}\\
			&&=\int \mathbf{s}_{\bm{\theta}}(\mathbf{z}_{t},t)\cdot\nabla_{\mathbf{z}_{t}}p_{t}(\mathbf{z}_{t})\diff\mathbf{z}_{t}\\
			&&=\int \mathbf{s}_{\bm{\theta}}(\mathbf{z}_{t},t)\cdot \int p_{0}(\mathbf{z}_{0})\nabla_{\mathbf{z}_{t}}p_{0t}(\mathbf{z}_{t}\vert\mathbf{z}_{0})\diff\mathbf{z}_{0}\diff\mathbf{z}_{t}\\
			&&=\mathbb{E}_{\mathbf{z}_{0}}\mathbb{E}_{\mathbf{z}_{t}\vert\mathbf{z}_{0}}\big[\mathbf{s}_{\bm{\theta}}(\mathbf{z}_{t},t)\cdot\nabla_{\mathbf{z}_{t}}\log{p_{0t}(\mathbf{z}_{t}\vert\mathbf{z}_{0})}\big]
		
			\lefteqn{\frac{1}{2}\int_{0}^{T}g^{2}(t)\mathbb{E}_{\mathbf{z}_{t}}\big[\Vert\mathbf{s}_{\bm{\theta}}(\mathbf{z}_{t},t)-\nabla_{\mathbf{z}_{t}}\log{p_{t}(\mathbf{z}_{t})}\Vert_{2}^{2}-\Vert\nabla_{\mathbf{z}_{t}}\log{p_{t}(\mathbf{z}_{t})}\Vert_{2}^{2}\big]}\\
			&&=\int_{0}^{T}g^{2}(t)\mathbb{E}_{\mathbf{z}_{t}}\Big[\frac{1}{2}\Vert\mathbf{s}_{\bm{\theta}}(\mathbf{z}_{t},t)\Vert_{2}^{2}-\mathbf{s}_{\bm{\theta}}(\mathbf{z}_{t},t)\cdot\nabla_{\mathbf{z}_{t}}\log{p_{t}(\mathbf{z}_{t})}\Big]\\
			&&=\int_{0}^{T}g^{2}(t)\mathbb{E}_{\mathbf{z}_{0}}\mathbb{E}_{\mathbf{z}_{t}\vert\mathbf{z}_{0}}\Big[\frac{1}{2}\Vert\mathbf{s}_{\bm{\theta}}(\mathbf{z}_{t},t)\Vert_{2}^{2}-\mathbf{s}_{\bm{\theta}}(\mathbf{z}_{t},t)\cdot\nabla_{\mathbf{z}_{t}}\log{p_{0t}(\mathbf{z}_{t}\vert\mathbf{z}_{0})}\Big]\\
			&&=\frac{1}{2}\int_{0}^{T}g^{2}(t)\mathbb{E}_{\mathbf{z}_{0}}\mathbb{E}_{\mathbf{z}_{t}\vert\mathbf{z}_{0}}\Big[\Vert\mathbf{s}_{\bm{\theta}}(\mathbf{z}_{t},t)-\nabla_{\mathbf{z}_{t}}\log{p_{0t}(\mathbf{z}_{t}\vert\mathbf{z}_{0})}\Vert_{2}^{2}-\Vert\nabla_{\mathbf{z}_{t}}\log{p_{0t}(\mathbf{z}_{t}\vert\mathbf{z}_{0})}\Vert_{2}^{2}\Big].
		
		\mathbb{E}_{\mathbf{z}_{t}\vert\mathbf{z}_{0}}\big[\Vert\nabla_{\mathbf{z}_{t}}\log{p_{0t}(\mathbf{z}_{t}\vert\mathbf{z}_{0})}\Vert_{2}^{2}\big]=\mathbb{E}_{\mathbf{z}_{t}\vert\mathbf{z}_{0}}\Big[\Big\Vert\frac{\mathbf{z}_{t}-\mu(t)\mathbf{z}_{0}}{\sigma^{2}(t)}\Big\Vert_{2}^{2}\Big]=\mathbb{E}_{\mathcal{N}(\mathbf{z};0,\mathbf{I})}\Big[\frac{\Vert\mathbf{z}\Vert_{2}^{2}}{\sigma^{2}(t)}\Big]=\frac{d}{\sigma^{2}(t)},
		
		\textup{Gap}\big(\bm{\mu}_{\bm{\phi}}(\{\mathbf{x}_{t}\}),\bm{\nu}_{\bm{\phi},\bm{\theta}}(\{\mathbf{x}_{t}\})\big):=&D_{KL}\big(\bm{\mu}_{\bm{\phi}}(\{\mathbf{x}_{t}\})\Vert\bm{\nu}_{\bm{\phi},\bm{\theta}}(\{\mathbf{x}_{t}\})\big)-D_{KL}\big(p_{0}^{\bm{\phi}}(\mathbf{x}_{0})\Vert q_{0}^{\bm{\theta}}(\mathbf{x}_{0})\big)\\
		=&\frac{1}{2}\int_{0}^{T}g^{2}(t)\mathbb{E}_{p_{t}^{\bm{\phi}}(\mathbf{z}_{t})}\big[\underbrace{\Vert\nabla\log{q_{t}^{\bm{\theta}}(\mathbf{z}_{t})}-\mathbf{s}_{\bm{\theta}}(\mathbf{z}_{t},t)\Vert_{2}^{2}}_{\text{Score-only error}}\big]\diff t.
		\label{eq:generative_latent_sde}
		\diff\mathbf{z}_{t}=\left[ \mathbf{f}(\mathbf{z}_{t},t)-g^{2}(t)\mathbf{s}_{\bm{\theta}}(\mathbf{z}_{t},t) \right]\diff \bar{t}+g(t)\diff\mathbf{\bar{w}}_{t}.
		
		\frac{\partial q_{t}^{\bm{\theta}}}{\partial t}(\mathbf{z}_{t})=&-\sum_{i=1}^{d}\frac{\partial}{\partial z_{i}}\left(\left[ f_{i}(\mathbf{z}_{t},t)-g^{2}(t)\big(\mathbf{s}_{\bm{\theta}}(\mathbf{z}_{t},t)\big)_{i} \right]q_{t}^{\bm{\theta}}(\mathbf{z}_{t})\right)-\frac{g^{2}(t)}{2}\sum_{i=1}^{d}\frac{\partial^{2}}{\partial z_{i}^{2}}\big[q_{t}^{\bm{\theta}}(\mathbf{z}_{t})\big]\\
		=&\text{div}\left(\Big(-\mathbf{f}(\mathbf{z}_{t},t)+g^{2}(t)\mathbf{s}_{\bm{\theta}}(\mathbf{z}_{t},t)-\frac{g^{2}(t)}{2}\nabla \log{q_{t}^{\bm{\theta}}(\mathbf{z}_{t})}\Big)q_{t}^{\bm{\theta}}(\mathbf{z}_{t})\right)\numberthis\label{eq:generative_ode}.
		
		\diff\mathbf{z}_{t}=\mathbf{f}(\mathbf{z}_{t},t)\diff t+g(t)\diff\mathbf{w}_{t},
		\label{eq:reverse_ode}
		\frac{\partial p_{t}^{\bm{\phi}}}{\partial t}(\mathbf{z}_{t})=\text{div}\left( \Big(-\mathbf{f}(\mathbf{z}_{t},t)+\frac{g^{2}(t)}{2}\nabla \log{p_{t}^{\bm{\phi}}(\mathbf{z}_{t},t)}\Big)p_{t}^{\bm{\phi}}(\mathbf{z}_{t}) \right).
		
			\lefteqn{\frac{\partial D_{KL}(p_{t}^{\bm{\phi}}\Vert q_{t}^{\bm{\theta}})}{\partial t}=\frac{\partial}{\partial t}\int p_{t}^{\bm{\phi}}(\mathbf{z}_{t})\log{\frac{p_{t}^{\bm{\phi}}(\mathbf{z}_{t})}{q_{t}^{\bm{\theta}}(\mathbf{z}_{t})}}\diff \mathbf{z}_{t}}&\\
			&&=\int \frac{\partial p_{t}^{\bm{\phi}}}{\partial t}(\mathbf{z}_{t})\log{\frac{p_{t}^{\bm{\phi}}(\mathbf{z}_{t})}{q_{t}^{\bm{\theta}}(\mathbf{z}_{t})}}\diff \mathbf{z}_{t}-\int \frac{\partial q_{t}^{\bm{\theta}}}{\partial t}(\mathbf{z}_{t})\frac{p_{t}^{\bm{\phi}}(\mathbf{z}_{t})}{q_{t}^{\bm{\theta}}(\mathbf{z}_{t})}\diff\mathbf{z}_{t}\\
			&&=-\int p_{t}^{\bm{\phi}}(\mathbf{z}_{t})\left(-\mathbf{f}(\mathbf{z}_{t},t)+\frac{g^{2}(t)}{2}\nabla \log{p_{t}^{\bm{\phi}}(\mathbf{z}_{t})}\right)^{T}\nabla\log{\frac{p_{t}^{\bm{\phi}}(\mathbf{z}_{t})}{q_{t}^{\bm{\theta}}(\mathbf{z}_{t})}}\diff\mathbf{z}_{t}\\
			&&\quad+\int p_{t}^{\bm{\phi}}(\mathbf{z}_{t})\left(-\mathbf{f}(\mathbf{z}_{t},t)+g^{2}(t)\mathbf{s}_{\bm{\theta}}(\mathbf{z}_{t},t)-\frac{g^{2}(t)}{2}\nabla \log{q_{t}^{\bm{\theta}}(\mathbf{z}_{t})}\right)^{T}\nabla\log{\frac{p_{t}^{\bm{\phi}}(\mathbf{z}_{t})}{q_{t}^{\bm{\theta}}(\mathbf{z}_{t})}}\diff\mathbf{z}_{t}\\
			&&=\frac{g^{2}(t)}{2}\int p_{t}^{\bm{\phi}}(\mathbf{z}_{t})\left(\nabla\log{\frac{p_{t}^{\bm{\phi}}(\mathbf{z}_{t})}{q_{t}^{\bm{\theta}}(\mathbf{z}_{t})}}\right)^{T}\left(2\mathbf{s}_{\bm{\theta}}(\mathbf{z}_{t},t)-\nabla\log{p_{t}^{\bm{\phi}}(\mathbf{z}_{t})}-\nabla\log{q_{t}^{\bm{\theta}}(\mathbf{z}_{t})}\right)\diff\mathbf{z}_{t}.
		
		&D_{KL}\big(p_{0}^{\bm{\phi}}(\mathbf{z}_{0})\Vert q_{0}^{\bm{\theta}}(\mathbf{z}_{0})\big)=-\int_{0}^{T} \frac{\partial D_{KL}(p_{t}^{\bm{\phi}}\Vert q_{t}^{\bm{\theta}})}{\partial t}\diff t+D_{KL}(p_{T}^{\bm{\phi}}\Vert q_{T}^{\bm{\theta}})\label{eq:indm_kl}\\
		&=\int_{0}^{T}\frac{g^{2}(t)}{2}\mathbb{E}_{\mathbf{z}_{t}^{\bm{\phi}}}\left[ (\nabla\log{p_{t}^{\bm{\phi}}}-\nabla\log{q_{t}^{\bm{\theta}}})^{T}(\nabla\log{p_{t}^{\bm{\phi}}}+\nabla\log{q_{t}^{\bm{\theta}}}-2\mathbf{s}_{\bm{\theta}}) \right]\diff t+D_{KL}(p_{T}^{\bm{\phi}}\Vert q_{T}^{\bm{\theta}}).\nonumber
		
		\begin{split}\label{eq:indm_nelbo}
		\lefteqn{D_{KL}\big(\bm{\mu}_{\bm{\phi}}(\{\mathbf{x}_{t}\})\Vert\bm{\nu}_{\bm{\phi},\bm{\theta}}(\{\mathbf{x}_{t}\})\big)=D_{KL}\big(\bm{\mu}_{\bm{\phi}}(\{\mathbf{z}_{t}\})\Vert\bm{\nu}_{\bm{\theta}}(\{\mathbf{z}_{t}\})\big)}&\\
		&&=\int_{0}^{T}\frac{g^{2}(t)}{2}\mathbb{E}_{p_{t}^{\bm{\phi}}(\mathbf{z}_{t})}\big[\Vert\nabla\log{p_{t}^{\bm{\phi}}(\mathbf{z}_{t})}-\mathbf{s}_{\bm{\theta}}(\mathbf{z}_{t},t)\Vert_{2}^{2}\big]\diff t+D_{KL}(p_{T}^{\bm{\phi}}\Vert q_{T}^{\bm{\theta}}).
		\end{split}
		
		&\text{Gap}(\bm{\mu}_{\bm{\phi}},\bm{\nu}_{\bm{\phi},\bm{\theta}})=D_{KL}\big(\bm{\mu}_{\bm{\phi}}(\{\mathbf{x}_{t}\})\Vert\bm{\nu}_{\bm{\phi},\bm{\theta}}(\{\mathbf{x}_{t}\})\big)-D_{KL}\big(p_{r}(\mathbf{x}_{0})\Vert p_{\bm{\phi},\bm{\theta}}(\mathbf{x}_{0})\big)\\
		&=D_{KL}\big(\bm{\mu}_{\bm{\phi}}(\{\mathbf{z}_{t}\})\Vert\bm{\nu}_{\bm{\theta}}(\{\mathbf{z}_{t}\})\big)-D_{KL}\big(p_{0}^{\bm{\phi}}(\mathbf{z}_{0})\Vert q_{0}^{\bm{\theta}}(\mathbf{z}_{0})\big)\\	
		&=\int\frac{g^{2}(t)}{2}\mathbb{E}_{\mathbf{z}_{t}^{\bm{\phi}}}\bigg[\Vert\nabla\log{p_{t}^{\bm{\phi}}}-\mathbf{s}_{\bm{\theta}}\Vert_{2}^{2}-(\nabla\log{p_{t}^{\bm{\phi}}}-\nabla\log{q_{t}^{\bm{\theta}}})^{T}(\nabla\log{p_{t}^{\bm{\phi}}}+\nabla\log{q_{t}^{\bm{\theta}}}-2\mathbf{s}_{\bm{\theta}})\bigg]\diff t\\
		&=\int\frac{g^{2}(t)}{2}\mathbb{E}_{p_{t}^{\bm{\phi}}(\mathbf{z}_{t})}\left[ \Vert\nabla\log{q_{t}^{\bm{\theta}}}-\mathbf{s}_{\bm{\theta}}\Vert_{2}^{2} \right]\diff t.
		\label{eq:cor_gen_sde}
		\diff\mathbf{z}_{t}=\left[\mathbf{f}(\mathbf{z}_{t},t)-g^{2}(t)\nabla\log{q_{t}^{\bm{\theta}}(\mathbf{z}_{t})}\right]\diff\bar{t}+g(t)\diff\mathbf{\bar{w}}_{t}.
		
		\frac{\partial q_{t}^{\bm{\theta}}}{\partial t}(\mathbf{z}_{t})=\text{div}\left(\Big(-\mathbf{f}(\mathbf{z}_{t},t)+\frac{g^{2}(t)}{2}\nabla \log{q_{t}^{\bm{\theta}}(\mathbf{z}_{t})}\Big)q_{t}^{\bm{\theta}}(\mathbf{z}_{t})\right),
		
		\mathbb{E}_{\bm{\epsilon}_{1},\bm{\epsilon}_{2}\sim\mathcal{N}(0,\mathbf{I})}\big[(\bm{\epsilon}_{2}^{T}A\bm{\epsilon}_{1}-\bm{\epsilon}_{1}^{T}A\bm{\epsilon}_{2})^{2}\big]=&\mathbb{E}_{\bm{\epsilon}_{1},\bm{\epsilon}_{2}\sim\mathcal{N}(0,\mathbf{I})}\big[(\bm{\epsilon}_{2}^{T}(A-A^{T})\bm{\epsilon}_{1})^{2}\big],
		
		\mathbb{E}_{\bm{\epsilon}_{1},\bm{\epsilon}_{2}}[(\bm{\epsilon}_{2}^{T}(A-A^{T})\bm{\epsilon}_{1})^{2}]=\mathbb{E}_{U}[U^{2}]^{2}\Vert A-A^{T}\Vert_{F}^{2}
		
		&\text{Var}\Big(\big(\bm{\epsilon}_{2}^{T}(A-A^{T})\bm{\epsilon}_{1}\big)^{2}\Big)=\text{Var}(U^{2})\Big(\text{Var}(U^{2})+2\big(\text{Var}(U)+\mathbb{E}_{U}[U]^{2}\big)^{2}\Big)\sum_{a,b}(\Delta A)_{ab}^{4}\\
		&\quad+2\big(\text{Var}(U)+\mathbb{E}_{U}[U]^{2}\big)^{2}\Big(3\text{Var}(U^{2})+2\big(\text{Var}(U)+\mathbb{E}_{U}[U]^{2}\big)^{2}\Big)\sum_{a}\sum_{b\ne d}(\Delta A)_{ab}^{2}(\Delta A)_{ad}^{2}\\
		&\quad+2\big(\text{Var}(U)+\mathbb{E}_{U}[U]^{2}\big)^{4}\Big(\sum_{a\neq c}\sum_{b\neq d}(\Delta A)_{ab}^{2}(\Delta A)_{cd}^{2}\\
		&\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad+3\sum_{a\ne c}\sum_{b\ne d}(\Delta A)_{ab}(\Delta A)_{ad}(\Delta A)_{cb}(\Delta A)_{cd}\Big),
		
		\mathbb{E}_{\bm{\epsilon}_{1},\bm{\epsilon}_{2}}\left[\left(\bm{\epsilon}_{2}^{T}(A-A^{T})\bm{\epsilon}_{1}\right)^{2}\right]=&\mathbb{E}_{\bm{\epsilon}_{1},\bm{\epsilon}_{2}}\Big[\big(\sum_{i,j}{\epsilon}_{1,i}{\epsilon}_{2,j}(A_{ij}-A_{ji})^{2}\big)^{2}\Big]\\
		=&\mathbb{E}_{\bm{\epsilon}_{1},\bm{\epsilon}_{2}}\Big[\sum_{i,j,r,s}{\epsilon}_{1,i}{\epsilon}_{2,j}{\epsilon}_{1,r}{\epsilon}_{2,s}(A_{ij}-A_{ji})(A_{rs}-A_{sr})\Big]\\
		=&\mathbb{E}_{\bm{\epsilon}_{1},\bm{\epsilon}_{2}}\Big[\sum_{i,j}{\epsilon}_{1,i}^{2}{\epsilon}_{2,j}^{2}(A_{ij}-A_{ji})^{2}\Big]\\
		=&\mathbb{E}_{U}[U^{2}]^{2}\sum_{i,j}(A_{ij}-A_{ji})^{2}\\
		=&\mathbb{E}_{U}[U^{2}]^{2}\Vert A-A^{T}\Vert_{F}^{2}.
		
			\lefteqn{\mathbb{E}_{\bm{\epsilon}_{1},\bm{\epsilon}_{2}}\left[\left(\bm{\epsilon}_{2}^{T}(A-A^{T})\bm{\epsilon}_{1}\right)^{4}\right]}&\\
			&&=\mathbb{E}_{\bm{\epsilon}_{1},\bm{\epsilon}_{2}}\Big[\sum_{a,b,c,d,e,f,g,h}{\epsilon}_{1,a}{\epsilon}_{2,b}{\epsilon}_{1,c}{\epsilon}_{2,d}{\epsilon}_{1,e}{\epsilon}_{2,f}{\epsilon}_{1,g}{\epsilon}_{2,h}B_{ab}B_{cd}B_{ef}B_{gh}\Big]\\
			&&=\mathbb{E}_{\bm{\epsilon}_{1},\bm{\epsilon}_{2}}\Big[\sum_{b,d,f,h}{\epsilon}_{2,b}{\epsilon}_{2,d}{\epsilon}_{2,f}{\epsilon}_{2,h}\sum_{a,c}{\epsilon}_{1,a}{\epsilon}_{1,c}\sum_{e,g}{\epsilon}_{1,e}{\epsilon}_{1,g}B_{ab}B_{cd}B_{ef}B_{gh}\Big]\\
			&&=\mathbb{E}_{\bm{\epsilon}_{1},\bm{\epsilon}_{2}}\Big[\sum_{b,d,f,h}{\epsilon}_{2,b}{\epsilon}_{2,d}{\epsilon}_{2,f}{\epsilon}_{2,h}\sum_{a}{\epsilon}_{1,a}^{2}\sum_{e,g}{\epsilon}_{1,e}{\epsilon}_{1,g}B_{ab}B_{ad}B_{ef}B_{gh}\Big]\\
			&&\quad+\mathbb{E}_{\bm{\epsilon}_{1},\bm{\epsilon}_{2}}\Big[\sum_{b,d,f,h}{\epsilon}_{2,b}{\epsilon}_{2,d}{\epsilon}_{2,f}{\epsilon}_{2,h}\sum_{a\ne c}{\epsilon}_{1,a}{\epsilon}_{1,c}\sum_{e,g}{\epsilon}_{1,e}{\epsilon}_{1,g}B_{ab}B_{cd}B_{ef}B_{gh}\Big]\\
			&&=\mathbb{E}_{\bm{\epsilon}_{1},\bm{\epsilon}_{2}}\Big[\sum_{b,d,f,h}{\epsilon}_{2,b}{\epsilon}_{2,d}{\epsilon}_{2,f}{\epsilon}_{2,h}\sum_{a}{\epsilon}_{1,a}^{2}\sum_{e}{\epsilon}_{1,e}^{2}B_{ab}B_{ad}B_{ef}B_{eh}\Big]\\
			&&\quad+\mathbb{E}_{\bm{\epsilon}_{1},\bm{\epsilon}_{2}}\Big[\sum_{b,d,f,h}{\epsilon}_{2,b}{\epsilon}_{2,d}{\epsilon}_{2,f}{\epsilon}_{2,h}\sum_{a\ne c}{\epsilon}_{1,a}^{2}{\epsilon}_{1,c}^{2}B_{ab}B_{cd}(B_{af}B_{ch}+B_{cf}B_{ah})\Big]\\
			&&=\mathbb{E}_{\bm{\epsilon}_{1},\bm{\epsilon}_{2}}\Big[\sum_{b,d,f,h}{\epsilon}_{2,b}{\epsilon}_{2,d}{\epsilon}_{2,f}{\epsilon}_{2,h}\sum_{a}{\epsilon}_{1,a}^{4}B_{ab}B_{ad}B_{af}B_{ah}\Big]\\
			&&\quad+3\mathbb{E}_{\bm{\epsilon}_{1},\bm{\epsilon}_{2}}\Big[\sum_{b,d,f,h}{\epsilon}_{2,b}{\epsilon}_{2,d}{\epsilon}_{2,f}{\epsilon}_{2,h}\sum_{a\ne c}{\epsilon}_{1,a}^{2}{\epsilon}_{1,c}^{2}B_{ab}B_{af}B_{cd}B_{ch}\Big]\\
			&&=\mathbb{E}_{U}[U^{4}]\sum_{a}\mathbb{E}_{\bm{\epsilon}_{2}}\Big[\sum_{b,d,f,h}{\epsilon}_{2,b}{\epsilon}_{2,d}{\epsilon}_{2,f}{\epsilon}_{2,h}B_{ab}B_{ad}B_{af}B_{ah}\Big]\\
			&&\quad+3\mathbb{E}_{U}[U^{2}]^{2}\sum_{a\ne c}\mathbb{E}_{\bm{\epsilon}_{2}}\Big[\sum_{b,d,f,h}{\epsilon}_{2,b}{\epsilon}_{2,d}{\epsilon}_{2,f}{\epsilon}_{2,h}B_{ab}B_{af}B_{cd}B_{ch}\Big]\\
			&&=\mathbb{E}_{U}[U^{4}]\sum_{a}\mathbb{E}_{\bm{\epsilon}_{2}}\Big[\sum_{b}{\epsilon}_{2,b}^{4}B_{ab}^{4}+3\sum_{b\ne d}{\epsilon}_{2,b}^{2}{\epsilon}_{2,d}^{2}B_{ab}^{2}B_{ad}^{2}\Big]\\
			&&\quad+3\mathbb{E}_{U}[U^{2}]^{2}\sum_{a\ne c}\mathbb{E}_{\bm{\epsilon}_{2}}\Big[\sum_{b}{\epsilon}_{2,b}^{4}B_{ab}^{2}B_{cb}^{2}+\sum_{b\ne d}{\epsilon}_{2,b}^{2}{\epsilon}_{2,d}^{2}(B_{ab}^{2}B_{cd}^{2}+2B_{ab}B_{ad}B_{cb}B_{cd})\Big]\\
			&&=\mathbb{E}_{U}[U^{4}]^{2}\sum_{a,b}B_{ab}^{4}+3\mathbb{E}_{U}[U^{2}]^{2}\mathbb{E}_{U}[U^{4}]\Big[\Big(\sum_{a}\sum_{b\ne d}B_{ab}^{2}B_{ad}^{2}+\sum_{b}\sum_{a\ne c}B_{ab}^{2}B_{cb}^{2}\Big)\Big]\\
			&&\quad+3\mathbb{E}_{U}[U^{2}]^{4}\sum_{a\ne c}\sum_{b\ne d}\Big(B_{ab}^{2}B_{cd}^{2}+2B_{ab}B_{ad}B_{cb}B_{cd}\Big)\\
			&&=\mathbb{E}_{U}[U^{4}]^{2}\sum_{a,b}B_{ab}^{4}+6\mathbb{E}_{U}[U^{2}]^{2}\mathbb{E}_{U}[U^{4}]\Big[\sum_{a}\sum_{b\ne d}B_{ab}^{2}B_{ad}^{2}\Big]\\
			&&\quad+3\mathbb{E}_{U}[U^{2}]^{4}\sum_{a\ne c}\sum_{b\ne d}\Big(B_{ab}^{2}B_{cd}^{2}+2B_{ab}B_{ad}B_{cb}B_{cd}\Big)
		
			\lefteqn{\mathbb{E}_{\bm{\epsilon}_{1},\bm{\epsilon}_{2}}\left[\left(\bm{\epsilon}_{2}^{T}(A-A^{T})\bm{\epsilon}_{1}\right)^{2}\right]^{2}=\Big(\mathbb{E}_{U}[U^{2}]^{2}\sum_{i,j}B_{ij}^{2}\Big)^{2}}&\\
			&&=\mathbb{E}_{U}[U^{2}]^{4}\sum_{i,j,r,s}B_{ij}^{2}B_{rs}^{2}\\
			&&=\mathbb{E}_{U}[U^{2}]^{4}\Big(\sum_{i,j}\sum_{s}B_{ij}^{2}B_{is}^{2}+\sum_{j,s}\sum_{i\ne r}B_{ij}^{2}B_{rs}^{2}\Big)\\
			&&=\mathbb{E}_{U}[U^{2}]^{4}\Big(\sum_{i,j}\sum_{s}B_{ij}^{2}B_{is}^{2}+\sum_{j}\sum_{i\ne r}B_{ij}^{2}B_{rj}^{2}+\sum_{i\ne r}\sum_{j\ne s}B_{ij}^{2}B_{rs}^{2}\Big)\\
			&&=\mathbb{E}_{U}[U^{2}]^{4}\Big(\sum_{i,j}B_{ij}^{4}+\sum_{i}\sum_{j\ne s}B_{ij}^{2}B_{is}^{2}+\sum_{j}\sum_{i\ne r}B_{ij}^{2}B_{rj}^{2}+\sum_{i\ne r}\sum_{j\ne s}B_{ij}^{2}B_{rs}^{2}\Big)\\
		
			\lefteqn{\text{Var}\left(\left(\bm{\epsilon}_{2}^{T}(A-A^{T})\bm{\epsilon}_{1}\right)^{2}\right)=\mathbb{E}_{\bm{\epsilon}_{1},\bm{\epsilon}_{2}}\left[\left(\bm{\epsilon}_{2}^{T}(A-A^{T})\bm{\epsilon}_{1}\right)^{4}\right]-\mathbb{E}_{\bm{\epsilon}_{1},\bm{\epsilon}_{2}}\left[\left(\bm{\epsilon}_{2}^{T}(A-A^{T})\bm{\epsilon}_{1}\right)^{2}\right]^{2}}&\\
			&&=\Big(\mathbb{E}_{U}[U^{4}]^{2}-\mathbb{E}_{U}[U^{2}]^{4}\Big)\sum_{a,b}B_{ab}^{4}+2\mathbb{E}_{U}[U^{2}]^{2}\Big(3\mathbb{E}_{U}[U^{4}]-\mathbb{E}_{U}[U^{2}]^{2}\Big)\sum_{a}\sum_{b\ne d}B_{ab}^{2}B_{ad}^{2}\\
			&&\quad+2\mathbb{E}_{U}[U^{2}]^{4}\Big(\sum_{a\neq c}\sum_{b\neq d}B_{ab}^{2}B_{cd}^{2}+3\sum_{a\ne c}\sum_{b\ne d}B_{ab}B_{ad}B_{cb}B_{cd}\Big)\\
			&&=\text{Var}(U^{2})\Big(\text{Var}(U^{2})+2\big(\text{Var}(U)+\mathbb{E}_{U}[U]^{2}\big)^{2}\Big)\sum_{a,b}B_{ab}^{4}\\
			&&\quad+2\big(\text{Var}(U)+\mathbb{E}_{U}[U]^{2}\big)^{2}\Big(3\text{Var}(U^{2})+2\big(\text{Var}(U)+\mathbb{E}_{U}[U]^{2}\big)^{2}\Big)\sum_{a}\sum_{b\ne d}B_{ab}^{2}B_{ad}^{2}\\
			&&\quad+2\big(\text{Var}(U)+\mathbb{E}_{U}[U]^{2}\big)^{4}\Big(\sum_{a\neq c}\sum_{b\neq d}B_{ab}^{2}B_{cd}^{2}+3\sum_{a\ne c}\sum_{b\ne d}B_{ab}B_{ad}B_{cb}B_{cd}\Big)
		
		\Vert\mu_{0}K-\mu_{1}K\Vert_{TV}\le\Vert\mu_{0}-\mu_{1}\Vert_{TV}.
		
		\Vert\varphi_{\#}\mu_{0}-\varphi_{\#}\mu_{1}\Vert_{TV}\le\Vert\mu_{0}-\mu_{1}\Vert_{TV},
		
		R_{k+1}^{\bm{\theta}}(\mathbf{z},\mathsf{A})=(4\pi\gamma_{k+1})^{-d/2}\int_{\mathsf{A}}\exp{\bigg[-\frac{\Vert\mathbf{\tilde{z}}-\mathcal{T}_{k+1}^{\bm{\theta}}(\mathbf{z})\Vert^{2}}{4\gamma_{k+1}}\bigg]}\diff\mathbf{\tilde{z}},
		
		R_{k+1}^{\bm{\phi}}(\mathbf{z},\mathsf{A})=(4\pi\gamma_{k+1})^{-d/2}\int_{\mathsf{A}}\exp{\bigg[-\frac{\Vert\mathbf{\tilde{z}}-\mathcal{T}_{k+1}^{\bm{\phi}}(\mathbf{z})\Vert^{2}}{4\gamma_{k+1}}\bigg]}\diff\mathbf{\tilde{z}},
		\label{appendix:127}
		p_{0}^{\bm{\phi}}\mathbb{P}_{T\vert 0}{\mathbb{P}^{R}}_{T\vert 0}(\mathsf{A})=\mathbb{P}_{T}{\mathbb{P}^{R}}_{T\vert 0}(\mathsf{A})={\mathbb{P}^{R}}_{0}{\mathbb{P}^{R}}_{T\vert 0}(\mathsf{A})={\mathbb{P}^{R}}_{T}(\mathsf{A})=p_{0}^{\bm{\phi}}(\mathsf{A}).
		
		&\Vert p_{0}^{\bm{\phi}}-p_{0,N}^{\bm{\theta}}\Vert_{TV}=\Vert p_{0}^{\bm{\phi}}\mathbb{P}_{T\vert 0}{\mathbb{P}^{R}}_{T\vert 0}-\pi Q_{N}^{\bm{\theta}}\Vert_{TV}\\
		&\quad\quad\quad\quad\le \Vert p_{0}^{\bm{\phi}}\mathbb{P}_{T\vert 0}{\mathbb{P}^{R}}_{T\vert 0}-\pi {\mathbb{P}^{R}}_{T\vert 0}\Vert_{TV}+\Vert \pi {\mathbb{P}^{R}}_{T\vert 0}-\pi Q_{N}^{\bm{\phi}}\Vert_{TV}+\Vert \pi Q_{N}^{\bm{\phi}}-\pi Q_{N}^{\bm{\theta}}\Vert_{TV}\\
		&\quad\quad\quad\quad\le \underbrace{\Vert p_{0}^{\bm{\phi}}\mathbb{P}_{T\vert 0}-\pi\Vert_{TV}}_{E_{pri}}+\underbrace{\Vert\pi{\mathbb{P}^{R}}_{T\vert 0}-\pi Q_{N}^{\bm{\phi}}\Vert_{TV}}_{E_{dis}}+\underbrace{\Vert\pi Q_{N}^{\bm{\phi}}-\pi Q_{N}^{\bm{\theta}}\Vert_{TV}}_{E_{est}}.
		
		\Vert\pi Q_{N}^{\bm{\phi}}-\pi Q_{N}^{\bm{\theta}}\Vert_{TV}^{2}\le\frac{1}{2}\int_{0}^{T}\mathbb{E}\big[\Vert b_{\bm{\phi}}(\{\mathbf{z}_{t}\}_{t=0}^{T},t)-b_{\bm{\theta}}(\{\mathbf{z}_{t}\}_{t=0}^{T},t)\Vert^{2}\big]\diff t,
		
		\diff\mathbf{z}_{t}=\Big[-\mathbf{z}_{t}-2\nabla\log{p_{t_{k}}^{\bm{\phi}}(\mathbf{z}_{t_{k}})}\Big]\diff\bar{t}+g(t)\diff\mathbf{\bar{w}}_{t}
		
		\diff\mathbf{z}_{t}=\Big[-\mathbf{z}_{t}-2\mathbf{s}_{\bm{\theta}}(\mathbf{z}_{t_{k}},t_{k})\Big]\diff\bar{t}+g(t)\diff\mathbf{\bar{w}}_{t}
		
		E_{est}(\bm{\phi},\bm{\theta})&\le \frac{1}{2}\int_{0}^{T}\mathbb{E}\big[\Vert b_{\bm{\phi}}(\{\mathbf{z}_{t}\}_{t=0}^{T},t)-b_{\bm{\theta}}(\{\mathbf{z}_{t}\}_{t=0}^{T},t)\Vert^{2}\big]\diff t\\
		&= 2\sum_{k=0}^{N-1}\int_{t_{k}}^{t_{k+1}}\mathbb{E}\big[\Vert\nabla\log{p_{t_{k}}^{\bm{\phi}}(\mathbf{z}_{t_{k}})}-\mathbf{s}_{\bm{\theta}}(\mathbf{z}_{t_{k}},t_{k})\Vert^{2}\big]\diff t\\
		&\le 2TM^{2}.
		
		\Vert p_{r}-(\mathbf{h}_{\bm{\phi}}^{-1})_{\#}\circ p_{0,N}^{\bm{\theta}}\Vert_{TV}=\Vert (\mathbf{h}_{\bm{\phi}})_{\#}\circ p_{r}-p_{0,N}^{\bm{\theta}}\Vert_{TV}=\Vert p_{0}^{\bm{\phi}}-p_{0,N}^{\bm{\theta}}\Vert_{TV},
		
		which completes the proof.
	\end{proof}
	
	\begin{table*}[t]
		\caption{Performance comparison to linear/nonlinear diffusion models on CIFAR-10. We report both before/after correction of density estimation performances. We report the baseline performances of linear diffusions by training our PyTorch implementation based on \citet{song2020score, song2021maximum} with identical hyperparameters and networks on both linear/nonlinear diffusions in order to quantify the effect of nonlinearity in a fair setting. Boldface numbers represent the best performance in a column, and underlined numbers represent the second best.}
		\label{tab:performance_cifar10_full}
		\tiny
		\centering
		\begin{adjustbox}{max width=\textwidth}
			\begin{tabular}{c|lc@{\hskip 0.3cm}r|cccccccc}
				\toprule
				\multirow{3}{*}{SDE} & \multirow{3}{*}{Model} & \multirow{3}{*}{\shortstack{Nonlinear Data\\Diffusion}} & \multirow{3}{*}{ Params} & \multicolumn{2}{c|}{NLL ()} & \multicolumn{2}{c|}{NELBO ()} & \multicolumn{2}{c|}{Gap ()} & \multicolumn{2}{c}{FID ()} \\
				&&&& \multirow{2}{*}{\shortstack{after\\correction}} & \multicolumn{1}{c|}{\multirow{2}{*}{\shortstack{before\\correction}}} &\multicolumn{1}{c}{w/ residual} & \multicolumn{1}{c|}{w/o residual} &\multicolumn{2}{c|}{(=NELBO-NLL)}& \multirow{2}{*}{ODE} & \multirow{2}{*}{PC} \\
				&&&& & \multicolumn{1}{c|}{} & \multicolumn{1}{c}{(after)} & \multicolumn{1}{c|}{(before)} & after & \multicolumn{1}{c|}{before} & &\\\midrule
				\multirow{4}{*}[-2pt]{VE} & NCSN++ (FID) & \xmark & 63M & 4.86 & 3.66 & 4.89 & 4.45 & 0.03 & 0.79 & - & 2.38 \\
				& \cc{15}INDM (FID) & \cc{15}\cmark & \cc{15}76M & \cc{15}3.22 & \cc{15}3.13 & \cc{15}3.28 & \cc{15}3.24 & \cc{15}0.06 & \cc{15}0.11 & \cc{15}- & \cc{15}2.29 \\\cmidrule(lr){2-12}
				& NCSN++ (deep, FID) & \xmark & 108M & 4.85 & 3.45 & 4.86 & 4.43 & 0.01 & 0.98 & - & \textbf{2.20} \\
				& \cc{15}INDM (deep, FID) & \cc{15}\cmark & \cc{15}118M & \cc{15}3.13 & \cc{15}3.03 & \cc{15}3.14 & \cc{15}3.10 & \cc{15}0.01 & \cc{15}0.07 & \cc{15}- & \cc{15}\underline{2.28} \\\midrule
				\multirow{9}{*}[-7pt]{VP} & DDPM++ (FID) & \xmark & 62M & 3.21 & 3.16 & 3.34 & 3.32 & 0.13 & 0.16 & 3.90 & 2.89 \\
				& \cc{15}INDM (FID) & \cc{15}\cmark & \cc{15}75M & \cc{15}3.17 & \cc{15}3.11 & \cc{15}3.23 & \cc{15}3.18 & \cc{15}0.06 & \cc{15}0.07 & \cc{15}\textbf{3.61} & \cc{15}2.90 \\\cmidrule(lr){2-12}
				& DDPM++ (deep, FID) & \xmark & 108M & 3.19 & 3.13 & 3.32 & 3.29 & 0.13 & 0.16 & 3.69 & 2.64 \\
				& \cc{15}INDM (deep, FID) & \cc{15}\cmark & \cc{15}121M & \cc{15}3.09 & \cc{15}3.02 & \cc{15}3.13 & \cc{15}3.08 & \cc{15}0.04 & \cc{15}0.06 & \cc{15}\underline{3.67} & \cc{15}3.15 \\\cmidrule(lr){2-12}
				& DDPM++ (NLL) & \xmark & 62M & 3.03 & 2.97 & 3.13 & 3.11 & 0.10 & 0.14 & 6.70 & 5.17 \\
				& \cc{15}INDM (NLL) & \cc{15}\cmark & \cc{15}75M & \cc{15}\underline{2.98} & \cc{15}\underline{2.95} & \cc{15}\underline{2.98} & \cc{15}\underline{2.97} & \cc{15}\textbf{0.00} & \cc{15}\textbf{0.02} & \cc{15}6.01 & \cc{15}5.30 \\
				& \cc{15}INDM (NLL, ST) & \cc{15}\cmark & \cc{15}75M & \cc{15}3.01 & \cc{15}2.98 & \cc{15}3.02 & \cc{15}3.01 & \cc{15}0.01 & \cc{15}0.03 & \cc{15}3.88 & \cc{15}3.25 \\\cmidrule(lr){2-12}
				& DDPM++ (deep, NLL) & \xmark & 108M & 3.01 & 2.95 & 3.11 & 3.09 & 0.10 & 0.14 & 6.43 & 4.88 \\
				& \cc{15}INDM (deep, NLL) & \cc{15}\cmark & \cc{15}121M & \cc{15}\textbf{2.97} & \cc{15}\textbf{2.94} & \cc{15}\textbf{2.97} & \cc{15}\textbf{2.96} & \cc{15}\textbf{0.00} & \cc{15}\textbf{0.02} & \cc{15}5.71 & \cc{15}4.79 \\
				\bottomrule
			\end{tabular}
		\end{adjustbox}
	\end{table*}
	
	\begin{table*}[t]
		\caption{Performance comparison on CIFAR-10.}
		\label{tab:performance_cifar10_appendix}
		\tiny
		\centering
		\begin{adjustbox}{max width=\textwidth}
			\begin{tabular}{cccl|cccccccc}
				\toprule
				\multirow{3}{*}{Class} & \multirow{3}{*}{SDE} & \multirow{3}{*}{Type} & \multirow{3}{*}{Model} & \multicolumn{2}{c|}{NLL ()} & \multicolumn{2}{c|}{NELBO ()} & \multicolumn{2}{c|}{Gap ()} & \multicolumn{2}{c}{FID ()} \\
				&&&& \multirow{2}{*}{\shortstack{after\\correction}} & \multicolumn{1}{c|}{\multirow{2}{*}{\shortstack{before\\correction}}} &\multicolumn{1}{|c}{w/ residual} & \multicolumn{1}{c|}{w/o residual} &\multicolumn{2}{|c|}{(=NELBO-NLL)}& \multirow{2}{*}{ODE} & \multirow{2}{*}{PC} \\
				&&&& & & \multicolumn{1}{|c}{(after)} & \multicolumn{1}{c|}{(before)} & after & \multicolumn{1}{c|}{before} & &\\\midrule
				\multirow{4}{*}{GAN}  &  	&											& StyleGAN2 + ADA \cite{karras2020training}	 & - & - & - & - & - & - &  \multicolumn{2}{c}{2.92}  \\	 &  	&											& StyleFormer \cite{park2022styleformer}	 & - & - & - & - & - & - &  \multicolumn{2}{c}{2.82}  \\	
				&  	&											& SNGAN + DGflow \cite{ansari2020refining}	 & - & - & - & - & - & - &  \multicolumn{2}{c}{9.62} \\
				&  	&											& TransGAN \cite{jiang2021transgan}		 & - & - & - & - & - & - &  \multicolumn{2}{c}{9.26} \\ \midrule
				\multirow{3}{*}{Autoregressive}  &  	&									& PixcelCNN \cite{van2016pixel}	& 3.14 & - & - & - & - & - &  \multicolumn{2}{c}{65.9}  \\
				&  	&									& PixcelRNN \cite{van2016pixel} & 3.00 & - & - & - & - & - &  \multicolumn{2}{c}{-}  \\
				&  	&									& Sparse Transformer \cite{child2019generating}	& 2.80 & - & - & - & - & - &  \multicolumn{2}{c}{-}  \\ \midrule
				\multirow{6}{*}{Flow}  &  	&											& Glow \cite{kingma2018glow}	& 3.35 &  - & - & - & - & - &  \multicolumn{2}{c}{48.9}  \\
				&  	&											& Residual Flow \cite{chen2019residual}	& 3.28 & - & - & - & - & - &  \multicolumn{2}{c}{46.4}  \\
				&  	&											& Flow++ \cite{ho2019flow++} & 3.28 & - & - & - & - & - &  \multicolumn{2}{c}{46.4}  \\
				&  	&											& Wolf \cite{ma2020decoupling}	 & 3.27 & - & - & - & - & - &  \multicolumn{2}{c}{37.5}  \\
				&  	&											& VFlow \cite{chen2020vflow}	 & 2.98 & - & - & - & - & - &  \multicolumn{2}{c}{-}  \\
				&  	&											& DenseFlow-74-10 \cite{grcic2021densely}	 & 2.98 & - & - & - & - & - &  \multicolumn{2}{c}{34.9}  \\	 \midrule
				\multirow{5}{*}{VAE}  &  	&											& NVAE \cite{vahdat2020nvae}	 & - & - & 2.91  & - & - & - &  \multicolumn{2}{c}{23.5}  \\
				&  	&											& Very Deep VAE \cite{child2020very}	 & - & - & 2.87 & - & - & - &  \multicolumn{2}{c}{-}  \\
				&  	&											& -VAE \cite{razavi2018preventing}	 & - & - & 2.83 & - & - & - &  \multicolumn{2}{c}{-}  \\
				&  	&											& DCVAE \cite{parmar2021dual}	 & - & - & - & - & - & - &  \multicolumn{2}{c}{17.9}  \\
				&  	&											& CR-NVAE \cite{sinha2021consistency} 	 & - & - & - & - & - & - &  \multicolumn{2}{c}{2.51}  \\	 \midrule
				\multirow{19}{*}[-1.5em]{Diffusion}  & \multirow{9}{*}{Linear} 	&						& DDPM \cite{ho2020denoising}	 & - & - & 3.75 & - & - & - &\multicolumn{2}{c}{3.17} \\	
				&						&											& NCSNv2 \cite{song2020improved}	& - & - & - & - & - & - &\multicolumn{2}{c}{10.87} \\	
				&						&											& DDIM \cite{song2020denoising}	 & - & - & - & - & - & - &\multicolumn{2}{c}{4.04} \\
				&						&											& IDDPM \cite{nichol2021improved}	 & 3.37 & - & - & - & - & - &\multicolumn{2}{c}{2.90} \\	
				&						&											& VDM \cite{kingma2021variational}	 & \textbf{2.65} & - & - & - & - & - &\multicolumn{2}{c}{7.41} \\	
				&						&											& NCSN++ (FID) \cite{song2020score}	 & 4.85 & 3.45 & 4.86 & 4.43 & 0.01 & 0.98 & - 		& \textbf{2.20} \\		
				& 						&											& DDPM++ (FID) \cite{song2020score}	 & 3.19 & 3.13 & 3.32 & 3.29 & 0.13 & 0.16 & 3.69 	& 2.64		 \\
				& 						&											& DDPM++ (NLL) \cite{song2021maximum}	 & 3.01 & 2.95 & 3.11 & 3.09 & 0.10 & 0.14 & 6.43 	& 4.88 		\\
				& 						&											& CLD-SGM \cite{dockhorn2021score}	 & - & - 	& - 	& 3.31 		& - & - & 2.25 	& - 		\\ \cmidrule(lr){2-12}
				& \multirow{10}{*}[-1.3em]{Nonlinear}	& SBP										& SB-FBSDE \cite{chen2021likelihood}	& - & 2.98 	& - 	& - 		& - & - & - 	& 3.18 		\\ \cmidrule(lr){3-12}
				& 						&\multirow{5}{*}{\shortstack[c]{VAE\\-based}}	& LSGM (FID) \cite{vahdat2021score} & - 	& - 	& 3.45 & 3.43	& - & - & \textbf{2.10} 	& -	\\
				& 						&											& LSGM (NLL)-269M 					 & - 	& - 	& - & 2.97	& - & - & 6.15 	&  -		\\
				&						&											& LSGM (NLL) 						 & - 	& - 	&\textbf{ 2.87} & \textbf{2.87}	& - & - & 6.89 	&  -		\\
				&						&											& LSGM (balanced)-109M					 & - 	& - 	& - & 2.96	& - & - & 4.60 	&  -		\\
				&						&											& LSGM (balanced)					 & - 	& - 	& 2.98 & 2.95	& - & - & 2.17 	&  -		\\ \cmidrule(lr){3-12}
				&						&\multirow{4}{*}[-0.45em]{\shortstack[c]{Flow\\-based}}	& DiffFlow (FID) \cite{zhang2021diffusion} & - 	& - 	& 3.04 & -	& - & - & - 	& 14.14 		\\ \cmidrule(lr){4-12}
				&						&											& \cc{15}INDM (FID) 					 &  \cc{15}3.13 & \cc{15}3.03 & \cc{15}3.14 & \cc{15}3.10 & \cc{15}0.01 & \cc{15}0.07 & \cc{15}- & \cc{15}2.28 		\\ 
				&						&											& \cc{15}INDM (NLL) 						 & \cc{15}2.97 & \cc{15}\textbf{2.94} & \cc{15}2.97 & \cc{15}2.96 & \cc{15}\textbf{0.00} & \cc{15}\textbf{0.02} & \cc{15}5.71 & \cc{15}4.79 \\ 
				&						&											& \cc{15}INDM (ST)					  & \cc{15}3.01 & \cc{15}2.98 & \cc{15}3.02 & \cc{15}3.01 & \cc{15}0.01 & \cc{15}0.03 & \cc{15}3.88 & \cc{15}3.25 \\
				\bottomrule
			\end{tabular}
		\end{adjustbox}
	\end{table*}
	
	
	
	
	\begin{table*}[t]
		\caption{Performance comparison on CelebA .}
		\label{tab:performance_celeba_appendix}
		\scriptsize
		\centering
		\begin{tabular}{lc@{\hskip 0.3cm}c@{\hskip 0.3cm}c@{\hskip 0.2cm}c@{\hskip 0.3cm}c@{\hskip 0.3cm}c@{\hskip 0.3cm}c@{\hskip 0.3cm}c@{\hskip 0.3cm}c}
			\toprule
			\multirow{2}{*}{Model} & \multicolumn{2}{c}{NLL ()} & \multicolumn{2}{c@{\hskip 0.5cm}}{NELBO ()} & \multicolumn{2}{c@{\hskip 0.5cm}}{Gap ()} & \multicolumn{2}{c@{\hskip 0.4cm}}{FID ()} \\
			& after & before & w/ res- & w/o res- & after & before & ODE & PC \\\midrule
			
			UNCSN++ \cite{kim2022soft} & - & \textbf{1.93} & - & - & - & - & - & \textbf{1.92} \\
			DDGM \cite{nachmani2021non} & - & - & - & - & - & - & - & 2.92 \\
			Efficient-VDVAE \cite{hazami2022efficient} & - & \textbf{1.83} & - & - \\
			CR-NVAE \cite{sinha2021consistency} & - & - & 1.86 & - & - & - & - & - \\
			DenseFlow-74-10 \cite{grcic2021densely} & 1.99 & - & - & - & - & - & - & - \\
			StyleFormer \cite{park2022styleformer}  & - & - & - & - & - & - & \multicolumn{2}{c}{3.66}\\ \midrule			
			NCSN++ (VE) & 3.41 & 2.37 & 3.42 & 3.96 & 0.01 & 1.59 & - & 3.95 \\
			\cc{15}INDM (VE, FID) & \cc{15}2.31 & \cc{15}1.95 & \cc{15}2.33 & \cc{15}2.17 & \cc{15}0.02 & \cc{15}0.22 & \cc{15}- & \cc{15}2.54\\\midrule
			DDPM++ (VP, FID) & 2.14 & 2.07 & 2.21 & 2.22 & 0.06 & 0.14 & 2.32 & 3.03 \\
			\cc{15}INDM (VP, FID) & \cc{15}2.27 & \cc{15}2.13 & \cc{15}2.31 & \cc{15}2.20 & \cc{15}0.04 & \cc{15}0.07 & \cc{15}\textbf{1.75} & \cc{15}2.32 \\\cmidrule(lr){2-9}
			DDPM++ (VP, NLL) & 2.00 & 1.93 & 2.09 & 2.09 & 0.09 & 0.16 & 3.95 & 5.31 \\
			\cc{15}INDM (VP, NLL) & \cc{15}2.05 & \cc{15}1.97 & \cc{15}2.05 & \cc{15}2.00 & \cc{15}0.00 & \cc{15}0.03 & \cc{15}3.06 & \cc{15}5.14 \\
			\bottomrule
		\end{tabular}
	\end{table*}
	
	\begin{figure}
		\centering
		\includegraphics[width=\linewidth]{cifar10.png}
		\caption{Non cherry-picked random samples from CIFAR-10 trained on INDM (VE, deep, FID).}
		\label{fig:CIFAR10_VE_FID_samples_tau_1.05}
	\end{figure}
	
	\begin{figure}
		\centering
		\includegraphics[width=\linewidth]{celeba.png}
		\caption{Non cherry-picked random samples fr om CelebA trained on INDM (VP, FID).}
		\label{fig:CelebA_VP_FID_samples_tau_1.11}
	\end{figure}
	


	
\end{document}