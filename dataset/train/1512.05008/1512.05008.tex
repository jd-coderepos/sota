

\long\def\comment#1{$<<$\textbf{#1}$>>$}




\documentclass[conference,letterpaper,10pt]{IEEEtran}

\usepackage[T1]{fontenc}
\usepackage[latin1]{inputenc}
\usepackage{float}
\usepackage{amsmath}
\DeclareMathOperator*{\argmax}{arg\,max}
\usepackage[noadjust]{cite}
\usepackage{amssymb}
\usepackage{enumerate}
\usepackage{amsthm}
\usepackage{graphics,epsfig,psfrag}
\usepackage{subfigure,epsf,pstricks,subfloat}
\usepackage{bm}
\usepackage{url}
\usepackage{gensymb}

\usepackage{comment}
\floatstyle{ruled}
\newfloat{algorithm}{tbp}{loa}
\floatname{algorithm}{Routine}

\usepackage{algorithmic}
\algsetup{linenodelimiter= }
\renewcommand{\algorithmiccomment}[1]{/* #1 */}
\renewcommand{\algorithmicrequire}{\textbf{Input:}}
\renewcommand{\algorithmicforall}{\textbf{for each}}
\renewcommand{\algorithmicreturn}{\textbf{Return:}}
\def\bfzero{{\mathbf{0}}}
\def\bfone{{\mathbf{1}}}
\def\bfa{{\mathbf a}}
\def\bfb{{\mathbf b}}
\def\bfc{{\mathbf c}}
\def\bfd{{\mathbf d}}
\def\bfe{{\mathbf e}}
\def\bff{{\mathbf f}}
\def\bfg{{\mathbf g}}
\def\bfh{{\mathbf h}}
\def\bfi{{\mathbf i}}
\def\bfj{{\mathbf j}}
\def\bfk{{\mathbf k}}
\def\bfl{{\mathbf l}}
\def\bfm{{\mathbf m}}
\def\bfn{{\mathbf n}}
\def\bfo{{\mathbf o}}
\def\bfp{{\mathbf p}}
\def\bfq{{\mathbf q}}
\def\bfr{{\mathbf r}}
\def\bfs{{\mathbf s}}
\def\bft{{\mathbf t}}
\def\bfu{{\mathbf u}}
\def\bfv{{\mathbf v}}
\def\bfw{{\mathbf w}}
\def\bfx{{\mathbf x}}
\def\bfy{{\mathbf y}}
\def\bfz{{\mathbf z}}
\def\bfA{{\mathbf A}}
\def\bfB{{\mathbf B}}
\def\bfC{{\mathbf C}}
\def\bfD{{\mathbf D}}
\def\bfE{{\mathbf E}}
\def\bfF{{\mathbf F}}
\def\bfG{{\mathbf G}}
\def\bfH{{\mathbf H}}
\def\bfI{{\mathbf I}}
\def\bfJ{{\mathbf J}}
\def\bfK{{\mathbf K}}
\def\bfL{{\mathbf L}}
\def\bfM{{\mathbf M}}
\def\bfN{{\mathbf N}}
\def\bfO{{\mathbf O}}
\def\bfP{{\mathbf P}}
\def\bfQ{{\mathbf Q}}
\def\bfR{{\mathbf R}}
\def\bfS{{\mathbf S}}
\def\bfT{{\mathbf T}}
\def\bfU{{\mathbf U}}
\def\bfV{{\mathbf V}}
\def\bfW{{\mathbf W}}
\def\bfX{{\mathbf X}}
\def\bfY{{\mathbf Y}}
\def\bfZ{{\mathbf Z}}



\newcommand{\lsem}{[\![} \newcommand{\rsem}{]\!]}
\newcommand{\cA}{\mathcal{A}}
\newcommand{\Cr}{\mathcal{C}r}
\newcommand{\A}{{\bf A}}
\def\x{{\bf x}}
\def\y{{\bf y}}
\def\w{{\bf w}}
\def\v{{\bf v}}
\def\u{{\bf u}}
\def\z{{\bf z}}
\def\e{{\bf e}}
\def\I{{\bf I}}
\def\V{{\bf V}}
\def\ddelta{\bf{\delta}}
\def\F{{\mathcal{F}}}
\def\G{{\mathfrak{G}}}
\def\P{{\mathcal{P}}}
\def\I{{\mathcal{I}}}
\def\J{{\mathcal{J}}}
\def\RR{{\mathcal{R}}}
\def\S{{\mathcal{S}}}





\newcommand{\C}{\mathbb{C}}

\newcommand{\R}{\mathbb{R}}


\title{Likelihood of Cyber Data Injection Attacks to Power Systems} 
\author{
\IEEEauthorblockN{Yingshuai Hao, \textit{Student Member, IEEE,}  Meng Wang, \textit{Member, IEEE}, Joe Chow, \textit{Fellow, IEEE} 
\IEEEauthorblockA{Department of Electrical, Computer, and Systems Engineering\\
Rensselaer Polytechnic Institute, Troy, NY, 12180, USA\\
Email:   \{haoy2,wangm7,chowj\}@rpi.edu}
 }
}

\usepackage{array}
\usepackage{multirow}
\usepackage{graphicx}
\usepackage{epstopdf}
\newtheorem{theorem}{Theorem}
\newtheorem{lemma}{Lemma}
\newtheorem{cor}{Corollary}
\newtheorem{remark}{Remark}
\newtheorem{defi}{Definition}
\newtheorem{prop}{Proposition}


\begin{document}

\maketitle \thispagestyle{empty} \pagestyle{empty}

\begin{abstract}
Cyber data attacks are the worst-case interacting bad data to power system state estimation and cannot be detected by existing bad data detectors.
In this paper, we for the first time analyze the likelihood of cyber data attacks by characterizing  the actions of a malicious intruder. 
We propose to use Markov decision process to model an intruder's strategy, where the objective is to maximize the cumulative reward across time. Linear programming method is employed to find the  optimal attack policy from the intruder's perspective.   Numerical experiments are conducted to  study the intruder's attack strategy in test power systems. 
\end{abstract}
\begin{IEEEkeywords}
cyber data attacks, Markov Decision Process, state estimation, power systems.
\end{IEEEkeywords}

\section{Introduction}\label{sec:intro} 
 
State  estimation \cite{AE04} solves for power system states from obtained measurements. The correct estimation of systems states is vital for the reliable operation of  power systems.  
Since  bad data 
can result in significant errors in  the outcome of state estimation and potentially lead to catastrophic consequences,   the detection and identification of bad data has been extensively studied \cite{CA06,HSKF75,MG83,MS71,XWCT13} in state estimation. 
  
The integration of cyber infrastructures in future smart grids inevitably increases the possibility of cyber attacks. 
Cyber data attacks, firstly studied in \cite{LNR11}, 
means that a malicious intruder with system configuration information simultaneously manipulates   multiple  measurements and the injected errors cannot be detected by any bad data detector. 
State estimation in the presence of cyber data  attacks has attracted much research attention recently  \cite{BRWKNO10,DS10,KJTT10,LEDEH14,LNR11,SJ13,STJ10,TKPC11}. Some work focused on the identification 
of a small number of key measurement units 
such that if those units are protected from an intruder, the intruder cannot launch a successful cyber data attack \cite{BRWKNO10,DS10,KP11}.
A few recent work \cite{SJ13,LEDEH14,WGGCFSR14} considered the detection of cyber data attacks in a power system with Supervisory Control and Data Acquisition (SCADA) systems or phasor measurement units (PMUs) and various detection methods have been proposed. 

What is missing in the literature of cyber data attacks is the analysis of the frequency of data attacks in smart grids and the likelihood of attacks at a given system state. 
This paper takes the first step to  analyze the likelihood of data attacks from the intruder's perspective. We consider a scenario that  if a cyber data attack is detected by the operator,   the affected measurement units will be protected for some time. Thus, the intruder's current action  affects its future available actions.
To address such challenge in  developing an attack strategy, we propose to use Markov Decision Process (MDP) \cite{MP94} to  model the intruder's attack decision across time. The solution to the resulting MDP
is a mapping from system states to the intruder's actions (attack or not, which bus to attack and how much error to inject). Numerical experiments are carried on PJM 5-bus system to verify the proposed approach and study the likelihood of cyber attacks in such systems. 

The rest of the paper is organized as follows. We motivate the problem and introduce cyber data attacks and MDP in Section \ref{sec:model}. We formulate the intruder's attack strategy as an MDP and introduce its solution method in Section \ref{sec:method}.  Section \ref{sec:simu} records our numerical study on an example network. We conclude the paper in Section \ref{sec:con}. 

\section{Problem Motivation and Background} \label{sec:model}

We first introduce the definition and existing work on cyber data attacks in Section~\ref{sec:cyber}. We then motivate and introduce the problem of likelihood analysis of cyber data attacks in Section~\ref{sec:problem}. One main contribution of our paper is to model this problem as a Markov Decision Process (MDP).  MDPs are introduced in Section \ref{sec:MDP}.
\subsection{Cyber Data Attacks in Power Systems}\label{sec:cyber}
In a power system, the state is usually represented by bus voltage magnitudes $\bm{V}\in \mathcal{R}^n$ and angles $\bm{\theta}\in [-\pi,\pi]^n$, where $n$ is the number of buses. 
State estimation \cite{AE04} solves for system states from the obtained measurements.
Under the AC measurement model, the measurements $\bm{z}$ can be expressed as a nonlinear function of state variables $\bm{x}=(\bm{V}$,$\bm{\theta}$):
\begin{equation}
\bm{z}=h(\bm{x})+\bm{\omega},
\end{equation}
where $\bm{\omega}$ represents the random measurement noise.


In the AC state estimation, the state variables are determined from the weighted least square optimization problem:
\begin{equation}
\bm{\hat{x}}=\arg\min(\bm{z}-h(\bm{x}))^T\cdot\bm{R}^{-1}\cdot(\bm{z}-h(\bm{x})),
\end{equation}
where $\bm{R}$ is the covariance matrix of measurement noise $\bm{\omega}$.

Malicious intruders can hack the measuring devices and inject interacting errors to the measurements. If they have sufficient system information and choose the errors $\bm{e_z}$ satisfying
\begin{equation}\label{eqn: measurements with errors}
\begin{split}
\bm{z}+\bm{e_z} & =h(\bm{x'})+\bm{\omega}\\
& =h(\bm{V}+\bm{e_V},\bm{\theta}+\bm{e_\theta})+\bm{\omega},
\end{split}
\end{equation}
where $\bm{e_V}$ and $\bm{e_\theta}$ represent the resulting errors on state variables $\bm{V}$ and $\bm{\theta}$ respectively, the manipulated measurements cannot be detected by existing bad data detectors. In this case, instead of correctly estimating state variables ($\bm{V},\bm{\theta}$), the operator would obtain a wrong estimate $(\bm{V}+\bm{e_V},\bm{\theta}+\bm{e_\theta})$.




Since such cyber data attacks cannot be identified by   bad data detectors, 
many efforts have been devoted to identify and protect  a small number of key measurement units such that an intruder cannot inject unobservable attacks without hacking protected units  \cite{BRWKNO10,DS10,KP11}. A few recent work \cite{SJ13,LEDEH14,WGGCFSR14} considered the detection of data attacks and various detection methods have been proposed.

The potential financial risks of cyber data attacks are studied in \cite{XMS11} and \cite{JKT14}, where the congestion pattern is defined as the set of congested lines.  By injecting false data without being detected, the intruders could change the congestion pattern and thus change the locational marginal price (LMP). The intruders can obtain financial reward from the resulting change in LMP. 

In this paper, we restrict our attention to attacks that satisfy (\ref{eqn: measurements with errors}) and result in a change of the system congestion pattern. By launching a data attack, if a line's real power is wrongly estimated to exceed its capacity while it actually is not, or the power is wrongly estimated to below its limit while the line is actually congested, then the intruder can gain a reward from the attack. 




\subsection{Likelihood of Cyber Data Attacks}\label{sec:problem}
One important question that has not been considered before is the analysis of the likelihood of cyber data attacks at a given operating state of power systems. 
In this paper, we act as an intruder and aim to find the optimal attack strategy from an intruder's perspective.
We assume that an intruder can obtain a reward from a change of the congestion pattern by injecting false data without being detected.  The intruder aims to maximize the cumulative reward. If a cyber data attack, however, is detected by detection methods such as \cite{SJ13,LEDEH14,WGGCFSR14}, we assume the intruded measuring devices will be protected for some time so that an intruder cannot change the measurements of these devices during the period. A detected attack, therefore, can limit the intruder's future actions and thus reduce the future reward. Since the state of a power system changes across time, and the future state is unknown to the intruder, it needs to decide  when and which buses to attack to maximize the total rewards based on its current estimate.  We employ Markov Chains \cite{MP94} to model the evolution of power system states and formulate the intruder's decision process as a Markov Decision Process \cite{MP94}. The solution of resulting MDP is a mapping from system states to the intruder's actions.





\subsection{Markov Decision Processes (MDPs)}\label{sec:MDP}
An MDP is a mathematical framework employed to model the  decision-making process in stochastic environments. In this framework, the system is modeled via a series of states $S$. Each state $s\in S$ has an associated set of actions $A(s)$. In time step $t$, a decision is made based on the system's current state $s_t\in S$, and an action $a_t\in A(s_t)$ is chosen to conduct. The cost of taking action $a_t$ at state $s_t$ is $G(s_t,a_t)$. Then following the state transition probability distribution, the system transits to a new state $s_{t+1}$ with a probability of $P(s_{t+1}|s_t,a_t)$. A reward $R(s_{t+1}|s_t, a_t)$ is received from the state transition. 
As the system evolves, a sequence of rewards is obtained. 
The aim for decision-makers is to choose sequential actions that yield maximal expected rewards over the total decision-making horizon. The MDP problem can be solved by numerous methods, like value iteration, policy iteration and linear programming approaches discussed in \cite{MP94}. 



\section{Problem Formulation and Solution}\label{sec:method}
In Section \ref{sec: problem formulation}, the problem is formulated from the perspective of attackers and the strategy of cyber data attacks is modeled as an infinite-horizon MDP. The solution method of resulting MDP is discussed in Section \ref{sec: MDP solution}.
\subsection{Problem Formulation}\label{sec: problem formulation}
\subsubsection{States and Time Steps}	


Here we employ bus voltage magnitudes, angles and the states of measuring devices together as system states in an MDP. Because the measurements contain noise and an intruder may have limited knowledge of the states of a power system, we use discrete states to model the intruder's estimate of actual power system states. 
For example, let $V_i$ denote the voltage magnitude of bus $i$, $V_i^{\max}$ and $V_i^{\min}$ denote the upper bound and lower bound of $V_i$ respectively. $\Delta V_i=V_i^{\max}-V_i^{\min}$. $n_V$ denotes the number of discrete states in the range. We define the state of the voltage magnitude of bus $i$ as
\begin{equation}\label{equ: voltage magnitude state}
\bar{V}_i=q/(n_V-1),\ q\in \{0,1,\cdots,n_V-1\},
\end{equation}
if $V_i \in \left[V_i^{\min}+q\times \tfrac{\Delta V_i}{n_V-1},V_i^{\min}+(q+1)\times \tfrac{\Delta V_i}{n_V-1}\right)$.
Similarly, let $\theta_i$ denote the voltage angle of bus $i$, $\theta_i^{\max}$ and $\theta_i^{\min}$ denote its upper bound and lower bound respectively, $n_{\theta}$ denote the number of discrete states. $\Delta \theta_i=\theta_i^{\max}-\theta_i^{\min}$. We say the state of the voltage angle of bus $i$ is
\begin{equation}
\bar{\theta}_i=q/(n_\theta-1),\ q\in \{0,1,\cdots,n_\theta-1\},
\end{equation}
if $\theta_i \in \left[\theta_i^{\min}+q\times \tfrac{\Delta \theta_i}{n_\theta-1},\theta_i^{\min}+(q+1)\times \tfrac{\Delta \theta_i}{n_\theta-1}\right)$.
The state of the $j$th measuring device is denoted by a variable $\bar{U}_j$:
\begin{equation}
\bar{U}_j=
\begin{cases}
1 & \text{$j$th device is open to attack},\\
0 & \text{$j$th device is protected from intrusion }.		
\end{cases}
\end{equation}
If a measuring device is protected, then an intruder cannot change any measurements of that device. Otherwise, an intruder can change partial or all measurements of that device. 

\begin{figure}	
	\centering
	\includegraphics[ width=0.5\textwidth]{event_sequence_of_cyber_data_attack}
	\caption{Event sequence with cyber data attacks. An intruder changes the observations of measuring devices to mislead the operator.}\vspace{-5mm}
	\label{fig:sequence}
\end{figure}


We consider a discrete-time system, and the time step is set as the duration between two consecutive instants of state estimation. The sampling rate of measuring devices can be higher than the state estimation frequency, as shown in Fig.~\ref{fig:sequence}. Attacks can happen during either  device sampling or  data transmission to control center. We assume if intruders decide to attack a device during step $t$, they need to change all the measurements of that device in the time step. Otherwise, the attack can be easily detected by comparing consecutive measurements. 
If a power system has $M$ buses and $N$  devices,  the state $s_t$ at time step $t$ is \begin{equation}\label{eqn: system state}
	\begin{split}
	s_t&= \left[\bar{\bm{V}}(t),\bar{\bm{\theta}}(t),\bar{\bm{U}}(t)\right]\\
	&=\left[\bar{V}_1(t),\cdots,\bar{V}_M(t),\bar{\theta}_1(t),\cdots,\bar{\theta}_M(t),\bar{U}_1(t), \cdots,\bar{U}_N(t)\right],
	\end{split}
\end{equation}
where $\bar{V}_i(t)$, $\bar{\theta}_i(t)$ and $\bar{U}_j(t)$ represent the states of voltage magnitude and angle of bus $i$ and the state of $j$th device at time step $t$ respectively. 

\subsubsection{Actions, Rewards and Costs}
Since the reward results from a change in the congestion pattern, in order to change the line power, the intruder needs to inject errors to the estimate of voltage phasors of incident buses. Let $e_{V_i}$ and $e_{\theta_i}$ denote the injected errors to the voltage magnitude and angle of bus $i$ respectively. To make the problem tractable, we assume $e_{V_i}$ and $e_{\theta_i}$ can only be multiples of $\frac{\Delta V_i}{n_V-1}$ and $\frac{\Delta \theta_i}{n_\theta-1}$  respectively, and the resulting estimates of system variables still lie in individual allowable range. In this case, there are totally $n_V\times n_\theta$ available ways to inject errors to one bus voltage phasor. Note that in order to pass the bad data detection, given $\bm{e_V}$ and $\bm{e_\theta}$, an intruder needs to choose the injected errors $\bm{e_z}$ to measurements according to (\ref{eqn: measurements with errors}).

 We call a set of  buses and lines as \textit{target buses} and \textit{target lines} respectively if the intruder attempts to change the congestion pattern of these lines by injecting errors on the target buses. Since an intruder may have limited resources to launch attacks, we assume at each time step the intruder can manipulate the states of at most $d$ bus voltages. The intruder, therefore, has at most $\sum_{i=0}^{d}\tbinom{M}{i}$ ways to select target buses.



 


The launched attacks can be detected by some recently developed methods, as presented in section \ref{sec:problem}. Here we use $p_d(s,a)$ to denote the probability that an action $a$ at state $s$ is detected by the network operator. We suppose it is a function of injected errors on the bus voltage magnitudes and angles:
\begin{equation}\label{eqn: detection probability}
p_d(s,a)=1-\exp\left(-C\times\sum_{i=1}^{M}\left(\frac{|e_{V_i}|}{\Delta V_i}+\frac{|e_{\theta_i}|}{\Delta \theta_i}\right)\right),
\end{equation}
where $C$ is a positive constant. Intuitively, a larger $C$ means a higher probability with which the launched attack can be detected.

Since the bus voltage magnitudes and angles are in discretized states, instead of computing the power flow of line $ij$ directly from one specific state $(\bar{\bm{V}},\bar{\bm{\theta}})$, we can obtain the lower and upper bound of its absolute value, denoted as $P_{ij}^{\min}(\bar{\bm{V}},\bar{\bm{\theta}})$ and $P_{ij}^{\max}(\bar{\bm{V}},\bar{\bm{\theta}})$ respectively.
Since the reward results from a change in the congestion pattern, we define the reward as a function proportional to the gap between the line's flow limit and the power bounds with injected errors:
\begin{equation}\label{eqn: attack reward}
R_{ij}=
\begin{cases}
K_{ij}\times \left( P_{ij}^{\min}(\bar{\bm{V'}}, \bar{\bm{\theta'}})-P_{ij}^{\text{M}} \right)/P_{ij}^{\text{M}}, \\
\text{if}\enspace P_{ij}^{\min}(\bar{\bm{V'}}, \bar{\bm{\theta'}})>P_{ij}^{\text{M}}>P_{ij}^{\max}(\bar{\bm{V}},\bar{\bm{\theta}}); \\
K_{ij}\times \left( P_{ij}^{\text{M}}-P_{ij}^{\max}(\bar{\bm{V'}}, \bar{\bm{\theta'}}) \right)/P_{ij}^{\text{M}}, \\
\text{if}\enspace P_{ij}^{\min}(\bar{\bm{V}}, \bar{\bm{\theta}})>P_{ij}^{\text{M}}>P_{ij}^{\max}(\bar{\bm{V'}},\bar{\bm{\theta'}}).		
\end{cases}
\end{equation}
where $K_{ij}$ is the given reward weight of line $ij$, $P_{ij}^{\text{M}}$ is the power flow limit of line $ij$, $(\bar{\bm{V'}},\bar{\bm{\theta'}})$ is the resulting estimate of system states by injecting errors $(\bm{e_V},\bm{e_\theta})$ to $(\bar{\bm{V}},\bar{\bm{\theta}})$. 





The expected immediate reward from action $a$ at state $s$ is:
\begin{equation}\label{eqn: expected reward}
\begin{split}
R(s,a) & =\sum_{s'}P(s'|s,a)\times R(s'|s,a)\\
& =(1-p_d(s,a))\times \sum_{ij\in \Phi(s,a)}R_{ij}.
\end{split}
\end{equation}
where $\Phi(s,a)$ is the set of target lines. 

We assume the cost to intrude an accessible  measuring device is fixed and known to an intruder, denoted by $g_u$. Let $f(\Phi(s,a))$ denote the number of intruded measuring devices in attack $a$, the attack cost at state $s$ is:
\begin{equation}\label{Formula: attack cost}
G(s,a)=g_u\times f(\Phi(s,a)).
\end{equation}





\subsubsection{State Transition Probabilities}
We assume all measuring devices that are currently open to attack  will stay open without attack. An action $a$ at state $s$ is detected  with probability $p_d(s,a)$, and the intruded  devices will be protected as a whole in the next time step.  Each protected device will change to open in the next time step with a fixed probability $p_T$. Intuitively,  a smaller $p_T$ indicates that once protected, a device is more likely to stay inaccessible to intruders for a longer period of  time.  When $p_T=0$, it means the protected devices will no longer be accessible to intruders.

To model the dynamics of a power system, we assume each load in the system evolves independently as a Markov Chain \cite{MP94} and the system state is determined from economic dispatch. We assume each load has $n_L$ states and a load can transit from state $q_1$ to state $q_2$ with a fixed and known probability $p_{q_1,q_2}$. In practice, one can learn these transition probabilities from historical data. In this case, in a power network with $M$ buses and $N$ devices, if $M_L$ loads evolve as Markov Chains, the total number of system state is $n_L^{M_L}\times2^N$.




\subsection{MDP Solutions}\label{sec: MDP solution}
A linear programming approach \cite{FR03,MP94} is applied to solve MDP. A stationary policy $\pi$ for an MDP is a mapping $\pi: S\mapsto A$, where $\pi(s)$ is the action taken in state $s$. We define $W_\pi(s)$ as the cumulative expected net reward by starting from state $s$ and following policy $\pi$, 
\begin{equation}
W_\pi(s)=E \left[\sum_{t=0}^{\infty}\gamma^t\left(R(s_t,\pi(s_t))-G(s_t,\pi(s_t))|s_0=s\right)\right],
\end{equation}
where $\gamma \in [0,1)$ is the discount factor for future reward.
The value of state $s$ is the maximal cumulative reward, 
\begin{equation}\label{Formula: maximal accumulated reward}
W^*(s):=\max_{\pi\in \Pi}\,W_\pi(s),
\end{equation} 
where $\Pi$ is the set of all available policies. The policy that achieves the maximum in (\ref{Formula: maximal accumulated reward}) is the optimal policy $\pi^*$.  It is shown in  \cite{FR03} that  $W^*(s)$ is the optimal solution to  the following optimization problem:
\begin{equation}\label{Formula: initial LP}
	\begin{split}
		\min_Q & \sum_{s\in S} Q(s)\\
		\text{s.t.}\ & Q(s)\geq R(s,a)-G(s,a)+\gamma \sum_{s'} P(s'|s,a)Q(s')\\ & \qquad \qquad \forall a\in A(s),\ \forall s,s' \in S.
	\end{split}
\end{equation}
Therefore, we can find $W^*(s)$ by solving   (\ref{Formula: initial LP}) 
and compute $\pi^*(s)$ defined as 
\begin{equation}\label{eqn:astar}
\argmax_{a\in A(s)}(R(s,a)-G(s,a)+\gamma \sum_{s'} P(s'|s,a)W^*(s')).
\end{equation}
 The optimal attack strategy is a mapping between system state $s$ and the corresponding optimal action $\pi^*(s)$. An intruder can solve the MDP to obtain the strategy offline and then inject attacks accordingly in real-time operations.


\section{Simulation}\label{sec:simu}
We test our proposed method on the PJM 5-bus system. The basic system configuration and the generation bids, generation MW limits and MW loads are shown in Fig.~\ref{fig: PJM 5-bus system}. More details can be found in \cite{LR10}.
\vspace{-2mm}
\begin{figure}[h]
	\centering
\includegraphics[width=0.37\textwidth]{PJM_5_bus_system}
	\caption{The PJM 5-bus system } \vspace{-3mm}
	\label{fig: PJM 5-bus system}
\end{figure}

\noindent\textit{1) States of loads and transition probability.}
Each load is assumed to have 2 states. The loads in Fig.~\ref{fig: PJM 5-bus system} are the base case loads. Another state for each load is half of its base case. The transition probability from one state to another is 0.5. 

\noindent\textit{2) Measuring device transition probability.}
$p_T$ is set 0.5. The attack detection probability is calculated from (\ref{eqn: detection probability}).

\noindent\textit{3) Costs.}
 The number of target buses at each time step is at most one. The reward weight of each line is 1. The cost $g_u$ is set as 0.05.

\noindent\textit{4) Discount factor.}
The discount factor $\gamma=0.95$.

We solve the economic dispatch in MATPOWER toolbox in MATLAB. The power flow limit of each line is set 300 MW. We relax the constraint in economic dispatch from $P_{ij}\leq P_{ij}^{\text{M}}$ to $P_{ij}\leq 1.2 P_{ij}^{\text{M}}$. We set $V^{\max}=1.1$ p.u. (per unit), $V^{\min}=1.0$ p.u., $n_V=5$; $\Delta \theta=5\degree, n_{\theta}=10, \theta_i^{\max}$ and $\theta_i^{\min}$ are determined from the actual values of bus $i$ in eight load states.  For each discretized state, we calculate the lower and upper bounds of each line power flow. One line can be an available target line if the upper bound of its power flow is below the power limit or the lower bound is over the limit.

We solve (\ref{Formula: initial LP}) and (\ref{eqn:astar}) to obtain the optimal actions for $2^3\times 2^3=64$ states and compute the static distribution probabilities of all states. The attack probability of one line is computed as the sum of the distribution probabilities of the states under which the optimal action is to change the congestion pattern of that line. The intrusion probability of one device is the sum of the distribution probabilities of the states under which the optimal action requires manipulating partial or all measurement of that device. The results of the likelihood of data attacks are shown in Figs.~\ref{fig: Attack probabilities of lines} and \ref{fig: Intrusion probabilities of devices}.

\vspace{-2mm}
\begin{figure}[h]
	\centering
	\includegraphics[width=0.37\textwidth]{Attack_probability_lines}
	\caption{Attack probabilities of part of lines } \vspace{-3mm}
	\label{fig: Attack probabilities of lines}
\end{figure}
\vspace{-3mm}
\begin{figure}[h]
	\centering
	\includegraphics[width=0.37\textwidth]{Intrusion_probability_measuring_devices}
	\caption{Intrusion probabilities of measuring devices } \vspace{-3mm}
	\label{fig: Intrusion probabilities of devices}
\end{figure}

Generally, as $C$ increases, the attack probability of each line and each measuring device decreases. When $C=0$, it means the launched attack cannot be detected by network operators. In this case, the intruders always choose the action that brings about the maximal immediate net reward. When $C\geq 4$, the net expected reward for each action is negative, hence the optimal action for all states is no attack.  


\section{Conclusion and Discussions}\label{sec:con}
We for the first time analyze the likelihood of cyber data attacks to power systems. We model an intruder's attack strategy as a Markov Decision Process (MDP). We compute the optimal attack action at a given power system state from an intruder's perspective. We study the likelihood of cyber data attacks on a small system through simulation.
One ongoing work is to apply the method to likelihood analysis of cyber data attacks on larger power systems.

\section*{Acknowledgement}
This research is supported in part by the ERC Program of NSF and DoE under the supplement to 
NSF Award   EEC-1041877 and the CURENT Industry Partnership
Program, and in part by NYSERDA Grants  \#36653 and \#28815. 
\bibliographystyle{IEEEtranS}\vspace{-3 mm}

\begin{thebibliography}{10}
\providecommand{\url}[1]{#1}
\csname url@samestyle\endcsname
\providecommand{\newblock}{\relax}
\providecommand{\bibinfo}[2]{#2}
\providecommand{\BIBentrySTDinterwordspacing}{\spaceskip=0pt\relax}
\providecommand{\BIBentryALTinterwordstretchfactor}{4}
\providecommand{\BIBentryALTinterwordspacing}{\spaceskip=\fontdimen2\font plus
\BIBentryALTinterwordstretchfactor\fontdimen3\font minus
  \fontdimen4\font\relax}
\providecommand{\BIBforeignlanguage}[2]{{\expandafter\ifx\csname l@#1\endcsname\relax
\typeout{** WARNING: IEEEtranS.bst: No hyphenation pattern has been}\typeout{** loaded for the language `#1'. Using the pattern for}\typeout{** the default language instead.}\else
\language=\csname l@#1\endcsname
\fi
#2}}
\providecommand{\BIBdecl}{\relax}
\BIBdecl

\bibitem{AE04}
A.~Abur and A.~G. Exposito, \emph{Power system state estimation: theory and
  implementation}.\hskip 1em plus 0.5em minus 0.4em\relax CRC Press, 2004.

\bibitem{BRWKNO10}
R.~B. Bobba, K.~M. Rogers, Q.~Wang, H.~Khurana, K.~Nahrstedt, and T.~J.
  Overbye, ``Detecting false data injection attacks on \mbox{DC} state
  estimation,'' in \emph{Proc. the First Workshop on Secure Control Systems
  (SCS)}, 2010.

\bibitem{CA06}
J.~Chen and A.~Abur, ``Placement of \mbox{PMUs} to enable bad data detection in
  state estimation,'' \emph{{IEEE} Trans. Power Syst.}, vol.~21, no.~4, pp.
  1608--1615, 2006.

\bibitem{DS10}
G.~D\'{a}n and H.~Sandberg, ``Stealth attacks and protection schemes for state
  estimators in power systems,'' in \emph{Proc. IEEE International Conference
  on Smart Grid Communications (SmartGridComm)}, 2010, pp. 214--219.

\bibitem{FR03}
D.~P. de~Farias and B.~Van~Roy, ``The linear programming approach to
  approximate dynamic programming,'' \emph{Operations Research}, vol.~51,
  no.~6, pp. 850--865, 2003.

\bibitem{HSKF75}
E.~Handschin, F.~Schweppe, J.~Kohlas, and A.~Fiechter, ``Bad data analysis for
  power system state estimation,'' \emph{{IEEE} Trans. Power App. Syst.},
  vol.~94, no.~2, pp. 329--337, 1975.

\bibitem{JKT14}
L.~Jia, J.~Kim, R.~J. Thomas, and L.~Tong, ``Impact of data quality on
  real-time locational marginal price,'' \emph{Power Systems, IEEE Transactions
  on}, vol.~29, no.~2, pp. 627--636, 2014.

\bibitem{KP11}
T.~Kim and H.~Poor, ``Strategic protection against data injection attacks on
  power grids,'' \emph{{IEEE} Trans. Smart Grid}, vol.~2, no.~2, pp. 326--333,
  2011.

\bibitem{KJTT10}
O.~Kosut, L.~Jia, R.~Thomas, and L.~Tong, ``Malicious data attacks on smart
  grid state estimation: Attack strategies and countermeasures,'' in
  \emph{Proc. IEEE International Conference on Smart Grid Communications
  (SmartGridComm)}, 2010, pp. 220--225.

\bibitem{LR10}
F.~Li and R.~Bo, ``Small test systems for power system economic studies,'' in
  \emph{Power and Energy Society General Meeting, 2010 IEEE}.\hskip 1em plus
  0.5em minus 0.4em\relax IEEE, 2010, pp. 1--4.

\bibitem{LEDEH14}
L.~Liu, M.~Esmalifalak, Q.~Ding, V.~A. Emesih, and Z.~Han, ``Detecting false
  data injection attacks on power grid by sparse optimization,'' \emph{{IEEE}
  Trans. Smart Grid}, vol.~5, no.~2, pp. 612--621, 2014.

\bibitem{LNR11}
Y.~Liu, P.~Ning, and M.~K. Reiter, ``False data injection attacks against state
  estimation in electric power grids,'' \emph{ACM Transactions on Information
  and System Security (TISSEC)}, vol.~14, no.~1, p.~13, 2011.

\bibitem{MS71}
H.~M. Merrill and F.~C. Schweppe, ``Bad data suppression in power system static
  state estimation,'' \emph{{IEEE} Trans. Power App. Syst.}, no.~6, pp.
  2718--2725, 1971.

\bibitem{MG83}
A.~Monticelli and A.~Garcia, ``Reliable bad data processing for real-time state
  estimation,'' \emph{{IEEE} Trans. Power App. Syst.}, no.~5, pp. 1126--1139,
  1983.

\bibitem{MP94}
M.~L. Puterman, ``Markov decision processes: Discrete stochastic dynamic
  programming,'' 1994.

\bibitem{STJ10}
H.~Sandberg, A.~Teixeira, and K.~H. Johansson, ``On security indices for state
  estimators in power networks,'' in \emph{Proc. the First Workshop on Secure
  Control Systems (SCS)}, 2010.

\bibitem{SJ13}
H.~Sedghi and E.~Jonckheere, ``Statistical structure learning of smart grid for
  detection of false data injection,'' in \emph{Proc. IEEE Power and Energy
  Society General Meeting (PES)}, 2013, pp. 1--5.

\bibitem{TKPC11}
A.~Tajer, S.~Kar, H.~V. Poor, and S.~Cui, ``Distributed joint cyber attack
  detection and state recovery in smart grids,'' in \emph{Proc. IEEE
  International Conference on Smart Grid Communications (SmartGridComm)}, 2011,
  pp. 202--207.

\bibitem{WGGCFSR14}
M.~Wang, P.~Gao, S.~Ghiocel, J.~H. Chow, B.~Fardanesh, G.~Stefopoulos, and
  M.~P. Razanousky, ``Identification of "unobservable" cyber data attacks on
  power grids,'' in \emph{Proc. IEEE SmartGridComm}, 2014.

\bibitem{XMS11}
L.~Xie, Y.~Mo, and B.~Sinopoli, ``Integrity data attacks in power market
  operations,'' \emph{{IEEE} Trans. Smart Grid}, vol.~2, no.~4, pp. 659--666,
  2011.

\bibitem{XWCT13}
W.~Xu, M.~Wang, L.~Lai, and A.~Tang, ``Sparse error correction from nonlinear
  measurements with applications in bad data detection for power networks,''
  \emph{{IEEE} Trans. Signal Process.}, vol.~61, no.~24, pp. 6175--6187, 2013.
\end{thebibliography}
\end{document}