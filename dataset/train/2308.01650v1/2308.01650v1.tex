\documentclass[review]{elsarticle}

\usepackage{lineno,hyperref}
\usepackage{amssymb,amsmath,amsthm}
\usepackage{cleveref}
\usepackage{color}
\usepackage{subfigure}
\usepackage{bm}
\usepackage{framed}
\usepackage{booktabs}
\usepackage{color}
\newtheorem{definition}{Definition}
\newtheorem{lemma}{Lemma}
\newtheorem{theorem}{Theorem}
\newtheorem{corollary}{Corollary}
\modulolinenumbers[5]
\definecolor{shadecolor}{rgb}{0.92,0.92,0.92}
\allowdisplaybreaks[2]

\journal{}









\usepackage{numcompress}\bibliographystyle{model3-num-names}









\begin{document}

\begin{frontmatter}

\title{UniG-Encoder: A Universal Feature Encoder for Graph and Hypergraph Node Classification}

\author[mymainaddress]{Minhao Zou}

\author[mymainaddress]{Zhongxue Gan\corref{mycorrespondingauthor}}
\ead{ganzhongxue@fudan.edu.cn}

\author[mymainaddress]{Yutong Wang}

\author[mymainaddress]{Junheng Zhang}

\author[mymainaddress]{Dongyan Sui}

\author[mymainaddress]{Chun Guan\corref{mycorrespondingauthor}}
\ead{chunguan@fudan.edu.cn}

\author[mymainaddress,iics]{Siyang Leng\corref{mycorrespondingauthor}}
\cortext[mycorrespondingauthor]{To whom correspondence should be addressed.}
\ead{syleng@fudan.edu.cn}

\address[mymainaddress]{Institute of AI and Robotics, Academy for Engineering and Technology, Fudan University, Shanghai 200433, China}
\address[iics]{Research Institute of Intelligent Complex Systems, Fudan University, Shanghai 200433, China}

\begin{abstract}
Graph and hypergraph representation learning has attracted increasing attention from various research fields. Despite the decent performance and fruitful applications of Graph Neural Networks (GNNs), Hypergraph Neural Networks (HGNNs), and their well-designed variants, on some commonly used benchmark graphs and hypergraphs, they are outperformed by even a simple Multi-Layer Perceptron. This observation motivates a reexamination of the design paradigm of the current GNNs and HGNNs and poses challenges of extracting graph features effectively. In this work, a universal feature encoder for both graph and hypergraph representation learning is designed, called UniG-Encoder. The architecture starts with a forward transformation of the topological relationships of connected nodes into edge or hyperedge features via a normalized projection matrix. The resulting edge/hyperedge features, together with the original node features, are fed into a neural network. The encoded node embeddings are then derived from the reversed transformation, described by the transpose of the projection matrix, of the network's output, which can be further used for tasks such as node classification. The proposed architecture, in contrast to the traditional spectral-based and/or message passing approaches, simultaneously and comprehensively exploits the node features and graph/hypergraph topologies in an efficient and unified manner, covering both heterophilic and homophilic graphs. The designed projection matrix, encoding the graph features, is intuitive and interpretable. Extensive experiments are conducted and demonstrate the superior performance of the proposed framework on twelve representative hypergraph datasets and six real-world graph datasets, compared to the state-of-the-art methods. Our implementation is available online at \url{https://github.com/MinhZou/UniG-Encoder}.
\end{abstract}

\begin{keyword}
Graph and hypergraph\sep Representation learning\sep Homophily and heterophily\sep Node classification\sep Feature projection
\end{keyword}

\end{frontmatter}



\section{Introduction}
Graph and hypergraph representation learning is a rapidly growing field of research that focuses on learning meaningful representations from nodes and edges/hyperedges features in graph/hypergraph-structured data. This field has seen significant progress in recent years due to the development of advanced techniques such as Graph Neural Networks (GNNs) and Hypergraph Neural Networks (HGNNs), which are capable of modeling complex interactions in real-world scenarios. Particularly, HGNNs are designed to extend GNNs to capture higher-order relationships among more than two nodes, which are ubiquitous in social networks~\cite{patania2017shape,qiu2023closed}, ecological networks~\cite{bairey2016high}, biological networks~\cite{petri2014homological}, etc. A fundamental task in graph/hypergraph representation learning is node classification that categorizing nodes based on their features and graph/hypergraph topologies.

Most of the existing literatures stick to learning node embeddings from neighbors using powerful neural operators, such as convolution~\cite{kipf2016semi, ma2019graph, yadati2019hypergcn}, attention~\cite{velickovic2017graph, georgiev2022heat,zou2023similarity}, spectrum~\cite{zien1999multilevel, sun2008hypergraph}, and diffusion~\cite{wang2022equivariant}. These approaches have resulted in the popular spectral-based and message passing architectures~\cite{huang2021unignn, feng2019hypergraph, gao2022hgnn, chien2021you}. Despite their wide applications, these approaches have limitations, as a simple Multi-Layer Perceptron (MLP) can even outperform well-designed GNNs, HGNNs, and their variants on some commonly used benchmark graphs and hypergraphs, see the results in Table \ref{table: acc-1} for \texttt{Zoo}, \texttt{House}, \texttt{Senate}, \texttt{Cornell}, \texttt{Texas}, and \texttt{Wisconsin} datasets. The major drawback of the spectral-based architecture is its heavy reliance on the homophily assumption, which requires that nodes with similar features and/or labels tend to be linked. The message passing architecture conducts aggregation on the raw node embeddings or considers only the node-to-edge then edge-to-node mapping procedure, which can lead to suboptimal performance in some cases. To address these issues, a new approach, called UniG-Encoder, is proposed which simultaneously and comprehensively exploits the node features and graph/hypergraph topologies.


Drawing inspiration from Hypergraph Line Expansion~\cite{yang2022semi}, which treats nodes and edges equally and converts hyperedges into ``line nodes'', our architecture leverages these approaches by treating edges/hyperedges as additional nodes and extracting their features from the topological relationships of the connected nodes. Edges/hyperedges that connect two or more nodes are transformed into additional feature vectors, enabling tuning the weights between node features and graph structure based on the homophilic extent thus alleviating the curse of heterophily. This is efficiently accomplished by using a normalized projection matrix, linearly combining the features of connected nodes and resulting the edge/hyperedge features. These generated features, together with the original node features, are fed into a neural network, e.g., MLP, Transformer~\cite{vaswani2017attention}, etc., and its output is processed via a reversed transformation, aggregating neighborhood features by the transpose of the projection matrix, to obtain the encoded node embeddings, which can be further used for tasks such as node classification. The proposed framework is demonstrated by extensive experiments to outperform the state-of-the-art methods on eighteen benchmark datasets with diverse properties. We summarize the main contributions of our work as:
\begin{itemize}
\item A universal framework UniG-Encoder is proposed towards representation learning for both graphs and hypergraphs, covering also both heterophilic and homophilic circumstances by leveraging simultaneously the information of node features and topology.
\item The architecture is realized via an intuitive and interpretable normalized projection matrix, enabling tuning the weights between node features and graph structure based on the homophilic extent, which can be easily acquired from \textit{a priori} knowledge of datasets.
\item The designed architecture involves minor computation consumption but achieves superior performance over the state-of-the-art methods on representative datasets, supported by extensive analysis and experiments.
\end{itemize}

\section{Related Works}

\textbf{Graph and Hypergraph Neural Networks.} GNNs and HGNNs learn informative graph/hypergraph embeddings by leveraging the node features and structure. Various variants of GNNs and HGNNs have been developed, and we review the most recent advances here.

Spectral-based approaches interpret graph convolution from the perspective of graph signal processing, with the aim of removing noise from graph signals or smoothing information among connected nodes. GCN~\cite{kipf2016semi} applies convolutional operation in the spectral domain to input features, generating node embeddings for node classification and other downstream tasks. Building upon GCN, GCNII~\cite{chen2020simple} employs initial residual and identity mapping to effectively alleviate the over-smoothing problem. The spectral-based approach has also been extended to deal with hypergraphs, such as HyperGCN~\cite{yadati2019hypergcn}.

Spatial-based approaches aggregate messages from neighboring nodes via message passing layers, known as Message Passing Neural Networks (MPNNs)~\cite{gilmer2017neural}. GraphSAGE~\cite{hamilton2017inductive} generates node embeddings by aggregating information from a fixed number of neighbors. In contrast, GAT~\cite{velickovic2017graph} uses an attention mechanism to weigh the contributions of neighboring nodes and aggregates information from these neighbors based on learned weights. Many GNNs have also been developed for heterophilic problem, such as H2GCN~\cite{zhu2020beyond}, GGCN~\cite{yan2022two}, and GloGNN~\cite{li2022finding}. In hypergraph representation learning, many works use a two-stage message passing process, such as HGNN~\cite{feng2019hypergraph}, AllSet (AllDeepSets and AllSetTransformer)~\cite{chien2021you}, and UniGCNII~\cite{huang2021unignn}. In most cases when the number of edges is significantly larger than the number of nodes, these two-stage methods suffer from computational burden due to enormous intermediate edge embeddings.

\textbf{Hypergraph Expansion.} In the realm of hypergraph analysis, a technique known as hypergraph expansion is often used to transform hypergraphs into graphs. One prominent algorithm for hypergraph expansion is the clique expansion~\cite{sun2008hypergraph}, which generates a graph from hypergraph by substituting each hyperedge with a clique in the resulting graph. Another approach, known as the star expansion algorithm~\cite{zien1999multilevel}, creates a graph by introducing a new vertex for every hyperedge, which is connected to each vertex in the hyperedge. Line expansion~\cite{yang2022semi} simplifies the hypergraph by treating nodes and hyperedges as equivalent, representing each vertex-hyperedge incident pair as a ``line node''. The expansion methods also bring in additional computational burden due to an extra number of edges expanded from hyperedges.

\section{Preliminaries}
In this section, essential concepts, definitions, and notations pertaining to GNNs and HGNNs are presented.

A universal representation learning framework for both graphs and hypergraphs is proposed in this work, so we adopt a unified representation for them here. Both edges and hyperedges are defined as subsets of nodes, while an edge is a subset with two elements and a subset of hyperedge contains more than two nodes. Therefore, let  denote a graph or hypergraph, where  is the set of all nodes, and  is the set of edges or hyperedges defined above.

For an arbitrary set , the cardinality of it is denoted by . A graph or hypergraph  can be characterized by a  incidence matrix , where  with node  and edge/hyperedge . For  and , their degrees are defined as  and , respectively.  and  denote the diagonal matrices of node degrees and edge degrees, respectively. The raw node features is described by matrix , where the -th row vector  denotes the {\it ego-feature} of node  and  is the dimension of features.

\section{Methods}

We illustrate here the general architecture of UniG-Encoder for both graph and hypergraph representation learning. The key component lies in a normalized projection matrix that first forwardly converts the topological relationships of connected nodes into edge or hyperedge features. The resulting edge/hyperedge features, together with the original node features, are fed into a neural network. In this work, we use a simple MLP to process these features. The encoded node embeddings are then derived from the reversed transformation, described by the transpose of the projection matrix, of the MLP's output, which are subsequently used for node classification task. The architecture of UniG-Encoder is summarized in Figure \ref{fig: architecture}, with the detailed components described in the following subsections.

\begin{figure*}[htbp]
  \centering
  \includegraphics[width=1.0\textwidth]{architecture.pdf}
  \caption{\textbf{The architecture of UniG-Encoder.} The architecture starts with a forward transformation of the topological relationships of connected nodes into edge or hyperedge features via a normalized projection matrix. The resulting edge/hyperedge features, together with the original node features, are fed into a neural network. The encoded node embeddings are then derived from the reversed transformation, described by the transpose of the projection matrix, of the network's output, which can be further used for tasks such as node classification. Notably, the MLP can be substituted by advanced neural networks such as the Transformer.}
  \label{fig: architecture}
\end{figure*}

\subsection{Forward Projection}

\textbf{Projected Set.} Let  denote the set induced by the projection matrix from the graph/hypergraph , which is an ordered set consisting of two parts. The first part is a permutation of the node set  and the second part denotes the transformed edge/hyperedge set, while the features of the projected set are obtained from the raw node features with the projection matrix  acting on them.


\textbf{Projection Matrix.} We introduce a seminal version of the projection matrix here, whereas it can be redesigned to accommodate different homophilic extents of the graphs/hypergraphs. The projection matrix  is the row-wise concatenation of two matrices: the node part  and the edge/hyperedge part . The former is of size , which is a column-wise permutation of the unit matrix . The latter  is of size , whose element  equals to  if  and whose other elements are all zero. Therefore, . The above forward projection procedure satisfies the following theorem:

\textbf{Theorem 1.} Assume there is no duplicate edge/hyperedge in a given graph/hypergraph . One can construct a map , which is bijective under the construction according to the above corresponding relations as the projection matrix , and its inverse exists. This means that each node and edge/hyperedge in  is uniquely mapped to an element in , and vice versa.







\subsection{Feature Projection}

The projection matrix  in fact provides a new method for generating edge/hyperedge features by linearly combining the features of connected nodes, called feature projection. These resulting features, together with the original node features, are subsequently fed as input to an MLP to obtain new embeddings. Notably, the MLP can be replaced by other neural network architectures, such as RNN or Transformer, thereby enhancing the flexibility and adaptability of out framework in different application scenarios.

Concretely, for a graph/hypergraph , the projection matrix  is acted on the original node features , yielding the feature vectors of the projected set , i.e., . In fact,  is the concatenation of the permutated node \textit{ego-features} and the generated edge/hyperedge features. Subsequently,  is fed into an -layer neural network and the embedding for its -th layer is denoted by .

\subsection{Reversed Projection}

The output of the neural network  is then reversely transformed by the transpose of the projection matrix, i.e., . In fact, . Thus the encoded node embeddings used for classification can be obtained by , where  denotes the number of final features. The resulting rows of  are obtained by taking a weighted summation of the corresponding rows of , where the weights are given by the nonzero elements in each row of . Here, the matrix  is used to extract representations from the \textit{ego-embeddings}, while  is used to extract representations from the edge/hyperedge embeddings. This operation represents an extension of the aggregation process from neighbors in message passing architecture or the spectral filter in spectral-based architecture, which simultaneously leverages both node embeddings and edge/hyperedge embeddings. The procedures satisfy the following theorem:

\textbf{Theorem 2.} Let  be an arbitrary permutation, thus , where . It can be concluded that  if and only if  or  such that  and .

This theorem guarantees the exact correspondence during the projection process, that is, the encoded embeddings for node  exactly contains the information from the raw features of node  and the features of edges/hyperedges containing .

\subsection{Normalization}

The defined projection matrix and its transpose are normalized in this framework. During the forward projection, the rows of  are obtained by taking a weighted summation of the corresponding rows of , where the weights are given by the nonzero elements in each row of . The intuition lies in that  is used to fuse the features of connected nodes into the features of edges/hyperedges. Therefore, row normalization needs to be performed on , i.e.,

Row normalization is also used for the reversed transformation described by , i.e.,

After normalization, the embeddings of nodes and the embeddings of edges/hyperedges they belong to are fused by weighted summation into the final encoded embeddings. We also try different normalization methods that trading-off the weights between node features and edge/hyperedge features in the experiments and compare their impacts.

\section{Experiments}

\subsection{Datasets}

Our framework is designed to accommodate both graphs and hypergraphs. To demonstrate its effectiveness, extensive experiments are conducted on various benchmark datasets. We briefly introduce the datasets used in this work, with their detailed information listed in Appendix.

\textbf{Graph Datasets.} Six real-world graph datasets with different homophilic extents are used and their statistics are listed in Table \ref{table:stat graph}.

\begin{table}[htbp]
  \centering
  \caption{\textbf{Statistics of six graph datasets.}}
  \resizebox{0.7\textwidth}{!}{\label{table:stat graph}
  \begin{tabular}{cccccccccccccccccc}
  \toprule
  Dataset         & \texttt{CiteSeer} & \texttt{Cora}  & \texttt{PubMed}  & \texttt{Cornell} & \texttt{Texas}  & \texttt{Wisconsin} \\
  \midrule
   & 3,327    & 2,708 & 19,717  & 183     &  183   & 251    \\
   & 4,676    & 5,278 & 44,327  & 280     &  295   & 466    \\
  \#Features      & 3,703    & 1,433 & 500     & 1,703   &  1,703 & 1,703  \\
  \#Classes       & 7        & 6     & 3       & 5       &   5    & 5      \\
  Homophily Score             & 0.74     & 0.81  & 0.80    & 0.30    & 0.11   & 0.21   \\
  \bottomrule
  \end{tabular}}
\end{table}

\textbf{Hypergraph Datasets.} Twelve benchmark hypergraph datasets are used in this work with diverse scales, structures, and homophilic extents. Their statistics are listed in Table \ref{table:stat hyper}.

\begin{table}[htbp]
  \centering
  \caption{\textbf{Statistics of twelve hypergraph datasets.}}
  \label{table:stat hyper}
  \resizebox{\textwidth}{!}{\begin{tabular}{cccccccccccccc}
    \toprule
    Dataset         & \texttt{Cora} & \texttt{Citeseer} & \texttt{Pubmed} & \texttt{Cora-CA} & \texttt{DBLP-CA} & \texttt{ModelNet40} & \texttt{NTU2012} & \texttt{House} & \texttt{Zoo}   & \texttt{20News} & \texttt{Yelp}   & \texttt{Senate} \\
    \midrule
     & 2,708 & 3,312     & 19,717  & 2,708    & 41,302   & 12,311      & 2,012    & 1,290  & 101   & 16,242  & 50,758  & 282 \\
     & 1,579 & 1,079     & 7,963   & 1,072    & 22,363   & 12,311      & 2,012    & 341   & 42    & 100    & 679,302 & 315 \\
    \#Features      & 1,433 & 3,703     & 500    & 1,433    & 1,425    & 100        & 100     & 100   & 16    & 100    & 1,862   & 2 \\
    \#Classes        & 7    & 6        & 3      & 7       & 6       & 40         & 67      & 2     & 7     & 4      & 9      & 2 \\
Homophily Score    & 0.897&0.893     &0.952   &0.803    & 0.869   & 0.853      & 0.752   & 0.509 & 0.241 & 0.461  & 0.226  & 0.498 \\
    \bottomrule
  \end{tabular}
  }
\end{table}

\subsection{Baselines and Settings}

We compare our UniG-Encoder framework with several classic graph-oriented models, including (1) MLP; (2) general GNN methods: GCN~\cite{kipf2016semi}, GAT~\cite{velickovic2017graph}, GCNII~\cite{chen2020simple}, GraphSAGE~\cite{hamilton2017inductive}; (3) heterophily-oriented methods: H2GCN~\cite{zhu2020beyond}, GGCN~\cite{yan2022two}, GloGNN~\cite{li2022finding}, across various benchmark datasets. To conduct these experiments, we adopt ten random splits with a ratio of 48\%/32\%/20\% of nodes per class for training/validation/test, as previously established in~\cite{li2022finding}. We evaluate the performance by computing the overall mean accuracy and standard deviation on the test sets over the ten splits.

We also present a comparative analysis of our proposed framework UniG-Encoder against several state-of-the-art models on hypergraph benchmarks, including HGNN~\cite{feng2019hypergraph}, HCHA~\cite{bai2021hypergraph}, HNHN~\cite{dong2020hnhn}, HyperGCN~\cite{yadati2019hypergcn}, UniGCNII~\cite{huang2021unignn}, AllSet (AllDeepSets and AllSetTransformer)~\cite{chien2021you}, ED-HNN~\cite{wang2022equivariant}, and LE-GCN~\cite{yang2022semi}. To ensure a fair comparison, we follow the experimental protocols of ED-HNN for the hypergraph datasets experiments. Specifically, we split the data into training, validation, and test sets in a 50\%/25\%/25\% ratio, as suggested in~\cite{chien2021you}. We adopt prediction accuracy as evaluation metric and run each model ten times with different training and validation splits to obtain the mean accuracy and standard deviation.

\section{Results and Analysis}

\textbf{Overall Performance Analysis.} We present our experimental results on six graph datasets in Table \ref{table: acc-2}. It is noted that general GNN models such as GCN, GAT, GCNII, and GraphSAGE perform well on homophilic datasets such as \texttt{CiteSeer}, \texttt{Cora}, and \texttt{PubMed}, but their performance deteriorates on heterophilic datasets such as \texttt{Cornell}, \texttt{Texas}, and \texttt{Wisconsin}, even outperformed by simple models such as MLP. Our proposed framework not only achieves competitive performance compared to general GNNs, but also outperforms some heterophily-oriented models such as H2GCN, GGCN, and GloGNN, by adjusting the weights in the projection matrix . Details on this adjustment can be found in Appendix.

\begin{table}[htbp]
  \centering
  \caption{\textbf{Results on graphs.} Mean accuracy (\%)  standard deviation is shown for each method. For each dataset, we mark the winner's score in bold and highlight the runner-up's with underline.}
  \label{table: acc-2}
  \resizebox{1.0\textwidth}{!}{\begin{tabular}{ccccccc}
    \toprule
    Graph    & \texttt{CiteSeer}         & \texttt{Cora}             & \texttt{PubMed}           & \texttt{Cornell}   & \texttt{Texas}        & \texttt{Wisconsin} \\
    \midrule
    MLP       &  &  &  &  &  &  \\
    GCN       &  &  &  &  &  &  \\
    GCNII     &  &  &  &  &  &  \\
    GraphSAGE &  &  &  &  &  &  \\
    GAT       &  &  &  &  &  &  \\
H2GCN     &  &  &  &  &  &  \\
    GGCN      &  &  &  &  &  &  \\
    GloGNN &  &  &  &  &  &  \\
    \midrule
    UniG-Encoder &   &  &  &  &  &  \\
    \bottomrule
  \end{tabular}
  }
\end{table}

Table \ref{table: acc-1} illustrates the results of our comparative analysis, demonstrating that our proposed UniG-Encoder well performs on all twelve hypergraph datasets, compared to existing models, ranking 1st in 6/12 datasets and 2nd in 4/12 datasets. The top-performing baseline models include AllSetTransformer, ED-HNN, MLP, and LEGCN, etc. However, their performance varies significantly across different datasets. For instance, AllSetTransformer, AllDeepSets, UniGCNII, and ED-HNN exhibit promising results on homophilic hypergraph datasets such as citation networks, but their performance are subpar on heterophilic datasets, such as \texttt{House} and \texttt{Senate}, where MLP and LEGCN perform much better. In contrast, our framework achieves consistently superior results. The out-of-memory (OOM) issue in LE-GCN is caused by line expansion, which generates ``line nodes'' from hyperedges. In datasets such as \texttt{Yelp}, which contain a large number of hyperedges, OOM error may also occur due to memory constraint.

\begin{table}[htbp]
  \centering
  \caption{\textbf{Results on hypergraphs.} Mean accuracy (\%)  standard deviation is shown for each method. For each dataset, we mark the winner's score in bold and highlight the runner-up's with underline. ``OOM'' denotes out-of-memory issue.}
  \label{table: acc-1}
  \resizebox{1.0\textwidth}{!}{\begin{tabular}{ccccccc}
    \toprule
    Hypergraph & \texttt{Cora}             & \texttt{Citeseer}         & \texttt{Pubmed}           & \texttt{Cora-CA}          & \texttt{DBLP-CA}          & \texttt{ModelNet40}\\
    \midrule
    HGNN        &  &  &  &  &  &   \\
    HCHA        &  &  &  &  &  &   \\
    HNHN        &  &  &  &  &  &   \\
    HyperGCN    &  &  &  &  &  &   \\
    UniGCNII    &  &  &  &  &  &   \\
    AllDeepSets &  &  &  &  &  &   \\
    AllSetTransformer  &  &  &  &  &  &    \\
    ED-HNN &  &  &  &  &  &   \\
    LE-GCN &  &  &  &  &  &   \\
    MLP &  &   &  &  &  &  \\
    \midrule
    UniG-Encoder &  &   &  &  &  &   \\
    \bottomrule
    \toprule
    Hypergraph & \texttt{NTU2012}          & \texttt{Zoo}       & \texttt{20Newsgroups}     & \texttt{Yelp}             & \texttt{House}            & \texttt{Senate} \\
    \midrule
    HGNN        &  &  &  &  &  &  \\
    HCHA        &  &  &  &   &  &  \\
    HNHN        &  &  &  &  &  &  \\
    HyperGCN    &  &  &  &  &  &  \\
    UniGCNII    &  &  &  &  &  &  \\
    AllDeepSets &  &  &  &  &  &  \\
    AllSetTransformer &  &  &  &  &  &   \\
    ED-HNN &  &  &  &  &  &  \\
    LE-GCN  &  &  &  & OOM &  &  \\
    MLP     &   &  &  &  &  &  \\
    \midrule
    UniG-Encoder &   &  &  &  &  &  \\
    \bottomrule
  \end{tabular}
  }
\end{table}

\textbf{Impacts of Normalization.} We compare five types of normalization here, including (1) no normalization for  and , (2) row normalization for  and , (3) column normalization for  and , (4) row normalization for  and column normalization for , and (5) column normalization for  and row normalization for . We conduct experiments on the \texttt{Cora} hypergraph dataset. It is indicated that normalizing  and  by row produces the best results (, , , ,  for types (1)-(5) respectively). This finding is also consistent with our design of , which represents a weighted average on edges/hyperedges, while  is used to aggregate the embeddings of the nodes and their neighbors.

\textbf{Impacts of weight on .} Our UniG-Encoder enables tuning the weight on  to accommodate various scenarios, especially with different homophilic extents. Heterophily refers to a situation where a node's neighbors are substantially different from the node itself. In this case, when performing operations such as summation or averaging on the features of a node and its neighbors, the \textit{ego-feature} should dominate. In our approach, this can be simply realized by modifying the nonzero values in  to control the weights of features from the node itself and its neighbors. This technique also enables a performance enhancement of our framework on heterophilic datasets. To validate, we conduct experiments on both real-world datasets and synthetic datasets obtained from \texttt{Texas}. The results are depicted in Figure \ref{fig:q1}. As illustrated in Figure \ref{fig:q1}(a), for datasets \texttt{Pubmed}, \texttt{Cora}, and \texttt{Citeseer} with high degree of homophily, the variation in the nonzero values of  has minor impact on their performance in the node classification task. This result aligns with our intuition that when a node and its neighbors have consistent features, the contribution of neighbors to the aggregated embeddings should be similar to that of the node itself. However, in a heterophilic graph where nodes and their neighbors have different categories, achieving better classification performance requires a trade-off between \textit{ego-features} and the features of neighbors. Consequently, excessively small or large nonzero values in  will both result in suboptimal accuracy, as depicted in Figure \ref{fig:q1}(b).

\begin{figure}[htbp]
  \centering
\subfigure[Real-World Datasets]{
      \includegraphics[width=0.43\textwidth]{pv_value.pdf}
  }\hspace{8mm}
  \subfigure[Synthetic \texttt{Texas} Datasets]{
      \includegraphics[width=0.43\textwidth]{pv_value_syn.pdf}
  }
\caption{\textbf{Performance with different nonzero values in .} The legends in (b) correspond to the Homophily Scores of the synthetic datasets.}
  \label{fig:q1}
\end{figure}

\textbf{Impacts of Projection Placement.} In fact, the projection operation with its reverse in our framework can be placed at any layer of the neural network pipeline. We present experiments placing projection and its reverse (denoted by ``'') at different layers of a three-layer MLP, and the results are shown in Table \ref{table: ab-3}. Although the effect of placing projection at different layers is not that significant, we emphasize that two variants,  and , which in fact successively execute forward projection and its reverse by multiplying the embeddings by , which can be regarded as a decomposition of the adjacency matrix~\cite{yang2015network,huang2017accelerated}, practically do not increase the time complexity. It is worth noting that the framework can be easily extended to utilize multi-hop neighborhood information by using multiple .

\begin{table}[htbp]
  \centering
  \caption{\textbf{Results of different projection placement.}}
  \label{table: ab-3}
  \resizebox{0.8\textwidth}{!}{\begin{tabular}{ccccc}
    \toprule
    Variant    &  \texttt{Cora}   & \texttt{Citeseer}  &  \texttt{Pubmed}  & \texttt{House} \\
    \midrule
    No Projection &  &  &  &  \\
     \&  &  &  &  &  \\
     \&  &  &  &  &  \\
     \&  &  &  &  & \\
     \&  &  &  &  & \\
     \&  &  &  &  &  \\
     \&  &  &  &  &  \\
\bottomrule
  \end{tabular}
  }
\end{table}

\textbf{Complexity Analysis.} Generally, the proposed framework has a similar computing complexity as the used neural network, such as MLP, Transformer. The extra computing consumption is brought in by the dimension increase between the forward projection and its reverse. Therefore, as mentioned above, if we place the forward projection and its reverse adjacently, i.e., multiplying the embeddings directly by , no extra complexity exists.

\section{Conclusion}

In this study, we propose a new universal architecture for both graph and hypergraph representation learning, called UniG-Encoder. In contrast to the traditional spectral-based and/or message passing approaches, our proposed framework simultaneously and comprehensively exploits the node features and graph/hypergraph topologies in an efficient and unified manner, covering both heterophilic and homophilic graphs. The designed projection matrix, serving as key encoder to the graph features, is intuitive and interpretable. We conduct experiments on various graph and hypergraph datasets with different scales, structures, and homophilic extents. The experimental results and comparisons with the state-of-the-art methods demonstrate superior performance of the proposed UniG-Encoder. The framework can lead to potential applications in many tasks, such as graph classification and link prediction.

\appendix
\section{Proofs}

\subsection{Proof of Theorem 1}

\textit{Proof.} Let  be an arbitrary permutation. The map  can be constructed as follows: for , let ; for , let . As there is no duplicate edge/hyperedge in , it is clear that  and  is an identity map on . Because  and the identity map are bijective and , the map  is also bijective.

\subsection{Proof of Theorem 2}

\textit{Proof.} Note that . Thus , which means that . Note also that  equals to  if . Thus  if . It follows that , where  is the indicator function. Therefore, . This indicates that  if and only if  or , which proves the theorem.

\section{A Schematic Example}

We provide here a schematic example to show the intuition and interpretability of the projection matrix. For the hypergraph shown in Figure 1 of the main text, the incidence matrix

Thus the projection matrix without permutation on  is

and its transpose is

The compound matrix thus satisfies

Note that the adjacency matrix  of a graph or hypergraph is defined as , where  represents the number of edges/hyperedges shared between nodes  and . Therefore, .

Regarding to the normalization process, the compound row normalized matrix is

where  represents the row normalization factor for  and  for .

\section{Graph and Hypergraph Datasets}

We utilize a total of 6 representative graph datasets and 12 benchmark hypergraph datasets sourced from the existing literatures, with their statistics listed in Table 1 and 2 of the main text. Here we describe the detailed information of these datasets.

The graph datasets include \texttt{Cora}, \texttt{Citeseer}, \texttt{Pubmed}, \texttt{Texas}, \texttt{Wisconsin}, and \texttt{Cornell}~\cite{pei2020geom}. The \texttt{Cora}, \texttt{Citeseer}, and \texttt{Pubmed} datasets consist of citation graphs where nodes represent papers and edges denote the citation or quotation relationships between them. These graphs employ bag-of-words representations as the feature vectors for the nodes, indicating the presence of corresponding words from the dictionary in the papers. The labels in these datasets correspond to the classes or fields of the papers. The \texttt{Texas}, \texttt{Wisconsin}, and \texttt{Cornell} datasets comprise web pages collected from the computer science departments of their respective universities. In these datasets, nodes represent web pages, while edges represent hyperlinks connecting them. Each page in these datasets also employs bag-of-words representations as the feature vectors for the nodes, indicating the existence of corresponding words from the dictionary.

The benchmark hypergraph datasets include \texttt{Cora}, \texttt{Citeseer}, \texttt{Pubmed}, \texttt{Cora-CA}, \texttt{DBLP-CA}, \texttt{20Newsgroups}, \texttt{Zoo}, \texttt{ModelNet40}, \texttt{NTU2012}, \texttt{Yelp}, \texttt{House}, and \texttt{Senate}. The co-citation networks \texttt{Cora}, \texttt{Citeseer}, and \texttt{Pubmed}, are obtained from~\cite{yadati2019hypergcn}, in which all documents cited by a document are connected by a hyperedge. The co-authorship networks \texttt{Cora-CA} and \texttt{DBLP-CA} are also obtained from~\cite{yadati2019hypergcn}, in which all documents co-authored by an author are connected by a hyperedge. In these co-citation and co-authorship networks datasets, the node features consist of bag-of-words representations of the corresponding documents, and node labels are the paper classes. The \texttt{20Newsgroups} and \texttt{Zoo} datasets are obtained from the UCI Categorical Machine Learning Repository~\cite{asuncion2007uci}. In the \texttt{20Newsgroups} dataset, the node features consist of TF-IDF representations of news messages. In the \texttt{Zoo} dataset, the node features are combinations of categorical and numerical measurements describing various animals. Two public 3D object datasets in computer vision, namely \texttt{ModelNet40}~\cite{wu20153d} and \texttt{NTU2012}~\cite{chen2003visual}, are utilized. The former comprises of 12,311 3D objects from 40 categories, while the latter consists of 2,012 3D shapes from 67 categories. The two datasets feature visual objects with extracted features using the Group-View Convolutional Neural Network (GVCNN)~\cite{feng2018gvcnn} and the Multi-View Convolutional Neural Network (MVCNN)~\cite{su2015multi}. The construction of the hypergraphs follows the methodology described in~\cite{feng2019hypergraph,yang2022semi}. The \texttt{Yelp}, \texttt{House}, and \texttt{Senate} datasets are introduced in~\cite{chien2021you,fowler2006legislative}. Using the ``restaurant'' catalog in \texttt{Yelp}, all businesses are selected as nodes, and hyperedges are formed by selecting restaurants visited by the same user. The node labels, representing the average review of a restaurant, are derived from the numbers of rating stars, ranged from 1 to 5 stars with an interval of 0.5 star. The node features are constructed using the latitude, longitude, city, state (encoded as one-hot vectors), and bag-of-words encodings of the top-1000 words in the restaurant names. In the \texttt{House} dataset, each node represents a member of the US House of Representatives, and hyperedges are formed by grouping together members of the same committee. The node labels indicate the political party affiliation of the representatives. As the original \texttt{House} dataset lacks node features, they are generated using Gaussian random vectors, following a similar approach of the contextual stochastic block model. The feature vectors are fixed at a dimension of 100, and the features are obtained by applying one-hot encodings to the labels, with Gaussian noise  added. The standard deviation of the noise, , is set to 1 here. In \texttt{Senate} dataset, nodes are US Congressperson and hyperedges are comprised of the sponsors and co-sponsors of bills put forth in the Senate. Each node in the datasets is labeled with political party affiliation.

\section{Experimental Settings}

All the experiments are conducted on a Linux machine running Ubuntu 18.04, equipped with eight NVIDIA 3090ti GPUs with 24GB memory. To ensure a fair comparison, we follow the same training recipe as~\cite{wang2022equivariant,chien2021you}. Adam optimizer~\cite{kingma2014adam} with fixed learning rate and weight decay across epochs is utilized to minimize the cross-entropy loss function. The models are trained for 500 epochs for all datasets. Dropout is applied to prevent overfitting, and \texttt{ReLU} is chosen as the nonlinear activation function. The best hyperparameters are determined using Optuna~\cite{akiba2019optuna} with 200 trails. The search range for the number of layers is , and the hidden dimensions are selected from . We tune the learning rate from the set , the weight decay from , and the dropout rate from . The initial nonzero values of  are set to either  or , where  is the -th diagonal value of .  and  are row normalized. The reported standard deviations are calculated by conducting experiments on ten different data splits.

\section{Sensitivity to Hidden Dimension}

We perform comparison study on the expressivity of UniG-Encoder versus the hidden dimension of the MLP, as shown in Table \ref{table: ab-5}, where we use different hidden dimensions and evaluate the performance on the \texttt{Pubmed} hypergraph dataset. We also compare our framework with the top-performing baselines, namely AllDeepSets, AllSetTransformer, and ED-HNN. Remarkably, our model with a hidden dimension of 128 achieves comparable results to the 512-width AllSet models and shows performance on par with the ED-HNN model. These results indicate that our UniG-Encoder exhibits good tolerance for low hidden dimension, which can be attributed to its enhanced expressive power via the normalized projection matrix.

\begin{table}[htbp]
  \centering
  \caption{\textbf{Sensitivity to hidden dimension on \texttt{Pubmed} hypergraph dataset.}}
  \label{table: ab-5}
  \resizebox{0.7\textwidth}{!}{\begin{tabular}{ccccc}
    \toprule
    Model    &  512   & 256  &  128  & 64 \\
    \midrule
AllDeepSets &  &  &  &  \\
    AllSetTransformer &  &  &  &  \\
    ED-HNN &  &  &  &  \\
    UniG-Encoder &  &  &  &  \\
\bottomrule
  \end{tabular}
  }
\end{table}

\section{Over-Smoothing Analysis}

GNNs encounter over-smoothing problem when they are extended to deeper architectures. The mixing of node embeddings from different classes results in a decline in GNNs performance, due to the excessive aggregation of neighborhood information. Figure \ref{fig:q8-9} illustrates that as the models go deeper, their overall performance deteriorates due to over-smoothing.

\begin{figure}[htbp]
  \centering
  \subfigure[\texttt{Cora}]{
      \includegraphics[width=0.3\textwidth]{over_smoothing_cora.pdf}
  }
  \subfigure[\texttt{Citeseer}]{
      \includegraphics[width=0.3\textwidth]{over_smoothing_citeseer.pdf}
  }
  \subfigure[\texttt{Pubmed}]{
    \includegraphics[width=0.3\textwidth]{over_smoothing_pubmed.pdf}
}
  \caption{\textbf{Performance of different models with deeper layers on three benchmark datasets.}}
  \label{fig:q8-9}
\end{figure}

\section{Synthetic Graph and Hypergraph Datasets}

The proposed framework utilizes a universal architecture for both graphs and hypergraphs with difference lying in the construction of the  matrix.  contains at most two nonzero elements per row for graphs, whereas for hypergraphs it contains three or more nonzero elements per row. In practise, an important question is the conversion between graphs and hypergraphs. To guarantee as high homophilic extent as possible when synthesizing hypergraphs from graphs, a technique is to add certain node to existing edge with a probability, which has same label with at least one of the original nodes in the edge. Our experiments on synthesized hypergraphs show that this approach significantly increases the homophilic extent, leading to improved performance, see Figure \ref{fig:q5-5}(a). We also provide the corresponding homophily scores for different probabilities of adding node to an existing edge and different ranks of synthetic hypergraphs in Table \ref{table: ab-6}.

\begin{table}[htbp]
  \centering
  \caption{\textbf{Corresponding homophily scores for different probabilities of adding node to an existing edge and different ranks of synthetic hypergraphs.}}
  \label{table: ab-6}
  \resizebox{0.8\textwidth}{!}{\begin{tabular}{cccccccccccc}
    \toprule
    Probability &  0.0 &  0.1 &  0.2 & 0.3  & 0.4  & 0.5  & 0.6  & 0.7  & 0.8  & 0.9  & 1.0\\
    \midrule
    Rank 3    & 0.06 & 0.14 & 0.21 & 0.25 & 0.28 & 0.30 & 0.32 & 0.34 & 0.35 & 0.36 & 0.37 \\
    Rank 4    & 0.06 & 0.26 & 0.36 & 0.42 & 0.44 & 0.46 & 0.49 & 0.50 & 0.51 & 0.52 & 0.53 \\
    Rank 5    & 0.06 & 0.37 & 0.48 & 0.54 & 0.56 & 0.57 & 0.60 & 0.60 & 0.61 & 0.62 & 0.62 \\
    Rank 6    & 0.06 & 0.46 & 0.57 & 0.62 & 0.64 & 0.65 & 0.66 & 0.66 & 0.67 & 0.68 & 0.68 \\
    Rank 7    & 0.06 & 0.54 & 0.64 & 0.68 & 0.69 & 0.70 & 0.71 & 0.71 & 0.72 & 0.72 & 0.73 \\
    \bottomrule
  \end{tabular}
  }
\end{table}

Moreover, to compare the performance of our UniG-Encoder on graphs and hypergraphs that have same homophilic extent, based on the above synthesized hypergraph datasets, we obtain the graph datasets with same homophilic extent by adding new edges that belong to the clique expansion of the corresponding hyperedges in the synthesized hypergraph datasets. Here to ensure a fair comparison, we fix the training hyperparameters, such as the learning rate of 0.001 and the hidden dimension of 64. Results in Figure \ref{fig:q5-5}(b)(c) show that our framework performs better on hypergraphs than graphs with the same high homophily and performs better on graphs than hypergraphs with the same low homophily, which are also reflected in Table \ref{table: ab-7}.

\begin{figure}[htbp]
  \centering
  \subfigure[]{
      \includegraphics[width=0.3\textwidth]{ce_homo.pdf}
  }
  \subfigure[]{
      \includegraphics[width=0.3\textwidth]{syn_acc_g.pdf}
  }
  \subfigure[]{
    \includegraphics[width=0.3\textwidth]{syn_acc.pdf}
}
  \caption{\textbf{Experiments on synthetic datasets based on \texttt{Texas}.} The horizontal axis denote the probability of adding node to an existing edge. The numbers attached to the curves denote the corresponding values of probability one. The numerical value indicated in the legend of (a)(c), e.g., ``syn-hypergraph-3'', corresponds to the rank of each hyperedge in the synthetic hypergraphs. The numerical value indicated in the legend of (b), e.g., ``syn-graph-3'', corresponds to the graph obtained from the corresponding synthetic hypergraph, as stated in the text. The homophily score is calculated based on the clique expansion of hypergraphs.}
  \label{fig:q5-5}
\end{figure}

\begin{table}[htbp]
  \centering
  \caption{\textbf{Performance on synthetic graph and hypergraph datasets with different probability of adding node to an existing edge.}}
  \label{table: ab-7}
  \resizebox{0.8\textwidth}{!}{\begin{tabular}{cccccc}
    \toprule
    Probability                &  0.0 &  0.1 &  0.2 & 0.3  & 0.4  \\
    \midrule
    syn-graph-3       &  &  & &  &  \\
    syn-hypergraph-3
    &  &  &  &  & \\

    syn-graph-4       &  &  &  &  &  \\
    syn-hypergraph-4
    &  &  &  &  &  \\
    syn-graph-5             &  &  &  &  &  \\

    syn-hypergraph-5

    &  &  &  &  &  \\


    syn-graph-6
    &  &  &  &  &  \\
    syn-hypergraph-6

    &  &  &  &  &  \\


    syn-graph-7  &  &  &  &  &  \\
    syn-hypergraph-7

    &  &  &  &  &  \\
    \bottomrule
    \toprule
    0.5  & 0.6  & 0.7  & 0.8  & 0.9  & 1.0 \\
    \midrule
     &  &  &  &  & \\


     &  &  &  &  &  \\

     &  &  &  &  & \\

     &  &  &  &  & \\

     &  &  &  &  & \\

     &  &  &  &  & \\

     &  &  &  &  & \\

     &  &  &  &  & \\


     &  &  &  &  & \\

     &  &  &  &  & \\
    \bottomrule
  \end{tabular}
  }
\end{table}

\section*{Declaration of competing interest}

The authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper.

\section*{Data availability}

Data will be made available on request.

\section*{Acknowledgements}

This work is supported by the National Natural Science Foundation of China (No. 12101133) and Shanghai Sailing Program (No. 21YF1402300). This work is also supported by Shanghai Municipal Science and Technology Major Project (No. 2021SHZDZX0103).

\bibliography{Ref}

\end{document}
