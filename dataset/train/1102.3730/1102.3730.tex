\oursection{Isomorphisms proofs}\label{apx:isomorphisms}

In order to prove Theorem \ref{theo:isomorphism}, we must show:

\begin{enumerate}[\hspace{.4cm} A.]
    \item \label{lambda_rex:isom:trad} $\comp{\tradWUniLone}{\tradUUniLone} = \textrm{Id}_{\lambdaREterm} \, \land \, \comp{\tradUUniLone}{\tradWUniLone} = \textrm{Id}_{\lambdaXterm}$
    \item \label{lambda_rex:isom:w_pres} $\forall t, u \in \lambdaXterm : t \reducea_{\lambdaEX (\lambdaX, \lambdaXGC)} u \implies \tradWUni{t} \reducea_{\lambdaREX (\lambdaRE, \lambdaREGC)} \tradWUni{u}$
    \item \label{lambda_rex:isom:u_pres} $\forall a, b \in \lambdaREterm : a \reducea_{\lambdaREX (\lambdaRE, \lambdaREGC)} b \implies \tradUUni{a} \reducea_{\lambdaEX (\lambdaX, \lambdaXGC)} \tradUUni{b}$
\end{enumerate}

For Part \ref{lambda_rex:isom:trad}, the following two lemmas are needed.

\begin{lemma}\label{lambda_re:lema:fv_wu} 
For every $t \in \lambdaXterm$, $a \in \lambdaREterm$, $\varset{x}{1}{n}$ variables, $\varset{y}{1}{m}$ distinct variables:
\begin{enumerate}
    \item $\fv{t} \subseteq \varset{x}{1}{n} \implies \fv{\tradW{\vlste{x}{1}{n}}{t}} \subseteq \numset{1}{n}$
    \item $\fv{a} \subseteq \numset{1}{m} \implies \fv{\tradU{\vlste{y}{1}{m}}{a}} \subseteq \varset{y}{1}{m}$
\end{enumerate}
    \begin{proof}
    \vspace{-.07cm}
    Easy inductions on $t$ and $a$, respectively.
    \end{proof}
\end{lemma}

\begin{lemma}\label{lambda_re:lema:comp} 
For every $a \in \lambdaREterm$, $t \in \lambdaXterm$: 
\begin{enumerate}
    \item $\tradWUni{\tradUUni{a}} = a$
    \item $\tradUUni{\tradWUni{t}} \alphaequiv t$
\end{enumerate}
\vspace{-.3cm}
    \begin{proof}
    Easy inductions on $a$ and $t$, respectively, using Lemma \ref{lambda_re:lema:fv_wu}.
    \end{proof}
\end{lemma}

Next, to prove Part \ref{lambda_rex:isom:w_pres} of the theorem, we need
several auxiliary lemmas, that we now state.

\begin{lemma}\label{lambda_re:lema:w_variable_no_primera_en_lista}
For every $\varset{x}{1}{n}$, $y \in \varset{x}{1}{n}$, $x \not\in \varset{x}{1}{n}$,
$\tradW{\left[ x, x_1, \ldots, x_n \right]}{y} = \tradW{\vlste{x}{1}{n}}{y} + 1$.
    \begin{proof}
    \vspace{-.07cm}
    Direct, using $\tradWUniLone$'s definition.
    \end{proof}
\end{lemma}

\begin{lemma}\label{lambda_re:lema:w_swap}
For every $t \in \lambdaXterm$, $i \in \naturalsnonzero$ such that $\fv{t} \subseteq \varset{x}{1}{n} \land i < n \land x_i \neq x_{i+1}$,\\
$\swap{i}{\tradW{\left[ x_1, \ldots, x_i, x_{i+1}, \ldots, x_n \right]}{t}} = \tradW{\left[ x_1, \ldots, x_{i+1}, x_i, \ldots, x_n \right]}{t}$.
    \begin{proof}
    \vspace{-.07cm}
    Easy induction on $t$.
    \end{proof}
\end{lemma}

\begin{lemma}\label{lambda_re:lema:w_incrementos}
For every $t \in \lambdaXterm$, $m \in \naturals$, $x \in \mathbb{V}$ such that $\fv{t} \subseteq \varset{x}{1}{n} \land m \leq n \land x \not\in \varset{x}{1}{n}$, \\
$\tradW{\left[ x_1, \ldots, x_m, x, x_{m+1}, \ldots, x_n \right]}{t} = \; \addOne{m}{\tradW{\vlste{x}{1}{n}}{t}}$.
    \begin{proof}
    \vspace{-.07cm}
    Easy induction on $t$.
    \end{proof}
\end{lemma}

\begin{lemma}\label{lambda_regc:lema:w_gc}
For every $t \in \lambdaXterm$, $m \in \naturals$, $x \in \mathbb{V}$ such that $\fv{t} \subseteq \varset{x}{1}{n} \land 1 \leq m \leq n+1$ :
    \vspace{-.07cm}
    \begin{enumerate}
        \item \label{lambda_regc:lema:w_gc:not} $x \not\in \varset{x}{1}{n} \implies m \not\in \fv{\tradW{\left[
        x_1, \ldots, x_{m-1}, x, x_m, \ldots, x_n \right]}{t}}$

        \item \label{lambda_regc:lema:w_gc:in} $x \not\in \varset{x}{1}{m-1} \land x \in \fv{t} \implies
        m \in \fv{\tradW{\left[ x_1, \ldots, x_{m-1}, x, x_m, \ldots, x_n
        \right]}{t}}$

        \item \label{lambda_regc:lema:w_gc:dec} $x \not\in \varset{x}{1}{n} \implies \tradW{\vlste{x}{1}{n}}{t} =
        \; \subOne{m}{\tradW{\left[ x_1, \ldots, x_{m-1}, x, x_m, \ldots, x_n
        \right]}{t}}$
    \end{enumerate}
    \begin{proof}
    \vspace{-.07cm}
    Easy inductions on $t$.
    \end{proof}
\end{lemma}

Given the auxiliary lemmas, we proceed to prove Part
\ref{lambda_rex:isom:w_pres} of the isomorphism theorem. Item
\ref{lambda_re:lema:mantenimiento_reduccion_w_red}
of the next lemma is enough to prove the reduction preservation under
translation $\tradWUniLone$ for the $\lambdaRE$ and $\lambdaREGC$ calculi. For
$\lambdaREX$, Item \ref{lambda_re:lema:mantenimiento_reduccion_w_eqr}
-- showing the preservation of the equivalence relations under
translation $\tradWUniLone$ -- is also needed. Then, preservation for
$\lambdaREX$ follows immediately from the definition of reduction modulo an
equivalence relation.

\begin{lemma}\label{lambda_re:lema:mantenimiento_reduccion_w}
For every $t, u \in \lambdaXterm :$
    \begin{enumerate}
        \item \label{lambda_re:lema:mantenimiento_reduccion_w_red} $t
        \reducea_{\BX (\lambdaX, \lambdaXGC)} u \implies \tradWUni{t}
        \reducea_{\lambdaREXP (\lambdaRE, \lambdaREGC)} \tradWUni{u}$

        \item \label{lambda_re:lema:mantenimiento_reduccion_w_eqr} $t
        \cequiv u \implies \tradWUni{t} \dequiv \tradWUni{u}$
    \end{enumerate}
    \begin{proof}
    \textbf{Part \ref{lambda_re:lema:mantenimiento_reduccion_w_red}.}
    Induction on $t$. The only interesting cases are those of the explicit
    substitution when the reduction takes place at the root. The rest of the
    cases are either trivial or easily shown by using the inductive hypothesis.
We will show the explicit substitution case in which reduction is done
    by using the (Comp) rule. The other two relevant cases, (Lamb) and (GC),
    omitted here for a matter of space, are proved in a similar fashion. Since
    we are working in the explicit substitution case, $t$ is of the form
    $\lambdaXsust{t_1}{x}{t_2}$. Now, as the (Comp) rule is used, we have that:
    $$\lambdaXsust{t_1}{x}{t_2} = \lambdaXsust{\lambdaXsust{t_3}{y}{t_4}}{x}{t_2} \stepjust{(Comp)}{\BXstep} \;
    \lambdaXsust{\lambdaXsust{t_3}{x}{t_2}}{y}{\lambdaXsust{t_4}{x}{t_2}} = u$$
    with $x \in \fv{t_4}$. By the variable convention, we assume $x
    \neq y \land y \not\in \varset{x}{1}{n}$. Thus,
    \[
        \tradW{\vlste{x}{1}{n}}{\lambdaXsust{\lambdaXsust{t_3}{y}{t_4}}{x}{t_2}} \stepjust{def}{=}
        \lambdaREsust{\tradW{\left[ x, x_1, \ldots, x_n \right]}{\lambdaXsust{t_3}{y}{t_4}}}{\tradW{\vlste{x}{1}{n}}{t_2}}
        \stepjust{def}{=}
    \]
    \[
        \lambdaREsust{\lambdaREsust{\tradW{\left[ y, x, x_1, \ldots, x_n \right]}{t_3}}{\tradW{\left[ x, x_1, \ldots, x_n \right]}{t_4}}}{\tradW{\vlste{x}{1}{n}}{t_2}}
        \stepjust{L.\ref{lambda_regc:lema:w_gc}.\ref{lambda_regc:lema:w_gc:in}, $x \in \fv{t_4}$, (Comp)}{\lambdaREXPstep}
    \]
    \[
        \lambdaREsust{\lambdaREsust{\swap{1}{\tradW{\left[ y, x, x_1, \ldots, x_n \right]}{t_3}}}{\addOne{0}{\tradW{\vlste{x}{1}{n}}{t_2}}}}{\lambdaREsust{\tradW{\left[ x, x_1, \ldots, x_n \right]}{t_4}}{\tradW{\vlste{x}{1}{n}}{t_2}}}
        \stepjust{L.\ref{lambda_re:lema:w_swap}, $x \neq y$}{=}
    \]
    \[
        \lambdaREsust{\lambdaREsust{\tradW{\left[ x, y, x_1, \ldots, x_n \right]}{t_3}}{\addOne{0}{\tradW{\vlste{x}{1}{n}}{t_2}}}}{\lambdaREsust{\tradW{\left[ x, x_1, \ldots, x_n \right]}{t_4}}{\tradW{\vlste{x}{1}{n}}{t_2}}}
        \stepjust{L.\ref{lambda_re:lema:w_incrementos}, $y \not\in \fv{t_2}$}{=}
    \]
    \[
        \lambdaREsust{\lambdaREsust{\tradW{\left[ x, y, x_1, \ldots, x_n \right]}{t_3}}{\tradW{\left[ y, x_1, \ldots, x_n \right]}{t_2}}}{\lambdaREsust{\tradW{\left[ x, x_1, \ldots, x_n \right]}{t_4}}{\tradW{\vlste{x}{1}{n}}{t_2}}}
        \stepjust{def}{=}
    \]
    \[
        \lambdaREsust{\lambdaREsust{\tradW{\left[ x, y, x_1, \ldots, x_n \right]}{t_3}}{\tradW{\left[ y, x_1, \ldots, x_n \right]}{t_2}}}{\tradW{\vlste{x}{1}{n}}{\lambdaXsust{t_4}{x}{t_2}}}
        \stepjust{def}{=}
    \]
    \[
        \lambdaREsust{\tradW{\left[ y, x_1, \ldots, x_n \right]}{\lambdaXsust{t_3}{x}{t_2}}}{\tradW{\vlste{x}{1}{n}}{\lambdaXsust{t_4}{x}{t_2}}}
        \stepjust{def}{=}
        \tradW{\vlste{x}{1}{n}}{\lambdaXsust{\lambdaXsust{t_3}{x}{t_2}}{y}{\lambdaXsust{t_4}{x}{t_2}}}
    \]







    \textbf{Part \ref{lambda_re:lema:mantenimiento_reduccion_w_eqr}.} 
    Induction on the inference of $t \cequiv u$. The only interesting case is
    when the actual equation is used.  Then, $t =
    \lambdaXsust{\lambdaXsust{t_1}{y}{t_2}}{x}{t_3} \cequiv
    \lambdaXsust{\lambdaXsust{t_1}{x}{t_3}}{y}{t_2} = u$, with $x \neq y \land
    x \not\in \fv{t_2} \land y \not\in \fv{t_3}$.  By the variable convention,
    assume that $\left\{ x, y \right\} \cap \varset{x}{1}{n} = \emptyset$.
Proceed in a similar way than that of the proof of Part
    \ref{lambda_re:lema:mantenimiento_reduccion_w_red} in the (Comp) case.
\end{proof}
\end{lemma}

Finally, to prove Part \ref{lambda_rex:isom:u_pres} of the isomorphism theorem,
we also need several auxiliary lemmas analogue to those used for Part
\ref{lambda_rex:isom:w_pres}. We will now state them.

\begin{lemma}\label{lambda_re:lema:u_swap}
For every $a \in \lambdaREterm$, $i \in \naturalsnonzero$, $\varset{x}{1}{n}$ distinct variables such that $\fv{a} \subseteq \numset{1}{n} \\ \land i < n$, we have that 
$\tradU{\left[ x_1, \ldots, x_i, x_{i+1}, \ldots, x_n \right]}{a} \alphaequiv \tradU{\left[ x_1, \ldots, x_{i+1}, x_i, \ldots, x_n \right]}{\swap{i}{a}}$.
    \begin{proof}
    Easy induction on $a$.
    \end{proof}
\end{lemma}

\begin{lemma}\label{lambda_re:lema:u_incrementos}
For every $a \in \lambdaREterm$, $m \in \naturals$, $\varset{x}{1}{n}$ distinct variables, $x \not\in \varset{x}{1}{n}$ such that \\
$\fv{a} \subseteq \numset{1}{n} \land m \leq n$, we have that
$\tradU{\left[ x_1, \ldots, x_m, x, x_{m+1}, \ldots, x_n \right]}{\addOne{m}{a}} \alphaequiv \tradU{\vlste{x}{1}{n}}{a}$.
    \begin{proof}
    Easy induction on $a$.
    \end{proof}
\end{lemma}

\begin{lemma}\label{lambda_regc:lema:u_gc}
For every $a \in \lambdaREterm$, $m \in \naturals$, $x \in \mathbb{V}$,
$\varset{x}{1}{n}$ distinct variables such that $\fv{a} \subseteq \numset{1}{n} \land 1
\leq m \leq n+1 \land x \not\in \varset{x}{1}{n} \,$:
    \begin{enumerate}
        \item \label{lambda_regc:lema:u_gc:not} $m \not\in \fv{a} \implies x \not\in \fv{\tradU{\left[ x_1,
        \ldots, x_{m-1}, x, x_m, \ldots, x_n \right]}{a}}$

        \item \label{lambda_regc:lema:u_gc:in} $m \in \fv{a} \implies x \in \fv{\tradU{\left[ x_1,
        \ldots, x_{m-1}, x, x_m, \ldots, x_n \right]}{a}}$

        \item \label{lambda_regc:lema:u_gc:dec} $m \not\in \fv{a} \implies \tradU{\left[ x_1, \ldots, x_{m-1}, x,
        x_m, \ldots, x_n \right]}{a} \alphaequiv
        \tradU{\vlste{x}{1}{n}}{\subOne{m}{a}}$
    \end{enumerate}
    \begin{proof}
    Easy inductions on $a$.
    \end{proof}
\end{lemma}

Given, once again, the auxiliary lemmas, we will now state Part
\ref{lambda_rex:isom:u_pres} of the isomorphism theorem. As for Part
\ref{lambda_rex:isom:w_pres}, Item
\ref{lambda_re:lema:mantenimiento_reduccion_u_red} of Lemma
\ref{lambda_re:lema:mantenimiento_reduccion_u} will be enough to prove
preservation for the $\lambdaX$ and $\lambdaXGC$ calculi, whereas Item
\ref{lambda_re:lema:mantenimiento_reduccion_u_eqr} will also be needed for the
case of $\lambdaEX$, concluding preservation by definition of reduction modulo
an equation.

\begin{lemma}\label{lambda_re:lema:mantenimiento_reduccion_u}
For every $a, b \in \lambdaREterm :$
    \begin{enumerate}
        \item \label{lambda_re:lema:mantenimiento_reduccion_u_red} $a \reducea_{\lambdaREXP (\lambdaRE, \lambdaREGC)} b \implies \tradUUni{a} \reducea_{\BX (\lambdaX, \lambdaXGC)} \tradUUni{b}$
        \item \label{lambda_re:lema:mantenimiento_reduccion_u_eqr} $a \dequiv b \implies \tradUUni{a} \cequiv \tradUUni{b}$
    \end{enumerate}
    
    \begin{proof}
    For part \ref{lambda_re:lema:mantenimiento_reduccion_u_red}, perform induction on $a$ analogue to that
    of lemma \ref{lambda_re:lema:mantenimiento_reduccion_w}.\ref{lambda_re:lema:mantenimiento_reduccion_w_red}. 
    For part \ref{lambda_re:lema:mantenimiento_reduccion_u_eqr}, perform induction on the inference of $a \dequiv b$, analogue to
    that of lemma \ref{lambda_re:lema:mantenimiento_reduccion_w}.\ref{lambda_re:lema:mantenimiento_reduccion_w_eqr}. In both cases,
    use auxiliary lemmas \ref{lambda_re:lema:u_swap}, \ref{lambda_re:lema:u_incrementos} and \ref{lambda_regc:lema:u_gc}.
    \end{proof}

\end{lemma}
