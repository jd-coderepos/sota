\documentclass[journal]{IEEEtran}

\hyphenation{op-tical net-works semi-conduc-tor}

\DeclareTextSymbol{\degre}{T1}{6}
\DeclareTextSymbol{\degre}{OT1}{23}
\usepackage{etex}
\usepackage{url}
\usepackage[cmex10]{amsmath}
\usepackage{amsfonts}
\newtheorem{prop}{Proposition}
\newtheorem{ass}{Assumption}
\usepackage{dsfont}
\usepackage{epstopdf}
\usepackage{graphicx}
\usepackage[noadjust]{cite}
\usepackage{pstricks}
\usepackage{pstricks-add}
\usepackage{pst-plot}
\usepackage{tikz}
\usepackage{pgfplots}
\usetikzlibrary{plotmarks}
\usetikzlibrary{shapes,arrows}
\usepackage{bbold}
\usepackage{subfigure}

\begin{document}
\title{Introducing Decentralized EV Charging Coordination for the Voltage Regulation}

\author{Olivier~Beaude,~\IEEEmembership{Student Member,~IEEE,}
				Yujun~He,~\IEEEmembership{Student Member,~IEEE,}
        and ~Martin~Hennebel~
\thanks{O. Beaude PhD student at L2S, Supelec Power System Department and Renault SAS, in Paris, France, Y. He PhD student at Supelec Power System Department, M. Hennebel researcher and professor at Supelec Power System Department, E3S, in Gif-sur-Yvette, France. E-mail: olivier.beaude@renault.com.}\thanks{Manuscript received June 19, 2013
}}

\markboth{ISGT Copenhagen 2013, October 2013}{Shell \MakeLowercase{\textit{et al.}}: Bare Demo of IEEEtran.cls for Journals}

\maketitle


\begin{abstract}
This paper investigates a decentralized optimization methodology to coordinate Electric Vehicles (EV) charging in order to contribute to the voltage control on a residential electrical distribution feeder. This aims to maintain the voltage level in function of the EV's power injection using the sensitivity matrix approach. The decentralized optimization is tested with two different methods, respectively global and local, when EV take into account their impact on all the nodes of the network or only on a local neighborhood of their connection point. EV can also update their decisions asynchronously or synchronously. While only the global approach with asynchronous update is theoretically proven to converge, using results from game theory, simulations show the potential of other algorithms for which fewer iterations or fewer informations are necessary. Finally, using Monte Carlo simulations over a wide range of EV localization configurations, the first analysis have also shown a promising performance in comparison with uncoordinated charging or with a "voltage droop charging control" recently proposed in the literature.
\end{abstract}

\begin{IEEEkeywords}Voltage control - Decentralized algorithms - EV charging - Game theory
\end{IEEEkeywords}

\IEEEpeerreviewmaketitle

\section{Introduction}



\IEEEPARstart{V}{oltage} regulation is one of the significant ancillary services  \cite{Geth2012}  in distribution systems. In the evolution towards a "smarter grid", it has to become more flexible to deal with the variation of consumer's need and distributed generations \cite{Baran2007}.   

In this context, smart grid is envisioned to make the most of potential interactions between power systems and electric vehicles (EV). A large part of literature has been devoted to a centralized approach (see \cite{Clement-Nyns2009}) to perfectly schedule EV charging according to various objectives (power losses, voltage deviations, charging costs...) while the behavior of end users is less considered. Thus, a decentralized approach could contribute to the further development of practical coordination mechanisms, the next step before real implementation. \cite{Leemput2011} recently gave an overview of smart mechanisms explored in EV smart charging literature comparing centralized and decentralized results. Some of the distributed methods leading to promising results are based on game theory, which is a powerful tool to study their properties \cite{Saad2012}. This comes from the fact that Nash equilibria may be attractors for many distributed mechanisms designed in coordination problems. Consequently, these equilibria, and particularly the study of their efficiency, may play a major role in this context. Recent literature in this field contains \cite{Gan2012} which optimizes the interaction between a transformer and a group of EVs and \cite{Wu2012} in the context of wind power integration. To the best of our knowledge, our work is the first to apply this framework to the issue of voltage control.

\section{Problem description}


\subsection{EV charging modeling}


The availability of EV charging is concerned with a wild research on user's behavior. In this work, it will be considered that most of users park their car at home during the night hours and require that it is enough charged to travel next day.  The EV charging in this context can be simply modeled as a controllable power-constant load in the band of , where  is the maximal charging power of EV. The value of  is varied from kW to kW, depending on different technologies of EV charging. With the state-of-charge (SoC) representing the charging state of EV batteries, the constraints of charging can be written as

where  is the initial value when EV parks at home,  is the minimal acceptable value for the user's next day traveling,  the maximal value limited by the battery of EV and  the EV charging power during time slot .

Given the SoC at time , and  (respectively ), the minimal (respectively maximal) charging power at time , denoted by  (respectively ), can be calculated, providing  


As known, cables on distribution systems have a great R/X ratio (close to 1).  Hence the active power delivery to EV chargers can generate voltage drops, and a charging power modulation can contribute to the voltage control, as is highlighted hereafter. In the following, time indexes will be omitted given that the proposed methodology is repeated at each time slot.

\subsection{Voltage control with a sensitivity analysis}


The sensitivity analysis \cite{VanCutsem1998} is used to evaluate the changes of some quantity  of interest if changes of some parameter  take place in electric systems. In this work, the changes of bus voltage magnitude  will be evaluated and the parameters of concern are bus power injections .

The concerned sensitivity matrix comes from the network's load-flow equations as follows:

where , ,  and  are respectively the active and reactive power injection, bus voltage magnitude and angle at bus ;  and  are respectively the module and argument of the element  of the network admittance matrix.  

By calculating the partial derivatives of (\ref{LFMatrix}), its Jacobian matrix is obtained:

The coupling of - and - can be expressed from the Jacobian matrix. In \cite{He2012}, we have 

where  is the notation of the set of pilot nodes whose voltage profile should be maintained, while  is the notation of the set of nodes where load injection is controlled. The matrices  and  are called sensitivity matrices respectively for the coupling - and -.

Considering active power control is concerned in EV charging, only the matrix  will be used for this study. The charger converter could also allow a reactive power control. 

Before presenting the decentralized algorithms to control the voltage, a key function is introduced



\begin{figure}[!htbp]
\centering
\scalebox{0.65}{
\begin{tikzpicture}
\begin{axis}[xlabel= (pu),ylabel=]

\addplot[domain=0.9:1.1,green,ultra thick]{0};
\addplot[domain=1.1:1.3,mark=*,red,ultra thick]{(x-1.1)^2/0.04};
\addplot[domain=0.7:0.9,mark=*,red,ultra thick]{(x-0.9)^2/0.04};


\end{axis}
\draw[red,dashed] (0.5,5.3)--(2.5,5.3);
\draw[red,dashed] (2.5,0.5)--(2.5,5.3);
\draw[red,dashed] (4.3,0.5)--(4.3,5.3);
\draw[red,dashed] (4.3,5.3)--(6.3,5.3);
\draw[red,dashed] (3.5,-1.4)--(4,-1.4);
\node at (5.5,-1.4) {Crenel metric};
\draw[red] (-1,-1.4)--(-0.5,-1.4);
\node at (1,-1.4) {Quadratic metric};
\node at (2.5,-0.7) {};
\node at (4.4,-0.7) {};
\end{tikzpicture}
}
\caption{Objective concerning voltage regulation}
\label{fig:PhysMetr}
\end{figure}

This will permit to quantify how efficient is the voltage regulation. In practice, this must be determined according to the penalties paid by the Distribution Network Operator (DNO) to keep the voltage within its standard limits. With this definition, while the voltage is between its standard limits ( and  pu), the DNO has no penalty, and these penalties are quadratic out of this interval. As a comparison and as presented in dashed in Fig.\ref{fig:PhysMetr}, a second metric will be considered here, called "crenel" function:  between  and  pu,  otherwise. This is a first step to analyze the sensibility of the results to the metric used.

\subsection{Decentralized algorithm for voltage control}


The decentralized algorithm used in this work is an iterative algorithm which is called the \textit{best response dynamics} (BRD) in game theory \cite{Fudenberg1991}. This implements a \textit{communication phase taking place off-line}, before charging begins, to coordinate charging decisions of all the EV connected to the same network. Note that an online application of the proposed methodology could also be considered : if the charging at time  has already begun but if there is a need for updating the charging decisions (for example, a new EV has just connected to the network) before time , the decentralized process could be applied again, having updated the charging needs of all the EV which were charging at this time. As soon as a new charging configuration is obtained, then it is applied.

By default, without knowing the state of the voltage on the pilot nodes, each EV (with an automaton) initially chooses a charging power (for example ). Receiving all the EV charging decisions, an \textit{aggregator} calculates the voltage on all the pilot nodes and feedbacks EV with this information. Therefore each EV updates its charging decision to minimize an objective and reports this change to the aggregator. This procedure is then repeated while a stopping criterion is not reached.

Observe that EV can update their decisions \textit{synchronously} or \textit{asynchronously} (EV  updates its choice, then the aggregator calculates and send the pilot nodes' voltage to all the EV, then EV  updates and reports its charging power...). Once this communication phase is finished, each EV knows its charging power. 

Using the sensitivity matrix, two decentralized approaches for the voltage regulation will be distinguished according to the objective used by EV to update their charging decisions. In the first one, all EV follow the same objective which concerns all pilot nodes. Setting  and supposing  fixed, EV  minimizes

where  is the actual voltage measurement and  the setpoint for voltage control. 



In the second one, EV  is more particularly concerned with the voltage on its neighborhood, denoted by , and defined by the electrical network topology (typically, a single feeder or a part of this feeder) given that its charging choice can more directly influence the state of these nodes. To update its charging choice, EV  will then minimize


It should be noted that one key advantage of the local approach in comparison to the global one is that only the local voltage state is needed for EV  to take its decision while in the global case, the voltage on all the pilot nodes must be sent, which makes a bigger need for data exchange.

\subsection{Convergence of the global asynchronous approach inherited from the game theoretical class of potential games}


This part describes the link between the decentralized charging algorithms defined previously and a field of game theory called potential games (see \cite{beaude12} for more details). The motivation for introducing here the tools from non-cooperative game theory is as follows. The practical scenario considered here corresponds to the situation where each EV owner decides when to charge his vehicle. In such a scenario, the variable  is controlled by EV  only. This is therefore a distributed optimization problem. One of the powerful links between distributed optimization and game theory is that scenarios involving several individual optimizers which update their configuration over time may converge to an equilibrium of a certain game. This is the reason why we define here an \textit{auxiliary game} of interest and then describe the properties of the distributed algorithm of this work, coming from the particular structure of this game. This auxiliary game under strategic form consists of three main components~:

\begin{itemize}
\item \textit{Players}: EV  connected to the district ;
\item \textit{Actions}: charging power , or equivalently .  are the actions of , denoting all players, or EV, except  ;
\item \textit{Utility}: cost depending on the voltage level

\end{itemize}

We now present the class of potential games, initially introduced by \cite{Monderer1996}, and particularly used in game theory for modeling congestion effects, as in transportation networks for example \cite{Wardrop1952}. A game is said to have a potential, or to be a potential game, if there exists a function  such that 


As in physics, this notion of potential corresponds to a field obtained from an initial problem and from which important properties may be derived. In such a game, a deviation of any player, which makes its utility increase, leads to an increase in the global function . This implies in particular that the asynchronous BRD, used here in the context of voltage regulation, converges because it can not make  infinitly increase during the dynamics.

In this framework, with global objectives, the auxiliary game admits thus  as a potential function and the proposed asynchronous global algorithm will thus converge. This is of practical interest to know that, after a finite time, the updating process will stop and a stable state will be reached. However, neither for the synchronous algorithm, nor for the case with local objectives, this convergence is theoretically proven. But both these approaches must be useful in the practice because a synchronous update of the strategies may permit to accelerate the convergence while the local approach decreases the amount of data to exchange. This will be analyzed by simulations.

\section{Simulation results}


The decentralized methods described in the previous section will be performed using a residential electrical distribution feeder with a large penetration of EV (up to one EV at each node) connected to the standard test network model IEEE  with impedances and lengths scaled down to correspond to a Low-Voltage network and adjusting the R/X ratios, greater in distribution systems. Unless otherwise specified, the number of considered EV will be . Their charging needs are normally distributed with a mean distance of km and a standard deviation of km, taking into account that a kWh battery has a range of km. Concerning the local approach, two neighborhoods are defined: if an EV is connected at node  to  (respectively  to ), it only takes into account the voltage on nodes  (respectively ) when deciding its charging policy in the local mechanism. 

\begin{figure}[!htbp]
\centering
\includegraphics[scale=0.32]{reseau34_V4}
\caption{IEEE  distribution network model used in the simulations.}
\label{DistribNet}
\end{figure}

\subsection{Convergence of the proposed mechanisms}


\begin{figure}[tbp]\vspace{-3mm}
\begin{center}\vspace{-2mm}
\subfigure[Asynchronous approach]{
\resizebox{0.45\columnwidth}{0.46\columnwidth}{\hspace*{-0.7in}\includegraphics{FunObj_asyncEPS_V2.eps}\hspace*{-0.7in}}
\label{fig:Glob}}\vspace{-2mm}
\subfigure[Synchronous approach]{
\resizebox{0.45\columnwidth}{0.46\columnwidth}{\hspace*{-.2in}\includegraphics{FunObj_simultaneEPS_V2.eps}\hspace*{-1in}}\vspace{-2mm}
\label{fig:Loc}} 
\caption{Dynamics of the asynchronous and synchronous global mechanisms}
\label{fig:Dyn} 
\end{center}\vspace{-5mm}
\end{figure}

First, the convergence of the proposed mechanism is analyzed. Given that it is repeated for each time slot, only one particular time slot,  am, is here presented. As claimed in the previous theoretical part, Fig.\ref{fig:Dyn} shows that, while the asynchronous global algorithm converges, the synchronous global algorithm can have oscillations. Interestingly, convergence in the asynchronous case occurs after approximately  iterations, that is a mean of  iterations by EV. This small number of update of EV charging policies is very interesting for practical applications. Note also that, even if the synchronous process does not converge, it provides a very efficient configuration after only one iteration, that is one update by EV. In practice, this scheme could thus be applied using the simple following stopping heuristic rule : when a charging configuration already observed in the coordination mechanism is obtained, the process is stopped. For example, in the case of Fig.\ref{fig:Dyn}, the synchronous mechanism would have been stopped after  iterations. Otherwise, the same cycle will be infinitely repeated without improving the considered objective. Consequently, balancing between obtaining a good state in term of voltage and exchanging little information, the aggregator could thus choose between both approaches. Similar results are observed, but not presented here, in the local case.   




\subsection{Performance of the proposed methodology}


Having ensured that after a finite (short) time, this mechanism leads to a stable configuration, then, its performance is studied observing the voltage profile, especially at the node  at the end of the considered network topology, probably the one which will be the more significantly impacted by an uncoordinated EV charging. Fig.\ref{fig:VProf} shows that, without coordinating EV charging, the voltage at the end of the network is under the limit of  pu. With both the global and the local approaches, the voltage remains in the standard limits. Both profiles are very similar with only a small difference for the voltage of the nodes , which are taken into account differently in both methods. Interestingly, the local mechanism seems here sufficient to coordinate efficiently EV charging. 



\begin{figure}[tbp]\vspace{-3mm}
\begin{center}\vspace{-2mm}
\subfigure[Global approach]{
\resizebox{0.45\columnwidth}{0.46\columnwidth}{\hspace*{-0.2in}\includegraphics{Vprofile_asyncEPS_V2.eps}\hspace*{-0.2in}}
\label{fig:Glob}}\vspace{-2mm}
\subfigure[Local approach]{
\resizebox{0.45\columnwidth}{0.46\columnwidth}{\hspace*{-.2in}\includegraphics{Vprofile_async_localEPS.eps}\hspace*{-1in}}\vspace{-2mm}
\label{fig:Loc}} 
\caption{Voltage profile obtained with the global and local mechanisms}
\label{fig:VProf} 
\end{center}\vspace{-5mm}
\end{figure}

\medskip

Then, the performance of the proposed methodology is compared with two other scenarios :
\begin{itemize}
\item without EV charging regulation, called \textit{uncoordinated case}. EV charge as soon as connected to the grid, with normal distributions for arrival time of mean  pm and standard deviation  hour and for departure time of mean  am and standard deviation  hour. This uncoordinated case is the one where the voltage may be the more adversely affected ;
\item with a \textit{voltage droop charging control}, as proposed in \cite{Geth2012}. Given the voltage at time  at the node where EV is located, the EV charges at time  according to the profile of Fig.\ref{fig:droopContr} (three are given and compared in \cite{Geth2012}, but ony the so-called "LM1" is considered here). 
\begin{figure}[!htbp]
\begin{center}
\scalebox{0.3}{
\begin{tikzpicture}[y=10cm,x=.5cm,font=\sffamily]
 	
\draw[line width=1] (0,0.2) -- (25,0.2);
	\draw[line width=1] (0,0.2) -- (0,1.2);
	\draw[line width=1] (0,0.18) -- (0,0.22);	
	\draw[line width=1] (5,0.18) -- (5,0.22);	
	\draw[line width=1] (10,0.18) -- (10,0.22);	
	\draw[line width=1] (15,0.18) -- (15,0.22);	
	\draw[line width=1] (20,0.18) -- (20,0.22);	
	\draw[line width=1] (25,0.18) -- (25,0.22);	
	\draw[line width=1] (-0.5,1) -- (0.5,1);
	\draw[line width=1] (-0.5,0.46) -- (0.5,0.46);
	\draw[line width=1] (-0.5,0.72) -- (0.5,0.72);
	
	\node[below=0.3cm] at (0,0.18) {\huge };
	\node[below=0.3cm] at (5,0.18) {\huge };
	\node[below=0.3cm] at (10,0.18) {\huge };
	\node[below=0.3cm] at (15,0.18) {\huge };
	\node[below=0.3cm] at (20,0.18) {\huge };
	\node[left=0.3cm] at (-0.5,0.46) {\huge };
	\node[left=0.3cm] at (-0.5,0.72) {\huge };
	\node[left=0.3cm] at (-0.5,1) {\huge };
	\node[below=0.3cm] at (12,0.1) {\huge Voltage (pu)};
	\node[left=0.3cm] at (-1.5,0.9) {\huge EV charging};
	\node[left=0.3cm] at (-1.5,0.8) {\huge power (kW)};
	\draw[color=red,line width=3] (0,0.2) -- (5,0.2);
	\draw[color=red,line width=3] (5,0.2) -- (10,1);
	\draw[color=red,line width=3] (10,1) -- (25,1);
	\draw[red,dashed] (10,0.2)--(10,1);
	\draw[red,dashed] (0,1)--(10,1);
\end{tikzpicture}
}
\caption{Voltage droop charging control of EV charging proposed in \cite{Geth2012}.
}
\label{fig:droopContr}
\end{center}
\end{figure}
\end{itemize}  

Fig.\ref{Fig:VDiffApp} shows that an uncoordinated EV charging would lead to a critical voltage drop at the end of the evening. With the proposed decentralized mechanisms, this is significantly reduced and the voltage remains almost within its standard bounds, which is also the case with the droop charging control. Moreover, observe that when the voltage is between  and  pu, the performance of the decentralized control with the quadratic or crenel objective and the droop voltage control can not be distinguished given that the metrics  used here to quantify voltage deviations is zero within this interval. Furthermore, the results with both the quadratic or crenel metrics seems very similar. An extension of this initial work could be to analyze in more details the sensibility of the results obtained with respect to the choice of the metrics used.

\begin{figure}[!htbp]
\includegraphics[scale=0.45]{Voltage_comparisonEPS_V4.eps}
\caption{Voltage profile obtained with different charging mechanisms.}
\label{Fig:VDiffApp}
\end{figure}



Finally, the different mechanisms are compared over a wide range of configurations, differentiated by the localizations of the EV which are randomly drawn ( random drawings of the localization are done). To this end, Tab.\ref{tab:perfV} provides the mean of the minimal voltage over the day at node . With this criterion, the proposed decentralized methodology slightly outperforms the voltage droop charging method and significantly the uncoordinated case. The decentralized local mechanism seems also to provide similar results than the global approach. Note finally that the more EV connected to the network is, the bigger the impact on the voltage of node  is, which is very intuitive. 

To summarize the efficiency of the different mechanisms analyzed in this paper, Fig.\ref{Fig:PerfDiffMeth} outlines their characteristics according to two key aspects : efficiency in terms of voltage control and need for data exchange for these methods to be applied. With the simulations done here, there is only a slight difference according to the voltage control and choice could be made to apply the mechanism with the smallest need for data exchange. Further simulations on other type of networks could put into question this first conclusion.



\begin{table}[h]
\caption{\textbf{Comparison of the minimal voltage at node  with different EV charging control mechanisms}}
\label{tab:perfV}
\begin{center}
\begin{tabular}{|c|c|c|c|}
\hline
Policy \& Number of EV & 10 & 20 & 30 \\
 \hline
Uncoordinated &	0.877 & 0.866 & 0.849 \\
\hline
Droop voltage control &	0.886 & 0.881 & 0.883 \\
\hline
Global asynchronous decentralized control &	0.892 & 0.890 & 0.888 \\ 
\hline
Local asynchronous decentralized control & 0.891 & 0.888 & 0.885 \\
\hline
\end{tabular}
\end{center}
\end{table}

\begin{figure}[!htbp]
\centering
\includegraphics[scale=0.3]{PerfDiffMethod_V3}
\caption{First overview of the characteristics of the different EV charging control methods}
\label{Fig:PerfDiffMeth}
\end{figure}

\section{Concluding remarks}


In this paper, we proposed a decentralized approach for scheduling EV charging in a distribution network in order to reduce its impact on the voltage plan. Concretely, this consists in an iterative exchange of information between a coordinator, or aggregator, and EV connected in the district until a stable configuration is reached. Receiving information from the aggregator, each EV aims at limiting its impact on the voltage plan using the sensitivity matrix approach in order to estimate the voltage on the key points of the network, or pilot nodes, according to its charging policy. More precisely, two different iterative algorithms are defined, namely a global and local mechanisms. In the global method, each EV takes into account its impact on the whole network when updating its charging choice while in the local one it only focuses on its impact on a close neighborhood of its connection node, assuming that its influence will be the more significant in this subpart of the network. Asynchronous and synchronous update of EV charging decisions were also studied. 

Using properties from game theory, the global approach is shown to converge when EV update their decisions asynchronously, which is of practical interest for a concrete application. Then, realistic simulations on an IEEE test network show the significant benefits done when applying these two mechanisms in comparison with the uncoordinated case and in comparison with a voltage local droop control recently proposed in the literature. This analysis also highlights the respective advantages of asynchronous and synchronous mechanisms: while the first permits to obtain a better configuration in terms of voltage plan, the second can reach an efficient configuration with significantly less iterations, which means less information exchanged between the aggregator and the EV. The local approach is also shown to provide very similar results in comparison with the global approach, for which more data has to be exchanged. Between both of these methods, a mixed approach, where subdistricts exchange information via aggregators and then a local decentralized mechanism is applied in each subdistrict, constitutes a relevant extension of this work.
\ifCLASSOPTIONcaptionsoff
  \newpage
\fi

\bibliographystyle{IEEEtran_NoURL}
\bibliography{LittISGT_2013_V3}


\end{document}