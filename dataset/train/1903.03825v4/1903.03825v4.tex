\documentclass{article}
\pdfpagewidth=8.5in
\pdfpageheight=11in
\usepackage[preprint]{nips_2018}
\usepackage{times}
\usepackage{soul}
\usepackage{url}
\usepackage[utf8]{inputenc}
\usepackage[small]{caption}
\usepackage{graphicx}
\usepackage{hyperref}
\usepackage{wrapfig,lipsum,booktabs}
\usepackage{subcaption}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{booktabs}
\usepackage{algorithm}
\usepackage{algpseudocode}
\usepackage{makecell}
\usepackage{microtype}
\urlstyle{same}
\usepackage{tikz}
\usepackage{pgfplots}
\usepackage{setspace}
\definecolor{mygreen}{HTML}{167dde}
\definecolor{myred}{HTML}{f22835}
\colorlet{greenfill}{mygreen!20!white}
\colorlet{purplefill}{red!50!blue!30!white}

\colorlet{redfill}{myred!20!white}
\colorlet{moreredfill}{myred!40!white}
\usetikzlibrary{positioning}
\usetikzlibrary{backgrounds}
\usetikzlibrary{calc}
\usetikzlibrary{fit}

\newcommand{\mix}[2]{\text{Mix}_\lambda(#1, #2)}
\newcommand{\ict}{Interpolation Consistency Training}
\newcommand{\ICT}{ICT}
\newcommand{\inputmixup}{Input Mixup}
\DeclareMathOperator*{\expectation}{\mathbb{E}}

\usepackage[titletoc,title]{appendix}
\usepackage[normalem]{ulem}
\usepackage{mathtools}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{bm}
\usepackage{bbm}
\ifx\proof\undefined
\newenvironment{proof}{\par\noindent{\bf Proof\ }}{\hfill\BlackBox\
    \mix{a}{b} = \lambda \cdot a + (1 - \lambda) \cdot b,

    f_\theta(\mix{u_j}{u_k}) \approx \mix{f_{\theta'}(u_j)}{f_{\theta'}(u_k)},

    L = L_S + w(t) \cdot L_{US}

\label{eq: consistency loss}
    \mathcal{L}_{US} = &\expectation_{u_j, u_k \sim P_X}\,
    \expectation_{\lambda \sim \text{Beta}(\alpha, \alpha)}
    \ell(f_\theta(\mix{u_j}{u_k}), \mix{f_{\theta'}(u_j)}{f_{\theta'}(u_k)})

L_{US}:=\mathop{\EE}_{u,u' \sim P_{X}} \mathop{\EE}_{\lambda \sim \Beta(\alpha, \alpha)}\ell(f_\theta(\Mix_{\lambda}(u,u')),\Mix_{\lambda}(f_\theta(u),f_\theta(u'))),

L_{US}= \frac{1}{n^{2}}\sum_{i=1}^n \sum_{j=1}^n \mathop{\EE}_{\lambda \sim \Beta(\alpha, \alpha)}\ell(f_\theta(\Mix_{\lambda}(u_{i},u_{j}))-\Mix_{\lambda}(f_\theta(u_{i}),f_\theta(u_{j}))),

f_\theta(u) = \sigma(h_{\theta}(u)),

\phi(x) \rightarrow \mathrm{relu}(x) \text{ as } \kappa\rightarrow \infty,

 \partial ^{k}f_\theta(u) _{t_1t_2 \cdots t_k}=\frac{\partial ^{k}}{\partial u_{t_1}\partial u_{t_2} \cdots \partial u_{t_k}} f_\theta(u).

\|a^{\otimes k}\|_2 = \|a\|_2^k

\|a^{\otimes 1}\|_2=\|a\|_2=\|a^{}\|_2^1,

\|a^{\otimes {k+1}}\|_2^{2}  =\|a^{\otimes {k}} \otimes a\|_2^2 = \left\| \begin{bmatrix}(a^{\otimes {k}})_1  a \\
\vdots \\
(a^{\otimes {k}})_{d^k}  a \\
\end{bmatrix} \right\|_2^2 = \sum_{i=1}^{d^k}  ((a^{\otimes {k}})_i  )^{2} \|a\|^2_2 &=\|a\|^2_2\sum_{i=1}^{d^k}  ((a^{\otimes {k}})_i  )^{2} \\ &=\|a\|^2_2 \|a^{\otimes k}\|_2^{2}. 

\|a^{\otimes {k+1}}\|_2^{2} = \|a\|^2_2 \|a\|_2^{2k} = \|a\|_2^{2(k+1)}.

\|a^{\otimes {k+1}}\|_2^{} = \|a\|_2^{k+1},

&\ell(f_\theta(\Mix_{\lambda}(u,u')),\Mix_{\lambda}(f_\theta(u),f_\theta(u'))) \\ \nonumber &=\left(\sum_{k=2}^K \frac{(\hlambda-\hlambda^{k})}{k!} \vect[\partial ^{k}f_\theta(u)]\T(u'-u)^{\otimes k} +O(\left\|u'-u\right\|_2^K) \right)^2, 

\scalebox{0.98}{},

E_{\theta}(u,u',\lambda)= \frac{1}{K!} ((1-\zeta')^{K}\vect[\partial ^{K+1}f_\theta(u+ \zeta'\Delta)]-\hlambda(\hlambda-\zeta)^{K}\vect[\partial ^{K+1}f_\theta(u+ \zeta\Delta)])\T \Delta^{\otimes K}.

\varphi(a)=f_\theta(u+ a  (u'-u)).
 \label{eq:1}
\Mix_{\lambda}(a,b)= \lambda a + (1-\lambda) b = a+(1-\lambda)(b-a)= a+ \hlambda (b-a).

f_\theta(\Mix_{\lambda}(u,u'))  =f_\theta(u+\hlambda (u'-u))=\varphi(\hlambda).

f_\theta(\Mix_{\lambda}(u,u')) =\varphi(\hlambda) &=\varphi(0)+ \sum_{k=1}^K \frac{\hlambda^{k}}{k!} \varphi^{(k)}(0) + \frac{\hlambda(\hlambda-\zeta)^{K}}{K!} \varphi^{(K+1)}(\zeta), 
 \label{eq:2}
f_\theta(\Mix_{\lambda}(u,u')) =f_\theta(u)+ \sum_{k=1}^K \frac{\hlambda^{k}}{k!} \varphi^{(k)}(0) + \frac{\hlambda(\hlambda-\zeta)^{K}}{K!} \varphi^{(K+1)}(\zeta).
 \label{eq:4}
\Mix_{\lambda}(f_\theta(u),f_\theta(u'))=f_\theta(u)+\hlambda (f_\theta(u')-f_\theta(u)).

f_\theta(u')=\varphi(1)=\varphi(0)+ \sum_{k=1}^K \frac{1}{k!} \varphi^{(k)}(0) + \frac{(1-\zeta')^{K}}{K!} \varphi^{(K+1)}(\zeta').
 \label{eq:3}
\Mix_{\lambda}(f_\theta(u),f_\theta(u'))=f_\theta(u)+\hlambda \left( \sum_{k=1}^K \frac{1}{k!} \varphi^{(k)}(0) +\frac{(1-\zeta')^{K}}{K!} \varphi^{(K+1)}(\zeta') \right).
 
& \ell(f_\theta(\Mix_{\lambda}(u,u')),\Mix_{\lambda}(f_\theta(u),f_\theta(u')))
\\ & =\left(\sum_{k=1}^K \frac{\hlambda^{k}}{k!} \varphi^{(k)}(0) + \frac{\hlambda(\hlambda-\zeta)^{K}}{K!} \varphi^{(K+1)}(\zeta)-\hlambda \left(\sum_{k=1}^K \frac{1}{k!} \varphi^{(k)}(0) +\frac{(1-\zeta')^{K}}{K!} \varphi^{(K+1)}(\zeta') \right) \right)^2
\\ & =\left(\sum_{k=1}^K \frac{(\hlambda^{k}-\hlambda)}{k!} \varphi^{(k)}(0) + \frac{1}{K!} (\hlambda(\hlambda-\zeta)^{K}\varphi^{(K+1)}(\zeta)-(1-\zeta')^{K}\varphi^{(K+1)}(\zeta')) \right)^2
 \label{eq:5}
&\ell(f_\theta(\Mix_{\lambda}(u,u')),\Mix_{\lambda}(f_\theta(u),f_\theta(u')))
\\ \nonumber &=\left(\sum_{k=2}^K \frac{(\hlambda^{k}-\hlambda)}{k!} \varphi^{(k)}(0) + \frac{1}{K!} (\hlambda(\hlambda-\zeta)^{K}\varphi^{(K+1)}(\zeta)-(1-\zeta')^{K}\varphi^{(K+1)}(\zeta')) \right)^2.

\varphi^{(1)}(a)= \frac{\partial f_\theta(u+ a\Delta)}{\partial a}= \sum_{t_1=1}^d\frac{\partial f_\theta(b)}{\partial b_{t_1}}\frac{\partial b_{t_1}}{\partial a}=\sum_{t_1=1}^d\frac{\partial f_\theta(b)}{\partial b_{t_1}}\Delta_{t_1}

\varphi^{(2)}(a) =\frac{\partial}{\partial a}\frac{\partial f_\theta(u+ a\Delta)}{\partial a} =\sum_{t_1=1}^d \frac{\partial}{\partial a}\frac{\partial f_\theta(b)}{\partial b_{t_1}}\Delta_{t_1}=\sum_{t_1=1}^d \sum_{t_2=1}^d \frac{\partial ^{2}f_\theta(b)}{\partial b_{t_1}\partial b_{t_2}}\Delta_{t_2}\Delta_{t_1}

\sum_{t_1=1}^d \sum_{t_2=1}^d \cdots \sum_{t_k=1}^d\frac{\partial ^{k}f_\theta(b)}{\partial b_{t_1}\partial b_{t_2} \cdots \partial b_{t_k}}\Delta_{t_1} \Delta_{t_2} \cdots \Delta_{t_k}.

\varphi^{(k+1)}(a) & =\frac{\partial}{\partial a}\sum_{t_1=1}^d \sum_{t_2=1}^d \cdots \sum_{t_k=1}^d\frac{\partial ^{k}f_\theta(b)}{\partial b_{t_1}\partial b_{t_2} \cdots \partial b_{t_k}}\Delta_{t_1} \Delta_{t_2} \cdots \Delta_{t_k} \\ & = \sum_{t_1=1}^d \sum_{t_2=1}^d \cdots \sum_{t_k=1}^d \sum_{t_{k+1}=1}^d\frac{\partial ^{k+1}f_\theta(b)}{\partial b_{t_1}\partial b_{t_2} \cdots \partial b_{t_k}\partial b_{t_{k+1}}}\Delta_{t_1} \Delta_{t_2} \cdots \Delta_{t_k}  \Delta_{t_{k+1}}
 \label{eq:6}
\varphi^{(k)}(a) =\sum_{t_1=1}^d \sum_{t_2=1}^d \cdots \sum_{t_k=1}^d\frac{\partial ^{k}f_\theta(b)}{\partial b_{t_1}\partial b_{t_2} \cdots \partial b_{t_k}}\Delta_{t_1} \Delta_{t_2} \cdots \Delta_{t_k}. 
 \label{eq:7}
\varphi^{(k)}(a)=\vect[\partial ^{k}f_\theta(u+ a\Delta)]\T \Delta^{\otimes k}, 

&\ell(f_\theta(\Mix_{\lambda}(u,u')),\Mix_{\lambda}(f_\theta(u),f_\theta(u')))
\\ \nonumber &=\left(\sum_{k=2}^K \frac{(\hlambda^{k}-\hlambda)}{k!} \varphi^{(k)}(0) + \frac{1}{K!} (\hlambda(\hlambda-\zeta)^{K}\varphi^{(K+1)}(\zeta)-(1-\zeta')^{K}\varphi^{(K+1)}(\zeta')) \right)^2
\\ \nonumber &=\left(\sum_{k=2}^K \frac{(\hlambda-\hlambda^{k})}{k!} \vect[\partial ^{k}f_\theta(u)]\T \Delta^{\otimes k} +E_{\theta}(u,u',\lambda) \right)^2

&|E_{\theta}(u,u',\lambda)|
\\ &= \left|\frac{1}{K!} ((1-\zeta')^{K}\vect[\partial ^{K+1}f_\theta(u+ \zeta'\Delta)]-\hlambda(\hlambda-\zeta)^{K}\vect[\partial ^{K+1}f_\theta(u+ \zeta\Delta)])\T \Delta^{\otimes K} \right| 
\\ & \le\frac{\left\|\Delta^{\otimes K} \right\|_2}{K!} \left\| ((1-\zeta')^{K}\vect[\partial ^{K+1}f_\theta(u+ \zeta'\Delta)]-\hlambda(\hlambda-\zeta)^{K}\vect[\partial ^{K+1}f_\theta(u+ \zeta\Delta)]) \right\|_2 
\\ & =\frac{\left\|\Delta\right\|_2^{K}}{K!} \left\| ((1-\zeta')^{K}\vect[\partial ^{K+1}f_\theta(u+ \zeta'\Delta)]-\hlambda(\hlambda-\zeta)^{K}\vect[\partial ^{K+1}f_\theta(u+ \zeta\Delta)]) \right\|_2

\partial f_\theta(u)=\partial\sigma (h_{\theta}(u))\partial h_{\theta}(u).

\|\partial f_\theta(u)\|=|\partial\sigma (h_{\theta}(u))| \|\partial h_{\theta}(u)\|=\partial\sigma (h_{\theta}(u)) \|\partial h_{\theta}(u)\|=\partial\sigma (|h_{\theta}(u)|) \|\partial h_{\theta}(u)\|.

\EE_{x,y}[\ell(f(x),y)]\le \frac{1}{m}\sum_{i=1}^{m} \ell(f(x_i),y_i)+2\Rcal_{m}(\ell \circ \Fcal_{\hat S})+C \sqrt{\frac{\ln(1/\delta)}{2m}}.   

 \varphi(S)= \sup_{f \in\Fcal_{\hat S}} \EE_{x,y}[\ell(f(x),y)]-\frac{1}{m}\sum_{i=1}^{m}\ell(f(x_i),y_i).
 
\varphi(S')-\varphi(S) \le\sup_{f \in\Fcal_{\hat S}}\frac{\ell(f(x_{i_0}),y_{i_0})-\ell(f_{}(x'_{i_0}),y'_{i_0})}{m} \le \frac{C}{m},

\varphi(S) \le  \EE_{S}[\varphi(S)] + C \sqrt{\frac{\ln(1/\delta)}{2m}}.

\EE_{S}[\varphi(S)] 
 &  = \EE_{S}\left[\sup_{f \in\Fcal_{\hat S}} \EE_{S'}\left[\frac{1}{m}\sum_{i=1}^{m}\ell(f_{}(x_i'),y_i')\right]-\frac{1}{m}\sum_{i=1}^{m}\ell(f(x_i),y_i)\right] 
 \\ &  \le\EE_{S,S'}\left[\sup_{f \in\Fcal_{\hat S}} \frac{1}{m}\sum_{i=1}^m (\ell(f_{}(x'_i),y'_i)-\ell(f(x_i),y_i)\right] 
 \\ & \le \EE_{\xi, S, S'}\left[\sup_{f\in\Fcal_{\hat S}} \frac{1}{m}\sum_{i=1}^m  \xi_i(\ell(f_{}(x'_{i}),y'_{i})-\ell(f(x_i),y_i))\right]
 \\ &  \le2\EE_{\xi, S}\left[\sup_{f\in\Fcal_{\hat S}} \frac{1}{m}\sum_{i=1}^m  \xi_i\ell(f(x_i),y_i))\right] =2\Rcal_{m}(\ell \circ \Fcal_{\hat S})  

\textstyle \ell_{01}(f(x),y) = \one \{y=1\} \one \{f(x)\le 1/2\}+\one \{y=-1\} \one \{f(x)\ge 1/2\}=\one \{y  (2f(x)-1)\le 0\}. 

{\bar \ell}_{\rho}(a)=
\begin{cases} 0 & \text{if } a\ge \rho \\
1-a/\rho &  \text{if } 0 \le a \le \rho \\
1 & \text{if } a \le 0.\\
\end{cases}

\EE_{x,y}[\ell_{01}(f(x),y)]\le \frac{1}{m}\sum_{i=1}^{m} \ell_{\rho}(f(x_i),y_i)+2\rho^{-1} \Rcal_{m}( \Fcal_{\hat S})+ \sqrt{\frac{\ln(1/\delta)}{2m}}.   
\\ 
\EE_{x,y}[\ell_{01}(f(x),y)]\le \frac{1}{m}\sum_{i=1}^{m} \ell_{\rho}(f(x_i),y_i)+2\rho^{-1}  \hat \Rcal_{m}( \Fcal_{\hat S})+3 \sqrt{\frac{\ln(2/\delta)}{2m}}.   

\EE_{x,y}[\ell_{01}(f(x),y)] \le \EE_{x,y}[{\ell}_{\rho}(f(x),y)]\le \frac{1}{m}\sum_{i=1}^{m} {\ell}_{\rho}(f(x_i),y_i)+2\Rcal_{m}({\ell}_{\rho} \circ \Fcal_{\hat S})+ \sqrt{\frac{\ln(1/\delta)}{2m}}.   

\EE_{x,y}[\ell_{01}(f(x),y)] &\le \frac{1}{m}\sum_{i=1}^{m} {\ell}_{\rho}(f(x_i),y_i)+2\rho^{-1} \Rcal_{m}(\Fcal_{\hat S})+ \sqrt{\frac{\ln (1/\delta)}{2m}}.

\EE_{x,y}[\ell_{01}(f(x),y)] &\le \frac{1}{m}\sum_{i=1}^{m} {\ell}_{\rho}(f(x_i),y_i) + 2\rho^{-1} \Rcal_{m}(\Fcal_{\hat S}) + \sqrt{\frac{\ln (2/\delta)}{2m}}
\\ & \le \frac{1}{m}\sum_{i=1}^{m} {\ell}_{\rho}(f(x_i),y_i)+2\rho^{-1}   \hat \Rcal_{m}(\Fcal_{\hat S})+3 \sqrt{\frac{\ln(2/\delta)}{2m}}   

\Fcal_{\hat S,\tau} =\{x\mapsto f(x) : \forall \bar S \subseteq \hat S,  \forall(u, k) \in \bar S \times \NN^+, \|\vect[\partial ^{k}f(u)]\| _{2}\le \tau_{\bar S} \},

\Ical_t^{S,\bar S}= \left\{i \in [m] : t= \argmin_{t\in \{1,\dots,|\bar S|\}} \|x_{i}-u_{t}^{\bar S}\|_{2} \right\}.

\scalebox{0.9}{}  
\\ 
\scalebox{0.93}{}   

\sum_{k=1}^K \vect[\partial ^{k}f(u)]\T (x-u)^{\otimes k}\le\sum_{k=1}^K \|\vect[\partial ^{k}f(u)]\|_{2} \|x-u\|^{k}_2. 

\lim_{K \rightarrow \infty}\sum_{k=1}^K \|\vect[\partial ^{k}f(u)]\|_{2} \|x-u\|^{k}_2 \le\tau_{\bar S} \lim_{K \rightarrow \infty}\sum_{k=1}^K\|x-u\|^{k}_2 .   

\lim_{K \rightarrow \infty}\sum_{k=1}^K\|x-u\|^{k}_2 \le \frac{1}{1-R}-1. 
 \label{eq:9}
\sum_{k=1}^\infty \vect[\partial ^{k}f(u)]\T (x-u)^{\otimes k} \le \frac{\tau_{\bar S}}{1-R}-1.

\hat\Rcal_{m}(\Fcal_{\hat S,\tau}) = \EE_{\xi} \sup_{f \in\Fcal_{\hat S,\tau}} \frac{1}{m} \sum_{i=1}^m \xi_i f(x_{i}) =  \EE_{\xi} \sup_{f \in\Fcal_{\hat S,\tau}} \frac{1}{m} \sum_{i=1}^m \xi_i f(u_{\hat t(x_{i})}^{\bar S}+(x_{i}-u_{\hat t(x_{i})}^{\bar S})). 

\hat\Rcal_{m}(\Fcal_{\hat S,\tau}) & = \EE_{\xi} \sup_{f \in\Fcal_{\hat S,\tau}} \frac{1}{m} \sum_{i=1}^m \xi_i f(u_{\hat t(x_{i})}^{\bar S}+(x-u_{\hat t(x_{i})}^{\bar S})) 
\\ &=\EE_{\xi} \sup_{f \in\Fcal_{\hat S,\tau}} \frac{1}{m} \sum_{i=1}^m \xi_i\left(  f(u_{\hat t(x_{i})}^{\bar S})+\sum_{k=1}^\infty \vect[\partial ^{k}f(u_{\hat t(x_{i})}^{\bar S})]\T (x_{i}-u_{\hat t(x_{i})}^{\bar S})^{\otimes k} \right)

&\hat \Rcal_{m}(\Fcal_{\hat S,\tau})
\\ &= \EE_{\xi} \sup_{f \in\Fcal_{\hat S,\tau}} \frac{1}{m} \sum_{i=1}^m \xi_i\left(  f(u_{\hat t(x_{i})}^{\bar S})+\sum_{k=1}^\infty \vect[\partial ^{k}f(u_{\hat t(x_{i})}^{\bar S})]\T (x_{i}-u_{\hat t(x_{i})}^{\bar S})^{\otimes k} \right) 
\\ & = \EE_{\xi} \sup_{f \in\Fcal_{\hat S,\tau}} \frac{1}{m} \sum_{t=1}^{|\bar S|}\sum_{i\in \Ical_t^{S,\bar S}} \xi_i\left(  f(u_{\hat t(x_{i})}^{\bar S})+\sum_{k=1}^\infty \vect[\partial ^{k}f(u_{\hat t(x_{i})}^{\bar S})]\T (x_{i}-u_{\hat t(x_{i})}^{\bar S})^{\otimes k} \right) 
\\ & = \EE_{\xi} \sup_{f \in\Fcal_{\hat S,\tau}} \frac{1}{m} \sum_{t=1}^{|\bar S|}\sum_{i\in \Ical_t^{S,\bar S}} \xi_i\left(  f(u_{t}^{\bar S})+\sum_{k=1}^\infty \vect[\partial ^{k}f(u_{t}^{\bar S})]\T (x_{i}-u_{t}^{\bar S})^{\otimes k} \right) 
\\ & = \frac{1}{m}\EE_{\xi}  \sup_{f \in\Fcal_{\hat S,\tau}} \left[ \sum_{t=1}^{|\bar S|}\sum_{i\in \Ical_t^{S,\bar S}} \xi_i  f(u_{t}^{\bar S})+\sum_{t=1}^{|\bar S|}  \sum_{i\in \Ical_t^{S,\bar S}}\xi_i\sum_{k=1}^\infty \vect[\partial ^{k}f(u_{t}^{\bar S})]\T (x_{i}-u_{t}^{\bar S})^{\otimes k} \right]
\\ & \scalebox{0.95}{}
 \label{eq:10}
\nonumber &\hat \Rcal_{m}(\Fcal_{\hat S,\tau})
\\ \nonumber  &\le  \scalebox{0.95}{}
\\ \nonumber & \le \frac{1}{m}\EE_{\xi} \left[  \sum_{t=1}^{|\bar S|}  \left|\sum_{i\in \Ical_t^{S,\bar S}} \xi_i \right| +\tau_{\bar S}\sum_{t=1}^{|\bar S|} \sum_{k=1}^\infty    \left\|\sum_{i\in \Ical_t^{S,\bar S}}\xi_i(x_{i}-u_{t}^{\bar S})^{\otimes k} \right\|_2 \right]
 \\ & =\frac{1}{m}  \sum_{t=1}^{|\bar S|} \EE_{\xi}   \sqrt{\left(\sum_{i\in \Ical_t^{S,\bar S}} \xi_i\right)^2 } +\frac{\tau_{\bar S}}{m}\sum_{t=1}^{|\bar S|} \sum_{k=1}^\infty  \EE_{\xi}  \left\|\sum_{i\in \Ical_t^{S,\bar S}}\xi_i(x_{i}-u_{t}^{\bar S})^{\otimes k} \right\|_2
 
\EE_{\xi}   \sqrt{\left(\sum_{i\in \Ical_t^{S,\bar S}} \xi_i\right)^2 } \le  \sqrt{\EE_{\xi} \left(\sum_{i\in \Ical_t^{S,\bar S}} \xi_i\right)^2}=  \sqrt{\EE_{\xi} \sum_{i\in \Ical_t^{S,\bar S}} \sum_{j\in \Ical_t^{S,\bar S}} \xi_i \xi_j } &=  \sqrt{ \sum_{i\in \Ical_t^{S,\bar S}} \sum_{j\in \Ical_t^{S,\bar S}} \EE_{\xi}[\xi_i \xi_j]}
\\ & =  \sqrt{ \sum_{i\in \Ical_t^{S,\bar S}} \EE_{\xi}[\xi_i^{2}]}   
 \label{eq:11}
\EE_{\xi}   \sqrt{\left(\sum_{i\in \Ical_t^{S,\bar S}} \xi_i\right)^2 } \le   \sqrt{|\Ical_t^{S,\bar S}|}

\EE_{\xi}  \left\|\sum_{i\in \Ical_t^{S,\bar S}}\xi_i(x_{i}-u_{t}^{\bar S})^{\otimes k} \right\|_2 &=\EE_{\xi}   \sqrt{ \sum_{i\in \Ical_t^{S,\bar S}}\sum_{j\in \Ical_t^{S,\bar S}}\xi_i\xi_j((x_{i}-u_{t}^{\bar S})^{\otimes k})\T (x_{j}-u_{t}^{\bar S})^{\otimes k} }
\\ & \le \sqrt{ \sum_{i\in \Ical_t^{S,\bar S}}\sum_{j\in \Ical_t^{S,\bar S}}\EE_{\xi}[\xi_i\xi_j]((x_{i}-u_{t}^{\bar S})^{\otimes k})\T (x_{j}-u_{t}^{\bar S})^{\otimes k} }
\\ & \le \sqrt{  \sum_{i\in \Ical_t^{S,\bar S}} \EE_{\xi}[\xi_i^2]\|(x_{i}-u_{t}^{\bar S})^{\otimes k}\|_2^2 }
 \label{eq:12}
\nonumber \EE_{\xi}  \left\|\sum_{i\in \Ical_t^{S,\bar S}}\xi_i(x_{i}-u_{t}^{\bar S})^{\otimes k} \right\|_2 \le \sqrt{  \sum_{i\in \Ical_t^{S,\bar S}} \|(x_{i}-u_{t}^{\bar S})^{\otimes k}\|_2^2 } &= \sqrt{  \sum_{i\in \Ical_t^{S,\bar S}} (\|x_{i}-u_{t}^{\bar S}\|_2)^{2k} } \\ &\le R_{S,\bar S}^{k} \sqrt{  |\Ical_t^{S,\bar S}| } 

m\hat \Rcal_{m}(\Fcal_{\hat S,\tau})\le  \sum_{t=1}^{|\bar S|}    \sqrt{|\Ical_t^{S,\bar S}|} +\tau_{\bar S}\sum_{t=1}^{|\bar S|} \sqrt{  |\Ical_t^{S,\bar S}| }  \sum_{k=1}^\infty  R_{S,\bar S}^{k}. 

m\hat \Rcal_{m}(\Fcal_{\hat S,\tau})\le  \sum_{t=1}^{|\bar S|}    \sqrt{|\Ical_t^{S,\bar S}|} +\frac{\tau_{\bar S} R_{S,\bar S}}{1-R_{S,\bar S}}\sum_{t=1}^{|\bar S|} \sqrt{  |\Ical_t^{S,\bar S}| } = \left(1+\frac{\tau_{\bar S} R_{S,\bar S}}{1-R_{S,\bar S}}\right)\sum_{t=1}^{|\bar S|} \sqrt{  |\Ical_t^{S,\bar S}| }  . 

\hat \Rcal_{m}(\Fcal_{\hat S,\tau})\le   \left(1+\frac{\tau_{\bar S} R_{S,\bar S}}{1-R_{S,\bar S}}\right) \frac{\sum_{t=1}^{|\bar S|} \sqrt{  |\Ical_t^{S,\bar S}| }}{m}.
 \label{eq:16}
\hat \Rcal_{m}(\Fcal_{\hat S,\tau}) = \EE_{\xi} \sup_{f \in\Fcal_{\hat S,\tau}} \frac{1}{m} \sum_{i=1}^m \xi_i f(x_{i}) \le \min_{\bar S \in\Scal_{S,\hat S} }    \left(1+\frac{\tau_{\bar S}  R_{S,\bar S}}{1-R_{S,\bar S}}\right) \frac{\sum_{t=1}^{|\bar S|} \sqrt{  |\Ical_t^{S,\bar S}| }}{m}. 

 \scalebox{0.99}{}
 \label{eq:17}
\EE_{x,y}[\ell_{01}(f(x),y)]\le \frac{1}{m}\sum_{i=1}^{m} \ell_{\rho}(f(x_i),y_i)+      \frac{2\rho^{-1}(1+\tau_{\bar S})}{\sqrt{m}}+3 \sqrt{\frac{\ln(2/\delta)}{2m}},
 
&\EE_{x,y}[\ell_{01}(f(x),y)]  \le \frac{1}{m}\sum_{i=1}^{m}\ell_{01}(f(x),y)+\frac{\EE_S\left[\min_{\bar S \in\Scal_{S,\hat S}^* } \sum_{t=1}^{|\bar S|} \sqrt{|\Ical_t^{S,\bar S}|} \right]}{m}+ \sqrt{\frac{\ln(2/\delta)}{2m}}.   
\\ & \EE_{x,y}[\ell_{01}(f(x),y)]  \le \frac{1}{m}\sum_{i=1}^m\ell_{01}(f(x),y)+\frac{\min_{\bar S \in\Scal_{S,\hat S}^* } \sum_{t=1}^{|\bar S|} \sqrt{|\Ical_t^{S,\bar S}|}}{m}+3 \sqrt{\frac{\ln(1/\delta)}{2m}}.   

\varsigma(f(x))=\begin{cases}+1 & \text{ if } f(x) - \frac{1}{2} > 0\\
-1 & \text{ if } f(x) - \frac{1}{2} \le 0 \\
\end{cases}
 \label{eq:13}
\ell_{01}(f(x),y)=\one\{\varsigma(f(x))\neq y\}= \frac{1-y\varsigma(f(x))}{2}
 \label{eq:14}
\EE_{x,y}[\ell_{01}(f(x),y)]  \le \frac{1}{m}\sum_{i=1}^{m}\ell_{01}(f(x),y)+2\Rcal_{m}(\ell_{01} \circ \Fcal_{\hat S,\tau})+ \sqrt{\frac{\ln(2/\delta)}{2m}}.   
 \label{eq:15}
\EE_{x,y}[\ell_{01}(f(x),y)]  \le \frac{1}{m}\sum_{i=1}^{m}\ell_{01}(f(x),y)+2\hat \Rcal_{m}(\ell_{01} \circ \Fcal_{\hat S,\tau})+3 \sqrt{\frac{\ln(1/\delta)}{2m}}.   

\hat \Rcal_{m}(\ell_{01} \circ\Fcal_{\bar S}) &=\EE_{\xi} \sup_{f \in\Fcal_{\hat S,\tau}} \frac{1}{m} \sum_{i=1}^m \xi_i \ell_{01}(f(x_{i}),y_{i})
\\ & =\EE_{\xi} \sup_{f \in\Fcal_{\hat S,\tau}} \frac{1}{m} \sum_{i=1}^m \xi_i \frac{1-y_{i}\varsigma(f(x_{i}))}{2}   
\\ & =\EE_{\xi} \sup_{f \in\Fcal_{\hat S,\tau}} \frac{1}{m} \sum_{i=1}^m  \frac{-\xi_iy_{i}\varsigma(f(x_{i}))}{2}
 \\ & =\frac{1}{2m}\EE_{\xi} \sup_{f \in\Fcal_{\hat S,\tau}}  \sum_{i=1}^m \xi_i\varsigma(f(x_{i})).

f(x_{i})=f(u_{\hat t(x_{i})}^{\bar S})+\sum_{k=1}^\infty \vect[\partial ^{k}f(u_{\hat t(x_{i})}^{\bar S})]\T (x_{i}-u_{\hat t(x_{i})}^{\bar S})^{\otimes k}. 

\hat\Rcal_{m}(\ell_{01} \circ\Fcal_{\bar S}) & =\frac{1}{2m}\EE_{\xi} \sup_{f \in\Fcal_{\hat S,\tau}}  \sum_{i=1}^m \xi_i\varsigma \left(f(u_{\hat t(x_{i})}^{\bar S})+\sum_{k=1}^\infty \vect[\partial ^{k}f(u_{\hat t(x_{i})}^{\bar S})]\T (x_{i}-u_{\hat t(x_{i})}^{\bar S})^{\otimes k} \right)
\\ & =\frac{1}{2m}\EE_{\xi} \sup_{f \in\Fcal_{\hat S,\tau}}  \sum_{t=1}^{|\bar S|}\sum_{i\in \Ical_t^{S,\bar S}} \xi_i\varsigma \left(f(u_{t}^{\bar S})+\sum_{k=1}^\infty \vect[\partial ^{k}f(u_{t}^{\bar S})]\T (x_{i}-u_{t}^{\bar S})^{\otimes k} \right) 

\left|\sum_{k=1}^\infty \vect[\partial ^{k}f(u_{t}^{\bar S})]\T (x_{i}-u_{t}^{\bar S})^{\otimes k} \right|
& \le \sum_{k=1}^\infty \| \vect[\partial ^{k}f(u_{t}^{\bar S})]\|_2 \|(x_{i}-u_{t}^{\bar S})^{\otimes k} \|_2
\\ & \le\tau_{\bar S} \frac{ R_{S,\bar S} }{1-R_{S,\bar S} } 
\\ & <  \Ccal_{\bar S}   

\hat\Rcal_{m}(\ell_{01} \circ\Fcal_{\bar S})
 & =\frac{1}{2m}\EE_{\xi} \sup_{f \in\Fcal_{\hat S,\tau}}  \sum_{t=1}^{|\bar S|}\sum_{i\in \Ical_t^{S,\bar S}} \xi_i\varsigma \left(f(u_{t}^{\bar S})+\sum_{k=1}^\infty \vect[\partial ^{k}f(u_{t}^{\bar S})]\T (x_{i}-u_{t}^{\bar S})^{\otimes k} \right) 
\\ & =\frac{1}{2m}\EE_{\xi} \sup_{f \in\Fcal_{\hat S,\tau}}  \sum_{t=1}^{|\bar S|} \varsigma \left(f(u_{t}^{\bar S}) \right)  \sum_{i\in \Ical_t^{S,\bar S}} \xi_i
\\ & \le \frac{1}{2m}\EE_{\xi}   \sum_{t=1}^{|\bar S|} \sup_{f \in\Fcal_{\hat S,\tau}} \left|\varsigma \left(f(u_{t}^{\bar S}) \right) \right| \left| \sum_{i\in \Ical_t^{S,\bar S}} \xi_i \right|
\\ & \le \frac{1}{2m}   \sum_{t=1}^{|\bar S|}  \EE_{\xi} \sqrt{ \left(\sum_{i\in \Ical_t^{S,\bar S}} \xi_i \right)^2}
 
\EE_{\xi}   \sqrt{\left(\sum_{i\in \Ical_t^{S,\bar S}} \xi_i\right)^2 } \le  \sqrt{\EE_{\xi} \left(\sum_{i\in \Ical_t^{S,\bar S}} \xi_i\right)^2}=   \sqrt{ \sum_{i\in \Ical_t^{S,\bar S}} \sum_{j\in \Ical_t^{S,\bar S}} \EE_{\xi}[\xi_i \xi_j]}
& =  \sqrt{ \sum_{i\in \Ical_t^{S,\bar S}} \EE_{\xi}[\xi_i^{2}]}   
\\ & =   \sqrt{|\Ical_t^{S,\bar S}|}

\hat\Rcal_{m}(\ell_{01} \circ\Fcal_{\bar S}) \le \frac{1}{2m}   \sum_{t=1}^{|\bar S|} \sqrt{|\Ical_t^{S,\bar S}|}.

\hat\Rcal_{m}(\ell_{01} \circ\Fcal_{\bar S}) \le \frac{1}{2m}   \min_{\bar S \in\Scal_{S,\hat S}^* } \sum_{t=1}^{|\bar S|} \sqrt{|\Ical_t^{S,\bar S}|}. 
 
&\EE_{x,y}[\ell_{01}(f(x),y)]  \le \frac{1}{m}\sum_{i=1}^{m}\ell_{01}(f(x),y)+\frac{\EE_S\left[\min_{\bar S \in\Scal_{S,\hat S}^* } \sum_{t=1}^{|\bar S|} \sqrt{|\Ical_t^{S,\bar S}|} \right]}{m}+ \sqrt{\frac{\ln(2/\delta)}{2m}}.   
\\ & \EE_{x,y}[\ell_{01}(f(x),y)]  \le \frac{1}{m}\sum_{i=1}^{m}\ell_{01}(f(x),y)+\frac{\min_{\bar S \in\Scal_{S,\hat S}^* } \sum_{t=1}^{|\bar S|} \sqrt{|\Ical_t^{S,\bar S}|}}{m}+3 \sqrt{\frac{\ln(1/\delta)}{2m}}.   
 \label{eq:18}
\EE_{x,y}[\ell_{01}(f(x),y)]  \le \frac{1}{m}\sum_{i=1}^m\ell_{01}(f(x),y)+\frac{1}{\sqrt m}+3 \sqrt{\frac{\ln(1/\delta)}{2m}},

\Rcal_{m}(\Fcal_{\hat S}) \le \hat \Rcal_{m}( \Fcal_{\hat S}) +C \sqrt{\frac{\log (1/\delta)}{m}}.

\frac{1}{m} \EE_{\sigma}\left[\sup_{f \in \Fcal} \sum_{i=1}^m \xi_i (\Psi_i \circ f)(x_i) \right] \le  \frac{\mu}{m} \EE_{\sigma}\left[\sup_{f \in \Fcal} \sum_{i=1}^m \xi_i f(x_i) \right]. 
  
\end{lemma}
\begin{proof} See the proof of \citep[Lemma 8]{mohri2014learning}.
\end{proof}


\bibliographystyle{icml}
\bibliography{ijcai19}

\end{document}
