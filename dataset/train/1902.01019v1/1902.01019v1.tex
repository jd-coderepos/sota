\documentclass[conference]{IEEEtran}

\usepackage[cmex10]{amsmath}
\usepackage{amsthm}
\usepackage{amssymb}
\usepackage{mathrsfs}
\usepackage{graphicx}
\usepackage{float}
\usepackage{array}
\usepackage{epstopdf}
\usepackage{multirow}
\usepackage{color,soul}
\usepackage{epstopdf}
\usepackage{subcaption}

\newcommand{\argmin}{\arg\!\min}
\newcommand{\argmax}{\arg\!\max}

\def\x{{\mathbf x}}
\def\L{{\cal L}}

\hyphenation{op-tical net-works semi-conduc-tor}


\begin{document}




\title{Deep-Emotion: Facial Expression Recognition Using Attentional Convolutional Network}


\author{Shervin~Minaee, Amirali Abdolrashidi  \\ Expedia Group \\ University of California, Riverside}


\maketitle


\begin{abstract}
Facial expression recognition has been an active research area over the past few decades, and it is still challenging due to the high intra-class variation. 
   Traditional approaches for this problem rely on hand-crafted features such as SIFT, HOG and LBP, followed by a classifier trained on a database of images or videos. 
   Most of these works perform reasonably well on datasets of images captured in a controlled condition, but fail to perform as good on more challenging datasets with more image variation and partial faces. 
   In recent years, several works proposed an end-to-end framework for facial expression recognition, using deep learning models. 
   Despite the better performance of these works, there still seems to be a great room for improvement.
   In this work, we propose a deep learning approach based on attentional convolutional network, which is able to focus on important parts of the face, and achieves significant improvement over previous models on multiple datasets, including FER-2013, CK+, FERG, and JAFFE.
   We also use a visualization technique which is able to find important face regions for detecting different emotions, based on the classifier's output. 
  Through experimental results, we show that different emotions seems to be sensitive to different parts of the face.
\end{abstract}


\IEEEpeerreviewmaketitle



\section{Introduction}
Emotions are an inevitable portion of any inter-personal communication. They can be expressed in many different forms which may or may not be observed with the naked eye. 
Therefore, with the right tools, any indications preceding or following them can be subject to detection and recognition.
There has been an increase in the need to detect a person's emotions in the past few years. 
There has been interest in human emotion recognition in various fields including, but not limited to, human-computer interface \cite{hci}, animation \cite{aneja2016modeling}, medicine \cite{edwards2002emotion,chu2017facial} and security \cite{clavel2008fear,saste2017emotion}.

Emotion recognition can be performed using different features, such as face \cite{aneja2016modeling,mollahosseini2016going,liu2014facial}, speech \cite{han2014speech,clavel2008fear}, EEG \cite{petrantonakis2010emotion}, and even text \cite{wu2006emotion}. Among these features, facial expressions are one of the most popular, if not the most popular, due to a number of reasons; they are visible, they contain many useful features for emotion recognition, and it is easier to collect a large dataset of faces (than other means for human recognition) \cite{aneja2016modeling, lyons1998japanese, carrier2013fer}. 

\begin{figure}[t]
\begin{center}
    \begin{tabular}{cc}
    \includegraphics[width=0.68\linewidth]{happy_fer.png} & \rotatebox{90}{\ \ \ \ Happiness} \\
    \includegraphics[width=0.68\linewidth]{sad_ck.png} & \rotatebox{90}{\ \ \ \ \ Sadness} \\
    \includegraphics[width=0.68 \linewidth]{angry11_fer.png} & \rotatebox{90}{\ \ \ \ \ Anger} \\
    \includegraphics[width=0.68 \linewidth]{anger_ck.png} & \rotatebox{90}{\ \ \ \ \ Anger} \\
    \end{tabular}
\end{center}
   \caption{The detected salient regions for different facial expressions by our model. The images in the first and third rows are taken from FER dataset, and the images in the second and fourth rows belong to the extended Cohn-Kanade dataset. }
\label{fig:sample_res}
\vspace{-3mm}
\end{figure}
Recently, with the use of deep learning and especially convolutional neural networks (CNNs) \cite{lecun1989generalization}, many features can be extracted and learned for a decent facial expression recognition system \cite{khorrami2015deep,tzirakis2017end}. 
It is, however, noteworthy that in the case of facial expressions, much of the clues come from a few parts of the face, e.g. the mouth and eyes, whereas other parts, such as ears and hair, play little part in the output \cite{cohn1995computerized}. 
This means that ideally, the machine learning framework should  focus only on the important parts of the face,  and less sensitive to other face regions.

In this work we propose a deep learning based framework for facial expression recognition, which takes the above observation into account, and uses attention mechanism to focus on the salient part of the face. We show that by using attentional convolutional network, even a network with few layers (less than 10 layers) is able to achieve very high accuracy rate. 
More specifically, this paper presents the following contributions:
\begin{itemize}
\item We propose an approach based on an attentional convolutional network, which can  focus on feature-rich parts of the face, and yet, outperform remarkable recent works in accuracy.
\item In addition, we use the visualization technique proposed in \cite{fergus} to highlight the face image's most salient regions, i.e. the parts of the image which have the strongest impact on the classifier's outcome. Samples of salient regions for different emotions are shown in Figure \ref{fig:sample_res}.
\end{itemize}
In the following sections, we first provide an overview of related works in Section II.
The proposed framework and model architecture are explained in Section III. 
We will then provide the experimental results, overview of databases used in this work, and also model visualization in Section IV.
Finally we conclude the paper in Section V.



\section{Related Works}
In one of the most iconic works in emotion recognition by Paul Ekman \cite{ekman1971constants}, happiness, sadness, anger, surprise, fear and disgust were identified as the six principal emotions (besides neutral). 
Ekman later developed FACS \cite{FACS} using this concept, thus setting the standard for works on emotion recognition ever since. 
Neutral was also included later on, in most of human recognition datasets, resulting in seven basic emotions.
Image samples of these emotions from three datasets are displayed in Figure \ref{fig:FACSImage}.

\begin{figure}[h]
\begin{center}
   \includegraphics[page=2,width=\linewidth,trim={0cm 0.8cm 0cm 0cm}]{NetArch.pdf}
\end{center}
   \caption{(Left to right) The six cardinal emotions (happiness, sadness, anger, fear, disgust, surprise) and neutral. The images in the first, second and the third rows belong to FER, JAFFE and FERG datasets respectively.}
\label{fig:FACSImage}
\end{figure}

Earlier works on emotion recognition, rely on the traditional two-step machine learning approach, where in the first step, some features are extracted from the images, and in the second step, a classifier (such as SVM, neural network, or random forest) are used to detect the emotions.
Some of the popular hand-crafted features used for facial expression recognition include the histogram of oriented gradients (HOG) \cite{mcconnell1986method,chen2014facial}, local binary patterns (LBP) \cite{shan2009facial}, Gabor wavelets \cite{bartlett2005recognizing} and Haar features \cite{whitehill2006haar}. 
A classifier would then assign the best emotion to the image. 
These approaches seemed to work fine on simpler datasets, but with the advent of more challenging datasets (which have more intra-class variation), they started to show their limitation. 
To get a better sense of some of the possible challenges with the images, we refer the readers to the images in the first row of Figure 2, where the image can have partial face, or the face can be occluded with hand or eye-glasses.

With the great success of deep learning, and more specifically convolutional neural networks for image classification and other vision problems \cite{alexnet,resnet,semseg,maskrcnn,iriscnn,adnet,aae,gan}, several groups developed deep learning-based models for facial expression recognition (FER).
To name some of the promising works, Khorrami in \cite{khorrami2015deep} showed that CNNs can achieve a high accuracy in emotion recognition and used a zero-bias CNN on the extended Cohn-Kanade dataset (CK+) and the Toronto Face Dataset (TFD)  to achieve state-of-the-art results.
Aneja et al \cite{aneja2016modeling} developed a model of facial expressions for stylized animated characters based on deep learning by training a network for modeling the expression of human faces, one for that of animated faces, and one to map human images into animated ones.
Mollahosseini \cite{mollahosseini2016going} proposed a neural network for FER using two convolution layers, one max pooling layer, and four ``inception'' layers, i.e. sub-networks.
Liu in \cite{liu2014facial} combines the feature extraction and classification in a single looped network, citing the two parts' need for feedback from each other. They used their Boosted Deep Belief Network (BDBN) on CK+ and JAFFE, achieving state-of-the-art accuracy.
Barsoum et al \cite{barsoum2016training} worked on using a deep CNN on noisy labels acquired via crowd-sourcing for ground truth images. They used 10 taggers to re-label each image in the dataset, and used various cost functions for their DCNN, achieving decent accuracy.
Han et al \cite{IBCNN} proposed an incremental boosting CNN (IB-CNN) in order to improve the recognition of spontaneous facial expressions by boosting the discriminative neurons, improving over the best methods of the time.
Meng in \cite{IACNN} proposed an identity-aware CNN (IA-CNN) which used identity- and expression-sensitive contrastive losses to reduce the variations in learning  identity- and expression-related information.



All of the above works achieve significant improvements over the traditional works on emotion recognition, but there seems to be missing a simple piece for attending to the important face regions for emotion detection. 
In this work, we try to address this problem, by proposing a framework based on attentional convolutional network, which is able to focus on salient face regions.




\begin{figure*}[t]
\begin{center}
   \includegraphics[page=1,width=\linewidth,trim={0cm 0.7cm 0cm 0cm}]{NetArch.pdf}
\end{center}
   \caption{The proposed model architecture}
\label{fig:NetArch}
\end{figure*}




\section{The Proposed Framework}
We propose an end-to-end deep learning framework, based on attentional convolutional network, to classify the underlying emotion in the face images.
Often times, improving a deep neural network relies on adding more layers/neurons, facilitating gradient flow in the network (e.g. by adding adding skip layers), or better regularizations (e.g. spectral normalization), especially for classification problems with a large number of classes.
However, for facial expression recognition, due to the small number of classes, we show that using a convolutional network with less than 10 layers and attention (which is trained from scratch) is able to achieve promising results, beating state-of-the-art models in several databases.

Given a face image, it is clear that not all parts of the face are important in detecting a specific emotion, and in many cases, we only need to attend to the specific regions to get a sense of the underlying emotion.
Based on this observation, we add an attention mechanism, through spatial transformer network into our framework to focus on important face regions. 

Figure \ref{fig:NetArch} illustrates the proposed model architecture.
The feature extraction part consists of four convolutional layers, each two followed by max-pooling layer and rectified linear unit (ReLU) activation function. 
They are then followed by a dropout layer and two fully-connected layers.
The spatial transformer (the localization network) consists of two convolution layers (each followed by max-pooling and ReLU), and two fully-connected layers.
After regressing the transformation parameters, the input is transformed to the sampling grid  producing the warped data.
The spatial transformer module essentially tries to focus on the most relevant part of the image, by estimating a sample over the attended region. One can use different transformations to warp the input to the output, here we used an affine transformation which is commonly used for many applications.
For further details about the spatial transformer network, please refer to \cite{STN}


This model is then trained by optimizing a loss function using  stochastic gradient descent approach (more specifically Adam optimizer). The loss function in this work is simply the summation of two terms, the classification loss (cross-entropy), and the regularization term (which is  norm of the weights in the last two fully-connected layers.



The regularization weight, , is tuned on the validation set. 
Adding both dropout and  regularization enables us to train our models from scratch even on very small datasets, such as JAFFE and CK+. 
It is worth mentioning that we train a separate model for each one of the databases used in this work.
We also tried a network architecture with more than 50 layers, but the accuracy did not improve much. Therefore the simpler model shown here was used in the end.







\section{Experimental Results}
In this section we provide the detailed experimental analysis of our model on several facial expression recognition databases. We first provide a brief overview the databases used in this work, we then provide the performance of our models on four databases and compare the results with some of the promising recent works. 
We then provide the salient regions detected by our trained model using a visualization technique. 
\subsection{Databases}
In this work, we provide the experimental analysis of the proposed model on several popular facial expression recognition datasets, including FER2013 \cite{carrier2013fer}, the extended Cohn-Kanade \cite{ckplus}, Japanese Female Facial Expression (JAFFE) \cite{lyons1998japanese}, and Facial Expression Research Group Database (FERG) \cite{aneja2016modeling}.
Before diving into the results, we are going to give a brief overview of these databases.

\textbf{FER2013}: The Facial Expression Recognition 2013 (FER2013) database was first introduced in the ICML 2013 Challenges in Representation Learning \cite{carrier2013fer}.
This dataset contains 35,887 images of 48x48 resolution, most of which are taken in wild settings. Originally the training set contained 28,709 images,and validation and test each include 3,589 images.
This database was created using the Google image search API and faces are automatically registered.
Faces are labeled as any of the six cardinal expressions as well as neutral.
Compared to the other datasets, FER has more variation in the images, including face occlusion (mostly with hand), partial faces, low-contrast images, and eyeglasses.
Four sample images from FER dataset are shown in Figure \ref{fig:FER}.
\begin{figure}[h]
\begin{center}
   \includegraphics[width=1.02\linewidth]{FER2013.png}
\end{center}
   \caption{Four sample images from FER database}
\label{fig:FER}
\end{figure}


\textbf{CK+}:
The extended Cohn-Kanade (known as CK+) facial expression database \cite{ckplus} is a public dataset for action unit and emotion recognition.
It includes both posed and non-posed (spontaneous) expressions.
The CK+ comprises a total of 593 sequences across 123 subjects.
In most of previous works, the last frame of these sequences are taken and used for image based facial expression recognition.
Six sample images from this dataset are shown in Figure \ref{fig:CKdata}.
\begin{figure}[h]
\begin{center}
   \includegraphics[width=0.9\linewidth]{ck+.png}
\end{center}
   \caption{Six sample images from CK+ database}
\label{fig:CKdata}
\end{figure}

\textbf{JAFFE}: This dataset contains 213 images of the 7 facial expressions posed by 10 Japanese female models. 
Each image has been rated on 6 emotion adjectives by 60 Japanese subjects \cite{lyons1998japanese}. 
Four sample images from this dataset are shown in Figure \ref{fig:JAFFE}.
\begin{figure}[h]
\begin{center}
   \includegraphics[width=0.85\linewidth]{Jaffe.png}
\end{center}
   \caption{Four sample images from JAFFE database}
\label{fig:JAFFE}
\end{figure}


\textbf{FERG}:
FERG is a database of stylized characters with annotated facial expressions. The database contains 55,767 annotated face images of six stylized characters. The characters were modeled using MAYA. 
The images for each character are grouped into seven types of expressions \cite{aneja2016modeling}. Six sample images from this database are shown in Figure \ref{fig:FERG}.
We mainly wanted to try our algorithm on this database to see how it performs on cartoonish characters.
\begin{figure}[h]
\begin{center}
   \includegraphics[width=0.7\linewidth]{FERG.png}
\end{center}
   \caption{Six sample images from FERG database}
\label{fig:FERG}
\end{figure}


\subsection{Experimental Analysis and Comparison}
We will now present the performance of the proposed model on the above datasets. In each case, we train the model on a subset of that dataset and validate on validation set, and report the accuracy over the test set. 

Before getting into the details of the model's performance on different datasets, we briefly discuss our training procedure.
We trained one model per dataset in our experiments, but we tried to keep the architecture and hyper-parameters similar among these different models. 
Each model is trained for 500 epochs from scratch, on an AWS EC2 instance with a Nvidia Tesla K80 GPU.
We initialize the network weights with random Gaussian variables with zero mean and 0.05 standard deviation. 
For optimization, we used Adam optimizer with a learning rate of 0.005 with weight decay (Different optimizer were tried, including stochastic gradient descents, and Adam seemed to be performing slightly better).
It takes around 2-4 hours to train our models on FER and FERG datasets. For JAFFE and CK+, since there are much fewer images, it takes less than 10 minutes to train a model.
Data augmentation is used for the images in the training sets to train the model on a larger number of images, and make the trained model for invariant on small transformations.

As discussed before, FER-2013 dataset is more challenging than other facial expression recognition datasets we used. 
Besides the intra-class variation of FER, another main challenge in this dataset is the imbalance nature of different emotion classes. Some of the classes such as happiness and neutral have a lot more examples than others. 
We used the entire 28,709 images in the training set to train the model, validated on 3.5k validation images, and report the model accuracy on the 3,589 images in the test set. 
We were able to achieve an accuracy rate of around 70.02\% on the test set.
The confusion matrix on the test set of FER dataset is shown in Figure \ref{fig:ConfusionFER}. 
As we can see, the model is making more mistakes for classes with less samples such as disgust and fear.
\begin{figure}[h]
\begin{center}
   \includegraphics[width=0.9\linewidth]{fer_final.png}
\end{center}
   \caption{The confusion matrix of the proposed model on the test set of FER dataset}
\label{fig:ConfusionFER}
\end{figure}


The comparison of the result of our model with some of the previous works on FER 2013 are provided in Table \ref{table:FER}.
\begin{table}[h]
\centering
  \caption{Classification Accuracies on FER 2013 dataset}
\begin{tabular}{|m{4cm}|m{2cm}|}
\hline
Method  & Accuracy Rate\\
\hline
Bag of Words \cite{bow}  &  \ \ \ 67.4\%\\
\hline 
VGG+SVM \cite{vggsvm} &   \ \ \  66.31\% \\
\hline 
GoogleNet \cite{googlenet} &   \ \ \  65.2\% \\
\hline 
Mollahosseini et al \cite{mollahosseini2016going} &   \ \ \  66.4\% \\
\hline
 The proposed algorithm  &  \ \ \ 70.02\%\\
\hline
\end{tabular}
\label{table:FER}
\end{table}


For FERG dataset, we use around 34k images for training, 14k for validation, and 7k for testing. For each facial expression, we randomly select 1k images for testing. We were able to achieve an accuracy rate of around 99.3\%.
The confusion matrix on the test set of FERG dataset is shown in Figure \ref{fig:ConfusionFERG}.
\begin{figure}[t]
\begin{center}
   \includegraphics[width=0.99\linewidth]{ferg_conf.png}
\end{center}
   \caption{The confusion matrix on FERG dataset}
\label{fig:ConfusionFERG}
\end{figure}

The comparison between the proposed algorithm and some of the previous works on FERG dataset are provided in Table \ref{table:FERG}.
\begin{table}[h]
\centering
  \caption{Classification Accuracy on FERG dataset}
\begin{tabular}{|m{5cm}|c|}
\hline
Method  & Accuracy Rate\\
\hline
DeepExpr \cite{aneja2016modeling} & \ \ \ 89.02\% \\
\hline 
Ensemble Multi-feature \cite{ensemble} & \ \ \ 97\% \\
\hline 
Adversarial NN \cite{Ad-NN} &   \ \ \ \ 98.2\% \\
\hline
 The proposed algorithm  &  \ \ \ \ 99.3\%\\
\hline
\end{tabular}
\label{table:FERG}
\end{table}

\iffalse
The accuracy of the model (on validation set) over different epochs on FERG is provided in Figure \ref{fig:AccFER}. 
As it can be seen, after the 200th epoch, there are not much improvement in the model performance.
\begin{figure}[h]
\begin{center}
   \includegraphics[width=0.99\linewidth]{ferg.png}
\end{center}
   \caption{FERG validation accuracies over different epochs}
\label{fig:AccFER}
\end{figure}
\fi


For JAFFE dataset, we use 120 images for training, 23 images for validation, and 70 images for test (10 images per emotion in the test set). 
The confusion matrix of the predicted results on this dataset is shown in Figure \ref{fig:ConfusionJAFFE}. The overall accuracy on this dataset is around 92.8\%.
\begin{figure}[t]
\begin{center}
   \includegraphics[width=0.85\linewidth]{Jaffe_confusion.png}
\end{center}
   \caption{The confusion matrix on JAFFE dataset}
\label{fig:ConfusionJAFFE}
\end{figure}

The comparison with previous works on JAFFE dataset are shown in Table \ref{table:JAFFE}.
\begin{table}[h]
\centering
  \caption{Classification Accuracy on JAFFE dataset}
\begin{tabular}{| m{5cm} | c |}
\hline
Method  & Accuracy Rate\\
\hline
Fisherface \cite{fisherface}  &  \ 89.2\%\\
\hline 
Salient Facial Patch \cite{SFP} &   \  91.8\% \\
\hline
CNN+SVM \cite{shima2018image} & 95.31\% \\
\hline
The proposed algorithm  &  \ 92.8\%\\
\hline
\end{tabular}
\label{table:JAFFE}
\end{table}


For CK+, 70\% of the images are used as training, 10\% for validation, and 20\% for testing.
The comparison of our model with previous works onthe extended CK dataset are shown in Table \ref{table:CK}.
\begin{table}[h]
\centering
  \caption{Classification Accuracy on CK+}
\begin{tabular}{|m{4cm}|c|}
\hline
Method  & Accuracy Rate\\
\hline
MSR \cite{MSR}   &  \ 91.4\%\\
\hline 
3DCNN-DAP \cite{3DCNN} &   \  92.4\% \\
\hline 
Inception \cite{mollahosseini2016going} &   \  93.2\% \\
\hline 
IB-CNN \cite{IBCNN} &   \  95.1\% \\
\hline 
IACNN \cite{IACNN} &   \  \ 95.37\% \\
\hline
DTAGN \cite{DTAGN} &   \  97.2\% \\
\hline
ST-RNN \cite{STRNN} &   \  97.2\% \\
\hline
PPDN \cite{PPDN} & \ 97.3\% \\
\hline
 The proposed algorithm  &  \ 98.0\%\\
\hline
\end{tabular}
\label{table:CK}
\end{table}



\subsection{Model Visualization}
Here we provide a simple approach to visualize the important regions while classifying different facial expression, inspired by the work in \cite{fergus}. 
We start from the top-left corner of an image, and each time zero out a square region of size x inside the image, and make a prediction using the trained model on the occluded image.
If occluding that region makes the model to make a wrong prediction on facial expression label, that region would be considered as a potential region of importance in classifying the specific expression. 
On the other hand, if removing that region would not impact the model's prediction, we infer that region is not very important in detecting the corresponding facial expression.
Now if we repeat this procedure for different sliding windows of x, each time shifting them with a stride of , we can get a saliency map for the most important regions in detecting an emotion from different images.

We show nine example cluttered images for a happy and an angry image from JAFFE dataset, and how zeroing out different regions would impact the model prediction. 
As we can see, for the happy face zeroing out the areas around mouth would cause the model to make a wrong prediction, whereas for angry face, zeroing out the areas around eye and eyebrow makes the model to make a mistake.
\begin{figure}[h]
\begin{center}
   \includegraphics[width=0.98\linewidth]{happy_shift.png}
   \includegraphics[width=0.95\linewidth]{angry_shift.png}
\end{center}
   \caption{The impact of zeroing out different image parts, on the model prediction for a happy face (the top three rows) and an angry face (the bottom three rows).}
\label{fig:shifting}
\end{figure}


Figure \ref{fig:SaliencyJAFFE}, shows the important regions of 7 sample images from JAFFE dataset, each corresponding to a different emotion.
There are some interesting observations from these results. 
For example, for the sample image with neutral emotion in the fourth row, the saliency region essentially covers the entire face, which means that all these regions are important to infer that a given image has neutral facial expression. 
This makes sense, since changes in any parts of the face (such as eyes, lips, eyebrows and forehead) could lead to a different facial expression, and the algorithm needs to analyze all those parts in order to correctly classify a neutral image.
This is however not the case for most of the other emotions, such as happiness, and fear, where the areas around the mouth turns out to be more important than other regions.
\begin{figure}[H]
\begin{center}
   \includegraphics[width=0.8\linewidth]{happy2.png} \rotatebox{90}{\ \ \ \ \ \ \  Happy} \\ \vspace{0.05cm}
   \includegraphics[width=0.8\linewidth]{sad0.png} \rotatebox{90}{\ \ \ \ \ \ \   Sad} \\ \vspace{0.05cm}
   \includegraphics[width=0.8\linewidth]{angry3.png} \rotatebox{90}{\ \ \ \ \ \ \   Angry} \\ \vspace{0.06cm}
   \includegraphics[width=0.8\linewidth]{neutral0.png} \rotatebox{90}{\ \ \ \ \ \ \   Neutral} \\ \vspace{0.09cm}
    \includegraphics[width=0.8\linewidth]{surprised3.png} \rotatebox{90}{\ \ \ \ \  Surprised} \\ \vspace{0.1cm}
    \includegraphics[width=0.8\linewidth]{disgust1.png} \rotatebox{90}{\ \ \ \ \ \   Disgust} \\ \vspace{0.12cm}
    \includegraphics[width=0.8\linewidth]{fear2.png} \rotatebox{90}{\ \ \ \ \ \ \  Fear} \\
\end{center}
   \caption{The important regions for detecting different facial expressions. As it can be seen, the saliency maps for happiness, fear and surprised are sparser than other emotions.}
\label{fig:SaliencyJAFFE}
\end{figure}



\begin{figure}[h]
\begin{center}
   \includegraphics[width=0.6\linewidth]{fear2_j.png}
   \includegraphics[width=0.6\linewidth]{fear3_j.png}
   \includegraphics[width=0.6\linewidth]{fear7_j.png}
\end{center}
   \caption{The important regions for three images with fear}
\label{fig:SaliencyFear}
\end{figure}

It is worth mentioning that different images with the same facial expression could have different saliency maps due to the different gestures and variations in the image. 
In Figure \ref{fig:SaliencyFear}, we show the important regions for three images with facial expression of ``fear''. 
As it can be seen from this figure, the important regions for these images are very similar in detecting the mouth, but the last one also considers some part of forehead in the important region. 
This could be because of the strong presence of forehead lines, which is not visible in the two other images. 






\section{Conclusion}
This paper proposes a new framework for facial expression recognition using an attentional convolutional network.
We believe attention is an important piece for detecting facial expressions, which can enable neural networks with less than 10 layers to compete with (and even outperform) much deeper networks for emotion recognition.
We also provided an extensive experimental analysis of our work on four popular facial expression recognition databases, and showed promising results.
Also, we have deployed a visualization method to highlight the salient regions of face images which are the most crucial parts thereof in detecting different facial expressions.


\section*{Acknowledgment}
We would like to express our gratitude to the people at University of Washington Graphics and Imaging Lab (GRAIL) for providing us with access to the FERG database.
We would also like to thank our colleagues and partners for reviewing our work, and providing very useful comments and suggestions.






\begin{thebibliography}{1}
\small
\bibitem{hci}
Cowie, Roddy, Ellen Douglas-Cowie, Nicolas Tsapatsoulis, George Votsis, Stefanos Kollias, Winfried Fellenz, and John G. Taylor. "Emotion recognition in human-computer interaction." IEEE Signal processing magazine 18, no. 1: 32-80, 2001.
\bibitem{aneja2016modeling}
Aneja, Deepali, Alex Colburn, Gary Faigin, Linda Shapiro, and Barbara Mones. "Modeling stylized character expressions via deep learning." In Asian Conference on Computer Vision, pp. 136-153. Springer, Cham, 2016.
\bibitem{edwards2002emotion}
Edwards, Jane, Henry J. Jackson, and Philippa E. Pattison. "Emotion recognition via facial expression and affective prosody in schizophrenia: a methodological review." Clinical psychology review 22.6: 789-832, 2002.
\bibitem{chu2017facial}
Chu, Hui-Chuan, William Wei-Jen Tsai, Min-Ju Liao, and Yuh-Min Chen. "Facial emotion recognition with transition detection for students with high-functioning autism in adaptive e-learning." Soft Computing: 1-27, 2017.
\bibitem{clavel2008fear}
Clavel, Chloé, Ioana Vasilescu, Laurence Devillers, Gaël Richard, and Thibaut Ehrette. "Fear-type emotion recognition for future audio-based surveillance systems." Speech Communication 50, no. 6: 487-503, 2008.
\bibitem{saste2017emotion}
Saste, Sonali T., and S. M. Jagdale. "Emotion recognition from speech using MFCC and DWT for security system." In Electronics, Communication and Aerospace Technology (ICECA), 2017 International conference of, vol. 1, pp. 701-704. IEEE, 2017.
\bibitem{khorrami2015deep}
Khorrami, Pooya, Thomas Paine, and Thomas Huang. "Do deep neural networks learn facial action units when doing expression recognition?." Proceedings of the IEEE International Conference on Computer Vision Workshops. 2015.
\bibitem{kahou2016emonets}
Kahou, Samira Ebrahimi, Xavier Bouthillier, Pascal Lamblin et al. "Emonets: Multimodal deep learning approaches for emotion recognition in video." Journal on Multimodal User Interfaces 10, no. 2: 99-111, 2016.
\bibitem{alexnet}
Krizhevsky, Alex, Ilya Sutskever, and Geoffrey E. Hinton. "Imagenet classification with deep convolutional neural networks." In Advances in neural information processing systems, pp. 1097-1105, 2012.
\bibitem{resnet}
He, Kaiming, Xiangyu Zhang, Shaoqing Ren, and Jian Sun. "Deep residual learning for image recognition." In Proceedings of the IEEE conference on computer vision and pattern recognition, pp. 770-778, 2016.
\bibitem{semseg}
Long, Jonathan, Evan Shelhamer, and Trevor Darrell. "Fully convolutional networks for semantic segmentation." Proceedings of the IEEE conference on computer vision and pattern recognition, 2015.
\bibitem{maskrcnn}
He, K., Gkioxari, G., Dollár, P., \& Girshick, R. ``Mask r-cnn'' International Conference on Computer Vision (pp. 2980-2988). IEEE, 2017.
\bibitem{iriscnn}
Minaee, S., Abdolrashidiy, A.,  Wang, Y. ``An experimental study of deep convolutional features for iris recognition'', In Signal Processing in Medicine and Biology Symposium, IEEE, 2016.
\bibitem{adnet}
Minaee, Shervin, Imed Bouazizi, Prakash Kolan, and Hossein Najafzadeh. "Ad-Net: Audio-Visual Convolutional Neural Network for Advertisement Detection In Videos." arXiv preprint arXiv:1806.08612, 2018.
\bibitem{gan}
Goodfellow, Ian, Jean Pouget-Abadie, Mehdi Mirza, Bing Xu, David Warde-Farley, Sherjil Ozair, Aaron Courville, and Yoshua Bengio. "Generative adversarial nets." In Advances in neural information processing systems, pp. 2672-2680, 2014.
\bibitem{aae}
Minaee, Shervin, Yao Wang, Alp Aygar, Sohae Chung, Xiuyuan Wang, Yvonne W. Lui, Els Fieremans, Steven Flanagan, and Joseph Rath. "MTBI Identification From Diffusion MR Images Using Bag of Adversarial Visual Features." arXiv preprint arXiv:1806.10419, 2018.
\bibitem{STN}
Jaderberg, Max, Karen Simonyan, and Andrew Zisserman. "Spatial transformer networks." Advances in neural information processing systems, 2015.
\bibitem{tzirakis2017end}
Tzirakis, Panagiotis, George Trigeorgis, Mihalis A. Nicolaou, Björn W. Schuller, and Stefanos Zafeiriou. "End-to-end multimodal emotion recognition using deep neural networks." IEEE Journal of Selected Topics in Signal Processing 11, no. 8: 1301-1309, 2017.
\bibitem{mollahosseini2016going}
Mollahosseini, Ali, David Chan, and Mohammad H. Mahoor. "Going deeper in facial expression recognition using deep neural networks." Applications of Computer Vision (WACV), 2016 IEEE Winter Conference on. IEEE, 2016.
\bibitem{liu2014facial}
Liu, Ping, Shizhong Han, Zibo Meng, and Yan Tong. "Facial expression recognition via a boosted deep belief network." In Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition, pp. 1805-1812. 2014.
\bibitem{barsoum2016training}
Barsoum, Emad, et al. "Training deep networks for facial expression recognition with crowd-sourced label distribution." Proceedings of the 18th ACM International Conference on Multimodal Interaction. ACM, 2016.
\bibitem{ckplus}
Lucey, Patrick, et al. "The extended cohn-kanade dataset (ck+): A complete dataset for action unit and emotion-specified expression." Computer Vision and Pattern Recognition Workshops (CVPRW), IEEE Computer Society Conference on. IEEE, 2010.
\bibitem{han2014speech}
Han, Kun, Dong Yu, and Ivan Tashev. "Speech emotion recognition using deep neural network and extreme learning machine." Fifteenth annual conference of the international speech communication association, 2014.
\bibitem{petrantonakis2010emotion}
Petrantonakis, Panagiotis C., and Leontios J. Hadjileontiadis. "Emotion recognition from EEG using higher order crossings." IEEE Transactions on Information Technology in Biomedicine 14.2: 186-197, 2010.
\bibitem{wu2006emotion}
Wu, Chung-Hsien, Ze-Jing Chuang, and Yu-Chung Lin. "Emotion recognition from text using semantic labels and separable mixture models." ACM transactions on Asian language information processing (TALIP) 5, no. 2: 165-183, 2006.

\bibitem{mcconnell1986method}
Hough, Paul VC. "Method and means for recognizing complex patterns." U.S. Patent 3,069,654, issued December 18, 1962.
\bibitem{shan2009facial}
Shan, Caifeng, Shaogang Gong, and Peter W. McOwan. "Facial expression recognition based on local binary patterns: A comprehensive study." Image and vision Computing 27.6: 803-816, 2009.
\bibitem{chen2014facial}
Chen, Junkai, Zenghai Chen, Zheru Chi, and Hong Fu. "Facial expression recognition based on facial components detection and hog features." In International workshops on electrical and computer engineering subfields, pp. 884-888, 2014.
\bibitem{lyons1999automatic}
Lyons, Michael J., Julien Budynek, and Shigeru Akamatsu. "Automatic classification of single facial images." IEEE transactions on pattern analysis and machine intelligence 21.12: 1357-1362, 1999.
\bibitem{whitehill2006haar}
Whitehill, Jacob, and Christian W. Omlin. "Haar features for facs au recognition." In Automatic Face and Gesture Recognition, 2006. FGR 2006. 7th International Conference on, pp. 5-pp. IEEE, 2006.
\bibitem{bartlett2005recognizing}
Bartlett, Marian Stewart, Gwen Littlewort, Mark Frank, Claudia Lainscsek, Ian Fasel, and Javier Movellan. "Recognizing facial expression: machine learning and application to spontaneous behavior." In Computer Vision and Pattern Recognition, 2005. CVPR 2005. IEEE Computer Society Conference on, vol. 2, pp. 568-573. IEEE, 2005.
\bibitem{lecun1989generalization}
LeCun, Y. Generalization and network design strategies. Connectionism in perspective, 143-155, 1989.
\bibitem{cohn1995computerized}
Cohn, J. F., and A. Zlochower. "A computerized analysis of facial expression: Feasibility of automated discrimination." American Psychological Society 2: 6, 1995.
\bibitem{fergus}
Zeiler, Matthew D., and Rob Fergus. "Visualizing and understanding convolutional networks." European conference on computer vision. Springer, Cham, 2014.
\bibitem{ekman1971constants}
Ekman, Paul, and Wallace V. Friesen. "Constants across cultures in the face and emotion." Journal of personality and social psychology 17.2: 124, 1971.
\bibitem{FACS}
Friesen, E., and P. Ekman. "Facial action coding system: a technique for the measurement of facial movement." Palo Alto, 1978.
\bibitem{carrier2013fer}
Carrier, P. L., Courville, A., Goodfellow, I. J., Mirza, M., \& Bengio, Y. FER-2013 face database. Universit de Montreal, 2013.
\bibitem{lyons1998japanese}
Lyons, Michael J., Shigeru Akamatsu, Miyuki Kamachi, Jiro Gyoba, and Julien Budynek. "The Japanese female facial expression (JAFFE) database."  third international conference on automatic face and gesture recognition, pp. 14-16, 1998.
\bibitem{MSR}
Rifai, Salah, Yoshua Bengio, Aaron Courville, Pascal Vincent, and Mehdi Mirza. "Disentangling factors of variation for facial expression recognition." In Computer Vision–ECCV 2012, pp. 808-822. Springer, Berlin, Heidelberg, 2012.
\bibitem{3DCNN}
Liu, Mengyi, Shaoxin Li, Shiguang Shan, Ruiping Wang, and Xilin Chen. "Deeply learning deformable facial action parts model for dynamic expression analysis." In Asian conference on computer vision, pp. 143-157. Springer, Cham, 2014.
\bibitem{IBCNN}
Han, Shizhong, Zibo Meng, Ahmed-Shehab Khan, and Yan Tong. "Incremental boosting convolutional neural network for facial action unit recognition." In Advances in Neural Information Processing Systems, pp. 109-117. 2016.
\bibitem{IACNN}
Meng, Zibo, Ping Liu, Jie Cai, Shizhong Han, and Yan Tong. "Identity-aware convolutional neural network for facial expression recognition." In IEEE International Conference on Automatic Face \& Gesture Recognition,  pp. 558-565. IEEE, 2017.
\bibitem{DTAGN}
Jung, Heechul, Sihaeng Lee, Junho Yim, Sunjeong Park, and Junmo Kim. "Joint fine-tuning in deep neural networks for facial expression recognition." In Proceedings of the IEEE International Conference on Computer Vision, pp. 2983-2991. 2015.
\bibitem{STRNN}
Zhang, T., Zheng, W., Cui, Z., Zong, Y., \& Li, Y. Spatial-temporal recurrent neural network for emotion recognition. IEEE transactions on cybernetics, (99), 1-9, 2018.
\bibitem{PPDN}
Zhao, Xiangyun, Xiaodan Liang, Luoqi Liu, Teng Li, Yugang Han, Nuno Vasconcelos, and Shuicheng Yan. "Peak-piloted deep network for facial expression recognition." In European conference on computer vision, pp. 425-442. Springer, Cham, 2016.
\bibitem{SFP}
Happy, S. L., and Aurobinda Routray. "Automatic facial expression recognition using features of salient facial patches." IEEE transactions on Affective Computing 6.1: 1-12, 2015.
\bibitem{fisherface}
Abidin, Zaenal, and Agus Harjoko. "A neural network based facial expression recognition using fisherface." International Journal of Computer Applications 59.3, 2012.
\bibitem{Ad-NN}
Feutry, Clément, Pablo Piantanida, Yoshua Bengio, and Pierre Duhamel. "Learning Anonymized Representations with Adversarial Neural Networks." arXiv preprint arXiv:1802.09386, 2018.
\bibitem{ensemble}
Zhao, Hang, Qing Liu, and Yun Yang. "Transfer learning with ensemble of multiple feature representations." 2018 IEEE 16th International Conference on Software Engineering Research, Management and Applications (SERA), IEEE, 2018.
\bibitem{shima2018image}
Shima, Yoshihiro, and Yuki Omori. "Image Augmentation for Classifying Facial Expression Images by Using Deep Neural Network Pre-trained with Object Image Database." Proceedings of the 3rd International Conference on Robotics, Control and Automation. ACM, 2018.
\bibitem{owusu2014neural}
Owusu, Ebenezer, Yongzhao Zhan, and Qi Rong Mao. "A neural-AdaBoost based facial expression recognition system." Expert Systems with Applications 41.7: 3383-3390, 2014.
\bibitem{bow}
Ionescu, Radu Tudor, Marius Popescu, and Cristian Grozea. "Local learning to improve bag of visual words model for facial expression recognition." Workshop on challenges in representation learning, ICML. 2013.
\bibitem{vggsvm}
Georgescu, Mariana-Iuliana, Radu Tudor Ionescu, and Marius Popescu. "Local Learning with Deep and Handcrafted Features for Facial Expression Recognition." arXiv preprint arXiv:1804.10892, 2018.
\bibitem{googlenet}
Giannopoulos, Panagiotis, Isidoros Perikos, and Ioannis Hatzilygeroudis. "Deep Learning Approaches for Facial Emotion Recognition: A Case Study on FER-2013." Advances in Hybridization of Intelligent Methods. Springer, Cham,  1-16, 2018.

\end{thebibliography}




\end{document}
