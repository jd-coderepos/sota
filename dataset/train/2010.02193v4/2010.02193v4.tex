\usepackage{iclr2021_conference,times}
\iclrfinalcopy
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[english]{babel}
\usepackage[colorlinks]{hyperref}
\usepackage{url}
\usepackage{amsfonts}
\usepackage{nicefrac}
\usepackage{microtype}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{mathtools}
\usepackage{subcaption}
\usepackage{booktabs}
\usepackage{ragged2e}
\usepackage{tikz}
\usepackage{stackengine}
\usepackage{etoolbox}
\usepackage{xspace}
\usepackage{xpatch}
\usepackage{cuted}
\usepackage{enumerate}
\usepackage{xstring}
\usepackage{natbib}
\usepackage{setspace}
\usepackage{tabularx}
\usepackage{makecell}
\usepackage{graphicx}
\usepackage{changepage}
\usepackage{enumitem}
\usepackage{cuted}
\usepackage{titlesec}
\usepackage{cancel}
\usepackage{eqparbox}
\usepackage{wrapfig}
\usepackage[hang,flushmargin,bottom]{footmisc}
\usepackage[capitalise,noabbrev,nameinlink]{cleveref}
\usepackage[useregional=numeric]{datetime2}
\usepackage[linesnumbered,ruled,noend]{algorithm2e}
\usepackage{tocbasic}
\usepackage{eqparbox}
\usepackage{pifont}
\usepackage{listings}
\usepackage{titlecaps}
\usepackage{floatrow}

\usetikzlibrary{positioning,arrows.meta,fit,calc,backgrounds}
\tikzset{node distance=2em, auto,
every node/.style={line width=0.7pt},
det/.style={draw=black, rectangle, minimum size=2.5em, inner sep=0.1ex},
lat/.style={draw=black, circle, minimum size=2.5em, inner sep=0.1ex},
obs/.style={draw=black, circle, fill=black!15, minimum size=2.5em, inner sep=0.1ex},
fac/.style={draw=black, rectangle, fill=black, minimum size=.6em, inner sep=0em},
dummy/.style={draw=none, circle, minimum size=2.5em},
plate/.style={draw=black, rounded corners, inner sep=.8em, yshift=-.7em, align=right},
box/.style={draw=black, rounded corners, inner sep=.4em, align=center},
generates/.style={->, -{Stealth[length=.6em, inset=0pt]}, line width=0.7pt},
undirected/.style={line width=0.7pt},
}

\setlength\parindent{0pt}
\setlength\parskip{1ex plus 1ex}
\setlist[itemize]{leftmargin=1.5em,itemsep=.1em,topsep=.1em}
\setlength{\textfloatsep}{10pt plus 1.0pt minus 2.0pt}
\titlespacing*{\paragraph}{0pt}{0ex plus .1ex}{1em}
\DeclareTOCStyleEntry[beforeskip=.2em plus 1pt]{tocline}{section}
\xapptocmd\normalsize{\abovedisplayskip=.8em plus .2em minus .2em
\belowdisplayskip=.6em plus .1em minus .1em
\abovedisplayshortskip=.8em plus .2em minus .2em
\belowdisplayshortskip=.6em plus .1em minus .1em
}{}{}

\newcommand{\itempar}[1]{\item\textbf{#1}\quad}
\newcommand{\padspace}{\hspace{3.5em}}

\newcommand{\dani}[1]{{\textbf{\color[HTML]{4DAF4A}[D: #1]}}}
\newcommand{\tim}[1]{{\textbf{\color[HTML]{4A51AF}[T: #1]}}}
\newcommand{\mohammad}[1]{{\textbf{\color[HTML]{AF4A4D}[M: #1]}}}
\newcommand{\jimmy}[1]{{\textbf{\color[HTML]{AF7B4A}[J: #1]}}}

\bibliographystyle{bibstyle}
\Addlcwords{and as but for if nor or so yet a an the as at by for in of off on per to up via}
\setcitestyle{authoryear,round,citesep={;},aysep={,},yysep={;}}
\renewcommand{\cite}[1]{\citep{#1}}
\newcommand{\needcite}{[?]\xspace}
\newcommand{\needcites}{[???]\xspace}
\creflabelformat{equation}{#2\textup{#1}#3}
\crefname{algocf}{Algorithm}{Algorithms}
\Crefname{algocf}{Algorithm}{Algorithms}

\definecolor{mydarkblue}{rgb}{0,0.08,0.45}
\hypersetup{colorlinks=true,
linkcolor=mydarkblue,
citecolor=mydarkblue,
filecolor=mydarkblue,
urlcolor=mydarkblue}

\setcounter{topnumber}{1}
\setcounter{bottomnumber}{1}
\setcounter{totalnumber}{2}
\graphicspath{{figures/}}
\renewcommand{\arraystretch}{1.2}
\renewcommand{\topfraction}{.8}
\renewcommand{\bottomfraction}{.8}
\renewcommand{\floatpagefraction}{.8}
\makeatletter
\def\hlinewd#1{\noalign{\ifnum0=`}\fi\hrule \@height #1 \futurelet
\reserved@a\@xhline}
\makeatother

\makeatletter
\DeclareDocumentCommand\todo{g}{\def\@message{\IfNoValueTF{#1}{TODO}{TODO: #1}}
\textbf{\textcolor[HTML]{FF8811}{\@message}}
\@latex@warning{\@message}{}{}}
\makeatother

\newcommand{\tlap}[1]{\vbox to 0pt{\vss\hbox{#1}}}
\newcommand{\blap}[1]{\vbox to 0pt{\hbox{#1}\vss}}

\lstloadlanguages{Python}
\lstset{
  language=Python,
  basicstyle=\ttfamily\mdseries\color[HTML]{666666},
commentstyle=\mdseries\color[HTML]{6aa94f},
  emph={[2]one_hot,softmax,stop_grad,compute_kl,draw},
  emphstyle={[2]\bfseries\color[HTML]{674ea7}},
  literate=
    {(}{{\bfseries\color[HTML]{000000}(\color[HTML]{666666}}}1
    {)}{{\bfseries\color[HTML]{000000})\color[HTML]{666666}}}1
    {=}{{\bfseries\color[HTML]{000000}=\color[HTML]{666666}}}1
    {+}{{\bfseries\color[HTML]{000000}+\color[HTML]{666666}}}1
    {-}{{\bfseries\color[HTML]{000000}-\color[HTML]{666666}}}1
    {*}{{\bfseries\color[HTML]{000000}*\color[HTML]{666666}}}1
}

\DeclareMathOperator*{\argmax}{arg\,max}
\DeclareMathOperator*{\argmin}{arg\,min}
\renewcommand\d{\mathop{}\!\textnormal{\slshape d}}
\newcommand\eye{\mathop{}\!\mathbb{I}}
\newcommand\defined{\doteq}
\newcommand\upto{\stackrel{+}{=}}
\newcommand\without{\setminus}
\newcommand{\describe}[3][0pt]{\hspace*{.12em}\underbracket[0.5pt][1pt]{#2\hspace*{#1}}_\text{#3}}
\newcommand{\describel}[2]{\Shortunderstack[l]{ \raisebox{.8ex}{\scriptsize\rlap{#2}}}}
\newcommand{\changes}[1]{\underbracket[1pt][0pt]{#1}}

\makeatletter
\newcommand{\removeParBefore}{\ifvmode\vspace*{-\baselineskip}\setlength{\parskip}{0ex}\fi}
\newcommand{\removeParAfter}{\@ifnextchar\par\@gobble\relax}
\newcommand{\eq}{\begingroup\removeParBefore\endlinechar=32 \eqinner}
\newcommand{\eqinner}[2][aligned]{\endlinechar=32\endgroup\removeParAfter}
\makeatother

\DeclareDocumentCommand{\p}{ D<>{p} D<>{} r() }{
\def\content{#3}\patchcmd{\content}{|}{\;#2\vert\;}{}{}
\ensuremath{#1 #2(\content #2)}}

\DeclareDocumentCommand{\P}{ D<>{P} D<>{\big} r() }{
\def\content{#3}\patchcmd{\content}{|}{\;#2\vert\;}{}{}
\ensuremath{\operatorname{#1}#2(\content #2)}}

\DeclareDocumentCommand{\E}{ D<>{E} E{_}{{}} D<>{\big} r[] }{
\def\content{#4}\patchcmd{\content}{|}{\;#3\vert\;}{}{}
\ensuremath{\operatorname{#1}_{#2}#3[\content #3]}}

\DeclareDocumentCommand{\D}{ D<>{D} D<>{\big} r[] }{
\def\content{#3}\patchcmd{\content}{||}{\;#2\|\;}{}{}
\ensuremath{\operatorname{#1}\!#2[\content #2]}}

\NewDocumentCommand{\Nor}{ r() }{\P<Normal>](#1)}
\NewDocumentCommand{\Cat}{ r() }{\P<Cat>](#1)}
\NewDocumentCommand{\Bin}{ r() }{\P<Bin>](#1)}
\NewDocumentCommand{\Bet}{ r() }{\P<Beta>](#1)}
\NewDocumentCommand{\Ber}{ r() }{\P<Bernoulli>(#1)}
\NewDocumentCommand{\Dir}{ r() }{\P<Dir>(#1)}

\DeclareDocumentCommand{\KL}{ D<>{\big} r[] }{\D<KL><#1>[#2]}
\DeclareDocumentCommand{\H}{ D<>{\big} r[] }{\E<H><#1>[#2]}
\DeclareDocumentCommand{\I}{ D<>{\big} r[] }{\E<I><#1>[#2]}

\newcommand{\cmark}{\textcolor{green}{\ding{51}}}
\newcommand{\xmark}{\textcolor{red}{\ding{55}}}

\DeclareDocumentCommand{\pp}{ D<>{} r() }{
\ensuremath{\p<p_\phi><#1>(#2)}}
\DeclareDocumentCommand{\qp}{ D<>{} r() }{
\ensuremath{\p<q_\phi><#1>(#2)}}
