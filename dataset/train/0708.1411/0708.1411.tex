\documentclass{article}
\usepackage{spconf,amsmath,epsfig,amsfonts,amssymb,epsf,enumerate,mathrsfs,amsthm}
\usepackage{psfrag}






\def\pth#1{\left(#1\right)}                \def\stdpth#1{(#1)}
\def\acc#1{\left\{#1\right\}}              \def\stdacc#1{\{#1\}}
\def\cro#1{\left[#1\right]}                \def\stdcro#1{[#1]}
\def\bars#1{\left|#1\right|}               \def\stdbars#1{|#1|}
\def\norm#1{\left\|#1\right\|}             \def\stdnorm#1{\|#1\|}
\def\scal#1{\left\langle#1\right\rangle}   \def\stdscal#1{\langle#1\rangle}
 
\def\bigpth#1{\bigl(#1\bigr)}              \def\biggpth#1{\biggl(#1\biggr)}
\def\bigacc#1{\bigl\{#1\bigr\}}            \def\biggacc#1{\biggl\{#1\biggr\}}
\def\bigcro#1{\bigl[#1\bigr]}              \def\biggcro#1{\biggl[#1\biggr]}
\def\bigbars#1{\bigl|#1\bigr|}             \def\biggbars#1{\biggl|#1\biggr|}
\def\bignorm#1{\bigl\|#1\bigr\|}           \def\biggnorm#1{\biggl\|#1\biggr\|}
\def\bigscal#1{\bigl\langle#1\bigr\rangle} \def\biggscal#1{\biggl\langle#1\biggr\rangle}

\def\Bigpth#1{\Bigl(#1\Bigr)}              \def\Biggpth#1{\Biggl(#1\Biggr)}
\def\Bigacc#1{\Bigl\{#1\Bigr\}}            \def\Biggacc#1{\Biggl\{#1\Biggr\}}
\def\Bigcro#1{\Bigl[#1\Bigr]}              \def\Biggcro#1{\Biggl[#1\Biggr]}
\def\Bigbars#1{\Bigl|#1\Bigr|}             \def\Biggbars#1{\Biggl|#1\Biggr|}
\def\Bignorm#1{\Bigl\|#1\Bigr\|}           \def\Biggnorm#1{\Biggl\|#1\Biggr\|}
\def\Bigscal#1{\Bigl\langle#1\Bigr\rangle} \def\Biggscal#1{\Biggl\langle#1\Biggr\rangle}


\def\diag{{\mathrm{diag}}}              \def\Diag#1{{\mathrm{diag}}\bigcro{#1}} \def\Diagold#1{{\mathrm{diag}}\cro{#1}}
\def\tr{{\mathrm{tr}}\,}                \def\Tr#1{{\mathrm{tr}}\bigcro{#1}}                     \def\Trold#1{{\mathrm{tr}}\cro{#1}}
\def\rg{{\mathrm{rg}}\,}                \def\Rg#1{{\mathrm{rg}}\bigcro{#1}}                     \def\Rgold#1{{\mathrm{rg}}\cro{#1}}
\def\esp{{\mathrm{E}}\,}              \def\Esp#1{{\mathrm{E}}\bigcro{#1}}  \def\Esph#1#2{\underset{{#1}}{\mathrm{E}}\bigcro{#2}}               \def\Espold#1{{\mathrm{E}}\cro{#1}} 
\def\var{{\mathrm{var}}\,}              \def\Var#1{{\mathrm{var}}\bigcro{#1}}           \def\Varold#1{{\mathrm{var}}\cro{#1}}
\def\cov{{\mathrm{Cov}}\,}              \def\Cov#1{{\mathrm{Cov}}\bigcro{#1}}           \def\Covold#1{{\mathrm{Cov}}\cro{#1}}




\def\Cos#1{\cos\cro{#1}}
\def\Sin#1{\sin\cro{#1}}
\def\Exp#1{\exp\cro{#1}}
\def\Log#1{\log\cro{#1}}
\def\Ln#1{\ln\cro{#1}}                  
\def\Det#1{\det\bigcro{#1}}
\def\Erf#1{\mathrm{erf}\cro{#1}} 
\def\Erfc#1{\mathrm{erfc}\cro{#1}}
\def\Erfcx#1{\mathrm{erfcx}\cro{#1}}

\def\cond{\textrm{Cond}\,}              \def\Cond#1{\cond\bigpth{#1}}

\def\sinc{{\mathrm{sinc}}\,}    \def\Sinc#1{{\mathrm{sinc}}\bigcro{#1}} \def\Sincold#1{{\mathrm{sinc}}\cro{#1}}
\def\rang{{\mathrm{rang}}\,}    \def\Rang#1{\rang\bigcro{#1}}                                   \def\Rangold#1{\rang\cro{#1}}
\def\ker{\textrm{Ker}\,}                \def\Ker#1{\ker\bigcro{#1}}                                     \def\Kerold#1{\ker\cro{#1}}
\def\img{\textrm{Im}\,}                 \def\Img#1{\img\bigcro{#1}}                                     \def\Imgold#1{\img\cro{#1}}
\def\vect{{\mathrm{Vect}}\,}    \def\Vect#1{\vect\bigcro{#1}}                                   \def\Vectold#1{\vect\cro{#1}}
\def\sgn{{\mathrm{sgn}}}                \def\Sgn#1{\sgn\bigcro{#1}}                                     \def\Sgnold#1{\sgn\cro{#1}}

\def\Pr{\mathop{\textrm{Pr}}}

\def\reel{{\mathrm{Re}}}                \def\Reel#1{{\mathrm{Re}}\cro{#1}}
\def\card{{\mathrm{Card}}}              \def\Card#1{{\mathrm{Card}}\cro{#1}}

\def\sh{{\mathrm{sh}}}                \def\ch{{\mathrm{ch}}}                \def\th{{\mathrm{th}}}                \def\coth{{\mathrm{coth}}}            \def\coeffbin#1#2{\pth{\setlength{\arraycolsep}{.1em}\barr{c}#1\\#2\earr}}


\def\Div{{\mathrm{div}}}                                                                                        \def\Rotv{\overrightarrow{\mathop{{\mathrm{rot}}}}}             \def\Gradv{\overrightarrow{\mathop{{\mathrm{grad}}}}}           

\def\IF{\text{if\:}}             \def\SI{\text{si\:}}
\def\If{\text{If\:}}             \def\Si{\text{Si\:}}
\def\AND{\text{and\:}}           \def\ET{\text{et\:}}
\def\OR{\text{or\:}}             \def\OU{\text{ou\:}}
\def\THEN{\text{then\:}}         \def\ALORS{\text{alors\:}}
                                 \def\DOU{\text{d'o\`u\:}}
\def\WHERE{\text{where\:}}       \def\Ou{\text{o\`u\:}}
\def\WHEN{\text{when\:}}         \def\QUAND{\text{quand\:}}
\def\FOR{\text{for\:}}           \def\POUR{\text{pour\:}}
\def\FORALL{\text{for all\:}}    \def\POURTOUT{\text{pour tout\:}}
\def\ST{\text{s.t.\:}}           \def\SC{\text{s.c.\:}}
\def\SUBJTO{\text{subject to\:}} \def\SOUSC{\text{sous contraintes\:}}
\def\OTHERWISE{\text{otherwise}} \def\SINON{\text{sinon}}
\def\WITH{\text{with\:}}         \def\AVEC{\text{avec\:}}
\def\IN{\text{in\:}}             \def\DANS{\text{dans\:}}



\def\arrayp{\renewcommand{\arraystretch}{.7}\setlength{\arraycolsep}{2pt}}
\def\tabp{\renewcommand{\arraystretch}{.7}\setlength{\tabcolsep}{2pt}}



\newsavebox{\fminibox}
\newlength{\fminilength}
\newenvironment{fminipage}[1][\linewidth]
  {\setlength{\fminilength}{#1}\begin{lrbox}{\fminibox}\begin{minipage}{\fminilength}}
  {\end{minipage}\end{lrbox}\noindent\fbox{\usebox{\fminibox}}}



\def\M{^{-1}} \def\T{^\tD} \def\+{^\dagger}
\def\I{\,|\,}           \def\J{\mathop{\,;\,}}  \def\w{,\thinspace}
\def\W{,\thickspace}
\def\ldotsv{,\,\ldots,\,}
\def\V{,}               \def\e#1{.10^{#1}}      

\def\egdef{\stackrel{\Delta}{=}}
\def\nequiv{\not\kern-.05em\equiv}
\def\egal{\kern-.5em=\kern-.5em}        \def\propt{\kern-.2em\propto\kern-.2em} \def\dans{\in\!}                        \def\pourtt{\forall\,}                  \def\wh#1{\widehat{#1}}                 \def\wt#1{\widetilde{#1}} 

\def\argmax{\mathop{\mathrm{arg\,max}}} \def\argmin{\mathop{\mathrm{arg\,min}}} \def\Argmax#1#2{\displaystyle \argmax_{#1}\left\{{#2}\right\}} \def\Argmin#1#2{\displaystyle \argmin_{#1}\left\{{#2}\right\}}  

\def\EL{\mathrm{EL}}
\def\Vect{\mathop{\text{Vect}}}

\def\froc#1#2{{#1/#2}}                  \def\fric#1#2{\frac1{#2}#1}
\def\fracds#1#2{\frac{\displaystyle#1}{\displaystyle#2}}
\def\diff#1#2{{\frac{d#1}{d#2}}}
\def\dd{\,d}                            \def\derpar#1#2{{\frac{\partial #1}{\partial #2}}}
\def\derpor#1#2{{\froc{\partial #1}{\partial #2}}}
\def\parsec#1#2#3{{\frac{\partial^2 #1}{\partial #2\,\partial #3}}}
\def\parsecd#1#2{{\frac{\partial^2 #1}{{\partial #2}^2}}}
\def\porsec#1#2#3{{\froc{\partial^2 #1}{\partial #2\,\partial #3}}}
\def\porsecd#1#2{{\froc{\partial^2 #1}{{\partial #2}^2}}}
\def\pornd#1#2#3{{\froc{\partial^{#3} #1}{{\partial #2}^{#3}}}}
\def\intdouble{\int\kern-0.3em\int}
\def\inttriple{\int\kern-0.3em\int\kern-0.3em\int}
\def\prods{\mathop{\text{\footnotesize}}}

\def\rond#1{\overset{\kern-0.33em~_\circ}{#1}}
\def\rondit[#1]#2{\overset{\kern#1~_\circ}{#2}}

\def\incirc#1{\pscirclebox[framesep=1pt]{\scriptsize#1}}
\def\incircp#1{\pscirclebox[framesep=1pt]{\tiny#1}}
\def\outcirc#1{\raisebox{-3pt}{\huge}\hspace*{-.45cm}\text{\incirc{#1}}}



 \def\Yb{{\mathbf Y}}
\def\Sb{{\mathbf S}}
\def\Hb{{\mathbf H}}
\def\Zb{{\mathbf Z}}
\def\Hh{{\widehat H}}
\def\Esp{\mathbb{E}}
\title{ACHIEVABLE OUTAGE RATES WITH IMPROVED DECODING OF BICM MULTIBAND OFDM UNDER CHANNEL ESTIMATION ERRORS}
\name{Sajad Sadough, Pablo Piantanida, and Pierre Duhamel}

\address{Ecole Nationale Sup\'erieure de Techniques Avanc\'ees, 75015 Paris, France\\
Email: sajad.sadough@ensta.fr\1mm]
}

\begin{document}
\ninept
\maketitle
\begin{abstract}
We consider the decoding of bit interleaved coded modulation (BICM) applied to multiband OFDM for practical scenarios where only a noisy (possibly very bad) estimate of the channel is available at the receiver. First, a decoding metric based on the channel {\it a posteriori} probability density, conditioned on the channel estimate is derived and used for decoding BICM multiband OFDM. Then, we characterize the limits of reliable information rates in terms of the maximal achievable outage rates associated to the proposed metric. We also compare our results with the outage rates of a system using a theoretical decoder. Our results are useful for designing a communication system where a prescribed quality of service (QoS), in terms of achievable target rates with small error probability, must be satisfied even in the presence of imperfect channel estimation.   
Numerical results over both realistic UWB and theoretical Rayleigh fading channels show that the proposed method provides significant gain in terms of BER and outage rates compared to the classical mismatched detector, without introducing any additional complexity. 
\end{abstract}
\section{Introduction}
\label{sec:intro}
Ultra-Wide-Band (UWB) is defined as any wireless transmission scheme that occupies a bandwidth of more than 25 \% of its center frequency or greater than 500 MHz over the 3.1-10.6 GHz frequency band \cite{fcc}. Multiband Orthogonal Frequency division multiplexing (MB-OFDM) \cite{batra_jour} is a spectrally efficient technique proposed for high data rate, short range UWB applications. This approach uses a conventional OFDM system, combined with bit interleaved coded modulation (BICM) and frequency hopping for improved diversity and multiple access. In MB-OFDM, the channel is assumed changing so slowly that it is considered time invariant during the transmission of an entire frame.    
Channel estimation is performed by one known symbol (pilot) transmitted at the beginning of the information frame while the rest of the frame is decoded based on the estimated channel. Due to the limited number of pilots, the estimate of the channel is imperfect and the receiver has only access to this noisy channel estimate. However, the receiver/decoder metric for any maximum-likelihood (ML) based detector, requires knowledge of the exact channel.

A standard sub-optimal technique, known as mismatched ML decoding, consists in replacing the exact channel by its estimate in the receiver metric. Hence, the resulting decoding metric is not adapted to the presence of channel estimation errors (CEE). This practical scenario, with mismatched decoding, leads to the following important questions. Firstly, in presence of CEE with a given amount of training, what are the limits of reliable transmission (the capacity). Secondly, what type of encoder/decoder is necessary to transmit reliable information close to the performance limits. The first problem has been recently addressed in \cite{piantanida}, characterizing the maximal reliable information rate, by using the notion of estimation induced outage capacity. Unfortunately, the theoretical encoder/decoder used to achieve this capacity can not be implemented on practical communication systems. Besides, the mismatched ML decoding has been showed to be largely suboptimal for the considered class of channels. 
Basically, the transmitter and the receiver strive to construct codes for ensuring reliable communication with a quality of service (QoS), no matter what degree of channel estimation accuracy arises during the transmission. The QoS requirements stand for achieving target rates with small error probability even with very bad channel estimates. 
In this paper, we propose a practical decoding metric for the aforementioned mismatch scenario. This metric uses the estimated channel and the {\it a posteriori} pdf characterizing the channel estimation process, which matches well the channel knowledge available at the receiver. Based on the derived metric, we formulate our decoding rule for BICM MB-OFDM. Interestingly, the present metric coincides with that derived for space-time decoding from independent results in \cite{Biglieri_jour}. In order to determine the limits of reliable information rates associated to the proposed metric, we use the complementary results obtained in \cite{merhav94}. This allows us to compare the maximal supported rate associated to our metric with that of the classical mismatched ML and the theoretical decoder. Our results are relevant for communication systems where a prescribed quality of service (given by the outage probability) must be ensured even in the presence of imperfect channel estimation. 
  
The outline of this paper is as follows. In Section \ref{sec:sysmodel} we describe the system model for MB-OFDM transmission over a frequency selective fading channel. Section \ref{sec:pilot} presents the pilot assisted channel estimation: we specify the statistics of the CEE and then calculate the posterior distribution of the perfect channel conditioned on the estimated channel. This posterior distribution is used in section \ref{sec:MLmetric} to derive the ML decoding metric in the presence of imperfect channel state information at the receiver (CSIR). In section \ref{sec:dem}, we use the general modified metric for soft decoding  BICM MB-OFDM systems. In section \ref{sec:outageCap}, we derive the achievable outage rates of a receiver using the proposed metric. 
Section \ref{sec:simul} illustrates via simulations the performance of the proposed receiver in realistic UWB channel environments and section \ref{sec:concl} concludes the paper.

Notational conventions are as follows : upper case bold symbols denote vectors,  represents an () identity matrix;  and  denote vector transpose and Hermitian transpose, respectively.   
\section{TRANSMISSION MODEL}
\label{sec:sysmodel}
An MB-OFDM system divides the spectrum between 3.1 to 10.6 GHz into several
non-overlapping subbands each one occupying approximately 500 MHZ of bandwidth
\cite{batra_jour}. Information is transmitted using OFDM modulation over one of the subbands in a particular time-slot. The transmitter architecture is depicted in figure \ref{fig1}: each bit  is convolutionally encoded into two bits  and  which are interleaved in order to break the error bursts. The interleaved bits are gathered in subsequences of  bits  and mapped to complex M-QAM\footnote[1]{Here, 16-QAM mapping is used instead of QPSK, proposed in \cite{norme_mb}.} () symbols  with average energy . At a particular time-slot, a time-frequency code (TFC) selects the center frequency of the subband over which the OFDM symbol is sent. The TFC is used not only to provide frequency diversity but also to distinguish between multiple users.  

At the receiver, assuming a cyclic prefix (CP) longer than the channel maximum delay spread and after performing fast Fourier transform (FFT), OFDM converts the the channel into  parallel Rayleigh distributed flat fading subchannels, where  is the number of subcarriers.
The baseband equivalent observation model over a given subband can be written as 
         
where  vectors  and  denote received and transmitted symbols, respectively; the noise block  is assumed to be a circularly symmetric complex Gaussian random vector with distribution ; and  is a diagonal matrix with diagonal elements equal to , where  is the vector of channel FFT coefficients.  

\begin{figure}[!t]
\centering
\psfrag{A}{\hspace{-1em}Binary Data}
\psfrag{B}{\hspace{-.5em}{\parbox{6em}{\centering  Convolutional Encoder}}}
\psfrag{C}{\hspace{-1.2em}{\parbox{6em}{\centering Bit\\ interleaver}}}
\psfrag{D}{\hspace{-1.2em}\parbox{6em}{\centering M-QAM\\ Mapping}}
\psfrag{E}{\hspace{-1.2em}\parbox{6em}{\centering IFFT\\ CP \& GI\\ Addition}}
\psfrag{F}{\hspace{-2em}\parbox{6em}{\centering DAC}}
\psfrag{G}{\hspace{-3em}\parbox{6em}{\centering }}
\psfrag{H}{\hspace{-.5em}{TFC: Subband Selection}}
\includegraphics[width=0.45\textwidth,height=4cm]{TXchainII}
\caption{TX architecture of the multiband OFDM system.}\label{fig1}
\end{figure}
\section{PILOT ASSISTED CHANNEL ESTIMATION}
\label{sec:pilot}
Under the assumption of time-invariant channel characteristics over the entire transmitted frame, channel estimation is usually performed by transmitting known training symbols at the beginning of each frame. 

Assume that we are interested to estimate the -th, \\, fade coefficient  via the transmission of  pilot symbols and let  be the () vector of transmitted training sequence. We will assume constant modulus training symbols for the -th subcarrier, i.e., . From (\ref{eq:sysmodel}) we have 
         
where  is a diagonal matrix with diagonal elements equal to the  vector \,  and  is a noise vector with the same distribution as  affecting the transmission of pilot symbols. The ML estimate of  is obtained by maximizing the likelihood function . After some standard calculus we have

where  is the estimation error. 
From equations \eqref{eq:pil2}, it is obvious that , where .

Assuming that s are i.i.d. and distributed as , the posterior distribution of the perfect channel conditioned on the estimated channel coefficient is given by .  
After standard manipulation of Gaussian densities we obtain 

where .

The availability of the estimation error distribution constitutes an interesting feature of pilot assisted channel estimation that we used to derive the posterior distribution (\ref{eq:pil3}). Next, we see how this additional information is exploited in a modified ML metric for improving the detection process.  
\section{Maximum-likelihood detection metric in the presence of channel estimation errors}
\label{sec:MLmetric}
\subsection{Mismatched ML metric}
The observation model (\ref{eq:sysmodel}) can be rewritten in a component-wise form as

It is well known that the ML estimate of  under the assumption of Gaussian noise is given by maximizing  which is equivalent to minimizing the euclidean distance
 
where the set  contains all of the possible discrete values in the constellation that  can take.   
Note that the above metric depends on the realization of the {\it perfect} channel  and is optimum when perfect CSIR is available. However, in a real communication system, the receiver has only access to an {\it imperfect} estimated version of the channel. In the mismatched decoder, the estimated channel  is used instead of  in the ML metric of (\ref{eq:ML2}) as 
 
which leads to a sub-optimal solution due to the mismatch introduced by the CEE. Next, we will see how the derived posterior channel distribution (\ref{eq:pil3}), can be used in a modified ML metric that takes into account the available imperfect CSI.    
\subsection{Modified ML metric for imperfect CSIR}    
Since in practice the receiver knows solely the imperfect channel, it is relevant to express the likelihood criterion in terms of the estimated fade coefficient. For this purpose, we consider the problem of detecting the transmitted symbol  by using the imperfect channel estimate  in an ML criterion as
 
where . 
The pdf  can be calculated as
    
The joint likelihood function  is related to known probabilities as
 
where the last equation results from the independence between  and . 
It is clear from (\ref{eq:ML5}) and (\ref{eq:ML6}) that  is obtained by the following conditional expectation 

evaluated over the posterior distribution of the exact channel given its estimate (equation (\ref{eq:pil3})).    
Since   and  are Gaussian densities, their product remains Gaussian and it is easy to verify that  where  and . 
         
According to (\ref{eq:ML4}), the decision metric to be minimized for ML detection at the receiver is easily seen to be


Let us first consider the ideal situation when exact channel knowledge is available. In this case  reduces to  and the averaging  of (\ref{eq:ML7}) becomes equivalent to replacing  by  in .  
Similarly, we note that with near perfect channel (i.e.  or ),  and we have  which is the euclidean distance metric for perfect CSIR. However, in the presence of CEE, the modified metric evaluates the average of the pdf  (that would be used if the exact channel were known) over the true channel  using the conditional expectation in (\ref{eq:ML7}). 

While we have focused on OFDM, the metric \eqref{eq:ML9} can also be applied for ML decoding/detection of single carrier systems with frequency selective fading. In the following, we use the above modified metric in the decoding process of BICM MB-OFDM.        
\section{Decoding of BICM-OFDM based on imperfect channel estimation}
\label{sec:dem}
The problem of decoding BICM-OFDM with large size constellations has been addressed in \cite{muq1} under the assumption of perfect CSIR. 
Here we consider the same problem in the case where the decoder has an imperfect estimate of the channel state. 
We denote by  the sequence of transmitted complex symbols and by  the corresponding sequence of received symbols where  is number of OFDM symbols in a frame.   
Based on the transmission model of figure \ref{fig1}, the sequence of transmitted bits  has to be estimated in the ML sense so as to maximize the likelihood function . In practice, due to the one to one correspondence between the information bits and the interleaved codeword , one look for the ML estimate  of the interleaved codeword as
    
By assuming that the received symbols are independent and the channel noise is white, (\ref{eq:dem1}) is equivalent to (see \cite{muq1})

where the bit metrics  are given by

and  is specified from \eqref{eq:ML7}.
We emphasize that the above decoding rule is conditioned on the imperfect estimated channel sequence  available at the receiver. Information bits are estimated in the trellis decoder part from the above bit metrics by applying either non-iterative or turbo procedures (see figure \ref{fig2}).    

\begin{figure}[!htb]
\centering
\includegraphics[width=0.5\textwidth,height=2.5cm]{BICM_RX}
\caption{BICM iterative demodulation with CEE.}\label{fig2}
\end{figure}       
\section{Achievable Outage Rates Associated to the Proposed Metric}
\label{sec:outageCap}
We now derive the achievable rates  of a receiver using the modified metric  of \eqref{eq:ML9}. This is done by using the following theorem proposed in \cite{merhav94} for a discrete-time memoryless channel , where ,   with decoding metrics : 
\newtheorem{theo}{Theorem}
\begin{theo}
\label{th1}
   
where the relative entropy functional 
\begin {equation}
\label{eq:I} 
\int \int P_S(\mathbf{s}) f(\mathbf{y}|\mathbf{s}) \log \frac{f(\mathbf{y}|\mathbf{s})} {\int P_{S^\prime}(s^\prime)f(\mathbf{y}|\mathbf{s}^\prime) \textrm{d}\mathbf{s}^\prime}  \textrm{d}\mathbf{y} \textrm{d}\mathbf{s},

&\mathrm{c_1}: \; \Esp_\mathbf{s} \big[f(\mathbf{y}|\mathbf{s})\big]=\Esp_\mathbf{s} \big[W(\mathbf{y}|\mathbf{s},\mathbf{H})\big], \;\;\;\;\;\; \textrm{a.s.}\vspace{-2mm} 
\\  \label{eq:ineqconstr}
&\mathrm{c_2}: \; \Esp_\mathbf{s}  \, \bigg[ \Esp_{_{f(\mathbf{y} |\mathbf{s} )}} \big[\mathcal{D}(s_k,y_k|\widehat{H}_k)\big] \bigg ] \leq \Esp_\mathbf{s} \, \bigg[ \Esp_{_{W(\mathbf{y} |\mathbf{s} )}} \big[\mathcal{D}(s_k,y_k|\widehat{H}_k )\big]\bigg],\vspace{-2mm}

\sigma^2_k = \sigma^2_z + P(|H_k|^2-|\mu_k|^2),\,\,\,\,k=1,\dots,M.  

\label{eq:CM}
C_{_\mathcal{M}}(\mathbf{H},\widehat{\mathbf{H}})=\!\!\!\!\! \!\!\!\!\!\inf_{\underline{\mu}: \,\,\mu_k\in \mathcal{V}(H_k,\widehat{H}_k)}\sum\limits_{k=1}^{M} \log_2\left(1+\frac{P\;|\mu_k|^2}{\sigma^2_k}\right),

\label{ineqconstr2}
\mathcal{V}(H_k,\widehat{H}_k)=\big\{\mu_k \in \mathbb{C}:|H_k-a_k \widehat{H}_k |^2 \leq |\mu_k-a\widehat{H}_k|^2\big \},

\mu_{\mathrm{opt},k} = \eta_{_{\mathcal{M},k}} \widehat{H}_k, \,\;\;\,k=1,\dots,M

\eta_{_{\mathcal{M},k}} =\left\{ \begin{array}{ll} a_k-\displaystyle{\frac{|H_k-a_k\widehat{H}_k|}{|\widehat{H}_k|}}, & \mathrm{if}\,\, a_k \geq 0\\
 a_k+\displaystyle{\frac{|H_k-a_k\widehat{H}_k|}{|\widehat{H}_k|}}, & \mathrm{if}\,\, a_k < 0. 
\end{array} \right.

C_{_\mathcal{M}}(\mathbf{H},\widehat{\mathbf{H}})=\sum\limits_{k=1}^M\log_2\left(1+\frac{P\; \eta_{_{\mathcal{M},k}}^2|\widehat{H}_k|^2}{\sigma^2_z + P(|H_k|^2-\eta_{_{\mathcal{M},k}}^2|\widehat{H}_k|^2)}\right).

P_{_{\mathcal{M}}}^{\mathrm{out}}(R,\widehat{\mathbf{H}})=\mathrm{Pr}_{\mathbf{H}| \widehat{\mathbf{H}}} \big(\mathbf{H}\in \Lambda_{_\mathcal{M}}(R,\widehat{\mathbf{H}})|\widehat{\mathbf{H}}\big), \notag

\label{capout}
C_{_\mathcal{M}}^{\mathrm{out}}(\gamma,\widehat{\mathbf{H}})=\sup_R\big\{R \geq 0: P_{_{\mathcal{M}}}^{\mathrm{out}}(R,\widehat{\mathbf{H}})\leq \gamma\big\}. 

\overline{C}_{_\mathcal{M}}^{\; \mathrm{out}}(\gamma)=\mathbb{E}_{\widehat{\mathbf{H}}}\big[C_{_\mathcal{M}}^{\mathrm{out}}(\gamma,\widehat{\mathbf{H}})\big]. \label{EQ-capacity}

\overline{C}_{_\mathcal{G}}^{\; \mathrm{out}}(\gamma)=\mathbb{E}_{\widehat{\mathbf{H}}}\big[C_{_\mathcal{G}}^{\mathrm{out}}(\gamma,\widehat{\mathbf{H}})\big], \label{perfect-capacity}

C_{_\mathcal{G}}(\mathbf{H},\widehat{\mathbf{H}})=\sum\limits_{k=1}^{M} \log_2\left(1+\frac{P\;|H _k|^2}{\sigma^2_z}\right). 


\begin{figure}[!htb] 
\centering
\includegraphics[width=0.5\textwidth,height=0.28\textheight]{BERvsSNR_CM1} 
\caption{BER performance of the proposed decoder over the LOS UWB channel CM1 for various training sequence lengths.}\label{fig3}
\end{figure} 

\begin{figure}[!htb] 
\centering
\includegraphics[width=0.5\textwidth,height=0.28\textheight]{BERvsSNR_Rayleigh} 
\caption{BER performance of the proposed decoder over Rayleigh fading channel for various training sequence lengths.}\label{fig4}
\end{figure} 
\section{Simulation results}
\label{sec:simul}
Simulations have been carried out in the context of IEEE802.15 wireless PAN \cite{norme_mb}:  data subcarriers along with 32 CP samples compose one OFDM symbol. Information bits are encoded by a rate  convolutional encoder with constraint length 3 defined in octal form by (5,7). The interleaver is a pseudo-random one operating over the entire frame and the mapping is 16-QAM. 
For each frame that contains 100 OFDM symbols, a different realization of the realistic UWB channel model specified in \cite{chanReport} has been drawn and supposed constant during the whole frame. Besides, the same average energy is allocated to training symbols and data, i.e., . 

Figure \ref{fig3} depicts the bit error rate (BER) performance gain that is obtained by decoding BICM MB-OFDM with the modified ML decoder in the context of LOS CM1 channel, where the channel estimation is performed by sending different training sequences with lengths  per frame. It can be noticed that the proposed decoder outperforms the mismatched decoder especially when few numbers of pilot symbols are dedicated for channel estimation. Note that the modified decoder with  pilot performs very close to the mismatched decoder with  pilots. 
For comparison, results obtained with theoretical Rayleigh fading channel are illustrated in figure \ref{fig4}. It can be observed that for , the SNR to obtain a BER of  is reduced by about  dB if the modified ML decoding is used instead of the mismatched approach.     

Figure \ref{fig5} shows the BER performance versus the training sequence length  at a fixed  of  dB for the CM1 channel. This allows to evaluate the number of training sequence necessary to achieve a certain BER. We observe that at  dB, the modified ML decoder requires  pilot symbols per frame to achieve a BER of  while the mismatched decoder attains this BER for  pilot symbols. Besides, this has been outlined in Section IV, for large training sequence lengths (), both decoders have close performance.   

Figure \ref{fig6} shows the expected achievable rates \eqref{EQ-capacity} corresponding to one OFDM symbol transmission with  data subcarriers (in bits per channel use) versus the SNR, for an outage probability . For comparison, we show the expected outage rates of mismatched ML decoding and that obtained in the case of the perfect theoretical encoder/decoder \eqref{perfect-capacity}. It can be observed that at a mean outage rate of 4 bits, the modified metric reduces the SNR by about 1 dB.  Indeed, we observe that the achievable rates using the proposed decoding metric are close (only  dB of SNR) to those obtained by using a theoretical decoder.             

\section{Conclusion}
\label{sec:concl}
This paper studied the problem of ML reception when the receiver has only access to a noisy estimate of the channel in the case of pilot assisted channel estimation. 
By using the statistics of the estimation error, we proposed a modified ML criterion that is expressed in terms of the estimated channel coefficient.  
This modified metric let us to formulate appropriate branch metrics for decoding BICM MB-OFDM with imperfect channel knowledge. Achievable outage rates associated to this modified metric have also been derived. Comparison in terms of BER and achievable outage rates was made with a system whose receiver uses mismatched ML decoding and a perfect theoretical decoder. 
Simulation results conducted over realistic UWB channels, indicate that mismatched decoding is quite sub-optimal for short training sequence and confirmed the adequacy of the proposed decoding rule in the presence of channel estimation errors. This was obtained without introducing any additional complexity.         
\bibliographystyle{IEEEbib}
\bibliography{bibli_asilomar}




\begin{figure}[!htb] 
\centering
\includegraphics[width=0.5\textwidth,height=0.28\textheight]{BERvsNp_CM1_12db} 
\caption{BER versus the number of pilot symbols at  dB over the LOS channel CM1.}\label{fig5}
\end{figure} 



\begin{figure}[!htb] 
\centering
\includegraphics[width=0.5\textwidth,height=0.27\textheight]{outageCap_OFDM} 
\caption{Expected outage rates of OFDM transmission with  subcarriers versus SNR .} \label{fig6}
\end{figure}     

\end{document}
