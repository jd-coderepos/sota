\documentclass[journal,,draftclsnofoot letterpaper, onecolumn]{IEEEtran}

\usepackage{cite}
\usepackage{graphicx}
\usepackage{subfigure}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{bm}
\usepackage{epsfig}
\usepackage{times}
\usepackage{color}
\usepackage{url}
\usepackage{array}
\usepackage{multirow}
\usepackage{rotating}
\usepackage{extarrows}
\usepackage{amsthm}
\usepackage{setspace}
\usepackage{tikz}
\usetikzlibrary{arrows,shapes}
\usepackage{epstopdf}
\def\tbeta{{\tilde\beta}}
\def\hbeta{{\widehat\beta}}

\newtheorem{theorem}{Theorem}
\newtheorem{pavikc}{\textbf{Corollary}}
\newtheorem{pavikl}{\textbf{Lemma}}
\newtheorem{pavikt}{\textbf{Theorem}}
\newtheorem{pavikd}{\textbf{Definition}}
\newtheorem{pavikp}{\textbf{Proposition}}
\newcommand{\argmin}{\operatornamewithlimits{argmin}}
\newcommand{\argmax}{\operatornamewithlimits{argmax}}
\newcommand{\pd}[2]{\frac{\partial#1}{\partial#2}}

\newcommand{\todo}{\textcolor{red}}
\newcommand{\sid}{\textcolor{blue}}
\interdisplaylinepenalty=2500
\renewcommand{\arraystretch}{1.5}
\doublespacing
\begin{document}

\title{Beam-forming for Secure Communication in Amplify-and-Forward Networks: An SNR based approach}\author{Siddhartha Sarma, Samar Agnihotri, and Joy Kuri\thanks{S. Sarma and J. Kuri are with the Department of Electronic Systems Engineering, Indian Institute of Science, Bangalore, Karnataka - 560012, India (e-mail: \{siddharth, kuri\}@dese.iisc.ernet.in).}
\thanks{S. Agnihotri is with the School of Computing and Electrical Engineering, Indian Institute of Technology Mandi, Mandi, Himachal Pradesh - 175001, India (e-mail: samar@iitmandi.ac.in).}
}

\maketitle

\begin{abstract}
The problem of secure communication in Amplify-and-Forward (AF) relay networks with multiple eavesdroppers is considered. Assuming that a receiver (destination or eavesdropper) can decode a message only if the received SNR is above a predefined threshold, we introduce SNR based optimization formulations to calculate optimal scaling factors for relay nodes in two scenarios. In the first scenario, we maximize the achievable rate at the legitimate destination, subject to the condition that the received SNR at each eavesdropper is below the target threshold. Due to the non-convex nature of the objective function and eavesdroppers' constraints, we transform variables and obtain a \textit{Quadratically Constrained Quadratic Program} (QCQP) with convex constraints, which can be solved efficiently. When the constraints are not convex, we consider a \textit{Semi-definite relaxation} (SDR). In the second scenario, we minimize the total power consumed by all relay nodes, subject to the condition that the received SNR at the legitimate destination is above the threshold and at every eavesdropper, it is below the corresponding threshold. We propose a \textit{semi-definite relaxation} of the problem in this scenario and also provide an analytical lower bound. 
\end{abstract}

\section{Introduction}
In wireless networks, generally security measures are implemented in the upper layers of protocol stack using cryptographic methods. However, current advances in computation technology pose threats for such systems, prompting researchers to explore alternatives like \textit{physical layer security} \cite{bloch2011physical}. In ad-hoc wireless networks, where relay nodes are constrained by hardware or available energy resources, physical-layer based schemes can indeed provide effective solutions. 

In the physical-layer security literature, most results are centered around an information-theoretic measure - the \textit{secrecy capacity} \cite{wyner}. The secrecy capacity is the maximum rate of information transfer from the source to the destination in the presence of eavesdropper(s). 
However, even for many simple networks, calculating secrecy capacity for a given eavesdropper model is a tedious task as it involves solving fractional optimization problems, which are known to be NP-hard in general \cite{schaible}. For amplify-and-forward (AF) relay networks, the authors in \cite{dong} evaluated secrecy capacity for a single eavesdropper, and the zero-forcing secrecy rate for multiple eavesdroppers under a total relay power constraint. In \cite{zhang10} and \cite{yang2013cooperative}, techniques are devised for computing the maximum AF secrecy rate with a single and multiple eavesdroppers under both individual and total relay power constraints, respectively. However, our work differs from them as we have considered an SNR based model for secure communication.
The motivation for our approach arises from the results in
\cite{Leung}, where it is shown that the secrecy capacity depends on the source-destination and the source-eavesdropper channel capacities, which in turn are functions of the respective signal-to-noise ratios (SNR).


In practical receivers, the correct decoding of the received signals is dependent on the received SNR \cite{proakisdigital}. If the received SNR is below a certain predefined threshold, then for all practical purposes, we can assume that the receiver cannot extract any information from the received signal. Following this argument, we consider a model where every eavesdropper has limited decoding capability, determined by its SNR threshold. Therefore, to ensure secure communication between the source and the destination, we strive to bring down the received SNR at each eavesdropper below its target SNR threshold. This approach is a generalization of the zero-forcing approaches for secure communication \cite{dong}. Concurrently, we also strive to improve the SNR at the legitimate destination. This leads us to our first scenario, where we maximize the achievable rate at the legitimate destination, subject to the condition that the received SNR at each eavesdropper is below its target threshold. We address this scenario in Section \ref{SNR}. Though a similar problem was considered in \cite{yang2013cooperative}, but unlike them we are not interested in evaluating optimal secrecy rate. Infact, as each eavesdropper can have a different threshold, therefore the optimal solution of our problem will differ from the solution of \textit{Secrecy Rate Maximization} (SRM) problem considered in \cite{yang2013cooperative}. Also, we propose a noble transformation for this problem to obtain a \textit{Quadratic Constrained Quadratic Program} (QCQP) which attains global solution under certain criteria.




The second scenario that we consider is motivated by wireless adhoc networks, where the intermediate relay nodes may be interested in minimizing total power consumption while ensuring secure communication between the source and the destination.
In such scenarios, we would like to minimize the total power consumption of relay nodes, subject to the condition that the received SNR at the legitimate destination is above a predefined threshold and at every eavesdropper it is below the respective predefined threshold.
This formulation is described in Section \ref{POW}. 

A similar SNR based model is also considered in \cite{sarma}. However, unlike the decode-and-forward (DF) relaying used in that work, we employ AF relaying as it is one of the simplest relaying schemes and even in low-SNR regimes, it can be a capacity achieving relay strategy in some scenarios \cite{107gomadamJafar}.



\section{System Model}
\label{sec:model}
The system consists of a single source , a single destination ,  relay nodes  and  eavesdroppers  as shown in Figure \ref{fig:model}. The channel gain from a node  to a node  is denoted by a complex constant , where  and . We assume the availability of complete channel state information 
(CSI), \textit{i.e.}, all  values are known throughout the network \cite{dong}, \cite{sarma}. Considering  discrete time instants and neglecting propagation delays, the signal received at each relay node due to the source can be expressed as:
 
where the source signal  at time instant , are i.i.d complex Gaussian random variables with zero mean and variance . 
Further,  is assumed to be independent of , the complex white Gaussian noise  at the  relay node. Each relay node  scales the received signal from the source by  before transmitting: \begin{figure}[!t]
\centering
\begin{tikzpicture}[scale=1.25]
\tikzstyle{every node}=[draw,shape=circle,minimum size=0.9cm,style=thick]
\node (v0) at (180:2.5) {};
\node (v1) at (90:1.5) {};
\node (v2) at (90:0.5) {};
\node (v3) at (270:1) {};
\node (v4) at (25:3) {};
\node (v5) at (5:2.85) {};
\node (v6) at (340:3.05) {};
\draw[style=thick,->] (v0) -- (v1);
\draw[style=thick,->] (v0) -- (v2);
\draw[style=thick,->] (v0) -- (v3);
\draw[style=thick,->] (v1) -- (v4);
\draw[style=thick,->] (v2) -- (v4);
\draw[style=thick,->] (v3) -- (v4);
\draw[dashed,->](v1) -- (v5);
\draw[dashed,->](v2) -- (v5);
\draw[dashed,->](v3) -- (v5);
\draw[dashed,->](v1) -- (v6);
\draw[dashed,->](v2) -- (v6);
\draw[dashed,->](v3) -- (v6);
\draw[loosely dotted,line width=1](0,0.10) -- (0,-.6);
\draw[loosely dotted,line width=1](2.9,-0.15) -- (2.9,-.6);
\draw[dashed,,rounded corners] (2.4,0.65) rectangle (3.3,-1.5);
\end{tikzpicture}
\caption{Simple AF network with multiple () eavesdroppers.}
\label{fig:model}
\end{figure}

where 
. Therefore, the received signal at the destination or an eavesdropper can be expressed as:

Here . We assume that  are independent of the source symbol and of each other. For the layered relay network shown in Figure \ref{fig:model}, 
the received signals at the destination and the eavesdroppers are free of intersymbol interference as they traverse paths with the same respective delays. Therefore, omitting the time index and using \eqref{eq:rel}, \eqref{eq:beta} and \eqref{eq:dest} we can write:

From \eqref{eq:rcvsgnl}, we can write the SNR at the destination or an eavesdropper as:
 
where  is an  column vector  and  is a  diagonal matrix \textit{i.e.}, .
  


\section{Receiver SNR Maximization}
\label{SNR}
In the first scenario, we consider the problem of maximizing the secrecy rate achievable with the AF-relays when the received SNR at the eavesdroppers is below their respective predefined thresholds. However, given the logarithmic dependence of the achievable information rate on the received SNR () and the monotonically increasing nature of the , we have:
      
       \text{\textbf{P1:}}\;\max_{\bm{\beta}} \; & \frac{\left| \sum_{i=1}^{M} h_{s,i}\beta_ih_{i,d}\right| ^2}{1 + \sum_{i=1}^{M}|\beta_i h_{i,d}|^2}\frac{P_s}{\sigma^2} \\
      \text{such that}  \; & \frac{\left| \sum_{i=1}^{M} h_{s,i} \beta_i h_{i,k}\right| ^2}{1 + \sum_{i=1}^{M}|\beta_ih_{i,k}|^2}\frac{P_s}{\sigma^2} \le \gamma_k, \; k \in \mathcal{K}\\
       		                &  |\beta_i|^2 \le \beta_{max,i}^2, i \in \mathcal{M}
      
      Here,  is a real number and represents the predefined threshold for the  eavesdropper. This problem is inherently non-convex. We consider the following transformation of the variable .

       If we consider the vector variables  and , then we can write:
       
Also, we define , where .

In terms of these new variables and parameters, the objective function and constraints are expressed in the following way:
\begin{itemize}
\item \textbf{Objective function:}


\item \textbf{Eavesdroppers Constraint} : 

where  and . By writing in terms of  and rearranging, we get: , where 


\item \textbf{Relay power constraint} : 

where 

\end{itemize}
Therefore, the equivalent optimization problem is:

\text{\textbf{P1-EQ:}}\;\max_\mathbf{u}&\; \mathbf{u^\dagger h_sh_s^\dagger u}\\
\text{such that}&\;\mathbf{u^\dagger C_ku} \le 1,\;k \in \mathcal{K}\\&\mathbf{u^\dagger D_iu} \le 1, \; i \in \mathcal{M}
If  then  is a diagonal matrix with positive entries, therefore,  is a positive definite matrix.
As the objective function and all the constraints are convex, 
we can obtain the global optimum using numerical routines as suggested by \cite{hiriart2001global}.
\par But, in general scenarios  may not be positive-semidefinite.  However, if a \textbf{QCQP} is not convex then it is hard to solve \cite{ANDREA},\cite{luo2010semidefinite}. As , so by considering relaxation on rank one symmetric positive semi-definite (PSD) matrix , the optimization program \ref{eq:snr_cvx} can be written as:

\max_{\mathbf{U}}& \quad \mathbf{h_sh_s^\dagger \bullet U}\\
\text{subject to }& \quad \mathbf{C_k\bullet U} \le 1, k \in \mathcal{K}\\
& \quad \mathbf{D_i\bullet U} \le 1, i \in \mathcal{M}

The  represents Frobenius product of matrices, . Once the problem \ref{eq:snr_sdr} is solved, we can find the corresponding optimal  and thereby  by applying eigenvalue decomposition on matrix  \cite{luo2010semidefinite}.


\textit{Remark 1:} If we denote the optimum objective function value by , then source can securely transmit at a rate ,
where  and  is the SNR threshold for destination.
   
\section{Relay Power Minimization}
\label{POW}
   For an energy constrained relay network, an objective would be to minimize the total relay power. Using \eqref{eq:beta}, the power of the signal transmitted by the  relay node is . Considering the SNR constraints on the destination and the eavesdroppers and individual power constraint for each relay node, the total relay power minimization problem is as follows:

   \text{\textbf{ P2:} }\; \min_{\bm{\beta}} & \sum\limits_{i=1}^{M}|\beta_i|^2 (|h_{s,i}|^2 P_s + \sigma^2)\\
   \text{such that}\; & \frac{\left| \sum_{i=1}^{M} h_{s,i}\beta_ih_{i,d}\right| ^2}{1 + \sum_{i=1}^{M}|\beta_i h_{i,d}|^2}\frac{P_s}{\sigma^2} \ge \gamma_d \label{prob1cons1}  \\
   		& \frac{\left| \sum_{i=1}^{M} h_{s,i} \beta_i h_{i,k}\right| ^2}{1 + \sum_{i=1}^{M}|\beta_ih_{i,k}|^2}\frac{P_s}{\sigma^2} \le \gamma_k, \; k \in \mathcal{K} \label{prob1cons2}\\
    		&|\beta_i|^2 \le \beta_{max,i}^2, i \in \mathcal{M}
   
   Similar to ,  is a real number and it represents the predefined SNR threshold for the destination.
We can easily rewrite the above expression in matrix notation and rearrange to get the following Quadratic Constrained Quadratic Program (QCQP) formulation \cite{ANDREA}:
   
   
Following the procedures discussed in previous section, we formulate another semi-definite program after relaxing the 
symmetric positive semi-definite (PSD) matrix .

\text{\textbf{P2-SDR:}}\;\min_\mathbf{B} \quad &  {\mathbf{Q}}_0 \bullet {\mathbf{B}} \\
    -& {\mathbf{Q}}_D \bullet {\mathbf{B}} \le -\gamma'_d\\
    & {\mathbf{Q}}_k \bullet {\mathbf{B}} \le \gamma'_k,\quad k \in  \mathcal{K}\\&\mathbf{B}_i \le \beta_{max,i}^2, \; i \in \mathcal{M}\\ & {\mathbf{B}} \succeq 0

  represents the  diagonal element of that matrix. Solving this will provide us ; we look for an eigenvector of  corresponding to the maximum eigenvalue. 

All the above formulations of Problem P2 require iterative algorithms to obtain the optimal solution. Therefore, we discuss a simple analytical relaxed solution for the problem \eqref{prob1}.

\textit{\textbf{Analytical Relaxed Solution:}} It can be argued that to minimize the objective function value, \eqref{prob1cons1} should be satisfied with equality. Therefore, we formulate another optimization problem to calculate the analytical relaxed solution of the original objective function value.

\min_{\bm{\beta}}\quad& \bm{\beta}^\dagger\mathbf{Q}_0\bm{\beta} \\
\text{such that}\quad & \bm{\beta}^\dagger\mathbf{Q}_D\bm{\beta}=\gamma'_d

This can be posed as the well known \textit{Rayleigh Quotient} \cite[p.~176]{Horn1985} problem \textit{i.e.}

If  is invertible, then the solution to this optimization problem is given by , where  is the minimum eigenvalue of matrix  and the optimal  is the corresponding eigenvector. The solution of this problem need not satisfy the eavesdroppers' constraints, but the objective function value serves as lower bound for optimization problem \ref{prob:P2SDP} and indicate the extra amount of power required to met the secrecy constraints.

\textit{Remark 2:} A lower bound on the achievable AF secrecy rate for the optimum scaling vector would be .

\section{Results}
\label{sec:res}
    In Figure \ref{fig_snrmax}, we plot the solution of the destination SNR maximization problem, mentioned in Section~\ref{SNR}, with respect to source power () for several values of eavesdroppers' SNR threshold () after averaging over 100 network instances. 
For each instance, the channel gains are obtained from a complex Gaussian distribution with mean 0 and variance 1. We considered five relay nodes () with equal maximum transmit power () and five eavesdroppers () for the evaluation. Though we have assumed equal threshold values () for all the eavesdroppers in our plots, our formulations are valid for unequal values ( where ) also.
As  increases, the relay nodes can transmit signals with higher power. This results in the increase of SNR at the destination, yet the received SNRs at the eavesdroppers remain below their respective SNR thresholds. This leads to an increase in the secure communication rate with increasing , which is evident from Figure \ref{fig_snrmax}.


Figure \ref{fig_powmin} depicts the variation of optimal total relay power consumption for the total relay power minimization formulations, mentioned in Section~\ref{POW}, with respect to the source power ().
The ``SDR" and ``Analytical Relaxed" values are outputs of the relaxed semidefinite program \textbf{P2-SDR} and Rayleigh Quotient problem \eqref{eq:rayleigh}, respectively. 
With the increase of source power , the SNR at relay nodes increases. Therefore, to maintain the SNR at the destination at any fixed value, the relays have to consume less power. This is apparent from Figure \ref{fig_powmin}, which shows decreasing total relay power consumption with the increase of . 


\begin{figure}[!t]
\centering
\includegraphics[scale=0.6]{snrmax_Ps.pdf}
\caption{Plot of the achievable secrecy rate at the destination  obtained from SNR maximization problem (\textbf{P1}) w.r.t. to source power  for several SNR threshold values  with ,  and , averaged over 100 instances.}
\label{fig_snrmax}
\vspace{-0.2in}
\end{figure}



\section{Conclusion}
\label{sec:concl}
SNR based secure communication for Amplify-and-Forward (AF) relay networks with multiple eavesdroppers is considered. After motivating the secure communication scheme, we formulate two optimization problems for obtaining respective optimal scaling factors. Due to the non-convexity of both the formulations, we reformulate those for obtaining computationally efficient solutions. We have considered a two hop network, but in future we plan to investigate similar SNR based model for general multihop AF networks. We also plan to study scenarios where some relay nodes act as jammers, thereby reducing the SNR at the eavesdroppers \cite{sarma}, \cite{sankararaman2012}.

\begin{figure}[!t]
\centering
\includegraphics[scale=0.6]{powmin_ps.pdf}
\caption{Plot of total relay power consumption calculated using optimization formulations in \eqref{prob1},\eqref{prob:P2SDP}, and \eqref{eq:rayleigh} w.r.t source power () with  and , ,  and , averaged over 100 instances.}
\label{fig_powmin}
\end{figure}



\begin{thebibliography}{99}
\bibitem{bloch2011physical} M.~Bloch and J.~Barros, \textit{Physical-Layer Security: From Information Theory to Security Engineering}, Cambridge University Press, 2011.

\bibitem{wyner} A.~Wyner, ``The Wire-tap channel,'' \textit{Bell Sys. Tech. Journal}, vol.~54, no.~8, pp. 1355--1387, Jan 1975.

\bibitem{schaible} S. Schaible and J. Shi, ``Fractional programming: the sum-of-ratios case", \textit{Optimization Methods and Software}, vol. 18, April 2003.

\bibitem{dong} L.~Dong, Z.~Han, A.~P.~Petropulu, and H.~V.~Poor, ``Amplify-and-forward based cooperation for secure wireless communications,'' \textit{Proc. IEEE ICASSP 2009,} Taipei, Taiwan, April 2009.

\bibitem{zhang10} J.~Zhang and M.~C. Gursoy, ``Collaborative relay beamforming for secrecy,'' \textit{Proc. IEEE ICC 2010,} Cape Town, South Africa, May 2010.

\bibitem{yang2013cooperative}
Y.~Yang, Q.~Li, W.-K. Ma, J.~Ge, and P.~Ching, ``{Cooperative Secure
  Beamforming for AF Relay Networks With Multiple Eavesdroppers},'' \textit{IEEE
  Signal Processing Letters}, vol.~20, no.~1, pp. 35--38, 2013.

\bibitem{Leung} S.~Leung-Yan-Cheong and M.~Hellman, ``The Gaussian wire-tap channel,'' \textit{IEEE Trans. Info. Theory,} vol. IT-24, no.~4, pp. 451--456, July 1978.

\bibitem{proakisdigital} J.~G. Proakis, \textit{Digital communications}, McGraw-Hill, New York , 1995
  
\bibitem{sarma} S.~Sarma, S.~Shukla, and J.~Kuri, ``Joint scheduling \& jamming for data secrecy in wireless networks,'' \textit{Proc. IEEE WiOpt 2013,} Tsukuba, Japan, May 2013.

\bibitem{107gomadamJafar} K.~S.~Gomadam and S.~A.~Jafar,``Optimal relay functionality for SNR maximization in memoryless relay networks,'' \textit{IEEE JSAC,} vol. 25, February 2007.

\bibitem{hiriart2001global}
J.-B. Hiriart-Urruty, ``{Global Optimality Conditions in Maximizing a Convex
  Quadratic Function Under Convex Quadratic Constraints},'' \emph{Journal of
  Global Optimization}, vol.~21, no.~4, pp. 443--453, 2001.

\bibitem{ANDREA} A.~Qualizza, P.~Belotti, and F.~Margot, ``Linear Programming Relaxations of Quadratically Constrained Quadratic Programs,'' in \textit{Mixed Integer Nonlinear Programming}, ser. The IMA Volumes in Mathematics and its Applications, J.~Lee and S.~Leyffer, Eds. Springer New York, 2012, vol. 154, pp. 407--426.

\bibitem{luo2010semidefinite} Z.-Q. Luo, W.-K. Ma, A.-C. So, Y.~Ye, and S.~Zhang, ``Semidefinite relaxation of quadratic optimization problems,'' \textit{IEEE Sig. Process. Mag.,} vol.~27, no.~3, pp. 20--34, 2010.

\bibitem{Horn1985} R.~A. Horn and C.~R. Johnson, Eds., \textit{Matrix Analysis}. New York, NY, USA: Cambridge University Press, 1986.

\bibitem{sankararaman2012} S.~Sankararaman, K.~Abu-Affash, A.~Efrat, S.~D. Eriksson-Bique, V.~Polishchuk, S.~Ramasubramanian, and M.~Segal, ``Optimization schemes for protective jamming,'' \textit{Proc. ACM Mobihoc 2012,} Hilton Head Island, SC, June 2012.

\end{thebibliography}

\end{document}