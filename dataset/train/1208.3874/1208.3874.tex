\documentclass[12pt,a4paper]{article}
\usepackage{latexsym,amssymb,amsmath}
\usepackage[russian]{babel}

\newcommand{\neeg}{\overline{\phantom a}}
\newcommand{\wt}{\widetilde}

\begin{document}
\title{Верхние оценки сложности формул для функции голосования
\footnote{Работа выполнена при финансовой поддержке РФФИ, проекты
11--01--00508 и 11--01--00792--а, и программы фундаментальных
исследований Отделения математических наук РАН <<Алгебраические и
комбинаторные методы математической кибернетики и информационные
системы нового поколения>> (проект <<Задачи оптимального синтеза
управляющих систем>>).}}
\date{}
\author{И. С. Сергеев}

\maketitle
\begin{abstract}
Показано, что сложность реализации функции подсчета числа единиц в
булевом наборе длины $n$ формулами над базисом двуместных булевых
функций не превосходит $O(n^{3,06})$, а над стандартным базисом
$O(n^{4,54})$. Как следствие, такие же оценки справедливы для
сложности любой пороговой симметрической функции $n$ переменных, в
частности, для функции голосования; сложность вычисления
произвольного разряда произведения $n$-разрядных двоичных чисел не
превосходит $O(n^{4,06})$ и $O(n^{5,54})$. Попутно получены оценки
сложности произвольных симметрических функций $n$ переменных:
$O(n^{3,23})$ и $O(n^{4,82})$ над теми же базисами.
\end{abstract}

\section{Введение}

В работе рассматривается сложность реализации симметрических
булевых функций формулами над базисом $B_2$ всех двуместных
булевых функций и над стандартным базисом $B_0 = \{ \wedge,
\vee,\neeg \}$. Понятия формулы и сложности $L_B(f)$ реализации
булевой функции $f$ формулами над базисом $B$ см. в~\cite{lu,ju}.

Рекордные на сегодня верхние оценки сложности и глубины реализации
симметрических функций как формулами, так и схемами из
функциональных элементов над полными базисами, опираются на
эффективную реализацию вектор-функции $C_n(x_1,\ldots,x_n)$
подсчета числа единиц в булевом наборе $(x_1,\ldots,x_n)$.
Сведение к вычислению функции $C_n$ используется при минимизации
глубины и сложности формул для умножения двоичных чисел.

В свою очередь, эффективные схемы и формулы для функции $C_n$
строятся из схем компрессоров (западный термин для схемы
компрессора --- CSA (carry save adder)). $(k,l)$-компрессор ширины
1 реализует булеву вектор-функцию $(x_1,\ldots,x_k) \to
(y_1,\ldots,y_l)$ с условием $\sum a_i x_i = \sum b_j x_j$, где
$k>l$, а константы $a_i, b_j$ являются целыми степенями двойки.
$(k,l)$-компрессор произвольной ширины строится из параллельных
копий компрессоров ширины 1 и позволяет сводить сложение $k$ чисел
к сложению $l$ чисел.

Используя подходящие компрессоры и метод~\cite{ppz}, в
работе~\cite{pz} получены оценки $L_{B_2}(C_n)=O(n^{3,13})$,
$L_{B_0}(C_n)=O(n^{4,57})$ уточняющие известные до этого оценки
$L_{B_2}(C_n)=O(n^{3,32})$~\cite{pe} и
$L_{B_0}(C_n)=O(n^{4,62})$~\cite{kh} (о более ранних результатах
см. в~\cite{ppz}).

В недавней работе~\cite{dkky} построен компрессор (MDFA),
позволяющий реализовать функцию $C_n$ схемой над базисом $B_2$
рекордной сложности $4,5n$ (до этого была известна оценка
сложности $5n$). Эффективное использование компрессора~\cite{dkky}
предусматривает кодирование некоторых пар битов $u, v$ в виде
$(u\oplus v, v)$ (такой способ кодирования предложен в~\cite{st}).
Выигрыш в сложности проистекает из того, что (а) пара $(u\oplus v,
v)$ вычисляется не сложнее, чем пара $(u, v)$, (б) впоследствии
вместо бита $u$ используется сразу $u\oplus v$, что экономит одно
булево сложение.

Заметим, что в силу этих же причин следует ожидать, что MDFA
эффективен для построения формул. Действительно, компрессор
позволяет использовать на промежуточных этапах вычислений формулы
для $u \oplus v$, более короткие, чем суммарно формулы для $u$ и
$v$, минуя явное выполнение сложения $u$ и $v$.

Указанное наблюдение неявно уже использовалось при построении
рекордного для сложности формул компрессора в~\cite{pz}. Этот
компрессор содержит MDFA, к выходам которого присоединен
стандартный $(3,2)$-компрессор FA$_3$. Промежуточное кодирование
битов в виде $(u\oplus v, v)$~--- это ровно то, что делает
компрессор~\cite{pz} более эффективным, чем стандартный
$(3,2)$-компрессор (последний позволяет получить оценку \linebreak
$L_{B_2}(C_n)=O(n^{3,21})$, как показано в~\cite{ppz}).

Более того, по той причине, что MDFA экономит схемную сложность,
компрессор~\cite{pz} тоже обладает этим свойством: его схемная
сложность равна 14 (способ реализации функций в схеме несколько
отличается от способа их реализации в формуле) поэтому он
позволяет реализовать функцию $C_n$ со сложностью $(14/3)n$. Таким
образом, барьер $5n$ мог быть преодолен еще в 90-е гг.

Естественно ожидать, что компрессор~\cite{pz} не является
оптимальным способом использования MDFA для построения коротких
формул. Далее мы покажем, что используя MDFA более независимым
образом, можно получить оценку $L_{B_2}(C_n)=O(n^{3,06})$.
Предлагаемый способ, однако, тоже не использует возможности MDFA
оптимально.

Аналогичная идея может быть реализована и в случае стандартного
базиса. В этом случае применяется кодирование пар битов $u$ и $v$
упорядоченными парами $(uv,\;u\vee v)$. Выходы компрессора в
старших разрядах в такой кодировке являются монотонными функциями
входов (причем пороговыми, если все входы относятся к одному
разряду). Это может давать преимущество, поскольку в известных
конструкциях компрессоров над базисом $B_0$ наиболее
сложнореализуемыми являются немонотонные выходы.

Ниже мы построим $(5,3)$-компрессор SFA$_5$~--- аналог MDFA для
монотонной кодировки битов. Используя его, совсем просто получить
оценку $L_{B_0}(C_n)=O(n^{4,55})$. Чуть лучшая оценка
$L_{B_0}(C_n)=O(n^{4,54})$ получается при помощи более сложной
конструкции, основанной на $(7,3)$-компрессоре из~\cite{kh} и
монотонной кодировке троек битов.

Новые оценки сложности для функции голосования не приводят к
автоматическому улучшению оценок сложности реализации формулами
класса $S_n$ симметрических функций $n$ переменных, поскольку
известные методы~\cite{kh,ppz0} ограничивают эффективность
компрессоров со входами и выходами в различных кодировках.

Впрочем, из нескольких экземпляров компрессоров с измененной
кодировкой битов несложно построить компрессоры со стандартной
кодировкой, при помощи которых методом~\cite{ppz0} получаются
оценки $L_{B_2}(S_n)=O(n^{3,23})$, $L_{B_0}(S_n)=O(n^{4,82})$,
уточняющие известные ранее оценки \linebreak
$L_{B_2}(S_n)=O(n^{3,30})$~\cite{ppz0},
$L_{B_2}(S_n)=O(n^{3,37})$~\cite{pe},
$L_{B_0}(S_n)=O(n^{4,85})$~\cite{ppz0},
$L_{B_0}(S_n)=O(n^{4,93})$~\cite{kh}.


Подчеркнем, что конструкции элементарных компрессоров,
используемые в настоящей работе, принципиально такие же или, во
всяком случае, не более сложные, чем конструкции из предшествующих
работ. Новые оценки сложности получены исключительно в результате
эксплуатации идеи альтернативной кодировки битов.

\section{Конструкция для базиса $B_2$}

\begin{figure}[htb]
\begin{picture}(170,90)(-115,0)

\multiput(0,30)(160,0){2}{\line(0,1){30}}
\multiput(0,30)(0,30){2}{\line(1,0){160}}

\multiput(40,30)(40,0){3}{\vector(0,-1){20}}
\multiput(10,80)(35,0){5}{\vector(0,-1){20}}

\put(64,41){MDFA}

\put(7,84){$x$} \put(41,84){$v_1$} \put(63,84){$u_1\oplus v_1$}
\put(111,84){$v_2$} \put(132,84){$u_2\oplus v_2$}

\put(37,0){$c$} \put(77,0){$b$} \put(107,0){$a\oplus b$}

\end{picture}
\caption{Блок-схема MDFA}
\end{figure}

На рис. 1 изображена блок-схема компрессора MDFA, а ниже приведено
определение функционирования компрессора и формулы, по которым
вычисляются функции на его выходах.

$$ 2(a+b)+c = x+u_1+u_2+v_1+v_2. $$
\begin{equation}\label{mdfa}
\begin{array}{c}
\phantom{\displaystyle \sum}  c  = x \oplus (u_1 \oplus v_1)
\oplus (u_2 \oplus v_2), \qquad
    b  = (x\oplus v_1)(u_1 \oplus v_1) \oplus v_1, \phantom{\displaystyle \sum}  \\
  (a \oplus b) = ((x\oplus v_1) \vee (u_1 \oplus v_1)) \oplus
    (x\oplus (u_1 \oplus v_1) \oplus v_2)\overline{(u_2 \oplus
    v_2)}.
\end{array}
\end{equation}

Для получения оценки сложности $O(n^{3,06})$ мы используем
компрессор, изображенный на рис. 2. С точностью до кодировки
выходов, он состоит из двух изолированных компрессоров MDFA.

\begin{figure}[htb]
\begin{picture}(370,120)(-13,30)


\put(0,30){
\begin{picture}(160,90) \multiput(0,30)(160,0){2}{\line(0,1){30}}
\multiput(0,30)(0,30){2}{\line(1,0){160}}
\multiput(40,30)(40,0){3}{\vector(0,-1){20}}
\put(10,80){\vector(0,-1){20}} \put(45,110){\vector(0,-1){50}}
\put(46.7,110){\vector(4,-3){29}} \put(80,110){\vector(0,-1){20}}
\put(80,85){\circle{10}} \put(80,80){\line(0,1){10}}
\put(75,85){\line(1,0){10}}
\multiput(80,80)(35,0){3}{\vector(0,-1){20}} \put(64,41){MDFA}
\end{picture}}


\put(11,114){$x_1$} \put(44,144){$x_2$} \put(80,144){$x_3$}
\put(115,114){$v_1$} \put(137,114){$u_1 \oplus v_1$}

\put(40,30){$c_1$} \put(81,30){$b_1$} \put(108,30){$a_1\oplus
b_1$}


\put(195,45){
\begin{picture}(160,90) \multiput(0,30)(160,0){2}{\line(0,1){30}}
\multiput(0,30)(0,30){2}{\line(1,0){160}}
\multiput(40,30)(40,0){3}{\vector(0,-1){20}}
\multiput(10,80)(35,0){5}{\vector(0,-1){20}} \put(64,41){MDFA}
\end{picture}}


\put(204,129){$x_4$} \put(239,129){$v_2$} \put(262,129){$u_2
\oplus v_2$} \put(309,129){$v_3$} \put(332,129){$u_3 \oplus v_3$}

\put(234,45){$c_2$} \put(275,45){$b_2$} \put(302,45){$a_2\oplus
b_2$}

\end{picture}
\caption{Конструкция основного компрессора}
\end{figure}

Компрессор имеет входы и выходы двух типов: одиночные биты и пары
битов в кодировке $(u\oplus v,v)$.

Входам и выходам первого типа поставим в соответствие сложность
реализующих их формул, обозначим ее через $X_i$ для входов $x_i$ и
через $C_i$~--- для выходов $c_i$. Входам и выходам второго типа в
кодировке $(u\oplus v,v)$ поставим в соответствие величину $\max
\{ V,\, U^+/\alpha\}$, где $V$, $U^+$~--- сложность (или верхняя
оценка сложности) формул, реализующих соответственно $v$ и
$u\oplus v$, а $\alpha$~--- параметр, который будет выбран
позднее. Указанную величину для входов $(u_i\oplus v_i,v_i)$ и
выходов $(a_i\oplus b_i,b_i)$ обозначим через $U_i$ и $A_i$
соответственно.

Согласно формулам~(\ref{mdfa}), справедливы соотношения:
\begin{equation}\label{sys}
\begin{array}{c}
C_1 \le X_1 + X_2 + X_3 + \alpha U_1, \\ \phantom{\displaystyle
\sum}
 C_2 \le X_4 + \alpha U_2 + \alpha U_3, \phantom{\displaystyle \sum}
 \\ \phantom{\displaystyle
\sum}
 A_1 \le \max \left\{ X_1 + X_2 + 3X_3, \;
\frac2{\alpha}X_1 + \frac2{\alpha}X_2 + \frac3{\alpha}X_3 +
\frac{\alpha+1}{\alpha}U_1 \right\}, \phantom{\displaystyle \sum}
\\ \phantom{\displaystyle \sum}
 A_2 \le \max \left\{ X_4 + (\alpha+2)U_2, \;
\frac2{\alpha}X_4 + \frac{2\alpha+1}{\alpha}U_2 +
\frac{\alpha+1}{\alpha}U_3 \right\}. \phantom{\displaystyle \sum}
\end{array}
\end{equation}

Из~\cite{ppz,pz} следует, что если при некотором $p>0$, некоторых
$X_i > 0$ и $U_i > 0$ (а также при некотором $\alpha>0$)
справедливо
\begin{equation}\label{inq}
\begin{array}{c}
X_1^p + X_2^p + X_3^p + X_4^p - C_1^p - C_2^p > 0, \\
\phantom{\displaystyle \sum}U_1^p + U_2^p + U_3^p - A_1^p - A_2^p
> 0, \phantom{\displaystyle \sum}
\end{array}
\end{equation}
то $L_{B_2}(C_n) = O\left(n^{1/p+o(1)}\right)$, см. также
Приложение. Используя вместо величин $C_i$ и $A_i$ верхние оценки
из~(\ref{sys}), можно проверить, что неравенства~(\ref{inq})
справедливы при $\alpha=2,906$, $p=0,327781$, $X_1=X_2=1$,
$X_3=0,5149081$, $X_4=1,9198088$, $U_1=1,2176395$,
$U_2=1,0031176$, $U_3=2,3573055$. Следовательно, $L_{B_2}(C_n) =
O(n^{3,0509})$.

Чтобы получить более точные оценки эффективности MDFA, можно
разбить второй тип входов и выходов на несколько типов с
различными значениями $\alpha$ (например, равномерно
распределенными на некотором отрезке) и рассмотреть набор из
MDFA-компрессоров со входами и выходами всевозможных типов.
Впрочем, без привлечения дополнительных соображений это достаточно
трудоемкая вычислительная задача. В малой части указанное
соображение учтено в конструкции компрессора рис.~2: отношение
размеров формул для $x_2\oplus x_3$ и $x_2$ отличается от
$\alpha$.


Чтобы оценить сложность реализации произвольной симметрической
функции, рассмотрим последовательность компрессоров со стандартной
кодировкой битов, в которой компрессор с номером $m$ состоит из
$m$ штук последовательно соединенных MDFA и внешнего компрессора
$FA_3$ (выходы каждого MDFA присоединяются ко входам $v_2$,
$u_2\oplus v_2$ следующего MDFA в обозначениях рис.~1). Первый
член этой последовательности ($m=1$) совпадает с компрессором
из~\cite{pz}. При $m=4$ получаем $(15,6)$-компрессор, который,
взятый отдельно, позволяет реализовать $C_n$ формулой сложности
$O(n^{3,089})$. Вектор сложности выходов этого компрессора
получается из вектора сложности входов умножением на матрицу
$$ \left( \begin{matrix}
0 & 0 & 0 & 0 & 0  \\
0 & 0 & 0 & 0 & 0  \\
0 & 0 & 0 & 0 & 1    \\
0 & 1 & 1 & 1 & 2   \\
1 & 2 & 2 & 3 & 3   \\
1 & 4 & 4 & 9 & 3
\end{matrix}\quad\begin{matrix}
 0 & 0 & 0 & 0 & 0 & 1 & 1 & 1 & 1 & 1 \\
 0 & 0 & 1 & 1 & 1 & 1 & 2 & 2 & 2 & 3 \\
 1 & 1 & 2 & 2 & 3 & 1 & 2 & 3 & 3 & 6  \\
 2 & 3 & 3 & 3 & 6 & 1 & 2 & 3 & 3 & 6 \\
 3 & 6 & 3 & 3 & 6 & 1 & 2 & 3 & 3 & 6 \\
 3 & 6 & 3 & 3 & 6 & 1 & 2 & 3 & 3 & 6
\end{matrix}\right)$$

Применяя этот $(15,6)$-компрессор способом~\cite{ppz0}, $k$-й
разряд функции $C_n$ можно реализовать со сложностью
$O(n^{2,2285}\cdot2^k)$, откуда получаем $L_{B_2}(S_n) =
O(n^{3,2285})$, обоснование см. в Приложении.

\section{Конструкция для базиса $B_0$}

В этом параграфе мы приведем два примера компрессоров, эффективных
для построения формул для $C_n$ над базисом $B_0$. Первый
компрессор изображен на рис. 3. Функционирование компрессора
SFA$_5$, лежащего в основе данного примера ~--- такое же, как у
MDFA. Выходы вычисляются по формулам:
\begin{equation}\label{sfa5}
\begin{array}{c}
\phantom{\displaystyle \sum} c = (x_1 \oplus (u_1 \oplus v_1))
\oplus (u_2 \oplus v_2) =
 \psi \overline{\chi} \vee  \overline{\psi} \chi, \phantom{\displaystyle \sum} \\
\psi =  x_1\left((u_1v_1) \vee \overline{(u_1 \vee v_1)}\right)
\vee \overline{x_1}\overline{(u_1v_1)}(u_1 \vee
 v_1), \;\,  \chi = \overline{(u_2v_2)}(u_2 \vee  v_2), \\
a_1b_1 = T_5^4(x_1,u_1,v_1,u_2,v_2) = \displaystyle\bigvee_{i+j=4}
T_3^i(x_1,u_1,v_1) T_2^j(u_2,v_2) =
\\ = (x_1(u_1 \vee v_1) \vee (u_1v_1))(u_2v_2) \vee x_1(u_1v_1)(u_2 \vee
v_2), \end{array}
\end{equation}
где через $T_n^k$ обозначается монотонная пороговая функция $n$
переменных с порогом $k$; выход $a_1 \vee b_1  =
T_5^2(x_1,u_1,v_1,u_2,v_2)$ является функцией, двойственной к
$a_1b_1$, поэтому реализуется двойственной формулой.

\begin{figure}[htb]
\begin{picture}(270,90)(-55,0)

\multiput(0,30)(160,0){2}{\line(0,1){30}}
\multiput(0,30)(0,30){2}{\line(1,0){160}}

\multiput(40,30)(40,0){3}{\vector(0,-1){20}}
\multiput(10,80)(35,0){5}{\vector(0,-1){20}}

\put(68,41){SFA$_5$}

\put(6,84){$x_1$} \put(35,84){$u_1v_1$} \put(64,84){$u_1\vee v_1$}
\put(105,84){$u_2v_2$} \put(134,84){$u_2\vee v_2$}

\put(37,0){$c$} \put(71,0){$a_1b_1$} \put(104,0){$a_1\vee b_1$}

\put(220,45){\circle{10}} \put(260,45){\circle{10}}
\put(216.1,42.2){$\wedge$} \put(256.1,40.9){$\vee$}

\multiput(220,70)(40,0){2}{\vector(0,-1){20}}
\multiput(220,40)(40,0){2}{\vector(0,-1){20}}
\put(222.5,70){\vector(3,-2){33}}
\put(257.5,70){\vector(-3,-2){33}}

\put(216,74){$x_2$} \put(256,74){$x_3$} \put(211,10){$a_2b_2$}
\put(244,10){$a_2\vee b_2$}

\end{picture}
\caption{Блок-схема компрессора из первого примера}
\end{figure}

По аналогии с предыдущим параграфом входам $x_i$,
$(u_iv_i,\,u_i\vee v_i)$ и выходам $c$, $(a_ib_i,\,a_i\vee b_i)$
поставим в соответствие величины $X_i$, $U_i$, $C$, $A_i$,
характеризующие сложность формул, реализующих $x_i$, $u_iv_i$ (или
$u_i\vee v_i$~--- в рассматриваемом примере формулы для элементов
пары имеют одинаковый размер), $c$, $a_ib_i$.

Из формул~(\ref{sfa5}) вытекают соотношения:
\begin{equation}\label{sys5}
C \le 4X_1 + 8U_1 + 4U_2, \quad A_1 \le 2X_1 + 3U_1 + 2U_2, \quad
A_2 \le X_2 + X_3.
\end{equation}
Как можно проверить исходя из этих неравенств, условие
\begin{equation*}
X_1^p + X_2^p + X_3^p - C^p > 0 \qquad U_1^p + U_2^p - A_1^p -
A_2^p > 0
\end{equation*}
выполнено при $p=0,219978$, $X_1=1$, $X_2=X_3=0,031702$,
$U_1=1,018913$, $U_2=2$. Следовательно, $L_{B_0}(C_n) =
O(n^{4,546})$.

Во втором примере мы используем кодирование троек битов $u$, $v$,
$w$ в виде упорядоченного набора $\wt s = (s',\,s'',\,s''')$,
дополненного суммой $s^{\oplus} = u \oplus v \oplus w$. Приведем
формулы для вычисления компонент кода:
$$ s' = \min \{ u,\,v,\,w \} = T_3^1(u,v,w) = u \vee v \vee w, $$
$$ s'' = T_3^2(u,v,w) = (u \vee v)w \vee uv, $$
$$ s''' = \max \{ u,\,v,\,w \} = T_3^3(u,v,w) = u v w. $$
Отметим, что $s''$ и $s^{\oplus}$ являются в точности битами суммы
$u+v+w$.

Компрессор из второго примера (см. рис. 4) состоит из двух
$(7,4)$-компрессоров SFA$_7$ и SFA$'_7$, отличающихся только
кодировкой одной из групп входов.

\begin{figure}[htb]
\begin{picture}(370,90)(-10,0)

\multiput(0,30)(160,0){2}{\line(0,1){30}}
\multiput(0,30)(0,30){2}{\line(1,0){160}}

\multiput(50,30)(60,0){2}{\vector(0,-1){20}}
\multiput(20,80)(60,0){3}{\vector(0,-1){20}}

\put(68,41){SFA$_7$}

\put(17,84){$x_1$} \put(66,84){$\wt s_1,\; s_1^{\oplus}$}
\put(126,84){$\wt s_2,\; s_2^{\oplus}$}

\put(47,0){$c_1$} \put(97,0){$\wt q_1,\; q_1^{\oplus}$}

\multiput(210,30)(160,0){2}{\line(0,1){30}}
\multiput(210,30)(0,30){2}{\line(1,0){160}}

\multiput(260,30)(60,0){2}{\vector(0,-1){20}}
\multiput(220,80)(30,0){4}{\vector(0,-1){20}}
\put(350,80){\vector(0,-1){20}}

\put(278,41){SFA$'_7$}

\put(216,84){$x_2$} \put(246,84){$x_3$} \put(276,84){$x_4$}
\put(306,84){$x_5$}

\put(336,84){$\wt s_3,\; s_3^{\oplus}$}

\put(257,0){$c_2$} \put(307,0){$\wt q_2,\; q_2^{\oplus}$}

\end{picture}
\caption{Блок-схема компрессора из второго примера}
\end{figure}

Функционирование компрессоров SFA$_7$ и SFA$'_7$ определяют
соотношения:
$$ c_1 + 2(q'_1 + q''_1 + q'''_1) = x_1 + s'_1 + s''_1 + s'''_1 + s'_2 + s''_2 + s'''_2, $$
$$ c_2 + 2(q'_2 + q''_2 + q'''_2) = x_2 + x_3 + x_4 + x_5 + s'_3 + s''_3 + s'''_3. $$
Выходы вычисляются по формулам, структурно таким же, как формулы
для $(7,3)$-компрессора~\cite{kh}:
\begin{equation}\label{sfa7}
\begin{array}{c}
c_1 = (x_1 \oplus s_1^{\oplus})\oplus s_2^{\oplus}  = s_2^{\oplus}
\overline{\left( x_1\overline{s_1^{\oplus}} \vee
\overline{x}_1s_1^{\oplus} \right)} \vee
 \overline{s_2^{\oplus}} \left( x_1\overline{s_1^{\oplus}} \vee \overline{x}_1s_1^{\oplus} \right), \\
c_2 = (x_2 \oplus x_3 \oplus x_4 \oplus x_5) \oplus s_3^{\oplus} =
\psi \overline{s_3^{\oplus}} \vee \overline{\psi} s_3^{\oplus}, \\
\phantom{\displaystyle \sum} \psi = (x_2\overline{x}_3 \vee
\overline{x}_2x_3)(x_4x_5 \vee \overline{x}_4\overline{x}_5) \vee
(x_2x_3 \vee \overline{x}_2\overline{x}_3)(x_4\overline{x}_5  \vee
\overline{x}_4x_5), \phantom{\displaystyle \sum} \\
\phantom{\displaystyle \sum}q'_1 = T_7^2(x_1,\wt s_1,\wt s_2) =
T_4^1(x_1, \wt s_1)s'_2
\vee T_4^2(x_1, \wt s_1) \vee s''_2, \phantom{\displaystyle \sum} \\
q''_1 = T_7^4(x_1,\wt s_1,\wt s_2) = \displaystyle
\bigvee_{i+j=4}T_4^i(x_1, \wt s_1)T_3^j(\wt s_2), \\
q^{\oplus}_1 = \overline{s'_2}\,T_4^2(x_1, \wt
s_1)\overline{T_4^4(x_1, \wt s_1)} \vee
s'_2\overline{s''_2}\,T_4^1(x_1, \wt s_1)\overline{T_4^3(x_1, \wt
s_1)} \; \vee \qquad \\ \qquad \vee \;
s''_2\overline{s'''_2}\left(T_4^4(x_1, \wt s_1) \vee
\overline{T_4^2(x_1, \wt s_1)}\right) \vee s'''_2\left(T_4^3(x_1,
\wt s_1) \vee \overline{T_4^1(x_1, \wt s_1)}\right).
 \end{array}
\end{equation}
Формула для $q'''_1 = T_7^6(x_1,\wt s_1,\wt s_2)$ получается
двойственным образом по отношению к формуле для $q'_1$ с заменой
$s'_i$ на $s'''_i$. Формулы для $\wt q_2$ и $q^{\oplus}_2$
устроены аналогично формулам для $\wt q_1$ и $q^{\oplus}_1$,
отличаясь только реализацией пороговых функций
$T_4(x_2,x_3,x_4,x_5)$.

Пороговые функции $T_4^i(y_1,y_2,y_3,y_4) = T^i_4(y_1,\wt s)$
четырех переменных, три из которых могут задаваться в разных
кодировках, реализуются формулами:
\begin{equation}\label{t4}
\begin{array}{c}
T_4^1 = y_1 \vee y_2 \vee y_3 \vee y_4 = y_1 \vee s', \\
T_4^2 = (y_1 \vee y_2)(y_3 \vee y_4) \vee y_1y_2 \vee y_3y_4 = y_1
s' \vee s''.
\end{array}
\end{equation}
Формулы для $T_4^3$ и $T_4^4$ получаются двойственным образом с
заменой $s'$ на $s'''$.

По построению, формулы для $q'_1$ и $q'''_1$ ($q'_2$ и $q'''_2$)
имеют одинаковую сложность при условии, что то же верно для входов
$s'_i$, $s'''_i$. Кроме того, сложность формулы для $q_i^{\oplus}$
вдвое больше, чем сложность формулы для $q''_i$.

Как и выше, будем обозначать через $X_i$ и $C_i$ сложность формул,
реализующих входы $x_i$ и выходы $c_i$ соответственно. Входам $\wt
s_i$ поставим в соответствие величину $S_i=\max\{ S'_i,\,
S''_i/\alpha \}$, где величины $S'_i$ и $S''_i$ характеризуют
сложность (точнее, верхнюю оценку сложности) формул, реализующих
$s'_i$ и $s''_i$. Аналогично определим величины $Q_i$,
соответствующие выходам $\wt q_i$.

Из (\ref{sfa7}) с учетом (\ref{t4}) следуют соотношения:
\begin{equation}\label{sys7}
\begin{array}{c}
C_1 \le 4X_1 + 8\alpha S_1 + 4\alpha S_2, \\
\phantom{\displaystyle \sum}
C_2 \le 8(X_2+X_3+X_4+X_5) + 4\alpha S_3, \phantom{\displaystyle \sum} \\
Q_1 \le \max \left\{ 2X_1 + (\alpha+2)S_1 + (\alpha+1)S_2, \;
\frac4{\alpha}X_1 + \frac{2\alpha+4}{\alpha}S_1 +
\frac{\alpha+2}{\alpha}S_2 \right\}, \\ \phantom{\displaystyle
\sum} Q_2 \le \max \left\{ 3(X_2+X_3+X_4+X_5) + (\alpha+1)S_3, \;
\right. \qquad \qquad \quad \phantom{\displaystyle \sum}
\\ \qquad \qquad \qquad \qquad \qquad \qquad \qquad \left. \frac6{\alpha}(X_2+X_3+X_4+X_5) + \frac{\alpha+2}{\alpha}S_3
\right\}.
\end{array}
\end{equation}

Используя~(\ref{sys7}), можно проверить, что условие
\begin{equation*}
X_1^p + X_2^p + X_3^p + X_4^p + X_5^p - C_1^p - C_2^p > 0 \qquad
S_1^p + S_2^p + S_3^p - Q_1^p - Q_2^p > 0
\end{equation*}
выполнено при $\alpha=1,6782$, $p=0,2204718$, $X_1=1$,
$X_2=X_3=X_4=X_5=0,3569540333$, $S_1=1,1282983248$,
$S_2=2,424317629$, $S_3=1,6884745179$. Следовательно,
$L_{B_0}(C_n) = O(n^{4,5358})$.

Вероятно, эту оценку можно улучшить даже без привлечения более
сложных, чем $SFA_5$ и $SFA_7$, конструкций, если использовать все
три способа кодировки битов в одном компрессоре.

Для оценки сложности произвольной симметрической функции
рассмотрим $(17,6)$-компрессор со стандартной кодировкой битов,
составленный из компрессора $SFA_7$ и двух компрессоров $SFA_5$ в
основании, упорядоченные тройка и две пары выходов которых
присоединены ко входам $(7,3)$-компрессора, который реализуется в
стиле~\cite{kh}. Вектор сложности выходов этого компрессора
получается из вектора сложности входов умножением на матрицу
$$ \left( \begin{matrix}
4 & 8 & 8 & 8 & 8 & 8 & 8 \\
0 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 0 & 0   \\
12 & 16 & 16 & 24 & 24 & 24 & 24  \\
14 & 20 & 20 & 24 & 24 & 24 & 24  \\
 7 & 10 & 10 & 12 & 12 & 12 & 12
\end{matrix}\quad\begin{matrix}
 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
 4 & 4 & 4 & 8 & 8 & 0 & 0 & 0 & 0 & 0 \\
 0 & 0 & 0 & 0 & 0 & 4 & 4 & 4 & 8 & 8  \\
 16 & 16 & 16 & 24 & 24 & 16 & 16 & 16 & 24 & 24 \\
 24 & 24 & 24 & 36 & 36 & 24 & 24 & 24 & 36 & 36 \\
 12 & 12 & 12 & 18 & 18 & 12 &12 & 12 & 18 & 18
\end{matrix}\right)$$

Можно проверить, что такой компрессор позволяет реализовать
функцию $C_n$ со сложностью $O(n^{4,558})$ и отдельно $k$-й разряд
этой функции~--- со сложностью $O(n^{3,8183}\cdot2^k)$, откуда
получаем $L_{B_0}(S_n) = O(n^{4,8183})$.



\begin{thebibliography}{99}

\bibitem{lu}
Лупанов О. Б. Асимптотические оценки сложности управляющих систем.
М.: Изд-во МГУ, 1984. 138 стр.

\bibitem{kh}
Храпченко В. М. О сложности реализации симметрических функций
формулами~// Мат. заметки. 1972, {\bf 11}(1), 109--120.

\bibitem{dkky}
Demenkov E., Kojevnikov A., Kulikov A., Yaroslavtsev G. New upper
bounds on the Boolean circuit complexity of symmetric functions~//
Inf. Proc. Letters. 2010, {\bf 110}(7), 264--267.

\bibitem{ju}
Jukna S. Boolean function complexity. Berlin, Heidelberg:
Springer-Verlag, 2012. 618 p.

\bibitem{ppz0}
Paterson M., Pippenger N., Zwick U. Faster circuits and shorter
formulae for multiple addition, multiplication and symmetric
Boolean functions~// Proc. 31st IEEE Symp. Found. Comput. Sci.,
1990, 642--650.

\bibitem{ppz}
Paterson M., Pippenger N., Zwick U. Optimal carry save networks~//
LMS Lecture Notes Series. {\bf 169}. Boolean function Complexity.
Cambridge University Press, 1992, 174--201.

\bibitem{pz}
Paterson M., Zwick U. Shallow circuits and concise formulae for
multiple addition and multiplication~// Comput. Complexity. 1993,
{\bf 3}, 262--291.

\bibitem{pe}
Peterson G. L. An upper bound on the size of formulae for
symmetric Boolean function. Tech. Report. 78--03--01. Univ.
Washington, 1978.

\bibitem{st}
Stockmeyer L. J. On the combinational complexity of certain
symmetric Boolean functions~// Math. Syst. Theory. 1977, {\bf 10},
323--336.

\end{thebibliography}

\section*{Приложение}

В этом разделе для полноты изложения мы приводим метод построения
формул. Его можно также найти в~\cite{ppz0,ppz,pz}.

\noindent {\bf 1. Реализация функции $C_n$.}

Пусть входы и выходы некоторого компрессора относятся к одному из
$t$ типов. Обозначим через $x_{i,j}$ входы, а через $y_{i,j}$~---
выходы $j$-го типа. Пусть размер $Y_{k,l}$ формулы, реализующей
выход $y_{k,l}$, является непрерывной кусочно-линейной однородной
и неубывающей по каждому аргументу функцией размеров $X_{i,j}$
формул, реализующих входы $x_{i,j}$, где величины $X_{i,j}$,
$Y_{k,l}$ могут принимать произвольные неотрицательные
вещественные значения. При этом если $Y_{k,l}<X_{i,j}$, то
$y_{k,l}$ не зависит от $x_{i,j}$. Пусть при некотором $p>0$ и
некоторых $X_{i,j}>0$ при любом $j=1,\ldots,t$ выполняется
\begin{equation}\label{bal}
\sum_i X_{i,j}^p - \sum_i Y_{i,j}^p >0.
\end{equation}
Покажем, как построить формулу для $C_n$ сложности
$O\left(n^{1/p+o(1)}\right)$.

Без ограничения общности можем считать, что $\min \{X_{i,j}\}=1<
\min \{Y_{i,j}\}$. В силу непрерывной зависимости $Y_{i,j}$ от
$X_{i,j}$ найдется такое $\delta>0$, что при любом $j$
неравенство~(\ref{bal}) остается справедливым при подстановке
в~(\ref{bal}) параметров $X'_{i,j} \in [X_{i,j}-\delta,\,X_{i,j}]$
и $Y'_{i,j} \in [Y_{i,j},\,Y_{i,j}+\delta]$ вместо соответствующих
$X_{i,j}$ и $Y_{i,j}$. Тогда найдется (достаточно малое)
$\lambda>1$, для которого существуют $d^X_{i,j},d^Y_{i,j} \in
\mathbb Z$ такие, что $\lambda^{d^X_{i,j}/p} \in
[X_{i,j}-\delta,\,X_{i,j}]$ и $\lambda^{d^Y_{i,j}/p} \in
[Y_{i,j},\,Y_{i,j}+\delta]$ для всех $i$, $j$. Следовательно, при
любом $j$ имеем
$$ \sum_i \lambda^{d^X_{i,j}}- \sum_i\lambda^{d^Y_{i,j}}>0, $$
причем $\lambda^{d^X_{i,j}/p}$ является оценкой снизу для
$X_{i,j}$, а $\lambda^{d^Y_{i,j}/p}$ является оценкой сверху для
$Y_{i,j}$. Назовем число $d^X_{i,j}$ (соответственно $d^Y_{i,j}$)
уровнем входа $x_{i,j}$ (выхода $y_{i,j}$). Мы можем полагать, что
$\min\{d^X_{i,j}\}=0$. Пусть $d=\max\{d^Y_{i,j}\}$.

Формулу, реализующую произвольный разряд функции $C_n$, построим
по следующему шаблону. Формула строится из компрессоров,
расположенных на различных уровнях: входами компрессоров могут
быть входы формулы, выходы компрессоров, расположенных на уровнях
с меньшими номерами, а также тождественно нулевые формулы.
Компрессор, расположенный на уровне $k$, принимает входы типа $j$
на уровнях $d^X_{i,j}+k$ и производит выходы соответствующего типа
на уровнях $d^Y_{i,j}+k$. Ненулевые входы формулы (т.е. символы
переменных) располагаются на уровнях $d$ и выше.

На каждом уровне $k$ формулы, $0 \le k \le \log_{\lambda} n$,
располагается $\left\lceil cn\lambda^{-k} \right\rceil$
компрессоров, где $c$~--- некоторая константа, которая будет
определена позднее.

Оценим число входов, включая тождественно нулевые, и число выходов
каждого типа $j$ в схеме. Поскольку следующее рассуждение не
зависит от $j$, индекс $j$ в нем опустим.

По построению, все выходы схемы на уровнях меньше $d$ являются
нулевыми. Суммарное число входов (все они нулевые) на тех же
уровнях есть $O(n)$. На уровне $k$, $d \le k \le \log_{\lambda}
n$, разность между числом входов и числом выходов есть
\begin{multline*}
\sum_i \left\lceil cn\lambda^{d^X_i-k} \right\rceil - \sum_i
\left\lceil cn\lambda^{d^Y_i-k} \right\rceil =\\
= cn\lambda^{-k}\left( \sum_i \lambda^{d^X_i} - \sum_i
\lambda^{d^Y_i} \right) \pm O(1) =
\Theta\left(n\lambda^{-k}\right) \pm O(1).
\end{multline*}
На уровнях выше $\log_{\lambda} n$ схема суммарно принимает и
производит $O(1)$ входов и выходов.

Таким образом, схема имеет $\Theta(n)$ ненулевых входов и
производит $O(\log n)$ ненулевых выходов ($j$-го типа). Выбирая
достаточно большое $c$, можно добиться, чтобы число входов было не
меньше $n$ при любом~$j$.

Оценим размер выходов. Согласно выбору $\lambda$, размер формул на
уро\-в\-не~$k$ оценивается сверху как $\lambda^{k/p}$.
Следовательно, формулы, реализующие выходы, имеют сложность не
выше $\lambda^{(\log_{\lambda}n+O(1))/p} = O(n^{1/p})$.

Функция $C_n$ реализуется посредством $\lfloor \log_2 n\rfloor+1$
параллельных копий описанного шаблона, в которых некоторые входы
обнуляются, и выполняется подходящая перекоммутация входов и
выходов на каждом уровне. Заключительное сложение $O(\log n)$
чисел можно реализовать произвольной формулой полиномиальной
сложности, поэтому окончательно сложность вычисления $C_n$
оценивается как $O\left(n^{1/p}\log^{O(1)}n\right)$.

\noindent {\bf 2. Реализация симметрических функций.}

Рассмотрим компрессор, имеющий входы и выходы одного типа. Через
$x_{s,i}$ и $y_{s,i}$ обозначим входы и выходы в $s$-м разряде,
$s\ge0$, через $X_{s,i}$ и $Y_{s,i}$ обозначим размер
соответствующих формул.
При любом $s$ положим
$$  a_s = \sum_i X_{s,i}^p - \sum_i Y_{s,i}^p, $$
где суммы по пустому множеству индексов считаются равными нулю.
Пусть при некоторых $p$, $X_{s,i}$ и $\nu\ge1$ выполнены
неравенства
\begin{equation}\label{nu} a_0>0, \qquad \qquad \sum_s a_s \nu^{-s} > 0. \end{equation}
Покажем, что $l$-й разряд функции $C_n$ можно реализовать формулой
сложности $O((\nu^ln)^{1/p+o(1)})$.

Как и в предыдущем пункте выберем подходящее приближение для
$X_{s,i}$ и $Y_{s,i}$ в виде целых степеней $\lambda>1$,
сохраняющее неравенства~(\ref{nu}) (показатели степеней обозначим
соответственно через $d^X_{s,i}$, $d^Y_{s,i}$). Без ограничения
общности считаем, что $\min\{d^X_{s,i}\}=0$. Обозначим
$d=\max\{d^Y_{s,i}\}$.

Пусть компрессор разряда $l$ и уровня $k$ принимает входы разряда
$s+l$ на уровнях $d^X_{s,i}+k$ и производит выходы разряда $s+l$
на уровнях $d^Y_{s,i}+k$. Формулу построим по схеме, в которой при
любом $l$, $0 \le l \le \log_2 n+1$, на уровне $k$, $0 \le k \le
\log_{\lambda} (\nu^ln)$, размещено $\lceil c\nu^ln\lambda^{-k}
\rceil$ компрессоров. Ненулевые входы формулы располагаются в
нулевом разряде на уровнях $d$ и выше.

Оценим число входов и выходов, относящихся к уровню $k$ и
разряду~$l$. Если $d \le k \le \log_{\lambda} (\nu^ln)$, то
разность между числом входов и числом выходов есть
\begin{multline*}
\sum_{s,i} \left\lceil c\nu^{l-s}n\lambda^{d^X_{s,i}-k}
\right\rceil - \sum_{s,i}
\left\lceil c\nu^{l-s}n\lambda^{d^Y_{s,i}-k} \right\rceil =\\
= c\nu^ln\lambda^{-k}\sum_s a_s \nu^{-s} \pm O(1) =
\Theta(\nu^ln\lambda^{-k}) \pm O(1).
\end{multline*}
На уровнях выше $\log_{\lambda} (\nu^ln)$ схема суммарно принимает
и производит $O(1)$ входов и выходов.

Следовательно, схема в каждом разряде производит $O(\log n)$
выходов. Подходящий выбор константы $c$ обеспечивает не менее $n$
входов в нулевом разряде. Формулы, реализующие выходы в разряде
$l$, имеют сложность не выше
$\lambda^{(\log_{\lambda}(\nu^ln)+O(1))/p} = O((\nu^ln)^{1/p})$.
Как следствие, $l$-й разряд функции $C_n$ реализуется формулой
сложности $O((\nu^ln)^{1/p}\log^{O(1)}n)$.

Если $\nu\le2^p$, то для реализации класса $S_n$ формулами
получаем оценку сложности $O(n^{1+1/p+o(1)})$: симметрическая
функция представляется как функция суммы своих аргументов~--- для
этой функции формула строится методом последовательного разложения
по (новым) переменным.
\end{document}
