


















\documentclass{article}








\usepackage[preprint, nonatbib]{neurips_2023}







\usepackage[utf8]{inputenc} \usepackage[T1]{fontenc}    \usepackage{hyperref}       \usepackage{url}            \usepackage{booktabs}       \usepackage{amsfonts}       \usepackage{nicefrac}       \usepackage{microtype}      \usepackage{xcolor}         


\usepackage[
natbib=true,
    citestyle=numeric-comp,
    bibstyle=ieee,
    sorting=nty
]{biblatex}
\addbibresource{neurips_2023.bib}

\usepackage{array}
\usepackage{tabularx}
\usepackage{tcolorbox}
\usepackage{graphicx}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{bm}
\usepackage{amsmath,amssymb}
\usepackage{booktabs}
\usepackage{algorithm}
\usepackage[noend]{algorithmic}
\usepackage{multirow}
\usepackage[flushleft]{threeparttable}

\usepackage{multirow}
\usepackage{makecell}
\usepackage{multirow}
\usepackage{xspace}
\usepackage{color}
\usepackage{wrapfig}
\usepackage{bbding}

\usepackage{hyperref}
\usepackage{url}
\usepackage{amsthm}
\usepackage{amsmath}
\newtheorem{theorem}{Theorem}

\usepackage{pifont}\newcommand{\cmark}{\ding{51}}\newcommand{\xmark}{\ding{55}}

\newcommand{\ie}{\emph{i.e.,}\xspace}
\newcommand{\eg}{\emph{e.g.,}\xspace}
\newcommand{\etal}{\emph{et al.}\xspace}
\newcommand{\promptfield}[1]{\textcolor{blue}{<#1>}}
\newcommand{\newl}{\textcolor{gray}{\textbackslash n }}
\def\revise{\textcolor{red}}



\title{Harnessing Explanations: \\LLM-to-LM Interpreter for Enhanced Text-Attributed Graph Representation Learning}








\author{\hspace{-0.4cm}
  Xiaoxin He$^{1}$ 
  \hspace{0.05cm}
  Xavier Bresson$^1$
  \hspace{0.05cm}
  Thomas Laurent$^2$ 
  \hspace{0.05cm}
  Adam Perold$^3$
  \hspace{0.05cm}
  Yann LeCun$^{4,5}$
  \hspace{0.05cm}
  Bryan Hooi$^1$
  \vspace{0.15cm} \\
  \texttt{\{xiaoxin, xaviercs, bhooi\}@comp.nus.edu.sg, tlaurent@lmu.edu}\\
  \texttt{research@provenance.ai, yann@cs.nyu.edu }
  \vspace{0.15cm} \\
  {\normalfont $^1$National University of Singapore \hspace{0.18cm} $^2$Loyola Marymount University \hspace{0.18cm} $^3$Provenance AI}\\
  $^4$New York University \hspace{0.18cm} $^5$Meta AI
}
\begin{document}


\maketitle




\begin{abstract}
Representation learning on text-attributed graphs (TAGs) has become a critical research problem in recent years. A typical example of a TAG is a paper citation graph, where the text of each paper serves as node attributes. Initial graph neural network (GNN) pipelines handled these text attributes by transforming them into shallow or hand-crafted features, such as skip-gram or bag-of-words features. Recent efforts have focused on enhancing these pipelines with language models (LMs), which typically demand intricate designs and substantial computational resources. With the advent of powerful large language models (LLMs) such as GPT or Llama2, which demonstrate an ability to reason and to utilize general knowledge, there is a growing need for techniques which combine the textual modelling abilities of LLMs with the structural learning capabilities of GNNs. Hence, in this work, we focus on leveraging LLMs to capture textual information as features, which can be used to boost GNN performance on downstream tasks. A key innovation is our use of \emph{explanations as features}: we prompt an LLM to perform zero-shot classification, request textual explanations for its decision-making process, and design an \emph{LLM-to-LM interpreter} to translate these explanations into informative features that enhance downstream GNNs. Our experiments demonstrate that our method achieves state-of-the-art results on well-established TAG datasets, including \texttt{Cora}, \texttt{PubMed}, \texttt{ogbn-arxiv}, as well as our newly introduced dataset, \texttt{tape-arxiv23}. Furthermore, our method significantly speeds up training, achieving a 2.88 times improvement over the closest baseline on \texttt{ogbn-arxiv}. Lastly, we believe the versatility of the proposed method extends beyond TAGs and holds the potential to enhance other tasks involving graph-text data~\footnote{Our codes and datasets are available at: \url{https://github.com/XiaoxinHe/TAPE}}.
\end{abstract}

\section{Introduction}
Many real-world graphs possess textual information, and are often referred to text-attributed graphs~\citep{yang2021graphformers}. In TAGs, nodes typically represent text entities, such as documents or sentences, while edges signify relationships between these entities. For example, the \texttt{ogbn-arxiv} dataset~\citep{hu2020open} represents a citation network in TAG form, where each node corresponds to a paper, with its title and abstract serving as node attributes. More generally, the combination of textual attributes with graph topology provides a rich source of information,  significantly enhancing representation learning for important applications, such as text classification~\citep{yang2015network_TADW, wang2016linked, yasunaga2017graph, chien2021node_giant, zhao2022learning_em}, recommendation systems~\citep{zhu2021textgnn}, social networks, and fake news detection~\citep{liu2019fine_fact_verify}.


\begin{figure}[t]
\vspace{-0.6cm}
    \centering
    \includegraphics[scale=0.43]{figs/overview-v14.pdf}
    \caption{Overview of our framework leveraging large language models (LLMs) to enhance representation learning on TAGs. First, the text attributes associated with each node, \ie title and abstract, are wrapped in a custom prompt (green box) and used to query the LLM, here GPT-3.5~\citep{brown2020language_gpt}, which generates a ranked prediction list and explanation (yellow box). Next, the original text, predictions, and explanation are used to fine-tune an language model (LM), here DeBERTa~\citep{he2021deberta}, then transformed into vectorial node features. Finally, these enriched node features, \ie $h_\textrm{orig}$, $h_\textrm{expl}$ and $h_\textrm{pred}$, are used in any downstream GNN, \eg RevGAT~\citep{li2021training_revgat} to predict unknown node classes.}
\label{fig: overview}
    \vspace{-0.4cm}
\end{figure}


\textbf{Representation learning on TAGs.}
Prior research has explored various approaches for representation learning on TAGs. The standard GNN pipeline (illustrated in Figure \ref{fig: overview} in light yellow),  first encodes the textual attributes of each node using shallow or hand-crafted features such as skip-gram~\citep{mikolov2013distributed_skipgram} or bag-of-words (BoW)~\citep{harris1985distributional_bow} (refer to Table~\ref{tab: text preprocess}). The resulting node features are then used as input for a GNN. For instance, the Open Graph Benchmark (OGB)~\citep{hu2020open} generated BoW and skip-gram~\citep{mikolov2013distributed_skipgram} features for the \texttt{ogbn-products} and \texttt{ogbn-arxiv} datasets respectively. These processed features are readily available within popular graph libraries, such as PyTorch Geometric (PyG)~\citep{fey2019fast_pyg} and Deep Graph Library (DGL)~\citep{wang2019deep_dgl}, and have been widely used by the graph community. However, these shallow text embeddings are limited in the complexity of the semantic features they can capture, especially when compared to approaches based on multi-layer LMs.


\textbf{LM-based pipeline for TAGs.} 
Recent works have therefore focused on designing LM-based techniques to better capture the context and nuances of text within TAGs~\citep{chien2021node_giant, zhao2022learning_em, dinh2022e2eg}.
In this approach, pre-trained LMs are fine-tuned and used to generate node embeddings that are tailored to the specific TAG tasks (depicted in Figure \ref{fig: overview} in light gray).
For example, \citet{chien2021node_giant} fine-tuned an LM using a neighborhood prediction task, while \citet{zhao2022learning_em} fine-tuned an LM to predict the label distribution from a GNN's outputs. 
LM-based models have achieved state-of-the-art (SOTA) results in node classification on \texttt{ogbn-arxiv} and \texttt{ogbn-products}~\citep{zhao2022learning_em}. However, these works typically entail intricate designs and demand substantial computational resources.
Furthermore, for scalability reasons, existing works mostly rely on relatively small LMs, such as BERT~\citep{devlin2018bert} and DeBERTa~\citep{he2021deberta}, and thus lack the complex reasoning abilities associated with larger language models.


\textbf{Large Language Models.}
The advent of large pre-trained models, exemplified by GPT~\citep{brown2020language_gpt}, has revolutionized the field of language modeling. LLMs have notably enhanced performance across various natural language processing (NLP) tasks, and enabled sophisticated language processing capabilities such as complex and zero-shot reasoning. 
Furthermore, scaling laws~\citep{kaplan2020scaling_law} have revealed predictable rules for performance improvements with model and training data size. Additionally, LLMs have exhibited ``emergent abilities'' that were not explicitly trained for, such as arithmetic, multi-step reasoning and instruction following~\citep{wei2022emergent}. 
While LLMs have found new success in domains like computer vision~\citep{tsimpoukelli2021multimodal}, their potential benefits when applied to TAG tasks remain largely uncharted. This presents an exciting and promising avenue for future research, and it is precisely this untapped potential that we aim to explore in this work.

\textbf{LMs vs. LLMs.} In this paper, we make a clear distinction between ``LMs'' and ``LLMs''. We use LMs to refer to relatively small language models that can be trained and fine-tuned within the constraints of  {\it an academic lab budget}. We refer to LLMs as very large language models that are capable of learning significantly more complex linguistic patterns than LMs, such as GPT-3/4. These models typically have tens or hundreds of billions of parameters and require {\it substantial computational resources} to train and use, \eg GPT-3 was trained on a supercomputer with 10,000 GPUs. The size and complexity of recent LLMs have raised concerns about their scalability, as they can be too large even to run inference on the machines typically available within academic research labs. To address this issue, LLMs are often made accessible through {\it language modeling as a service} (LMaaS)~\citep{sun2022black_lmaas}. This approach enables developers to harness the power of LLMs without necessitating extensive computational resources or specialized expertise. In the context of this paper, one of our primary objectives is to extract information from an LLM in a LMaaS-compatible manner. As a result, we do not require fine-tuning the LLM or extracting its logits; rather, we focus solely on obtaining its output in textual form. In contrast, existing LM-based techniques~\citep{chien2021node_giant, zhao2022learning_em, dinh2022e2eg} are not directly compatible with LLMs, as they require fine-tuning of LMs, as well as accessing their latent embeddings or logits, which GPT-3/4 do not provide. Consequently, to the best of our knowledge, the use of LLMs in TAG tasks remains an unexplored area.

\textbf{Preliminary study.} To assess the potential of LLMs in enhancing representation learning for TAGs, we conducted an initial investigation into leveraging GPT-3.5 for zero-shot classification on the \texttt{ogbn-arxiv} dataset. Using task-specific prompts consisting of paper titles, abstracts, and questions, GPT-3.5 achieved a promising accuracy of 73.5\%, along with high-quality text explanations, surpassing several fully trained GNN baselines like RevGAT~\citep{li2021training_revgat} with OGB features (70.8\% accuracy), but falling short of the SOTA accuracy of 76.6\%~\citep{zhao2022learning_em}.


\textbf{The present work: LLM augmentation using explanations.} We introduce a novel framework that leverages LLMs to improve representation learning on TAGs. A key innovation is the concept of \emph{explanations as features}. By prompting a powerful LLM to explain its predictions, we extract its relevant prior knowledge and reasoning steps, making this information digestible for smaller models, akin to how human experts use explanations to convey insights. To illustrate this concept further, observe in Figure \ref{fig: overview} that the explanations (in the yellow box) highlight and expand upon key crucial information from the text, such as ``deep learning techniques such as DeconvNet,'' and the relationship between text recognition and information retrieval. These explanations draw from the LLM's general knowledge and serve as valuable features for enhancing subsequent TAG pipeline phases. In practice, we design a tailored prompt to query an LLM such as GPT or Llama2 to generate both a \emph{ranked prediction list} and a \emph{textual explanation} for its predictions. These predictions and explanations are then transformed into informative node features through fine-tuning a smaller LM such as DeBERTa~\citep{he2021deberta} for the target task, providing tailored features for any downstream GNNs. This smaller model acts as an {\it interpreter}, facilitating seamless communication between the LLM (handling text) and the GNN (managing vectorial representation). 



\begin{figure}[t]
\vspace{-0.5cm}
    \centering
    \includegraphics[scale=0.45]{figs/comparison-v8.pdf}
    \caption{The performance trade-off between node classification accuracy and total training time on \texttt{ogbn-arxiv}~\citep{hu2020open} for various training approaches that combine language models (LMs) and graph neural networks (GNNs). The experiment employs DeBERTa-base~\citep{he2021deberta} as the LM backbone and RevGAT~\citep{li2021training_revgat} as the GNN backbone,  with the size of the marker indicating the number of parameters.}
    \label{fig: comparison}
    \vspace{-0.25cm}
\end{figure}



Our contributions are summarized as follows:
\begin{itemize}
    \item \textbf{Novel LMaaS-compatible approach.} We propose the first LMaaS-compatible approach, to the best of our knowledge, for leveraging LLMs to enhance representation learning on TAGs. Our innovations involve extracting explanations from an LLM, here GPT-3.5 and Llama2, and subsequently employing an LLM-to-LM interpreter to translate textual explanations into enriched node vector representations for downstream GNNs. 
Our approach improves modularity and efficiency compared to prior LM+GNN models.
    \item \textbf{SOTA performance.} Extensive experiments demonstrate that our {method} significantly boost the performance of various GNN models across diverse datasets. 
    Notably, we achieve top-1 performance on \texttt{ogbn-arxiv} with significantly lower computation time, {\ie $2.88\times$ faster than GLEM}, and also excel in the TAG versions of \texttt{PubMed} and \texttt{Cora} datasets. 
    \item \textbf{Data contribution.} We provide open-source access to our codes, pre-trained networks and enriched features. Additionally, recognizing the absence of raw text data for \texttt{Cora} and \texttt{PubMed} in common repositories (\eg PyG, DGL), we have collected and released these datasets in TAG format. Furthermore, we introduce the new \texttt{tape-arxiv23} citation graph dataset, extending beyond GPT-3's knowledge cutoff, \ie Sept. 2021. These datasets can serve as valuable resources for the NLP and GNN research community.
\end{itemize}



\section{Related Work}

\textbf{Shallow embedding pipeline for TAGs.}
In the context of learning representations on TAGs, a common approach involves combining graph-based learning with language modeling techniques.
One prevalent strategy is to transform text attributes into shallow or hand-crafted features, such as skip-gram~\citep{mikolov2013distributed_skipgram} or BoW~\citep{harris1985distributional_bow} features. Detailed information is available in Table~\ref{tab: text preprocess}. These engineered features can then be fed as inputs to a graph-based learning algorithm, such as a graph convolutional network (GCN)~\citep{kipf2016semi_gcn}, which learns embeddings capturing the graph structure while incorporating the extracted text features. Shallow embedding methods are widely used in the graph community due to their simplicity and computational efficiency, such as for designing GNN architectures~\citep{velivckovic2017graph_gat, chiang2019cluster_gcn, velickovic2019deep_graph_informax, zhang2021graphless} or benchmarking graph learning~\citep{yang2016revisiting, hu2020open}. However, they may have limitations in capturing complex semantic relationships and fully leveraging the richness of text attributes, particularly in scenarios involving intricate semantic relationships and contextual information.


\textbf{LM-based pipeline for TAGs.}
To overcome the limitations of shallow embedding approaches, researchers have explored deep embedding techniques by fine-tuning pre-trained LMs, such as BERT~\citep{devlin2018bert}, to generate node embeddings that are specifically adapted to the domain and context of the TAGs. These deep embeddings effectively capture the semantic richness of text attributes, leading to improved performance on various TAG-related tasks. Integrating LM-based embeddings and graph-based learning can be done through different approaches. One approach is to use a cascaded architecture, where the node features are first encoded independently by the LMs, and then fed into GNN models. This representation paradigm has been widely adopted in subsequent works, such as TextGNN~\citep{zhu2021textgnn}, GIANT~\citep{chien2021node_giant}, GPT-GNN~\citep{hu2020gpt_gnn}, SimTeg~\citep{duan2023simteg}, as well as in studies related to knowledge graphs~\citep{yasunaga2021qa, zhang2022greaselm} and  fact verification~\citep{liu2019fine_fact_verify, zhou2019gear} that are beyond the scope of this work. An alternative approach involves fusing text encoding and graph aggregation into an iterative workflow, enabling the model to refine both the text representations and the node embeddings simultaneously, such as Graphormer~\citep{yang2021graphformers}, DRAGON~\citep{yasunaga2022deep_dragon}, and GLEM~\citep{zhao2022learning_em}, to name a few. 



\textbf{LLM-based pipeline for TAGs.}
Incorporating LLMs into TAG tasks presents a promising frontier. LLMs such as ChatGPT~\citep{brown2020language_gpt} by OpenAI, PaLM~\citep{chowdhery2022palm} by Google, and LLaMA~\citep{touvron2023llama} by Meta, have demonstrated their effectiveness across a spectrum of NLP tasks. However, their potential benefits for TAG tasks have yet to be fully explored. While some recent research efforts have sought to evaluate the capacity of LLMs in understanding graph-structured data and enhance their graph processing capabilities~\citep{wang2023can, zhang2023graph_toolformer, guo2023gpt4graph}, these endeavors, while valuable, may not be directly aligned with our specific focus on TAGs. By exploring LLM-based methods designed specifically for TAGs, we can unlock new possibilities for improving TAG prediction performance and advancing our understanding of text attributes within graph-based data. Notably, our initial attempt has already inspired further research endeavors in this direction.


\section{Formalization}

In this section, we introduce notation and formalize some concepts related to language models, large language models, and graph neural networks for node classification on TAGs.

\textbf{Text-attributed graphs.}
Formally, a TAG can be represented as $\mathcal{G} = (\mathcal{V}, A, \{s_n\}_{n \in \mathcal{V}})$, where $\mathcal{V}$ is a set of $N$ nodes, $A\in \mathbb{R}^{N\times N}$ is the adjacency matrix, and $s_n\in\mathcal{D}^{L_n}$ is a sequential text associated with node $n \in \mathcal{V}$, with $\mathcal{D}$ as the words or tokens dictionary, and $L_n$ as the sequence length. 
In this paper, we investigate node classification on TAGs.  Specifically, given some labeled nodes $\mathcal{L} \subset \mathcal{V}$ , the goal is to predict the labels of the remaining unlabeled nodes $\mathcal{U} = \mathcal{V} \setminus \mathcal{L}$.

\textbf{Language models for text classification.}
In the context of TAGs,  LMs can be employed to encode the text attributes associated with each node and learn a representation that captures the semantic meaning of the text. Let $s_n\in\mathcal{D}^{L_n}$ denote the text attributes of node $n$, and $\textrm{LM}$ be a pre-trained network, such as BERT~\citep{devlin2018bert} or DeBERTa~\citep{he2021deberta}. Then, the text attributes of node $n$ can be encoded by applying the LM to $s_n$ as follows:
\begin{equation}
    h_n=\textrm{LM}(s_n) \in \mathbb{R}^d,
\end{equation}
where $h_n$ is the output of the LM, and $d$ is the dimension of the output vector.

To perform node classification, the output is employed as input to a classifier, such as a logistic regression or a neural network. The goal is to learn a function that maps the encoded text attributes to the corresponding node labels. 

\textbf{Large language models and prompting.}
LLMs have introduced a new paradigm for task-adaptation known as ``pre-train, prompt, and predict'', replacing the traditional ``pre-train, fine-tune'' procedure. In this paradigm, the LLM is first pre-trained on a large corpus of text data to learn general language representations. Then, rather than fine-tuning the model on task-specific labeled data, the model is prompted with a natural language prompt that specifies the task and context, and the model generates the output directly based on the prompt and the input~\citep{liu2023pre_survey}.


The prompt can take various forms, such as a single sentence or a longer passage, and can include additional information or constraints to guide the model's behavior. Let $\mathcal{M}$ be an LLM that takes as input a sequence of tokens $x=(x_1,x_2,\ldots,x_q)$ and produces as output a sequence of tokens $y=(y_1,y_2,\ldots,y_m)$. The model $\mathcal{M}$ is typically trained to optimize a conditional probability distribution $p(y|x)$, which assigns a probability to each possible output sequence $y$ given $x$. To include a prompt $p$ with the input sequence $x$, we can concatenate them into a new sequence $\hat{x}=(p,x_1,x_2,\ldots,x_q)$. We then use $\hat{x}$ to compute the conditional probability distribution $p(y|\hat{x})$. Formally, the probability of the output sequence $y$ given $\hat{x}$ is:
\begin{equation}
p(y|\hat{x})=\prod_{i=1}^m p(y_i|y_{<i}, \hat{x}),
\end{equation}
where $y_{<i}$ represents the prefix of sequence $y$ up to position $i-1$, and $p(y_i | y_{<i}, \hat{x})$ represents the probability of generating token $y_i$ given $y_{<i}$ and $\hat{x}$. 



\textbf{Graph neural networks for node classification.}
In node classification, the task is to label each node in a graph based on its attributes and connections with other nodes. GNNs operate by aggregating information from a node's neighbors, then updating the node's representation based on the aggregated information. Formally, the $k$-th layer of a GNN is designed as:
\begin{equation}
    h_i^{k} = f^{k}(h_i^{k-1}, \, \textrm{AGG}(\{h_j^{k-1}: j\in \mathcal{N}_i\})) \in \mathbb{R}^d,
\end{equation}
where $h_i^{k}\in\mathbb{R}^{d}$ is the representation of node $i$ at layer $k$ and $\mathcal{N}_i \subseteq \mathcal{V}$ is the set of neighbors of node $i$. Function $f^{k}$ is a differentiable function that updates the representation of a node based on its previous-layer representation and the aggregated information from its neighbors. This function is typically implemented as a neural network layer (\eg a multi-layer perceptron, or an attention mechanism). $\textrm{AGG}$ is also a differentiable function (\eg sum, mean, etc.) that aggregates the representations of a node's neighbors to produce a summary vector. The final representation is fed into a fully connected layer and a softmax function for class prediction.





\section{Proposed Method}
In this section, we describe our LLM-based pipeline designed for node classification on TAGs. As illustrated in Figure~\ref{fig: overview}, the key idea
is to leverage the LLM's explanations as informative features for a downstream GNN. To achieve this goal, our method involves three main steps: 1) LLM-based prediction and explanation generation, 2) fine-tuning an LM interpreter, and 3) training a GNN.


\subsection{Generating Predictions and Explanations with LLMs}
As outlined in the introduction, our approach is designed to be \emph{LMaaS-compatible} given the scale of LLMs. This means that we aim to operate solely through API access to an LLM, using text-based input and output, without requiring fine-tuning the LLM or accessing its embeddings or logits.


In lieu of these requirements, our approach focuses on querying the LLM in an ``open-ended'' manner, \ie instructing the LLM to make multiple predictions and provide explanations for its decisions. By doing so, we aim to effectively extract its reasoning abilities and general knowledge in text format. These text-based outputs are then processed using an \emph{LLM-to-LM interpreter} to create informative node features for downstream GNNs. With this objective, for each paper node $i \in \mathcal{V}$, we generate a prompt that includes the title and abstract of the paper, along with an open-ended question about the paper's topic. The specific phrasing of the question part of the prompt is tailored to the task and dataset, as shown in Table~\ref{tab: prompt}. The general structure of the prompt is as follows:
\begin{tcolorbox}\textbf{Abstract:} [paper abstract]\\
\textbf{Title:} [paper title]\\
\textbf{Question:} [ask the model to predict one or more class labels of the paper, ordered from most to least likely, and provide explanations for its predictions]\\
\textbf{Answer:}
\end{tcolorbox}

Querying the LLM results in a ranked prediction list and a textual explanation for each paper:
\begin{tcolorbox}(\textbf{Ranked Predictions}) [a ranked prediction list]\\
(\textbf{Explanations}) [model-generated explanation for the predictions]
\end{tcolorbox}
These predictions and explanations serve as supplementary text attributes for the downstream LMs and GNN models, as detailed in the subsequent section.


\subsection{Fine-Tuning LM Interpreter and Node Feature Extraction}

\textbf{Original text and explanation features.} 
Our initial step involves converting both the original text, \ie title and abstract, and the LLM's explanations into fixed-length node features suitable for downstream GNN applications. Our approach is to fine-tune a smaller LM, which acts as an ``interpreter'' for the LLM's text explanations. The rationale behind this step is that both the LLM and LM possess distinct advantages: the LLM has greater power and more knowledge but is less flexible, while the LM has less skills but is compact enough to be fine-tuned to a specific task. Thus, the LM serves to interpret the LLM's output for the GNN, with the text explanation acting as an effective intermediate medium for communication. Then, fine-tuning the LM enables it to extract the most valuable and task-relevant features from the explanations. 


Concretely, we first fine-tune pre-trained LMs as follows: let $\textrm{LM}_{\textrm{orig}}$ and $\textrm{LM}_{\textrm{expl}}$ be pre-trained LMs that take as input the original $s^{\textrm{orig}}$ and the explanation $s^{\textrm{expl}}$ text sequences, respectively. We obtain text embeddings for each source as follows:
\begin{equation}
    \begin{split}
        h_{\textrm{orig}} = \textrm{LM}_{\textrm{orig}}(s^{\textrm{orig}})\in \mathbb{R}^{N\times d}, \quad 
        h_{\textrm{expl}} = \textrm{LM}_\textrm{expl}(s^{\textrm{expl}})\in \mathbb{R}^{N\times d}.
    \end{split}
\end{equation}
We further apply a Multi-Layer Perceptron (MLP) to the output of the LMs to obtain a $N \times C$-dimensional prediction matrix representing the LM's predictions for each node (in logits):
\begin{equation}
    \begin{split}
        y_{\textrm{orig}}= \textrm{MLP}_{\textrm{orig}}(h_{\textrm{orig}}) \in \mathbb{R}^{N\times C}, \quad 
        y_{\textrm{expl}}= \textrm{MLP}_\textrm{expl}(h_{\textrm{expl}}) \in \mathbb{R}^{N\times C}.
    \end{split}
\end{equation}
We fine-tune these LMs and MLPs using cross-entropy loss. Finally, the text embeddings from both sources, $h_{\textrm{orig}}$ and $h_{\textrm{expl}}$, are used as enriched features for training downstream GNNs.

\textbf{Ranked prediction features.}
In addition to the explanations, the LLM also provides a top-$k$ ranked prediction list for each node, which adds valuable information. To incorporate this knowledge, the top-$k$ predictions for node $i$ are first one-hot encoded as vectors $p_{i,1}, \dots, p_{i,k} \in \mathbb{R}^{C}$. These vectors are subsequently concatenated into a $kC$-dimensional vector, followed by a linear transformation to produce a fixed-sized vector of length $d_P$. This process produces a prediction feature matrix as $h_{\textrm{pred}} \in \mathbb{R}^{N\times d_P}$ across all nodes.


In summary, we denote our features as $h_\textrm{TAPE} = \{h_\textrm{orig}, h_\textrm{expl}, h_\textrm{pred}\}$, where ``TAPE'' stands for \underline{T}itle, \underline{A}bstract, \underline{P}rediction and \underline{E}xplanation for each node. Importantly, our framework requires these features to remain frozen during downstream GNN training, ensuring that the LM and LLM do not participate in the GNN training process. This characteristic significantly enhances ease-of-use, modularity, and efficiency compared to approaches like GLEM, which involve an expensive iterative LM-GNN training process. As a result, we achieve a substantial speedup over GLEM, \eg a $2.88\times$ speedup on \texttt{ogbn-arxiv} even when utilizing the same backbone LM and GNN.

\subsection{GNN Training on Enriched Features}

Our final step is to train a GNN using the $h_\textrm{TAPE}$ features. We aim to achieve this without increasing the memory requirements of the GNN or making any changes to its architecture. To accomplish this, we use an ensemble approach, as a simple and effective way of combining the features. Specifically, we independently train GNN models $f_{\textrm{orig}}$, $f_{\textrm{expl}}$, and $f_{\textrm{pred}}$ on the features $h_{\textrm{orig}}$, $h_{\textrm{expl}}$, and $h_{\textrm{pred}}$, respectively, to predict the ground truth node labels:
\begin{equation}
\begin{split}
\hat y_{\textrm{orig}/\textrm{expl}/\textrm{pred}} = f_{\textrm{orig}/\textrm{expl}/\textrm{pred}}(h_{\textrm{orig}/\textrm{expl}/\textrm{pred}}, A) \in \mathbb{R}^{N\times C}.
\end{split}
\end{equation}
We then fuse these predictions by taking their average:
\begin{equation}
\hat y = \textrm{mean}(\hat y_{\textrm{orig}}, \hat y_{\textrm{expl}}, \hat y_{\textrm{pred}}) \in \mathbb{R}^{N\times C}.
\end{equation}

Each of the three models performs well individually as shown in Table~\ref{tab: ablation}, which validates the effectiveness of simple averaging. This strategy enables us to capture complementary information from diverse input sources, ultimately enhancing the overall model's performance.

\subsection{Theoretical Analysis}\label{subsec: theorm}
In this section, we aim to demonstrate that explanations generated by an LLM can be valuable features for a smaller LM. Specifically, the explanations $E$ are helpful if they possess \emph{fidelity} in describing the LLM's reasoning; and the LLM is \emph{non-redundant}, utilizing information not used by the smaller LM. Let $E$ be the textual explanations generated by an LLM; $Z_L$ and $Z$ are embeddings from the LLM and smaller LM respectively, $y$ is the target and $H(\cdot |\cdot)$ is the conditional entropy. The detailed proof is in Appendix~\ref{theory}. 

\textbf{Theorem. }Given the following conditions 1) \emph{Fidelity}: $E$ is a good proxy for $Z_L$ such that $H(Z_l | E)=\epsilon$, with $\epsilon>0$,  2) \emph{Non-redundancy}: $Z_L$ contains information not present in $Z$, expressed as $H(y| Z, Z_L) = H(y|Z) - \epsilon'$, with $\epsilon'>\epsilon$. Then it follows that $H(y | Z, E) < H(y | Z)$.

\section{Experiments}

We evaluate the proposed TAPE technique across five TAG datasets: \texttt{Cora}~\citep{mccallum2000automating_cora}, \texttt{PubMed}~\citep{sen2008collective_pubmed}, \texttt{ogbn-arxiv}, \texttt{ogbn-products}~\citep{hu2020open}, and \texttt{tape-arxiv23}. 
For \texttt{Cora} and \texttt{PubMed}, raw text data of the articles is unavailable in common graph libraries such as PyG and DGL. Hence, we  collected and formatted the missing text data for these datasets in TAG format. Additionally, given the popularity of these datasets, their TAG version will be released publicly for reproducibility and new research projects.  For \texttt{ogbn-products}, given its substantial scale of 2 million nodes and 61 million edges and considering our academic resource budget, we conducted experiments on a subgraph sample. Details can be found in Appendix~\ref{app sec: dataset}.

\subsection{Main Results}

\begin{table}[!ht]
\caption{Node classification accuracy for the \texttt{Cora}, \texttt{PubMed}, \texttt{ogbn-arxiv}, \texttt{ogbn-products} and \texttt{tape-arxiv23} datasets. $G\uparrow$ denotes the improvements of our approach over the same GNN trained on shallow features $h_\textrm{shallow}$; $L\uparrow$ denotes the improvements of our approach over LM$_\textrm{finetune}$. The results are averaged over four runs with different seeds, and the best results are \textbf{in bold}.}
\tiny
    \label{tab: performance}
    \centering
\begin{tabular}{llccccccc}
\toprule
    \multirow{2}{*}{Dataset}     
    & \multirow{2}{*}{Method}
    & \multicolumn{3}{c}{GNN} 
    & \multicolumn{3}{c}{LM}
    & \multicolumn{1}{c}{Ours}\\
    \cmidrule(lr){3-5}\cmidrule(lr){6-8}\cmidrule(lr){9-9}
    &  
    &$h_{\textrm{shallow}}$
    & $h_{\textrm{GIANT}}$
    & $G\uparrow$
    & LLM 
    & LM$_{\textrm{finetune}}$ 
    & $L\uparrow$ 
    & $h_{\textrm{TAPE}}$ 
    \\
    \midrule
         \multirow{3}{*}{\texttt{Cora}} 
         & {MLP}
         & {0.6388 ± 0.0213}
         & {--}
         & 26.58\%
         & {0.6769}
         & {0.7606 ± 0.0378}
         & 6.31\%
         & 0.8086 ± 0.0190
         \\
         & GCN 
         & 0.8653 ± 0.0139
         & --
         & 1.39\%
         & 0.6769
         & 0.7606 ± 0.0378
         & 15.34\%
         & 0.8773 ± 0.0063
         \\
         & SAGE
         & 0.8727 ± 0.0172
         & --
         & 0.74\%
         & 0.6769
         & 0.7606 ± 0.0378
         & 15.59\%
         & 0.8792 ± 0.0107\\
         & RevGAT
         & 0.8736 ± 0.0208
         & --
         & 2.22\%
         & 0.6769
         & 0.7606 ± 0.0378
         & 17.41\%
         & \textbf{0.8930 ± 0.0072}
         
         \\
         \midrule
    \multirow{3}{*}{\texttt{PubMed}} 
    & {MLP}
         & 0.8635 ± 0.0032
         & {--}
         & 9.70\%
         & {0.9342}
         & {0.9494 ± 0.0046}
         & -0.22\%
         & 0.9473 ± 0.0040
         \\
         & GCN 
         & 0.8533 ± 0.0101
         & --
         & 10.07\%
         & 0.9342
         & 0.9494 ± 0.0046
         & -1.07\%
         & 0.9392 ± 0.0023
         \\
         & SAGE
         & 0.8688 ± 0.0086
         & --
         & 9.69\%
         & 0.9342
         & 0.9494 ± 0.0046
         & 0.38\%
         & \textbf{0.9530 ± 0.0035}
         \\
         & RevGAT
         & 0.8465 ± 0.0808
         & --
         & 12.53\%
         & 0.9342
         & 0.9494 ± 0.0046
         & 0.34\%
         & 0.9526 ± 0.0032
         \\
         \midrule
    \multirow{3}{*}{\texttt{ogbn-arxiv}}
    & {MLP}
         & {0.5336 ± 0.0038}
         & {0.7308 ± 0.0006}
         & {42.19\%}
         & {0.7350}
         & {0.7361 ± 0.0004}
         & {3.07\%}
         & {0.7587 ± 0.0015}
         \\
         & GCN 
         & 0.7182 ± 0.0027
         & 0.7329 ± 0.0010
         & 4.71\%
         & 0.7350
         & 0.7361 ± 0.0004
         & 2.16\%
         & 0.7520 ± 0.0003
         \\
         & SAGE
         & 0.7171 ± 0.0017
         & 0.7435 ± 0.0014
         & 6.98\%
         & 0.7350
         & 0.7361 ± 0.0004
         & 4.22\%
         & 0.7672 ± 0.0007
         \\
         & RevGAT
         & 0.7083 ± 0.0017
         & 0.7590 ± 0.0019
         & 9.42\%
         & 0.7350
         & 0.7361 ± 0.0004
         & 5.28\%
         & \textbf{0.7750 ± 0.0012}
         \\
         \midrule
         \multirow{4}{*}{\texttt{ogbn-products}}
         &MLP 
         & 0.5385 ± 0.0017
         & --
         & 46.3\%
         & {0.7440}
         & {0.7297 ± 0.0023}
         & 7.96\%
         & 0.7878 ± 0.0082
         \\
          & {GCN}
    & 0.7052 ± 0.0051
    & {--}
    & 13.39\%
    & {0.7440}
    & {0.7297 ± 0.0023}
    & 9.58\% 
    & 0.7996 ± 0.0041
    \\
     & {SAGE}
    & 0.6913 ± 0.0026
    & {--}
    & 17.71\%
    & {0.7440}
    & {0.7297 ± 0.0023}
    & 11.51\% 
    & 0.8137 ± 0.0043
    \\
     & RevGAT
    & 0.6964 ± 0.0017
    & --
    & 18.24\%
    & 0.7440
    & 0.7297 ± 0.0023
    & 12.84\% 
    & \textbf{0.8234 ± 0.0036}
    \\
    \midrule
    \multirow{4}{*}{\texttt{tape-arxiv23}} 
    & MLP 
    & 0.6209 ± 0.0031
    & -- 
    & 28.83\%
    & 0.7356
    & 0.7358 ± 0.0006
    & 8.71\%
    & 0.7999 ± 0.0037
    \\
    & GCN 
    & 0.6521 ± 0.0099
    & -- 
    & 20.03\%
    & 0.7356 
    & 0.7358 ± 0.0006
    & 6.37\%
    & 0.7827 ± 0.0037
    \\
    & SAGE 
    & 0.6571 ± 0.0042
    & -- 
    & 22.05\%
    & 0.7356 
    & 0.7358 ± 0.0006
    & 9.00\%
    & 0.8020 ± 0.0024
    \\
    & RevGAT 
    & 0.6958 ± 0.0032
    & -- 
    & 16.04\%
    & 0.7356
    & 0.7358 ± 0.0006
    & 9.73\%
    & \textbf{0.8074 ± 0.0021}
    \\
    \bottomrule    
    \end{tabular}
    
\end{table}
We conduct a comprehensive evaluation of our proposed TAPE method by comparing with existing GNN- and LM-based methods, with the results summarized in Table~\ref{tab: performance}. For GNN comparisons, we consider three widely utilized architectures:  GCN~\citep{kipf2016semi_gcn}, GraphSAGE~\citep{sun2021scalable_sagn}, and RevGAT~\citep{li2021training_revgat} along with a basic MLP baseline that operates independently off graph-related information. We explore three types of node features: 1) shallow features (detailed in Table~\ref{tab: text preprocess}), denoted as $h_\textrm{shallow}$, 2) GIANT features~\citep{chien2021node_giant} $h_\textrm{GIANT}$, and 3) our proposed features $h_\textrm{TAPE}$, comprising $h_\textrm{orig}$, $h_\textrm{expl}$, and $h_\textrm{pred}$. For LM-based methods, we investigate two approaches: 1) fine-tuning DeBERTa on labeled nodes, denoted as $\textrm{LM}_\textrm{finetune}$, and 2) using zero-shot ChatGPT (gpt-3.5-turbo) with the same prompts as our approach, denoted as $\textrm{LLM}$. 

Our approach consistently outperforms other methods on all datasets and across all  models, demonstrating its effectiveness in enhancing TAG representation learning. Among GNN-based methods, shallow features (\ie $h_\textrm{shallow}$) yields subpar performance, while LM-based features (\ie $h_\textrm{GIANT}$) improves results. In the case of LMs, fine-tuned LMs (\ie $\textrm{LM}_\textrm{finetune}$) also perform well. Our proposed novel features, leveraging the power of the LLM, further enhance the results.  


Additionally, we expanded our experimentation to include the open-source Llama2~\citep{touvron2023llama}, demonstrating the feasibility of a cost-effective (free) alternative, as shown in Table~\ref{rebuttal tab: llama2}. Furthermore, to address the potential label leakage concern in LLM, we took the initiative to construct a novel dataset, namely \texttt{tape-arxiv23}, comprising papers published in 2023 or later -- well beyond the knowledge cutoff for GPT-3.5. The results clearly illustrate strong generalization capabilities: while the LLM achieves 73.56\% accuracy, our approach outperforms it with 84.23\%. 

\subsection{Scalability}

Our proposed method surpasses not only pure LMs and shallow embedding pipelines but also the LM-based pipelines on the \texttt{ogbn-arxiv} dataset, achieving a superior balance between accuracy and training time, as illustrated in Figure~\ref{fig: comparison}. Specifically, our method achieved significantly higher accuracy than the SOTA GLEM~\citep{zhao2022learning_em} method while utilizing the same LM and GNN models. Furthermore, our approach requires only $2.88\times$ less computation time. These efficiency improvements are attributed to our decoupled training approach for LMs and GNNs, avoiding the iterative (\ie multi-stage) approach used in GLEM. Moreover, unlike the iterative approach, our model allows for parallelizing the training of LM$_\textrm{orig}$ and LM$_\textrm{expl}$, further reducing overall training time when performed simultaneously. 

\begin{table}[t]
\caption{Experiments on \texttt{ogbn-arxiv} dataset with DeBERTa-base~\citep{he2021deberta} as LM backbone and RevGAT~\citep{li2021training_revgat} as GNN backbone for comparison of different training paradigms of fusing LMs and GNNs, including our proposed method and the state-of-the-art GLEM method~\citep{zhao2022learning_em}.  The validation and test accuracy, number of parameters, maximum batch size (Max bsz.), and total training time on 4 NVIDIA RTX A5000 24GB GPUs are reported. 
}
\label{tab: comparison}
\small
    \centering
    \begin{tabular}{lccccc}
    \toprule
    Method
    &  Val acc. &  Test acc. & Params. & Max bsz. & Total time \\
    \midrule
    LM$_{orig}$
    & 0.7503 ± 0.0008
    & 0.7361 ± 0.0004
    & 139,223,080
    & 36
    & 1.73h \\
    \midrule
    GNN-$h_{\textrm{shallow}}$
    & 0.7144 ± 0.0021
    & 0.7083 ± 0.0017
    & 427,728
    & all nodes
    & 1.80min \\
    \midrule
    GLEM-G-Step
    & 0.7761 ± 0.0005
    & 0.7657 ± 0.0029
    & 1,837,136
    & all nodes
    & \multirow{2}{*}{9.18h} \\
    GLEM-L-Step
    & 0.7548 ± 0.0039
    & 0.7495 ± 0.0037
    & 138,632,488
    & 36
    &\\
    \midrule
    TAPE-LM$_{\textrm{orig}}$-Step
    & 0.7503 ± 0.0008
    & 0.7361 ± 0.0004
    & 139,223,080
    & 36
    & 1.73h\\
    TAPE-LM$_{\textrm{expl}}$-Step
    & 0.7506 ± 0.0008
    & 0.7432 ± 0.0012
    & 139,223,080
    & 36
    & 1.40h\\
    TAPE-GNN-${h_\textrm{TAPE}}$-Step
    & {0.7785 ± 0.0016}
    & 0.7750 ± 0.0012
    & 1,837,136
    & all nodes
    & 3.76min
    \\
    \bottomrule
    \end{tabular}
\end{table}



\begin{table}[t]
\small
\caption{Ablation study on the \texttt{ogbn-arxiv} dataset, showing the effects of different node features on the performance. Node features include the original text attributes ($h_{\textrm{orig}}$), the explanations ($h_{\textrm{expl}}$  and predicted $h_{\textrm{pred}}$) generated by LLM, and the proposed method ($h_{\textrm{TAPE}}$). Results are averaged over 4 runs with 4 different seeds. The best results are \textbf{in bold}.}
    \label{tab: ablation}
    \centering
    \begin{tabular}{lccccc}
    \toprule
    \multicolumn{2}{l}{Method}   &  $h_{\textrm{orig}}$ & $h_{\textrm{expl}}$ & $h_{\textrm{pred}}$ & $h_{\textrm{TAPE}}$\\
    \midrule
    \multirow{2}{*}{GCN}
    & val & 0.7624 ± 0.0007 & 0.7577 ± 0.0008 & 0.7531 ± 0.0006 & 0.7642 ± 0.0003\\
    & test & 0.7498 ± 0.0018 & 0.7460 ± 0.0013 & 0.7400 ± 0.0007 & \textbf{0.7520 ± 0.0003}\\
    \midrule
    \multirow{2}{*}{SAGE}
    & val & 0.7594 ± 0.0012 & 0.7631 ± 0.0016 & 0.7612 ± 0.0010 & 0.7768 ± 0.0016\\
    & test & 0.7420 ± 0.0018 & 0.7535 ± 0.0023 & 0.7524 ± 0.0015 & \textbf{0.7672 ± 0.0007}\\
    \midrule
    \multirow{2}{*}{RevGAT}
    & val & 0.7588 ± 0.0021 &  0.7568 ± 0.0027 &  0.7550 ± 0.0015 & 0.7785 ± 0.0016\\
    & test & 0.7504 ± 0.0020 & 0.7529 ± 0.0052 & 0.7519 ± 0.0031 & \textbf{0.7750 ± 0.0012}
    \\ \bottomrule
    \end{tabular}
\end{table}

\subsection{Ablation Study}\label{subsec: ablation study}

We perform an ablation study on the \texttt{ogbn-arxiv} dataset~\citep{hu2020open} to evaluate the relevance of each module within our framework. The results are summarized in Table~\ref{tab: ablation} and Figure~\ref{fig: ablation2}. Across all methods and for both the validation and test sets, our proposed method consistently outperforms the other settings. This underscores the value of incorporating explanations and predictions into node embeddings. Our case study (Figure~\ref{fig: casestudy}) suggests this improvement can be attributed to the concise and focused nature of LLM-generated explanations, as well as their reasoning ability and utilization of external knowledge.

\section{Conclusion}
Given the increasing importance of integrating text and relationships, coupled with the emergence of LLMs, we foresee that TAG tasks will attract even more attention in the coming years. The convergence of LLMs and GNNs presents new opportunities for both research and industrial applications. As a pioneering work in this field, we believe that our contribution will serve as a strong baseline for future studies in this domain.


\textbf{Limitation and future work.}
An inherent limitation of our approach lies in the requirement for customized prompts for each dataset. Currently, we rely on manually crafted prompts, which may not be optimal for the node classification task for every dataset. The efficacy of these prompts may fluctuate depending on the specific characteristics of the dataset and the specific task at hand.
Future work can focus on automating the prompt generation process, exploring alternative prompt designs, and addressing the challenges of dynamic and evolving TAGs.


\section*{Acknowledgment}
Xavier Bresson is supported by NUS Grant ID R-252-000-B97-133.

\printbibliography

\newpage
\appendix
\section{Theoretical Analysis}\label{theory}

In this section, we aim to demonstrate that explanations generated by an LLM can provide valuable features for another model (such as a smaller LM). This is true under two key conditions:
\begin{enumerate}
\item \emph{Fidelity:} The explanations effectively represent LLM's reasoning over the raw text, containing most of the information from the LLM's hidden state.
\item \emph{Non-redundancy:} The LLM possesses unique knowledge not captured by another model.
\end{enumerate}


We formulate our theorem as follows:
\begin{theorem}
Given the following conditions: 

1) Fidelity: $E$ is a good proxy for $Z_L$ such that
\begin{equation}
    H(Z_l | E)=\epsilon, {\quad \epsilon>0}
\end{equation}

2) Non-redundancy: $Z_L$ contains information not present in $Z$, expressed as
\begin{equation}
    H(y| Z, Z_L) = H(y|Z) - \epsilon', \quad \epsilon'>\epsilon
\end{equation}


Then, it follows that:
\begin{equation}
H(y | Z, E) < H(y | Z)
\end{equation}

where $E$ is textual explanations generated by an LLM, $Z_L$ is the vectorial representation of the raw text modeled by the LLM, $Z$ is the vectorial representation of the raw text modeled by the other model, $y$ is the target and $H(\cdot |\cdot)$ is the conditional entropy.
\end{theorem}

\begin{proof}

We aim to demonstrate that the conditional entropy of $y$ given both $Z$ and $E$, denoted as $H(y | Z, E)$, is less than the conditional entropy of $y$ given only $Z$, denoted as $H(y | Z)$. 

Starting with:
\begin{equation}
H(y | Z, E)
\end{equation}

We apply the properties of entropy to decompose this expression into two components:

\begin{equation}
H(y | Z, E) = H(y | Z, Z_L, E) + I(y; Z_L | Z, E) \label{eq:decomp}
\end{equation}



Now, we utilize the following upper bound of conditional mutual information:
\begin{align}
I(y; Z_L | Z, E) &= H(Z_L | Z, E) - H(Z_L | y, Z, E) \\
& \leq H(Z_L | Z, E) \label{eq:bound}
\end{align}
where the first line follows from the definition of mutual information, and the second line follows from the nonnegativity of conditional entropy.

Substituting \eqref{eq:bound} into \eqref{eq:decomp}, we rewrite the conditional entropy as:
\begin{equation}
H(y | Z, E) \leq H(y | Z, Z_L, E) + H(Z_L | Z, E)
\end{equation}

Since conditional entropy increases when conditioning on fewer variables, we further have:

\begin{equation}
H(y | Z, Z_L, E) + H(Z_L | Z, E) \leq H(y | Z, Z_L) + H(Z_L | E)
\end{equation}

Applying the "Fidelity" and "Non-redundancy" conditions:

\begin{equation}
H(y | Z, Z_L) + H(Z_L | E) \leq H(y | Z) - \epsilon' + \epsilon
\end{equation}

Finally, as $\epsilon' > \epsilon$, we have:

\begin{equation}
H(y | Z) - \epsilon' + \epsilon < H(y | Z)
\end{equation}

Consequently, we have proven that:

\begin{equation}
H(y | Z, E) < H(y | Z)
\end{equation}

This completes the proof.
\end{proof}

\section{Addressing Label Leakage Concerns with a New Dataset}\label{app: arxiv2023}

GPT-3.5's training data might include certain arXiv papers, given its comprehensive ingestion of textual content from the internet. However, the precise composition of these arXiv papers within GPT-3.5's training remains undisclosed, rendering it infeasible to definitively identify their inclusion. It is essential to emphasize that the challenge of label leakage is widespread and affects various language model benchmarks, such as the prominent BIG-bench~\citep{srivastava2022beyond_bigbench} and TruthfulQA~\citep{lin2021truthfulqa}.

To address this concern, we created a novel dataset \texttt{tape-arxiv23} for our experiments. We made sure that this dataset only included papers published in 2023 or later, which is well beyond the knowledge cutoff for GPT-3.5, as it was launched in November 2022. The creation of this new dataset was meticulously executed. We collected all cs.ArXiv papers published from January 2023 to September 2023 from the arXiv daily repository~\footnote{\url{https://arxiv.org/}}. We then utilized the Semantic Scholar API~\footnote{\url{https://www.semanticscholar.org/product/api}} to retrieve citation relationships. This process yielded a comprehensive graph containing 46,198 papers and 78,548 connections.



\section{Dataset}\label{app sec: dataset}
We conduct experiments on five TAGs -- \texttt{Cora}~\citep{mccallum2000automating_cora}, \texttt{PubMed}~\citep{sen2008collective_pubmed}, \texttt{ogbn-arxiv}, \texttt{ogbn-products}~\citep{hu2020open}, and \texttt{tape-arxiv23}.  
For \texttt{Cora} and \texttt{PubMed}, we collected the raw text data since they are not available in common repositories like PyG and DGL. For \texttt{ogbn-products}, given its substantial scale of 2 million nodes and 61 million edges, we have employed a node sampling strategy to obtain a subgraph containing 54k nodes and 74k edges. Additionally, we introduced the \texttt{tape-arxiv23} citation graph dataset, extending beyond the knowledge cutoff of GPT-3. This dataset serves as a valuable resource for the research community. Table~\ref{tab: dataset} provides a summary of the dataset statistics.

\begin{table}[!ht]
    \centering
    \small
    \caption{Statistics of the TAG datasets}
    \label{tab: dataset}
    \begin{tabular}{lccccc}
    \toprule
         Dataset &  \#Nodes &\#Edges & Task  & Metric & Augmentation \\
         \midrule
         \texttt{Cora}& 2,708 &5,429 & 7-class classif. & Accuracy & \cmark \\
\texttt{Pubmed}& 19,717 & 44,338 & 3-class classif.& Accuracy & \cmark
         \\
         
         \texttt{ogbn-arxiv} & 169,343 & 1,166,243 & 40-class classif.& Accuracy & 
         \\
         \texttt{ogbn-products} (subset) & 54,025 &74,420 & 47-class classif. & Accuracy & \\
         \texttt{tape-arxiv23}
         & {46,198}
         & {78,548}
         &{40-class-classif.}
         & {Accuracy}
         & \cmark\\
         \bottomrule
    \end{tabular}
\end{table}


\subsection{Dataset Description}
\textbf{Cora~\citep{mccallum2000automating_cora}.}
The \texttt{Cora} dataset comprises 2,708 scientific publications classified into one of seven classes -- 
case based, genetic algorithms, neural networks, probabilistic methods, reinforcement learning, rule learning, and theory, with a citation network consisting of 5,429 links. The papers were selected in a way such that in the final corpus every paper cites or is cited by at least one other paper. 


\textbf{PubMed~\citep{sen2008collective_pubmed}.}
The Pubmed dataset consists of 19,717 scientific publications from PubMed database pertaining to diabetes classified into one of three classes -- Experimental induced diabetes, Type 1 diabetes, 
 and Type 2 diabetes. The citation network consists of 44,338 links. 

\textbf{ogbn-arxiv~\citep{hu2020open}.}
The \texttt{ogbn-arxiv} dataset is a directed graph that represents the citation network between all computer science arXiv papers indexed by MAG~\citep{wang2020microsoft_mag}. Each node is an arXiv paper, and each directed edge indicates that one paper cites another one. The task is to predict the 40 subject areas of arXiv CS papers, \eg, cs.AI, cs.LG, and cs.OS, which are manually determined (\ie labeled) by the paper’s authors and arXiv moderators. 

\textbf{ogbn-products~\citep{hu2020open}.}
The \texttt{ogbn-products} dataset represents an Amazon product co-purchasing network, with product descriptions as raw text. Nodes represent products sold in Amazon, and edges between two products indicate that the products are purchased together. The task is to predict the category of a product in a multi-class classification setup, where the 47 top-level categories are used for target labels.

\textbf{tape-arxiv23}. 
The \texttt{tape-arxiv23} dataset is a directed graph that represents the citation network between all computer science arXiv papers published in 2023 or later. Similar to \texttt{ogbn-arxiv}, each node is an arXiv paper, and each directed edge indicates that one paper cites another one. The task is to predict the 40 subject areas of arXiv CS papers, \eg, cs.AI, cs.LG, and cs.OS, which are manually determined (\ie labeled) by the paper’s authors and arXiv moderators. 




\subsection{Dataset splits and random seeds}
In our experiments, we adhered to specific dataset splits and employed random seeds for reproducibility.
For the \texttt{ogbn-arxiv} and \texttt{ogbn-products} dataset, we adopted the standard train/validation/test split provided by OGB~\citep{hu2020open}.
As for the \texttt{Cora}, \texttt{PubMed} datasets, and \texttt{tape-arxiv23}, we performed the train/validation/test splits ourselves, where 60\% of the data was allocated for training, 20\% for validation, and 20\% for testing. Additionally, we utilized random seeds to ensure the reproducibility of our experiments, enabling the consistent evaluation of our proposed method on the respective datasets, which can be found in our linked code repository.


\subsection{Shallow Embedding Methods for Node Feature Extraction}

Table~\ref{tab: text preprocess} provides an overview of the text preprocessing and feature extraction methods commonly used in graph libraries such as PyG and DGL, which are widely adopted in GNN research.

\begin{table}[!ht]
\caption{Details of text preprocessing and feature extraction methods used for TAG datasets.}
\small
    \label{tab: text preprocess}
    \centering
    \begin{tabularx}{\textwidth}{lllX}
    \toprule
         Dataset  &Methods & Features & Description \\
         \midrule
         \texttt{Cora}
         & BoW
         & 1,433
         & After stemming and removing stopwords there is a vocabulary of size 1,433 unique words. All words with document frequency less than 10 were removed.\\
\midrule
         \texttt{PubMed} 
         & TF-IDF
         & 500
         & Each publication in the dataset is described by a TF/IDF weighted word vector from a dictionary which consists of 500 unique words. \\
         \midrule
         \texttt{ogbn-arxiv}
         & skip-gram
         & 128
         & The embeddings of individual words are computed by running the skip-gram model~\citep{mikolov2013distributed_skipgram} over the MAG~\citep{wang2020microsoft_mag} corpus.\\
         \midrule
         \texttt{ogbn-products} 
         & BoW
         & 100
         & Node features are generated by extracting BoW features from the product descriptions followed by a Principal Component Analysis to reduce the dimension to 100.
         \\
         \midrule
         \texttt{tape-arxiv23}
         & word2vec
         & 300
         & The embeddings of individual words are computed by running the word2vec model.
         \\
         \bottomrule
    \end{tabularx}
\end{table}

These text preprocessing and feature extraction methods facilitate the extraction of node features from the text attributes of TAG datasets, enabling the utilization of GNN models for node classification tasks. While these methods are easy to apply and computationally efficient, it is important to note that they rely on traditional language modeling techniques that may not capture the full semantic meaning in the text. This limitation can impact the expressiveness of the extracted node features and potentially affect the development of techniques for downstream tasks.


\section{Experiments}\label{app sec: experiment}

\subsection{Computing Environment and Resources}
The implementation of the proposed method utilized the PyG and DGL modules, which are licensed under the MIT License. The experiments were conducted in a computing environment with the following specifications: LM-based experiments were performed on four NVIDIA RTX A5000 GPUs, each with 24GB VRAM. On the other hand, the GNN-based experiments were conducted on a single GPU.

\subsection{Hyperparameters}

Table~\ref{tab: hyperparam} provides an overview of the hyperparameters used for the GCN~\citep{kipf2016semi_gcn}, SAGE~\citep{hamilton2017inductive_sage}, and RevGAT~\citep{li2021training_revgat} models. These hyperparameters were selected based on the official OGB repository~\footnote{\url{https://github.com/snap-stanford/ogb}}, and the RevGAT and language model hyperparameters follow those used in the GLEM repository~\footnote{\url{https://github.com/AndyJZhao/GLEM}}. It is important to note that these hyperparameters were not tuned on a per-dataset basis, but instead were used consistently across all three TAG datasets based on those from prior work, and also set consistently across both our proposed method and the baselines. This demonstrates the generality and ease of use of our method, as well as its compatibility with existing GNN baselines.

\begin{table}[!ht]
    \centering
    \small
    \caption{Hyperparameters for the GCN, SAGE, and RevGAT models.}
    \label{tab: hyperparam}
\begin{tabular}{m{4cm}m{2cm}m{2cm}m{2cm}}
    \toprule
Hyperparameters & GCN& SAGE&RevGAT\\
\midrule
\# layers & 3 & 3 & 3\\
hidden dim & 256 & 256 & 256 \\
learning rate & 0.01 & 0.01 & 0.002\\
dropout & 0.5 & 0.5 & 0.75\\
epoch & 1000 & 1000 & 1000\\
warmup epochs & 0 & 0 & 50\\
early stop & 50 & 50 & 50\\
\bottomrule
\end{tabular}
\end{table}

\subsection{Prompt Design}


Table~\ref{tab: prompt} provides our prompt designs for different datasets. Each prompt includes the abstract and title of the paper, followed by a task-specific question. The question is formulated to query the model about a particular aspect of the paper and request an explanation for the prediction. The answer section is left blank for the model to fill in. Generally, our analysis finds that the current instructions allow the LLM to produce output that conforms well to the expected format without significant deviations, allowing the answers to be straightforwardly extracted from the text output of the LLM. 

\begin{table}[!ht]
\small
    \centering
\caption{Design of Prompts}
    \label{tab: prompt}
    \begin{tabularx}{\textwidth}{lX}
    \toprule
         Dataset & Prompt\\
         \midrule
         \texttt{Cora}
         &Abstract: \promptfield{abstract text} \newl Title: \promptfield{title text} \newl Question: Which of the following sub-categories of AI does this paper belong to: Case Based, Genetic Algorithms, Neural Networks, Probabilistic Methods, Reinforcement Learning, Rule Learning, Theory? If multiple options apply, provide a comma-separated list ordered from most to least related, then for each choice you gave, explain how it is present in the text. \newl \newl Answer: \\
         \midrule
         \texttt{Pubmed}
         &Abstract: \promptfield{abstract text} \newl Title: \promptfield{title text} \newl Question: Does the paper involve any cases of Type 1 diabetes, Type 2 diabetes, or Experimentally induced diabetes? Please give one or more answers of either Type 1 diabetes, Type 2 diabetes, or Experimentally induced diabetes; if multiple options apply, provide a comma-separated list ordered from most to least related, then for each choice you gave, give a detailed explanation with quotes from the text explaining why it is related to the chosen option. \newl \newl Answer:\\
         \midrule
         \texttt{ogbn-arxiv}
         &{Abstract: \promptfield{abstract text} \newl Title: \promptfield{title text} \newl Question: Which arXiv CS sub-category does this paper belong to? Give 5 likely arXiv CS sub-categories as a comma-separated list ordered from most to least likely, in the form ``cs.XX'', and provide your reasoning. \newl \newl Answer:}\\
         \midrule
         \texttt{ogbn-products}
         & Product description: {\color{blue}<product description>} \newl Question: Which of the following category does this product belong to: 1) Home \& Kitchen, 2) Health \& Personal Care, 3) Beauty, 4) Sports \& Outdoors, 5) Books, 6) Patio, Lawn \& Garden, 7) Toys \& Games, 8) CDs \& Vinyl, 9) Cell Phones \& Accessories, 10) Grocery \& Gourmet Food, 11) Arts, Crafts \& Sewing, 12) Clothing, Shoes \& Jewelry, 13) Electronics, 14) Movies \& TV, 15) Software, 16) Video Games, 17) Automotive, 18) Pet Supplies, 19) Office Products, 20) Industrial \& Scientific, 21) Musical Instruments, 22) Tools \& Home Improvement, 23) Magazine Subscriptions, 24) Baby Products, 25) NAN, 26) Appliances, 27) Kitchen \& Dining, 28) Collectibles \& Fine Art, 29) All Beauty, 30) Luxury Beauty, 31) Amazon Fashion, 32) Computers, 33) All Electronics, 34) Purchase Circles, 35) MP3 Players \& Accessories, 36) Gift Cards, 37) Office \& School Supplies, 38) Home Improvement, 39) Camera \& Photo, 40) GPS \& Navigation, 41) Digital Music, 42) Car Electronics, 43) Baby, 44) Kindle Store, 45) Kindle Apps, 46) Furniture \& Decor? Give 5 likely categories as a comma-separated list ordered from most to least likely, and provide your reasoning. \newl\newl Answer: 
         \\
         \midrule
         \texttt{tape-arxiv23}
         &{Abstract: \promptfield{abstract text} \newl Title: \promptfield{title text} \newl Question: Which arXiv CS sub-category does this paper belong to? Give 5 likely arXiv CS sub-categories as a comma-separated list ordered from most to least likely, in the form ``cs.XX'', and provide your reasoning. \newl \newl Answer:}\\
         \bottomrule
    \end{tabularx}
\end{table}


\paragraph{Additional Prompt Experiments.}

\begin{table}[!ht]
\small
    \centering
\caption{Prompts used for our experiments studying the effect of different prompts. Most prompts have similar performance. }
    \label{tab: prompt experiment}
    \begin{tabularx}{\textwidth}{lXc}
    \toprule
         Description & Prompt & Accuracy\\
         \midrule
         Default prompt & Abstract: \promptfield{abstract text} \newl Title: \promptfield{title text} \newl Question: Which arXiv CS sub-category does this paper belong to? Give 5 likely arXiv CS sub-categories as a comma-separated list ordered from most to least likely, in the form ``cs.XX'', and provide your reasoning. \newl \newl Answer: & 0.720\\  
         \midrule
         Title first & Title: \promptfield{title text} \newl Abstract: \promptfield{abstract text} \newl Question: Which arXiv CS sub-category does this paper belong to? Give 5 likely arXiv CS sub-categories as a comma-separated list ordered from most to least likely, in the form ``cs.XX'', and provide your reasoning. \newl \newl Answer: & 0.695\\  
         \midrule
         Focus on text content & Title: \promptfield{title text} \newl Abstract: \promptfield{abstract text} \newl Question: Which arXiv CS sub-category does this paper belong to? Give 5 likely arXiv CS sub-categories as a comma-separated list ordered from most to least likely, in the form ``cs.XX''. Focus only on content in the actual text and avoid making false associations. Then provide your reasoning.  & 0.695\\  
         \midrule
         Chain of thought prompt & Title: \promptfield{title text} \newl Abstract: \promptfield{abstract text} \newl Question: Which arXiv CS sub-category does this paper belong to? Give 5 likely arXiv CS sub-categories as a comma-separated list ordered from most to least likely, in the form ``cs.XX''. Please think about the categorization in a step by step manner and avoid making false associations. Then provide your reasoning.   & 0.705\\  
         \bottomrule
    \end{tabularx}
\end{table}


To study the effect of different prompts, we consider a variety of prompts and evaluate the zero-shot accuracy of the LLM (ChatGPT) on each prompt. We evaluate all prompts on 200 sample papers from the \texttt{ogbn-arxiv} dataset, see Table~\ref{tab: prompt experiment}. We accompany each prompt by a brief summary of the change being made. In summary, most prompts have similar performance, with a slight performance gain when placing the title after the abstract, which seems to agree with the notion in \cite{zhao2021calibrate} that more important information (like the title) should be placed later in the prompt.




\subsection{Detailed Ablation Study}\label{subsec: ablation2}
We conducted a detailed ablation study on the \texttt{ogbn-arxiv} dataset to assess the impact of different sources of node features. The study focused on three types of node features: original text features ($h_\textrm{orig}$), explanation as features ($h_\textrm{expl}$), and predictions as features ($h_\textrm{pred}$). We systematically removed one of these features at a time while keeping the other components unchanged in our model.

The results of the ablation study are illustrated in Figure~\ref{fig: ablation2}. The figure presents the performance of the model when each type of node feature is removed. It is observed that using the full set of features yields the best performance, while leaving out any of the features leads to a drop in performance. However, the extent of the performance drop may vary depending on the specific GNN model being used.

\begin{figure}[!ht]
    \centering
    \includegraphics[clip, trim=1cm 24cm 2cm 1.5cm, width=0.8\textwidth]{figs/ablation2-v2.pdf} 
    \caption{Effect of node features. We study the effects of different sources of node features on the \texttt{ogbn-arxiv} dataset, \ie original text features ($h_\textrm{orig}$), explanation as features ($h_\textrm{expl}$) and predictions as features ($h_\textrm{pred}$), by removing one of them in turn from our model while keeping the other components unchanged.}
    \label{fig: ablation2}
\end{figure}

This ablation study provides additional insights to complement the findings presented in section~\ref{subsec: ablation study}. While Table~\ref{tab: ablation} compared the performance of using the full set of features versus using just one of them, this ablation study specifically focuses on comparing the performance of using the full set of features versus leaving one of them out. Although the experimental design differs, the overall message conveyed remains consistent, emphasizing the significance of considering all the various sources of node features for achieving optimal performance in node classification tasks.
































\subsection{Llama as a cost-efficient alternative}

We extend out experiment to the open-source LLM "llama-2-13b-chat"  (llama for short), which demonstrates the feasibility of a cost-effective (free) alternative, see Table~\ref{rebuttal tab: llama2}.

It is worth noting that although llama exhibits a lower performance compared to GPT-3.5 in terms of both zero-shot accuracy and explanation quality, our pipeline still maintains its robust performance. As an illustration, we achieved an accuracy of 76.19\% on the \texttt{ogbn-arxiv} dataset using llama, slightly below the 77.50\% achieved with GPT-3.5. We attribute this impressive level of generalization to the complementary nature of the explanations themselves, which serve as a rich source of semantic information supplementing the original text such as title and abstract.

\begin{table}[!ht]
    \caption{Node classification accuracy for the \texttt{Cora}, \texttt{PubMed}, \texttt{ogbn-arxiv} and \texttt{tape-arxiv23} datasets. }
\scriptsize
    \label{rebuttal tab: llama2}
    \centering
\begin{tabular}{llcccccc}
\toprule
    \multirow{2}{*}{Dataset}     
    & \multirow{2}{*}{Method}
    & \multicolumn{3}{c}{{llama2-13b-chat}} 
    & \multicolumn{3}{c}{{GPT3.5}}\\
    \cmidrule(lr){3-5}\cmidrule(lr){6-8}
    &  
    & {LLM} & {LM$_{\textrm{finetune}}$} & {$h_\textrm{TAPE}$}
    & LLM & LM$_{\textrm{finetune}}$ & {$h_\textrm{TAPE}$}
    
    \\
    \midrule
         \multirow{3}{*}{\texttt{Cora}} 
         & MLP
         & {0.5746}
         & {0.6845 ± 0.0194}
         & 0.7675 ± 0.0187
         & 0.6769
         & 0.7606 ± 0.0378
         &0.8086 ± 0.0190
         \\
         & GCN 
         & {0.5746}
         & {0.6845 ± 0.0194}
         & 0.8630 ± 0.0101
         & 0.6769
         & 0.7606 ± 0.0378
         & 0.8773 ± 0.0063
         \\
         & SAGE
         & {0.5746}
         & {0.6845 ± 0.0194}
         & 0.8625 ± 0.0093
         & 0.6769
         & 0.7606 ± 0.0378
         & 0.8792 ± 0.0107
         \\
         & RevGAT
         & {0.5746}
         & {0.6845 ± 0.0194}
         & 0.8884 ± 0.0100
         & 0.6769
         & 0.7606 ± 0.0378
         & 0.8930 ± 0.0072
         \\
         \midrule
    \multirow{3}{*}{\texttt{PubMed}} 
        & MLP
        & {0.3958}
         & {0.9121 ± 0.0026}
         & 0.9475 ± 0.0046
         & 0.9342
         & 0.9494 ± 0.0046
         & 0.9473 ± 0.0040
         \\
         & GCN 
         & {0.3958}
         & {0.9121 ± 0.0026}
         & 0.9257 ± 0.0063
         & 0.9342
         & 0.9494 ± 0.0046
         & 0.9392 ± 0.0023
         \\
         & SAGE
         & {0.3958}
         & {0.9121 ± 0.0026}
         & 0.9464 ± 0.0033
         & 0.9342
         & 0.9494 ± 0.0046
         & 0.9530 ± 0.0035
         \\
         & RevGAT
         & {0.3958}
         & {0.9121 ± 0.0026}
         & 0.9465 ± 0.0042
         & 0.9342
         & 0.9494 ± 0.0046
         & 0.9526 ± 0.0032
         \\
         \midrule
    \multirow{3}{*}{\texttt{ogbn-arxiv}}
    & MLP
         & {0.4423}
         & {0.6941 ± 0.0020}
         & 0.7361 ± 0.0009
         & 0.7350
         & 0.7361 ± 0.0004
         & 0.7587 ± 0.0015
         \\
         & GCN 
         & {0.4423}
         & {0.6941 ± 0.0020}
         & {0.7418 ± 0.0031}
         & 0.7350
         & 0.7361 ± 0.0004
         & 0.7520 ± 0.0003
         \\
         & SAGE
         & {0.4423}
         & {0.6941 ± 0.0020}
         & {0.7536 ± 0.0028}
         & 0.7350
         & 0.7361 ± 0.0004
         & 0.7672 ± 0.0007
         \\
         & RevGAT
         & {0.4423}
         & {0.6941 ± 0.0020}
         & {0.7619 ± 0.0027}
         & 0.7350
         & 0.7361 ± 0.0004
         & {0.7750 ± 0.0012}
         \\
         \midrule
         \multirow{3}{*}{\texttt{tape-arxiv23}}
         & MLP
         & 0.4452
         & 0.7677 ± 0.0042
         & 0.7905 ± 0.0041
         & 0.7356
         & 0.7832 ± 0.0052
         & 0.7999 ± 0.0037
         \\
         & GCN
         & 0.4452
         & 0.7677 ± 0.0042
         & 0.7751 ± 0.0029
         & 0.7356
         & 0.7832 ± 0.0052
         & 0.7827 ± 0.0037
         \\
         & SAGE
         & 0.4452
         & 0.7677 ± 0.0042
         & 0.7935 ± 0.0029
         & 0.7356
         & 0.7832 ± 0.0052
         & 0.8020 ± 0.0024
         \\
         & RevGAT
         & 0.4452
         & 0.7677 ± 0.0042
         & 0.7993 ± 0.0043
         & 0.7356
         & 0.7832 ± 0.0052
         & 0.8074 ± 0.0021
         \\
    \bottomrule
    \end{tabular}
\end{table}


\subsection{Case Study}\label{appendix: case study}
\begin{figure}[!ht]
    \centering
    \includegraphics[scale=0.15]{figs/comparison-v7.pdf}
    \caption{Case study comparing features for node classification on the \texttt{PubMed} dataset: (a) Original text attributes and (b) Explanations generated by LLMs. The GNN model trained with (b) accurately predicts the label for node 12390 (type 2 diabetes), while the model trained with (a) predicts the incorrect label (experimentally induced diabetes). This improvement can be attributed to the concise and focused nature of LLM-generated explanations, as well as their reasoning ability and utilization of external knowledge.}
\label{fig: casestudy}
\end{figure}
To investigate the impact of using explanations as features in improving node classification on TAGs, we conduct an analysis on predicted samples from the \texttt{PubMed} dataset. Figure~\ref{fig: casestudy} presents a case where the GNN model trained with original text attributes as features incorrectly predicts the label for node 12390 (as experimentally induced diabetes), while the model trained with explanations generated by LLMs as features correctly predicts the label (as type 2 diabetes).



This improvement can be attributed to two main factors. Firstly, compared to the original text attributes, which consist of the title and abstract text, the explanations generated by the LLM are more concise and focused. This aids the subsequent LM in generating node embeddings that capture the essential semantics without the need to compress an excessive amount of information into a fixed-length representation. Secondly, LLMs possess reasoning capabilities and the ability to leverage general knowledge, which prove crucial in achieving accurate predictions. For instance, the explanations generated by LLMs explicitly link type 2 diabetes to MKR mice and db/db mice (which are common animal models of type 2 diabetes), as well as the insulinopenic mice / streptozotocin to experimentally induced diabetes. This knowledge is either absent or only implicitly specified in the original text attributes.


\subsection{GLEM}
\citet{zhao2022learning_em} evaluated GLEM on the \texttt{ogbn-arxiv} dataset. We extended our evaluation of GLEM with the \texttt{Cora} and \texttt{PubMed} datasets for a more comprehensive comparison with our method. Results are reported in Table~\ref{rebuttal tab: glem}
\begin{table}[!ht]
      \centering
        \caption{GLEM~\citep{zhao2022learning_em}}
    \label{rebuttal tab: glem}
    \centering
    \small
    \begin{tabular}{lccc}
    \toprule
         Dataset &  GCN & SAGE & RevGAT\\
         \midrule
        {\texttt{Cora}} 
        & {0.8732 ± 0.0066} 
        & {0.8801 ± 0.0054} 
        & {0.8856 ± 0.0060}\\
        {\texttt{PubMed}} & 
        {0.9469 ± 0.0010}
        & {0.9459 ± 0.0018}
        & {0.9471 ± 0.0020}\\
        \texttt{ogbn-arxiv} & 0.7593 ± 0.0019 & 0.7550 ± 0.0024 & 0.7697 ± 0.0019\\
        \bottomrule
    \end{tabular}
\end{table}



\end{document}