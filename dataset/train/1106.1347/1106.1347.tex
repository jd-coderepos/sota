\documentclass{amsart}
\usepackage{a4wide,times}

\usepackage{listings}
\lstset{language=C,frame=lines,basicstyle=\small\ttfamily,keywordstyle=\bfseries,emph={malloc,free},emphstyle=\bfseries}

\newcommand{\CODE}[2]{\lstinputlisting[firstline=#2]{#1}}
\newcommand{\CODElast}[3]{\lstinputlisting[firstline=#2,lastline=#3]{#1}}

\setcounter{tocdepth}{5}

\begin{document}

\title[Methods of Matrix Multiplication]{Methods of Matrix Multiplication\
(A+B)_{ij} = A_{ij} + B_{ij}

(A-B)_{ij}= A_{ij} - B_{ij}.

\max(x,y) = \begin{cases}
x & x \geq y\\
y & \text{otherwise}
\end{cases}

\|A\|_\infty = \max_{i=1,\ldots,N}\left\{\sum_{j=1}^P |A_{ij}|\right\}

(\alpha A)_{ij} = \alpha A_{ij}.
(AB)_{ij}=\sum_{k=1}^P A_{ik}B_{k j}.\sum_{i=1}^n x_i
(AB)_{ij}=\sum_{k=1}^P A_{ik}B_{kj},

(AB)_{ij} &=\sum_{k=1}^{P/2} A_{i,2k-1}B_{2k-1,j} + A_{i,2k}B_{2k,j}, \qquad \text{or}\\
(AB)_{ij} & =\left(\sum_{k=1}^{\lfloor P/2 \rfloor} A_{i,2k-1}B_{2k-1,j} + A_{i,2k}B_{2k,j}\right)
+ A_{i,P}B_{P,j},

(AB)_{ij} =\sum_{k=1}^{P/3} A_{i,3k-2}B_{3k-2,j} +  A_{i,3k-1}B_{3k-1,j} + A_{i,2k}B_{2k,j}

(AB)_{ij}=\sum_{k=1}^P A_{ik}B_{kj},

(AB)_{ik}=\sum_{j=1}^{P/2} (A_{i,2j-1} + B_{2j,k})(A_{i,2j} + B_{2j-1,k}) - \underbrace{\sum_{j=1}^{P/2}A_{i,2j-1}A_{i,2j}}_{=:y_i} -
\underbrace{\sum_{j=1}^{P/2}B_{2j-1,k}B_{2j,k}}_{=:z_k}

\|E\|\leq 2^{-\tau}\frac{N^2+12N-8}{4}(\|A\|+\|B\|)^2,

\|E\|\leq 2^{-\tau}\frac{N^2+12N-8}{4}(k+2+1/k)\|A\|\|B\|.

1/2 \leq \frac{2^\lambda \|A\|}{2^{-\lambda}\|B\|} \leq 2.
\max_{\frac12\leq k \leq 2} k+2+1/k=9/2
\|E\|\leq 2^{-\tau}\cdot \frac98 \cdot (N^2+12N-8)\cdot \|A\|\cdot\|B\|
\label{eq:StrassenZerlegen}
A=\begin{bmatrix}
A_{11} & A_{12}\\
A_{21} & A_{22}
\end{bmatrix},\quad 
B=\begin{bmatrix}
B_{11} & B_{12}\\
B_{21} & B_{22}
\end{bmatrix}\quad
\text{and}\quad
C:=AB=\begin{bmatrix}
C_{11} & C_{12}\\
C_{21} & C_{22}
\end{bmatrix},

A_1&:=A_{11}-A_{21} & B_1&:=B_{22} - B_{12}\\
A_2&:=A_{22} - A_1  & B_2&:=B_1 + B_{11}
\intertext{and}
H_1 &=A_{11}B_{11} & H_5 &= A_1B_1\\
H_2 &=A_{12}B_{21} & H_6 &= (A_{12} - A_{2})B_{22}\\
H_3 &=A_2B_2 & H_7&=A_{22}(B_{21} - B_{2})\\
H_4 &=(A_{21} + A_{22})(B_{12} - B_{11}).
\intertext{With}
H_8&:=H_1+H_3 & H_9 &:= H_8 + H_4
\intertext{we finally get}
C_{11} &= H_1 + H_2 & C_{12} &= H_9 + H_6\\
C_{21}&= H_8 + H_5 + H_7 & C_{22} &= H_9 + H_5.


\CODE{StrassenWinograd.c}{229}
\CODElast{StrassenWinograd.c}{3}{225}

































\newpage\section{Tests}

To test the algorithms we compute the product of a random square matrix  with its scaled variant . The test routine is part of the package of C files. Is has the command line options
\begin{itemize}
\item \texttt{-O} matrix size, \emph{standard:} 400
\item \texttt{-R} number of repeats, \emph{standard:} 10
\end{itemize}

\begin{verbatim}
+-----------------------------------------------------------------------+
|            TIME TEST FOR METHODS OF MATRIX MULTIPLICATION             |
|                                                                       |
| C = A*(8A), where A is a (n x n) random matrix with n =        200    |
+-----------------------------------------------------------------------+
| method                      |       time (sec) |       NormInf( N-C ) |
+-----------------------------------------------------------------------+
| N := NaivKahan              |         0.146027 |                      |
| NaivStandard                |         0.083263 |         0.0000000000 |
| NaivOnArray                 |         0.121735 |         0.0000000000 |
| NaivLoopUnrollingTwo        |         0.072981 |         0.0000000000 |
| NaivLoopUnrollingThree      |         0.068356 |         0.0000000000 |
| NaivLoopUnrollingFour       |         0.067080 |         0.0000000000 |
| StrassenNaiv                |         0.077584 |         0.0000000001 |
| StrassenWinograd            |         0.080180 |         0.0000000000 |
| WinogradOriginal            |         0.073193 |         0.0000000001 |
| WinogradScaled              |         0.061350 |         0.0000000001 |
+-----------------------------------------------------------------------+

+-----------------------------------------------------------------------+
|            TIME TEST FOR METHODS OF MATRIX MULTIPLICATION             |
|                                                                       |
| C = A*(8A), where A is a (n x n) random matrix with n =        800    |
+-----------------------------------------------------------------------+
| method                      |       time (sec) |       NormInf( N-C ) |
+-----------------------------------------------------------------------+
| N := NaivKahan              |        11.817480 |                      |
| NaivStandard                |         7.370365 |         0.0000000009 |
| NaivOnArray                 |        10.828352 |         0.0000000009 |
| NaivLoopUnrollingTwo        |         6.914036 |         0.0000000006 |
| NaivLoopUnrollingThree      |         6.605404 |         0.0000000005 |
| NaivLoopUnrollingFour       |         6.480659 |         0.0000000004 |
| StrassenNaiv                |         3.806864 |         0.0000000022 |
| StrassenWinograd            |         3.978543 |         0.0000000010 |
| WinogradOriginal            |         6.892913 |         0.0000000036 |
| WinogradScaled              |         5.781587 |         0.0000000022 |
+-----------------------------------------------------------------------+
\end{verbatim}





















\newpage\begin{thebibliography}{5}
\bibitem{brent} \textsc{Brent, R. P.}: \emph{Algorithms for Matrix Multiplication}. STAN-CS-70-157. Computer Science Department, School of Humanities and Sciences, Stanford University. March 1970.

\bibitem{fischer} \textsc{Fischer, Patrick C.} and \textsc{Probert, Robert L.}: \emph{Efficient Procedures for using Matrix Algorithms}.

\bibitem{kahan} \textsc{Kahan, William}: \emph{Further remarks on reducing truncation errors}. 
Communications of the ACM 8 (1): 40. January 1965.

\bibitem{strassen} \textsc{Strassen, Volker}: \emph{Gaussian Elimination is not Optimal}. Numer. Math. 13: 354--356. 1969.

\bibitem{wilk} \textsc{Wilkinson, J. H.}: \emph{Rounding Errors in Algebraic Processes}. H.M.S.O. 1963.
\end{thebibliography}

\end{document}