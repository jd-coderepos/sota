\documentclass[12pt,a4paper]{article}
\usepackage{latexsym,amssymb,amsmath,amsthm}
\usepackage[russian]{babel}

\tolerance=1000

\newtheorem{theorem}{Теорема}
\newtheorem{prop}{Утверждение}
\newtheorem{lemma}{Лемма}
\newtheorem{corol}{Следствие}

\begin{document}
\title{Реализация линейных преобразований с циркулянтными матрицами вентильными схемами по модулю 2
ограниченной глубины\footnote{Работа выполнена при финансовой
поддержке РФФИ, проекты 11--01--00508 и 11--01--00792, и программы
фундаментальных исследований ОМН РАН <<Алгебраические и
комбинаторные методы математической кибернетики и информационные
системы нового поколения>> (проект <<Задачи оптимального синтеза
управляющих систем>>).}}
\date{}
\author{И. С. Сергеев\footnote{эл. адрес: isserg@gmail.com}}

\maketitle

\begin{abstract}
В настоящей заметке показано, что при любой постоянной $k \in
\mathbb N$ произвольную булеву циркулянтную матрицу можно
реализовать вентильной схемой по модулю 2 глубины $2k-1$ и
сложности $O\left(n^{1+1/k}\right)$, а также схемой глубины $2k$ и
сложности $O\left(n^{1+1/k}\log^{-1/k} n\right)$.
\end{abstract}

Напомним, что вентильная $(m,n)$-схема~--- это ориентированный
ациклический граф, в котором $n$ вершин отмечены как входы и $m$
вершин отмечены как выходы. Вентильная схема по модулю 2 реализует
булеву $m\times n$-матрицу $A=(a_{i,j})$ тогда и только тогда,
когда при любых $i$ и $j$ число ориентированных путей из $j$-го
входа в $i$-й выход сравнимо с $a_{i,j}$ по модулю 2. Сложностью
схемы называется число ребер в ней, а глубиной~--- максимальная
длина ориентированного пути. Подробнее см. в~\cite{lu,ju}.

$n\times n$-матрица $Z=(z_{i,j})$ называется циркулянтной, если
при любых $i$, $j$ выполнено $z_{i,j} = z_{0,k}$, где
$k=(j-i)\bmod n$.

Рассмотрим линейный булев оператор размера $n\times n$ с
циркулянтной матрицей --- он реализует циклическую
(алгебраическую, над $GF(2)$) свертку с некоторым постоянным
вектором $A$. Действительно, компоненты вектора
$C=(C_0,\ldots,C_{n-1})$~--- свертки векторов
$A=(A_0,\ldots,A_{n-1})$ и $B=(B_0,\ldots,B_{n-1})$, выражаются
формулами:
$$ C_k = \sum_{i+j \equiv k \mod n} A_iB_j. $$

Следующая теорема позволяет распространить
результаты~\cite{gs,gs1} о сравнении сложности реализации
некоторых циркулянтных матриц вентильными схемами и вентильными
схемами по модулю 2 на схемы ограниченной глубины.

\begin{theorem}
При $k \in \mathbb N$ произвольную булеву циркулянтную $n\times
n$-матрицу $Z$ можно реализовать вентильной схемой по модулю $2$:

а) глубины $2k-1$ и сложности не более $f(2k-1)n^{1+1/k}$;

б) глубины $2k$ и сложности не более $f(2k)n\left(\frac{n}{\log
n}\right)^{1/k}$.
\end{theorem}

Рассуждение проведем по индукции. При $k=1$ предъявляются
тривиальная схема глубины 1 и сложности $O(n^2)$, а также схема
глубины 2 и сложности $O(n^2/\log n)$, которая строится методом
О.Б.~Лупанова~\cite{lu}.

Докажем индуктивный переход от $k-1$ к $k$. Для доказательства
используется метод А.Л.~Тоома умножения многочленов~\cite{to}
вместе с приемом А.~Ш\"енхаге~\cite{sh}, позволяющим
распространить метод на двоичные многочлены. Умножение многочленов
с глубиной $d$ сводится к нескольким параллельным умножениям
глубины $d-2$.

Разобьем вектор переменных на $q$ частей длины $n/q$. Эти части
интерпретируем как вектора коэффициентов многочленов из кольца
$$ R=GF(2)[y]/(y^{2\cdot3^s}+y^{3^s}+1)$$ при младших степенях $y$.
Параметр $s$ выбирается из условия $3^s \ge n/q$.

Сведем умножение двоичных многочленов степени $n-1$ к умножению
многочленов степени $n/q-1$ над $R$. Последнее умножение выполним
при помощи ДПФ порядка $3^m \ge 2q$ с примитивным корнем
$\zeta=y^{s+1-m} \in R$.

Опишем схему.

На входе многочлен $B(x)=\sum B_i x^i \in R[x]$ степени $q-1$.
Постоянный сомножитель обозначим через $A(x)=\sum A_i x^i$. На
выходе --- произведение $C(x)=A(x)B(x)=\sum C_i x^i$.

1. Вычисляем $B(\zeta^0)$, \ldots, $B(\zeta^{3^m-1})$.

2. Вычисляем $C(\zeta^i)=A(\zeta^i)B(\zeta^i)$ для всех
$i=0,\ldots,3^m-1$.

3. Вычисляем коэффициенты многочлена $C(x)$.

Этапы 1 и 3 реализуем схемами глубины 1, а этап 2 --- схемой
глубины $d-2$. Оценим сложность схемы, обозначим ее $M(d,n)$.

1. Умножение на степень $y$ в кольце $R$ выполняется с линейной
сложностью, поэтому с линейной сложностью вычисляется значение
многочлена $F(x)$ в точке $y^p$. Следовательно, сложность первой
схемы оценивается как $O(3^m3^sq)$.

2. Каждое из умножений на шаге 2 есть умножение двоичных
многочленов степени $2\cdot3^s-1$ с последующим приведением по
модулю. Умножение выполним методом из индуктивного предположения
глубины $d-2$ и сложности $M(d-2,2\cdot3^s)$. Приведение
многочлена (в данном случае, степени $4\cdot3^s-1$) по модулю
$y^{2\cdot3^s}+y^{3^s}+1$ достигается дублированием некоторых его
коэффициентов (выходов предшествующей схемы) и отождествлением
некоторых коэффициентов, т.к. каждый коэффициент приводимого
многочлена используется не более чем дважды. Следовательно,
приведение по модулю можно реализовать без увеличения глубины и с
не более чем двукратным увеличением сложности. Общую сложность
второго этапа теперь можно оценить как
$2\cdot3^mM(d-2,2\cdot3^s)$.

3. Согласно основному свойству ДПФ искомые коэффициенты многочлена
$C(x)$ находятся как $C_i=C^*(\zeta^{-i})$, где многочлен $C^*(x)$
имеет коэффициенты $C(\zeta^i)$. Поэтому сложность этапа 3 можно
оценить так же, как и сложность этапа 1, $O(3^m3^sq)$.

Чтобы результат умножения многочленов над $R$ преобразовать
(обратно) в результат умножения двоичных многочленов, надо
выполнить подстановку $x=y^{2\cdot3^s}$ и привести подобные. Это
преобразование реализуется отождествлением выходов и не влияет на
глубину и сложность схемы.

Оценки теоремы получаются при следующем выборе параметров:
$q=n^{1/k}$ при $d=2k-1$ и $q=(n/\log n)^{1/k}$ при $d=2k$;
$3^s=\Theta(n/q)$, $3^m=\Theta(q)$.

(По построению, $f(k)=O(c^k)$ при некоторой константе $c$.) \qed

\begin{thebibliography}{99}

\bibitem{gs}
Гашков С. Б., Сергеев И. С. О сложности линейных булевых
операторов с редкими матрицами. Дискретный анализ и исследование
операций. 2010. {\bf 17}(3), 3--18.

\bibitem{gs1}
Гринчук М. И., Сергеев И. С. Редкие циркулянтные матрицы и нижние
оценки сложности некоторых булевых операторов. Дискретный анализ и
исследование операций. 2011. {\bf 18}(5), 38--53.

\bibitem{lu}
Лупанов О. Б. О вентильных и контактно-вентильных схемах. ДАН
СССР. 1956. {\bf 111}(6), 1171--1174.

\bibitem{to}
Тоом А. Л. О сложности схемы из функциональных элементов,
реализующей умножение целых чисел. Доклады АН СССР. 1963. {\bf
150}(3), 496--498.

\bibitem{ju}
Jukna S. Boolean function complexity. Advances and frontiers.
Springer--Verlag, 2012.

\bibitem{sh}
Sch\"{o}nhage A. Schnelle multiplikation von polynomen \"{u}ber
k\"{o}rpern der charakteristik 2. Acta Inf. 1977. {\bf 7},
395--398.

\end{thebibliography}

\end{document}
