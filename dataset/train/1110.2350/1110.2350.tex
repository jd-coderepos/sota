\bgroup\sf\medskip\begin{flushleft}

\noindent\textrm{\textcolor{Gray}{01\;\;\,}}\hspace{0.5em}\hspace*{0.00000em}\textbf{type} list = Nil \ensuremath{|} Cons (nat, list)~\linebreak
\noindent\textrm{\textcolor{Gray}{02\;\;\,}}\hspace{0.5em}\hspace*{0.00000em}\textbf{type} bool = BTrue \ensuremath{|} BFalse~\linebreak
\noindent\textrm{\textcolor{Gray}{03\;\;\,}}\hspace{0.5em}\hspace*{0.00000em}\textbf{logic} \{ ~\linebreak
\noindent\textrm{\textcolor{Gray}{04\;\;\,}}\hspace{0.5em}\hspace*{0.50000em}\textbf{Definition} bound (p \ensuremath{\colon} nat \ensuremath{\longrightarrow} (nat \ensuremath{\ast} bool)) (k \ensuremath{\colon} nat) \ensuremath{\colon} \textbf{Prop} \ensuremath{\colon}=~\linebreak
\noindent\textrm{\textcolor{Gray}{05\;\;\,}}\hspace{0.5em}\hspace*{2.00000em}\ensuremath{\forall} x m\ensuremath{\colon} nat, \ensuremath{\forall} r\ensuremath{\colon} bool, post p x (m, r) \ensuremath{\Rightarrow} m \ensuremath{\le} k.~\linebreak
\noindent\textrm{\textcolor{Gray}{06\;\;\,}}\hspace{0.5em}\hspace*{0.50000em}\textbf{Definition} k0 \ensuremath{\colon}= \ensuremath{\mbox{costof}(\ell_{m})} + \ensuremath{\mbox{costof}(\ell_{nil})}.~\linebreak
\noindent\textrm{\textcolor{Gray}{07\;\;\,}}\hspace{0.5em}\hspace*{0.50000em}\textbf{Definition} k1 \ensuremath{\colon}= \ensuremath{\mbox{costof}(\ell_{m})} + \ensuremath{\mbox{costof}(\ell_{p})} + \ensuremath{\mbox{costof}(\ell_{c})} + \ensuremath{\mbox{costof}(\ell_{f})} + \ensuremath{\mbox{costof}(\ell_{r})}. ~\linebreak
\noindent\textrm{\textcolor{Gray}{08\;\;\,}}\hspace{0.5em}\hspace*{0.00000em}\}~\linebreak
\noindent\textrm{\textcolor{Gray}{09\;\;\,}}\hspace{0.5em}\hspace*{0.00000em}\textbf{let} \textbf{rec} pexists (p \ensuremath{\colon} nat \ensuremath{\rightarrow} bool, l\ensuremath{\colon} list) \{ \ensuremath{\forall} x, pre p x \} \ensuremath{\colon} bool \{~\linebreak
\noindent\textrm{\textcolor{Gray}{10\;\;\,}}\hspace{0.5em}\hspace*{0.50000em}((result = BTrue) \ensuremath{\Leftrightarrow} (\ensuremath{\exists} x c\ensuremath{\colon} nat, mem x l \ensuremath{\wedge} post p x (c, BTrue))) \ensuremath{\wedge}~\linebreak
\noindent\textrm{\textcolor{Gray}{11\;\;\,}}\hspace{0.5em}\hspace*{0.50000em}(\ensuremath{\forall} k\ensuremath{\colon} nat, bound p k \ensuremath{\wedge} (result = BFalse) \ensuremath{\Rightarrow} cost \ensuremath{\le} k0 + (k + k1) \ensuremath{\times} length (l))~\linebreak
\noindent\textrm{\textcolor{Gray}{12\;\;\,}}\hspace{0.5em}\hspace*{0.00000em}\} = \ensuremath{\ell_{m}}\ensuremath{>} \textbf{match} l \textbf{with}~\linebreak
\noindent\textrm{\textcolor{Gray}{13\;\;\,}}\hspace{0.5em}\hspace*{1.00000em}\ensuremath{|} Nil \ensuremath{\rightarrow} \ensuremath{\ell_{nil}}\ensuremath{>} BFalse~\linebreak
\noindent\textrm{\textcolor{Gray}{14\;\;\,}}\hspace{0.5em}\hspace*{1.00000em}\ensuremath{|} Cons (x, xs) \ensuremath{\rightarrow} \ensuremath{\ell_{c}}\ensuremath{>} \textbf{match} p (x) \ensuremath{>} \ensuremath{\ell_{p}} \textbf{with}~\linebreak
\noindent\textrm{\textcolor{Gray}{15\;\;\,}}\hspace{0.5em}\hspace*{10.50000em}\ensuremath{|} BTrue \ensuremath{\rightarrow} BTrue ~\linebreak
\noindent\textrm{\textcolor{Gray}{16\;\;\,}}\hspace{0.5em}\hspace*{10.50000em}\ensuremath{|} BFalse \ensuremath{\rightarrow} \ensuremath{\ell_{f}}\ensuremath{>} (pexists (p, xs) \ensuremath{>} \ensuremath{\ell_{r}})
\end{flushleft}\medskip\egroup\noindent
