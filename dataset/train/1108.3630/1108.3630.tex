\documentclass[submission,copyright]{eptcs}\providecommand{\event}{WORDS 2011}
\usepackage{cite}
\usepackage[english]{babel} 
\usepackage{breakurl}             
\usepackage {array}
\usepackage{gastex}
\usepackage{amssymb,amsfonts,amsmath,amsthm}
\usepackage[usenames]{color}
\righthyphenmin=2\relax \emergencystretch=10pt\relax  \newtheorem {teo} {Theorem}
\newtheorem {Rmk} {Remark}
\newtheorem {Lemma} {Lemma}
\newtheorem {cor} {Corollary}
\DeclareMathOperator{\per}{per}
\DeclareMathOperator{\parent}{parent}
\def\A{{\mathcal A}}
\def\B{{\mathcal B}}
\def\R{{\mathcal R}}
\def\Cyl{{\sf Cyl}}
\newcommand{\II}{
\mbox{
\unitlength=1pt
\begin{picture}(2,12)(-1,5)
\gasset{Nw=1.5,Nh=1.5,Nfill=y,AHnb=0}
\node(o1)(0,16){}
\node(p1)(0,10){}
\node(q1)(0,4){}
\drawedge(o1,p1){}
\drawedge(p1,q1){}
\end{picture} }}
\newcommand{\XX}{
\mbox{
\unitlength=1pt
\begin{picture}(16,12)(4.5,5)
\gasset{Nw=1.5,Nh=1.5,Nfill=y,AHnb=0}
\node(o1)(5,16){}
\node(o4)(20,16){}
\node(p1)(5,10){}
\node(p2)(10,10){}
\node(p3)(15,10){}
\node(p4)(20,10){}
\node(q2)(10,4){}
\node(q3)(15,4){}
\drawedge(o1,p2){}
\drawedge(p1,q2){}
\drawedge(p4,q3){}
\drawedge(o4,p3){}
\end{picture} }}
\newcommand{\V}{
\mbox{
\unitlength=1pt
\begin{picture}(2,10)(0,10)
\gasset{Nw=1.5,Nh=1.5,Nfill=y,AHnb=0}
\node(o1)(0,16){}
\node(p1)(0,10){}
\drawedge(o1,p1){}
\end{picture} }}
\newcommand{\Pp}{
\mbox{
\unitlength=1pt
\begin{picture}(5,10)(0,10)
\gasset{Nw=1.5,Nh=1.5,Nfill=y,AHnb=0}
\node(o1)(0,16){}
\node(p2)(5,10){}
\drawedge(o1,p2){}
\end{picture} }}
\newcommand{\Ll}{
\mbox{
\unitlength=1pt
\begin{picture}(5,10)(0,10)
\gasset{Nw=1.5,Nh=1.5,Nfill=y,AHnb=0}
\node(o2)(5,16){}
\node(p1)(0,10){}
\drawedge(o2,p1){}
\end{picture} }}
\newcommand{\X}{
\mbox{
\unitlength=1pt
\begin{picture}(5,10)(0,10)
\gasset{Nw=1.5,Nh=1.5,Nfill=y,AHnb=0}
\node(o2)(5,16){}
\node(p1)(0,10){}
\node(o1)(0,16){}
\node(p2)(5,10){}
\drawedge(o2,p1){}
\drawedge(o1,p2){}
\end{picture} }}

\newcommand{\VP}{
\mbox{
\unitlength=0.8mm
\begin{picture}(6,6)\gasset{Nw=1.5,Nh=1.5,Nfill=y,AHnb=0}
\node[linecolor=White, fillcolor=White](o1)(0,0){}
\node[linecolor=White, fillcolor=White](p1)(0,6){}
\drawedge[linewidth=0.5](o1,p1){}
\end{picture} }}
\newcommand{\N}{
\mbox{
\unitlength=0.8mm
\begin{picture}(6,6)\gasset{Nw=1.5,Nh=1.5,Nfill=y,AHnb=0}
\node[linecolor=White, fillcolor=White](o1)(-2.9,0){}
\node[linecolor=White, fillcolor=White](p1)(2.9,6){}
\drawedge[linewidth=0.5](o1,p1){}
\end{picture} }}
\newcommand{\K}{
\mbox{
\unitlength=0.8mm
\begin{picture}(6,6)\gasset{Nw=1.5,Nh=1.5,Nfill=y,AHnb=0}
\node[linecolor=White, fillcolor=White](o1)(2.9,0){}
\node[linecolor=White, fillcolor=White](p1)(-2.9,6){}
\drawedge[linewidth=0.5](o1,p1){}
\end{picture} }}

\title{On Pansiot Words Avoiding 3-Repetitions}
\author{Irina A. Gorbunova
\institute{Ural Federal University\\
Ekaterinburg, Russia}
\email{i.a.gorbunova@gmail.com}
\and Arseny M. Shur
\institute{Ural Federal University\\
Ekaterinburg, Russia}
\email{arseny.shur@usu.ru}
}
\def\titlerunning{On Pansiot Words Avoiding 3-Repetitions}
\def\authorrunning{I. A. Gorbunova, A. M. Shur}
\begin{document}
\maketitle
\hyphenation{Using}

\begin{abstract}
The recently confirmed Dejean's conjecture about the threshold between avoidable and un\-avoidable powers of words gave rise to interesting and challenging problems on the structure and growth of threshold words. Over any finite alphabet with  letters, Pansiot words avoiding 3-repetitions form a regular language, which is a rather small superset of the set of all threshold words. Using cylindric and 2-dimensional words, we prove that, as  approaches infinity, the growth rates of complexity for these regular languages tend to the growth rate of complexity of some ternary 2-dimensional language. The numerical estimate of this growth rate is .
\end{abstract}

Powers, integral and fractional, are the simplest and most natural repetitions in words. Any repetition over an arbitrary fixed alphabet is characterized by the set of all words over this alphabet, avoiding this repetition. The main question concerning such a set is whether it is finite or infinite. For fractional powers, this question is answered by Dejean's conjecture \cite{Dej}, which is now proved in all cases by the efforts of different authors, see \cite{Pan,Mou,MNC,Car,CR1,CR2,Rao}.

Recall that the \textit{exponent} of a word  is the ratio between its length and its minimal period: . If , then  is a \textit{fractional power} (-\textit{power}). It is convenient to treat the notion of -power as follows: a word  is a -power if  while , and a -power if  while . As usual,  is treated as a ``number'', covering  in the usual  order. A word is called \textit{-free} (where  can be a number with plus as well) if it contains no -powers as factors. A -power is \textit{-avoidable} if the number of -ary -free words is infinite. Dejean's conjecture states that a -power is -avoidable if and only if

The -free languages over -letter alphabets, where , are called \textit{threshold languages}; we denote them by . We study structure and growth of these languages, aiming at the asymptotic properties as the size of the alphabet increases.

Any threshold language can be approximated from above by a series of regular languages consisting of words that \textit{locally} satisfy the -freeness property. Namely, these words avoid all -powers  such that , for some constant . From our previous work \cite{ShGo}, it is clear that the case  gives a lot of important structural information about the languages . Here we study this case in details, using \textit{cylindric representation} that captures the properties common for considered words over all alphabets.

\section {Preliminaries}

We study finite words and two-sided infinite words (\textit{Z-words}) over finite -letter alphabets  and over some special ternary alphabet introduced below. We also consider 2-dimensional words, which are just finite rectangular arrays of alphabetic symbols. Unlike to some commonly used models of 2-dimensional words (cf.~\cite{2D}), we do not use additional symbols to mark the borders of such a word. Factors of 2-dimensional words are also 2-dimensional words.

A (1- or 2-dimensional) language is \textit{factorial}, if it is closed under taking factors of its words. A word  \textit{avoids} a word  if  is not a factor of . The set of all minimal (with respect to the factor order) words avoided by all elements of a factorial language  is called the {\it antidictionary} of . All 1-dimensional languages with finite antidictionaries are regular.

We denote the antidictionary of the threshold language  by . A word  can be factorized as , where , , and all proper factors of  have the exponent at most . If , we call  an \textit{-repetition}.

The finite set  consists of all -repetitions with . The notation  is used for the (regular) language with the antidictionary . Then, . Since an infinite regular language contains arbitrary powers of some word, one has . Clearly, .

The \textit{combinatorial complexity} of a language  is a function  which returns the number of words in  of length . This function serves as a natural quantitative measure of . ``Big'' [``small''] languages have exponential [resp., subexponential] complexity. Exponential complexity can be described by means of the \textit{growth rate}  (subexponential complexity is indicated by ). For factorial languages, classical Fekete's lemma implies 

The growth rate of  approximates the growth rate of  from above. It is easy to prove that .

For regular languages, the growth rate equals the \textit{index} (spectral radius of the adjacency matrix) of recognizing automaton, providing that this automaton is \textit{consistent} (each vertex belongs to some accepting walk), and either deterministic, or non-deterministic but \textit{unambiguous} (there is at most one walk with the given label between two given vertices); see \cite{Sh1}.

\smallskip
In \cite{Pan}, Pansiot showed how to encode all words from the language  with ``characteristic'' words over the alphabet . This encoding played a big role in the proof of Dejean's conjecture; so, we refer to the elements of  as to \textit{Pansiot words}. These words can be equivalently defined by the following pair of conditions:
\begin{itemize}
\item[(P1)] two closest occurrences of a letter are on the distance , , or ;
\item[(P2)] two closest occurrences of a letter are followed by different letters.
\end{itemize}
We also consider \textit{Pansiot Z-words}, which are given by (P1), (P2) as well. Finite factors of Pansiot Z-words are exactly Pansiot words.

Now we introduce \textit{cylindric representation} of Pansiot words. Imagine such a word (finite or infinite) as a rope with knots, which are representing letters. This rope is wound around a cylinder such that the knots at distance  are placed one under another (Fig.~\ref{fig0}, a). By (P1), the knots labeled by two closest occurrences of the same letter appear on two consecutive winds of the rope one under another or shifted by one knot (Fig.~\ref{fig0}, b). If we connect these closest occurrences by ``sticks'', we get three types of such sticks: vertical, left-slanted, and right-slanted (Fig.~\ref{fig0},~b). We associate each letter in a Pansiot word with a stick going up from the corresponding knot, getting an encoding of this word by a \textit{cylindric word} over the ternary alphabet . Since the sticks allow one to establish equality of letters in a Pansiot word, such a cylindric word [Z-word] uniquely represents the original word [resp., Z-word] up to the permutation of the alphabet. Note that cylindric words avoid squares of letters in view of (P2). Hence, cylindric Z-words are just infinite sequences of blocks  and .

\begin{figure}[htb]
\unitlength=0.9mm
\centerline{ 
\begin{picture}(64,60)(0,-3) 
\gasset{Nw=1.3,Nh=1.3,Nfill=y,AHnb=0,ExtNL=y,NLdist=1}
\node[Nw=0,Nh=0](f0)(15,50.4){}
\node[Nw=0,Nh=0](f1)(5,45){}
\node[Nw=0,Nh=0](f2)(55,35){}
\node[Nw=0,Nh=0](f3)(5,29){}
\node[Nw=0,Nh=0](f4)(55,19){}
\node[Nw=0,Nh=0](f5)(5,13){}
\node[Nw=0,Nh=0](f6)(55,3){}
\node[Nw=0,Nh=0](f7)(48,5){}
\put(5,53){\line(0,-1){53}}
\put(55,53){\line(0,-1){53}}
\node(o1)(10,41.8){}
\node(o2)(19.6,37){}
\node(o3)(29.9,34){}
\node(o4)(41,33.1){}
\node(o5)(52,34.3){}
\node[Nfill=n](o6)(46.7,37.2){}
\node[Nfill=n](o7)(35,38.3){}
\node[Nfill=n](o8)(24.1,37){}
\node[Nfill=n](o9)(12.5,32.9){}
\node(p1)(10,25.8){}
\node(p2)(19.6,21){}
\node(p3)(29.9,18){}
\node(p4)(41,17.1){}
\node(p5)(52,18.3){}
\node[Nfill=n](p6)(46.7,21.2){}
\node[Nfill=n](p7)(35,22.3){}
\node[Nfill=n](p8)(24.1,21){}
\node[Nfill=n](p9)(12.5,16.9){}
\node(q1)(10,9.8){}
\node(q2)(19.6,5){}
\node(q3)(29.9,2){}
\node(q4)(41,1.1){}
\node(q5)(52,2.3){}
\drawedge[curvedepth=0.3,dash={2.5 2}{0}](f1,f0){}
\drawedge[curvedepth=-6](f1,f2){}
\drawedge[curvedepth=-6,dash={2.5 2}{0}](f2,f3){}
\drawedge[curvedepth=-6](f3,f4){}
\drawedge[curvedepth=-6,dash={2.5 2}{0}](f4,f5){}
\drawedge[curvedepth=-6](f5,f6){}
\drawedge[curvedepth=-0.3,dash={2.5 2}{0}](f6,f7){}
\put(30,52){\makebox(0,0)[cb]{}}
\put(30,6){\makebox(0,0)[cb]{}}
\end{picture} 
\begin{picture}(64,57)(-4,-3)
\gasset{Nw=1.3,Nh=1.3,Nfill=y,AHnb=0,ExtNL=y,NLdist=1}
\node[Nw=0,Nh=0](f0)(15,50.4){}
\node[Nw=0,Nh=0](f1)(5,45){}
\node[Nw=0,Nh=0](f2)(55,35){}
\node[Nw=0,Nh=0](f3)(5,29){}
\node[Nw=0,Nh=0](f4)(55,19){}
\node[Nw=0,Nh=0](f5)(5,13){}
\node[Nw=0,Nh=0](f6)(55,3){}
\node[Nw=0,Nh=0](f7)(48,5){}
\put(5,53){\line(0,-1){53}}
\put(55,53){\line(0,-1){53}}
\node(o1)(10,41.8){}
\node(o2)(19.6,37){}
\node(o3)(29.9,34){}
\node(o4)(41,33.1){}
\node(o5)(52,34.3){}
\node(p1)(10,25.8){}
\node[NLangle=80](p2)(19.6,21){}
\node[NLangle=270](p3)(29.9,18){}
\node[NLangle=270](p4)(41,17.1){}
\node[NLangle=270,NLdist=0.6](p5)(52,18.3){}
\node[NLangle=270](q1)(10,9.8){}
\node[NLangle=270](q2)(19.6,5){}
\node[NLangle=270](q3)(29.9,2){}
\node[NLangle=270,NLdist=0.4](q4)(41,1.1){}
\node[NLangle=270](q5)(52,2.3){}
\drawedge[curvedepth=0.3,dash={2.5 2}{0}](f1,f0){}
\drawedge[curvedepth=-6](f1,f2){}
\drawedge[curvedepth=-6,dash={2.5 2}{0}](f2,f3){}
\drawedge[curvedepth=-6](f3,f4){}
\drawedge[curvedepth=-6,dash={2.5 2}{0}](f4,f5){}
\drawedge[curvedepth=-6](f5,f6){}
\drawedge[curvedepth=-0.3,dash={2.5 2}{0}](f6,f7){}
\drawedge[linewidth=0.25](o1,p2){}
\drawedge[linewidth=0.25](o2,p1){}
\drawedge[linewidth=0.25](o3,p3){}
\drawedge[linewidth=0.25](o1,p2){}
\drawedge[linewidth=0.25](o4,p5){}
\drawedge[linewidth=0.25](o5,p4){}
\drawedge[linewidth=0.25](p1,q1){}
\drawedge[linewidth=0.25](p2,q3){}
\drawedge[linewidth=0.25](p3,q2){}
\drawedge[linewidth=0.25](p4,q5){}
\drawedge[linewidth=0.25](p5,q4){}
\put(30,52){\makebox(0,0)[cb]{}}
\put(32,6){\makebox(0,0)[cb]{}}
\end{picture} 
}
\vspace*{2mm}
\scriptsize{\hspace*{2.75cm}a) Infinite word on a cylinder ()\hspace*{3.0cm}b) Sticks (only visible)}
\caption{\small\sl Cylindric representation of Pansiot words.} \label{fig0}
\end{figure}
The feature of cylindric words is that they have an additional 2-dimensional structure, allowing one to capture structural properties of Pansiot words through 2-dimensional factors of cylindric words. We say that a Z-word  is \textit{compatible} to a language  if all factors of  belong to .

\begin{teo}[\cite{ShGo}]
For any integer , there exists a set  of 2-dimensional words of size  over  such that for any , a Pansiot Z-word  over  is compatible to  if and only if the corresponding cylindric Z-word has no 2-dimensional factors from .
\end{teo}

This theorem states that cylindric words that encode the words from  are defined by 2-dimensional avoidance properties. For example, cylindric words of the Pansiot words avoiding 3-repetitions are defined by the avoidance of the structures  and . Indeed, any of these structures implies the existence of three successive letters (say, , and ) in the encoded Pansiot word such that two occurrences of the factor  appear one under another at the distance ; since , the encoded word contains a 3-repetition. 

For a language , let  be its subset consisting of all factors of Z-words compatible to . By \cite[Theorem~3.1]{Sh2}, . Let  be the set of all factors of cylindric Z-words encoding Pansiot Z-words compatible to . Then clearly . Thus, the growth rates of threshold languages can be estimated through the study of cylindric words with simple avoidance properties that are independent of the size of the alphabet. In what follows, we refer to the elements of  as cylindric factors.

\smallskip
The above considerations imply two natural conjectures: \textit{for any fixed , the sequence  has a limit as  approaches infinity, and this limit is the ``growth rate'' of the 2-dimensional language defined by the same avoidance properties as }. Through the computations of growth rates for the alphabets with  letters we observed in \cite{ShGo} that the sequence  demonstrates fast convergence to the limit .

In this paper, we confirm both conjectures for the case . The corresponding 2-dimen\-sional language will be denoted by ; it consists of all rectangular words over  having no factors  and .
In fact, the case  is the crucial one to approximate the growth rates of threshold languages, because in \cite{ShGo} it was shown that
\begin{itemize}
\item[-] there is no 4- and 5-repetitions;
\item[-] -repetitions with  do not affect significantly the growth rate, as far as we can check this by extensive computer-assisted studies based on the results of \cite{Sh1}.
\end{itemize}

\section {Two-dimensional languages}
\textit{Combinatorial complexity}  of a 2-dimensional language  is the function returning the number of  words in . If  is factorial, then its \textit{growth rate} is defined by the formula 

The function  in this case is submultiplicative for each variable, and hence the existence of the limit (\ref{ind2d}) follows from the multivariate version of Fekete's lemma \cite{Cap}.

On the other hand, it is completely unclear how to calculate the growth rates of 2-dimensional languages. For the 1-dimensional case, the growth rate of a regular language can be found quite efficiently, see \cite{Sh1}. Here we give one idea how to estimate the growth rate of a 2-dimen\-sional language. Since the limit (\ref{ind2d}) exists, we can take any ``diagonal'' subsequence of ; we choose . Applying Stolz's Theorem (see~\cite{Fih}) twice, we get

if the last two limits exist. Calculating the values of these sequences for the language  (see Table~\ref{tab1}), we see that the last sequence has the best behaviour and allows one to suggest . Thus, we get an additional support to the conjecture that  is the limit of the sequence . For the rest of the paper, we set .
\begin{table}[htb]
\caption{\small\sl Approximation to the growth rate of the 2-dimensional language .} \label{tab1}
\vspace*{2mm}
\centerline{
\begin{tabular}{|c|c|c|c|}
\hline
&&&\\
\hline
3&1.627251&1.438233&1.191687\\
4&1.525034&1.402991&1.318617\\
5&1.464419&1.362547&1.229958\\
\ldots&\ldots&\ldots&\ldots\\
27&1.280207&1.261332&1.242089\\
28&1.278823&1.260626&1.242080\\
29&1.277537&1.259972&1.242104\\
30&1.276337&1.259362&1.242102\\
\hline
\end{tabular}}
\end{table}


\section {Automata}

Let us fix an arbitrary . We denote the set of all words of width  from  by . It is natural to put ; then   as the iterative limit of the existing double limit. Note that  can be also viewed as a 1-dimensional regular language over the alphabet . The automaton  recognizing  can be defined as follows:
\begin{enumerate}
\item[(A1)] the words of length  from  (they coincide with the words of size  from ) are the vertices; 
\item[(A2)] an edge  exists if and only if the word  of size  belongs to ; such an edge is labeled by ; 
\item[(A3)] each vertex is both initial and terminal.
\end{enumerate}

Note that  is an unambiguous nondeterministic automaton recognizing  as a language over . The index of  (and the growth rate of  over ) equals . The underlying graph of  is undirected due to vertical symmetry of the avoided factors. Let  be the number of walks of length  in , starting at the vertex ,  be the number of all walks of length  in . Then .

\smallskip
For the language , we build the \textit{Rauzy graph}  of order . The vertices of this graph are the words of  of length , and a directed edge connects a vertex  to  if and only if some word of  of length  has the prefix  and the suffix . It is easy to see that the edges of  can be labeled such that  becames a deterministic \textit{cover automaton} (all transitions are deterministic, all vertices are both initial and terminal), recognizing the language . Deterministic cover automaton is a special case of unambiguous nondeterministic automaton; so, the index of  equals . Now consider the th power  of . Note that in most cases the correctness of transition from some vertex  of  to some other vertex  can be checked using only  last symbols of . The only exception is the case when the -letter suffix of  begins and ends with : if  begins with , then the -letter suffix of  can begin with both  and , while if  begins with , then this suffix of  must begin with  to prevent the appearance of the avoided  factor. Let us require  to begin with  in any case and consider the automaton  such that 
\begin{enumerate}
\item[(B1)] the words of length  from  (the suffixes of length  of the vertices from ) are the vertices; 
\item[(B2)] an edge  exists if and only if (a) the automaton  contains the edge  for some , and (b) if  has the form , then  begins with ; such an edge is labeled by ;
\item[(B3)] each vertex is both initial and terminal.
\end{enumerate}

We will write  for the number of walks of length  in , starting at , and  for the number of all walks of length  in . If we denote the number of words of length  in the language  by , then it is easy to see that .


\section {Main result}

Since the indices of automata depend only on their adjacency matrices, below we consider the automata  and  just as digraphs. Recall that they share the same set of vertices and any edge of  is contained in . The outdegrees of a vertex  in  and  are denoted respectively by  and . We say that the vertices  and  are \textit{similar} if they coincide up to the first 11 letters. Similarity is an equivalence relation; we write . 

\begin{Rmk}\label{NN}
The classes of  are finite, since the cardinality of such a class is the number of words of length  over  that can be extended by the same suffix. The maximum cardinality of such a class is  independently of , and is achieved on any suffix that begins with . 
\end{Rmk}

The following two key lemmas hold for any  (this restriction is necessary only for the existence of 12th symbol in the label of the vertex). 

\begin{Lemma}\label{12th} 
For any vertex  and any  such that either  or , there exists an edge  in  such that the 12th letter of  is .
\end{Lemma}

\begin{proof}
Let .
We first show that if the condition of the lemma holds for some th letter () then it also holds for any th letter (). It suffices to check the case . Indeed, the minimal structures avoided by the words from  are either factors of length 2, or the ``vertical factor''  of height 2, or the ``square factor''  of size . Thus, the possible values of  are determined by , , and ; each of these values together with  and  determine the possible values of , and so on. There are only four possibilities for the factor . For each of them, we show that if the symbol  can take all possible values, then the same is true for , see Fig.~\ref{fig1}.

\begin{figure}[htb] 
\unitlength=0.8mm
\centerline{
\begin{picture}(90,28)(-6,0) 
\put(0,0){\N}
\put(6,0){\K}
\put(0,6){\K}
\put(6,6){\N}
\put(0,12){\K}
\put(6,12){\VP}
\put(0,18){\VP}
\put(6,18){\N}
\put(-22,20){}
\put(-41,12){possible values}
\put(-35,6){of }
\put(-12,6){\Huge\{}
\put(-5,19){1)}
\put(2,25){i}
\put(6,25){i+1}
\put(24,0){\N}
\put(30,0){\K}
\put(24,6){\VP}
\put(30,6){\N}
\put(24,12){\K}
\put(30,12){\VP}
\put(24,18){\N}
\put(30,18){\K}
\put(19,19){2)}
\put(26,25){i}
\put(30,25){i+1}
\put(48,6){\N}
\put(54,6){\K}
\put(48,12){\K}
\put(54,12){\N}
\put(48,18){\K}
\put(54,18){\VP}
\put(43,19){3)}
\put(50,25){i}
\put(54,25){i+1}
\put(72,0){\N}
\put(78,0){\K}
\put(72,6){\VP}
\put(78,6){\N}
\put(72,12){\K}
\put(78,12){\VP}
\put(72,18){\K}
\put(78,18){\N}
\put(67,19){4)}
\put(74,25){i}
\put(78,25){i+1}
\multiput(-6,0)(6,0){16}{\line(0,1){24}}
\multiput(-6,0)(0,6){5}{\line(1,0){90}}
\end{picture}}
\vspace*{-1mm}
\caption{\small\sl Proving Lemma~\ref{12th}. If  can take any value,  can take any value as well.} \label{fig1}
\end{figure}

In order to prove the lemma we find, for each vertex , the number  such that the th letter of  can take any value required by the condition of the lemma. If  for any , then we are done with the proof. So we examine all possible beginnings of  
 and try to build the word  such that  for any allowed . Recall that the letter  follows  in some cylinder word and hence, depends on . In order to avoid the consideration of  (the restrictions involving  depend on ), we build the word  for any . The word  for all  that begin with  and  is shown in Fig.~\ref{fig2} (cases 1--3 and 4--11, respectively). The maximum value of , namely 11, is achieved in case~9. If  begins with , then its factor  falls into one of the cases 1--11, so, we conclude that .
\end{proof}

\begin{figure}[phtb] 
\unitlength=0.75mm
\centerline{
\begin{picture}(132,228)(6,-4) 
\put(-5,217){1)}
\put(0,216){\VP}
\put(6,216){\N}
\put(12,216){\K}
\put(18,216){\VP}
\put(24,216){}
\put(0,210){\N}
\put(6,210){\K}
\put(12,210){\VP}
\put(18,210){\N}
\put(0,204){\N}
\put(6,204){\K}
\put(12,204){\N}
\put(18,204){\K}
\put(0,198){\K}
\put(6,198){\N}
\put(12,198){\K}
\put(18,198){\N}
\put(0,192){\K}
\put(6,192){\VP}
\put(12,192){\N}
\put(18,192){\K}
\put(31,217){2)}
\put(36,216){\VP}
\put(42,216){\N}
\put(48,216){\K}
\put(54,216){\N}
\put(60,216){\K}
\put(66,216){\VP}
\put(72,216){}
\put(36,210){\N}
\put(42,210){\K}
\put(48,210){\N}
\put(54,210){\K}
\put(60,210){\VP}
\put(36,204){\N}
\put(42,204){\K}
\put(48,204){\N}
\put(54,204){\K}
\put(60,204){\N}
\put(36,198){\N}
\put(42,198){\K}
\put(48,198){\VP}
\put(54,198){\N}
\put(60,198){\K}
\put(36,192){\K}
\put(42,192){\VP}
\put(48,192){\N}
\put(54,192){\K}
\put(60,192){\VP}
\put(66,192){\N}
\put(36,186){\K}
\put(42,186){\VP}
\put(48,186){\N}
\put(54,186){\K}
\put(60,186){\N}
\put(66,186){\K}
\put(79,217){3)}
\put(84,216){\VP}
\put(90,216){\N}
\put(96,216){\K}
\put(102,216){\N}
\put(108,216){\K}
\put(114,216){\N}
\put(120,216){\K}
\put(126,216){}
\put(84,210){\K}
\put(90,210){\VP}
\put(96,210){\N}
\put(102,210){\K}
\put(108,210){\N}
\put(114,210){\K}
\put(120,210){\VP}
\put(84,204){\K}
\put(90,204){\VP}
\put(96,204){\N}
\put(102,204){\K}
\put(108,204){\N}
\put(114,204){\K}
\put(120,204){\N}
\put(84,198){\K}
\put(90,198){\VP}
\put(96,198){\N}
\put(102,198){\K}
\put(108,198){\VP}
\put(114,198){\N}
\put(120,198){\K}
\put(-5,175){4)}
\put(0,174){\N}
\put(6,174){\K}
\put(12,174){\VP}
\put(18,174){\N}
\put(24,174){\K}
\put(30,174){\VP}
\put(36,174){}
\put(0,168){\VP}
\put(6,168){\N}
\put(12,168){\K}
\put(18,168){\N}
\put(24,168){\K}
\put(30,168){\N}
\put(0,162){\VP}
\put(6,162){\N}
\put(12,162){\K}
\put(18,162){\VP}
\put(24,162){\N}
\put(30,162){\K}
\put(0,156){\N}
\put(6,156){\K}
\put(12,156){\N}
\put(18,156){\K}
\put(24,156){\VP}
\put(30,156){\N}
\put(0,150){\N}
\put(6,150){\K}
\put(12,150){\N}
\put(18,150){\K}
\put(24,150){\N}
\put(30,150){\K}
\put(0,144){\K}
\put(6,144){\N}
\put(12,144){\K}
\put(18,144){\N}
\put(24,144){\K}
\put(30,144){\N}
\put(0,138){\K}
\put(6,138){\N}
\put(12,138){\K}
\put(18,138){\VP}
\put(24,138){\N}
\put(30,138){\K}
\put(-5,127){6)}
\put(0,126){\N}
\put(6,126){\K}
\put(12,126){\VP}
\put(18,126){\N}
\put(24,126){\K}
\put(30,126){\N}
\put(36,126){\K}
\put(42,126){\N}
\put(48,126){\K}
\put(54,126){}
\put(0,120){\VP}
\put(6,120){\N}
\put(12,120){\K}
\put(18,120){\VP}
\put(24,120){\N}
\put(30,120){\K}
\put(36,120){\N}
\put(42,120){\K}
\put(48,120){\VP}
\put(0,114){\VP}
\put(6,114){\N}
\put(12,114){\K}
\put(18,114){\VP}
\put(24,114){\N}
\put(30,114){\K}
\put(36,114){\N}
\put(42,114){\K}
\put(48,114){\N}
\put(0,108){\VP}
\put(6,108){\N}
\put(12,108){\K}
\put(18,108){\VP}
\put(24,108){\N}
\put(30,108){\K}
\put(36,108){\VP}
\put(42,108){\N}
\put(48,108){\K}
\put(61,175){5)}
\put(66,174){\N}
\put(72,174){\K}
\put(78,174){\VP}
\put(84,174){\N}
\put(90,174){\K}
\put(96,174){\N}
\put(102,174){\K}
\put(108,174){\VP}
\put(114,174){}
\put(66,168){\VP}
\put(72,168){\N}
\put(78,168){\K}
\put(84,168){\VP}
\put(90,168){\N}
\put(96,168){\K}
\put(102,168){\VP}
\put(108,168){\N}
\put(66,162){\VP}
\put(72,162){\N}
\put(78,162){\K}
\put(84,162){\VP}
\put(90,162){\N}
\put(96,162){\K}
\put(102,162){\N}
\put(108,162){\K}
\put(66,156){\N}
\put(72,156){\K}
\put(78,156){\N}
\put(84,156){\K}
\put(90,156){\N}
\put(96,156){\K}
\put(102,156){\VP}
\put(66,150){\N}
\put(72,150){\K}
\put(78,150){\N}
\put(84,150){\K}
\put(90,150){\N}
\put(96,150){\K}
\put(102,150){\N}
\put(66,144){\N}
\put(72,144){\K}
\put(78,144){\N}
\put(84,144){\K}
\put(90,144){\VP}
\put(96,144){\N}
\put(102,144){\K}
\put(66,138){\K}
\put(72,138){\VP}
\put(78,138){\N}
\put(84,138){\K}
\put(90,138){\N}
\put(96,138){\K}
\put(102,138){\VP}
\put(66,132){\K}
\put(72,132){\VP}
\put(78,132){\N}
\put(84,132){\K}
\put(90,132){\N}
\put(96,132){\K}
\put(102,132){\N}
\put(66,126){\K}
\put(72,126){\VP}
\put(78,126){\N}
\put(84,126){\K}
\put(90,126){\VP}
\put(96,126){\N}
\put(102,126){\K}
\put(-5,97){7)}
\put(0,96){\N}
\put(6,96){\K}
\put(12,96){\N}
\put(18,96){\K}
\put(24,96){\VP}
\put(30,96){\N}
\put(36,96){\K}
\put(42,96){\VP}
\put(48,96){}
\put(0,90){\VP}
\put(6,90){\N}
\put(12,90){\K}
\put(18,90){\VP}
\put(24,90){\N}
\put(0,84){\VP}
\put(6,84){\N}
\put(12,84){\K}
\put(18,84){\N}
\put(24,84){\K}
\put(0,78){\N}
\put(6,78){\K}
\put(12,78){\VP}
\put(18,78){\N}
\put(24,78){\K}
\put(30,78){\N}
\put(36,78){\K}
\put(42,78){\N}
\put(0,72){\N}
\put(6,72){\K}
\put(12,72){\VP}
\put(18,72){\N}
\put(24,72){\K}
\put(30,72){\VP}
\put(36,72){\N}
\put(42,72){\K}
\put(0,66){\K}
\put(6,66){\N}
\put(12,66){\K}
\put(18,66){\VP}
\put(24,66){\N}
\put(0,60){\K}
\put(6,60){\N}
\put(12,60){\K}
\put(18,60){\N}
\put(24,60){\K}
\put(55,97){8)}
\put(60,96){\N}
\put(66,96){\K}
\put(72,96){\N}
\put(78,96){\K}
\put(84,96){\VP}
\put(90,96){\N}
\put(96,96){\K}
\put(102,96){\N}
\put(108,96){\K}
\put(114,96){\VP}
\put(120,96){}
\put(60,90){\N}
\put(66,90){\K}
\put(72,90){\VP}
\put(78,90){\N}
\put(84,90){\K}
\put(90,90){\VP}
\put(96,90){\N}
\put(102,90){\K}
\put(108,90){\VP}
\put(114,90){\N}
\put(60,84){\N}
\put(66,84){\K}
\put(72,84){\VP}
\put(78,84){\N}
\put(84,84){\K}
\put(90,84){\VP}
\put(96,84){\N}
\put(102,84){\K}
\put(108,84){\N}
\put(114,84){\K}
\put(55,73){9)}
\put(60,72){\N}
\put(66,72){\K}
\put(72,72){\N}
\put(78,72){\K}
\put(84,72){\VP}
\put(90,72){\N}
\put(96,72){\K}
\put(102,72){\N}
\put(108,72){\K}
\put(114,72){\N}
\put(120,72){\K}
\put(126,72){}
\put(60,66){\N}
\put(66,66){\K}
\put(72,66){\VP}
\put(78,66){\N}
\put(84,66){\K}
\put(90,66){\N}
\put(96,66){\K}
\put(102,66){\VP}
\put(108,66){\N}
\put(114,66){\K}
\put(120,66){\VP}
\put(60,60){\N}
\put(66,60){\K}
\put(72,60){\VP}
\put(78,60){\N}
\put(84,60){\K}
\put(90,60){\N}
\put(96,60){\K}
\put(102,60){\VP}
\put(108,60){\N}
\put(114,60){\K}
\put(120,60){\N}
\put(60,54){\N}
\put(66,54){\K}
\put(72,54){\VP}
\put(78,54){\N}
\put(84,54){\K}
\put(90,54){\VP}
\put(96,54){\N}
\put(102,54){\K}
\put(108,54){\VP}
\put(114,54){\N}
\put(120,54){\K}
\put(-6,43){1\!0)}
\put(0,42){\N}
\put(6,42){\K}
\put(12,42){\N}
\put(18,42){\K}
\put(24,42){\N}
\put(30,42){\K}
\put(36,42){\VP}
\put(42,42){}
\put(0,36){\VP}
\put(6,36){\N}
\put(12,36){\K}
\put(18,36){\N}
\put(24,36){\K}
\put(30,36){\VP}
\put(0,30){\VP}
\put(6,30){\N}
\put(12,30){\K}
\put(18,30){\N}
\put(24,30){\K}
\put(30,30){\N}
\put(0,24){\VP}
\put(6,24){\N}
\put(12,24){\K}
\put(18,24){\VP}
\put(24,24){\N}
\put(30,24){\K}
\put(0,18){\N}
\put(6,18){\K}
\put(12,18){\VP}
\put(18,18){\N}
\put(24,18){\K}
\put(30,18){\VP}
\put(36,18){\N}
\put(0,12){\N}
\put(6,12){\K}
\put(12,12){\VP}
\put(18,12){\N}
\put(24,12){\K}
\put(30,12){\N}
\put(36,12){\K}
\put(0,6){\K}
\put(6,6){\N}
\put(12,6){\K}
\put(18,6){\N}
\put(24,6){\K}
\put(30,6){\VP}
\put(0,0){\K}
\put(6,0){\N}
\put(12,0){\K}
\put(18,0){\N}
\put(24,0){\K}
\put(30,0){\N}
\put(0,-6){\K}
\put(6,-6){\N}
\put(12,-6){\K}
\put(18,-6){\VP}
\put(24,-6){\N}
\put(30,-6){\K}
\put(54,43){1\!1)}
\put(60,42){\N}
\put(66,42){\K}
\put(72,42){\N}
\put(78,42){\K}
\put(84,42){\N}
\put(90,42){\K}
\put(96,42){\N}
\put(102,42){\K}
\put(108,42){}
\put(60,36){\N}
\put(66,36){\K}
\put(72,36){\VP}
\put(78,36){\N}
\put(84,36){\K}
\put(90,36){\N}
\put(96,36){\K}
\put(102,36){\VP}
\put(60,30){\N}
\put(66,30){\K}
\put(72,30){\VP}
\put(78,30){\N}
\put(84,30){\K}
\put(90,30){\N}
\put(96,30){\K}
\put(102,30){\N}
\put(60,24){\N}
\put(66,24){\K}
\put(72,24){\VP}
\put(78,24){\N}
\put(84,24){\K}
\put(90,24){\VP}
\put(96,24){\N}
\put(102,24){\K}
\thinlines
\multiput(-6,-6)(6,0){24}{\line(0,1){228}}
\multiput(-6,-6)(0,6){39}{\line(1,0){138}}
\end{picture}}
\caption{\small\sl Proving Lemma~\ref{12th}. Cases 1--11 represent different beginnings of the word . Under each beginning, some possible beginnings of the word  are drawn. For each possible first letter of , we exhibit such beginnings ending by all possible letters. In some cases, not all possible beginnings of  are drawn; for such missing beginnings, case 3 refers to case 2, case 6 to case 5, cases 8 and 9 to case 7, and case 11 to case 10.} \label{fig2}
\end{figure}

Lemma~\ref{12th} is used to prove another property of similarity.

\begin{Lemma}\label{sim2} 
If  and  is an edge in , then there exists an edge  in  such that .
\end{Lemma}

\begin{proof} 
Let , , , and we have to find the vertex . Assume that we know only the letters , and . Then we still can restore all possible values of the factor  independently of the letters  (cf. the proof of Lemma~\ref{12th}). 

Now consider all 's such that  is an edge in  and . The set of all such 's is nonempty by Lemma~\ref{12th}. Since  by similarity of  and , the set of all possible values of the factor  coincides with such a set for the factor . Thus, we can pick up  so that the factor  equals  for the actual value of . Then , and the lemma is proved.
\end{proof}

\begin{teo} 
The limit  exists and is equal to .
\end{teo}

\begin{proof} 
Recall that . Since the sequence  converges to , so does any its subsequence. Hence, . On the other hand, we know that . Thus, let us estimate the ratio . The upper bound  is trivial. In order to get the lower bound, we recall that  and . 

Let us fix an arbitrary vertex  and consider the -\textit{tree} (for ) defined as follows. The vertices of this tree are labeled by the vertices of ,  being the label of the root. Any vertex labeled by  has  children; the children are labeled by all forward neighbours of  in . Thus, there is a natural bijection between the set of vertices of level  in the -tree and the set of all walks from  of length  in the automaton . That is, th level of the -tree contains exactly  vertices. The -\textit{tree} is defined in the same way, using  instead of . The th level of the -tree contains  vertices.

Using Lemma~\ref{sim2} inductively, we get that the label of any vertex of th level in the -tree is similar to the label of some vertex of th level in the -tree. Let us start from the roots of the trees and inductively construct a total map  from the -tree to the -tree satisfying the following conditions:
\begin{itemize}
\item[(1)] if  is a level  vertex labeled by , then  is a level  vertex labeled by some ;
\item[(2)] .
\end{itemize}
The existence of such a map is ensured by Lemma~\ref{sim2} and the structure of trees. 

Now we take a level  vertex  from the -tree and estimate the size of the set . Assume that . If  is mapped to , then . All children of the vertex  are different. Hence, by Remark~\ref{NN}, at most  of these children can be mapped to . Thus, . The case  gives us  whence we obtain . Since  is total, we have . Summing up these inequalities for all vertices , we finally get .

Returning to combinatorial complexities, we can write

Taking the limits of all sides as , we get

Now we let  and use the squeese theorem to conclude that the limit  exists and is equal to 1 (recall that  is independent of ). Since the limit  also exists, we have

as desired.
\end{proof}

\begin{Rmk}
From the proof of the above theorem it is clear that the actual value of the constant  such that  is much smaller than 28. Computations show that . Hence, the set  of 2-dimensional words of width  is not much bigger than the corresponding set  of cylindric words.
\end{Rmk}

\bibliographystyle{eptcs}
\begin {thebibliography} {0}
\providecommand{\doi}[1]{\href{http://dx.doi.org/#1}{#1}}

\bibitem {Cap}
S. Capobianco (2008): \textit{Multidimensional cellular automata and generalization of Fekete's lemma}. {\slshape Discrete Mathematics and Theoretical Computer Science} 10(3), pp. 95--104.

\bibitem{Car}
A. Carpi (2007): {\it On Dejean's conjecture over large alphabets}. {\slshape Theoretical Computer Science} 385, pp. 137--151, doi: \doi{10.1016/j.tcs.2007.06.001}.

\bibitem {CR1}
J.\,D. Currie \& N. Rampersad (2009): {\it Dejean's conjecture holds for }. {\slshape RAIRO Theoretical Informatics and Applications } 43, pp. 775--778, doi: \doi{10.1051/ita/2009017}.

\bibitem {CR2}
J.\,D. Currie \& N. Rampersad (2011): {\it A proof of Dejean's conjecture}. {\slshape Mathematics of Computation}  80, pp. 1063--1070, doi: \doi{10.1090/S0025-5718-2010-02407-X}.

\bibitem {Dej}
F. Dejean (1972): {\it Sur un Theoreme de Thue}. {\slshape Journal of Combinatorial Theory. Series A} 13(1), pp. 90--99.

\bibitem {Fih}
G. M. Fichtenholz (2001): \textit{Differential and integral calculus}, volume 1, Fizmatlit, Moscow.

\bibitem {2D}
D. Giammarresi \& A. Restivo,  G. Rozenberg \& A. Salomaa, editors (1997): \textit{Two-dimensional languages}, Handbook of Formal Languages, volume 3, pp. 215--268, Springer, Berlin. 

\bibitem {MNC}
M. Mohammad-Noori \& J.\,D. Currie (2007): {\it Dejean's conjecture and Sturmian words}. {\slshape European Journal of Combinatorics} 28, pp. 876--890, doi: \doi{10.1016/j.ejc.2005.11.005}.

\bibitem {Mou}
J. Moulin-Ollagnier (1992): {\it Proof of Dejean's Conjecture for Alphabets with 5, 6, 7, 8, 9, 10 and 11 Letters}. {\slshape Theoretical Computer Science} 95(2), pp. 187--205, doi: \doi{10.1016/0304-3975(92)90264-G}.

\bibitem {Pan}
J.-J. Pansiot (1984): {\it A propos d'une conjecture de F. Dejean sur les r\'ep\'etitions dans les mots}. {Discrete Applied Mathematics} 7, pp. 297--311, doi: \doi{10.1016/0166-218X(84)90006-4}.

\bibitem {Rao}
M. Rao (2011): {\it Last Cases of Dejean's Conjecture}. {\slshape Theoretical Computer Science} 412(27), pp. 3010-3018, doi: \doi{10.1016/j.tcs.2010.06.020}.

\bibitem {ShGo}
A. M. Shur \& I. A. Gorbunova (2010): {\it On the growth rates of complexity of threshold languages}. {\slshape RAIRO Theoretical Informatics and Applications} 44, pp. 175--192, doi: \doi{10.1051/ita/2010012}.

\bibitem {Sh1}
A.M. Shur (2010): {\it Growth rates of complexity of power-free languages}. {\slshape Theoretical Computer Science} 411, pp. 3209--3223, doi: \doi{10.1016/j.tcs.2010.05.017}.

\bibitem {Sh2}
A.M. Shur (2008): {\it Comparing complexity functions of a language and its extendable part}. {\slshape RAIRO Theore\-tical Informatics and Applications } 42, pp. 647--655, doi: \doi{10.1051/ita:2008021}.
\end {thebibliography}

\end{document}
