\documentclass{article}[11pt,a4paper]



\usepackage[utf8]{inputenc}
\usepackage{booktabs}

\usepackage{amsthm}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{authblk}

\def\sharedaffiliation{\end{tabular}
\begin{tabular}{c}}
	
\newtheorem{theorem}{Theorem}[section]
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{definition}{Definition}[section]

\usepackage{complexity}
\usepackage{cite}
\usepackage{xspace}
\usepackage[usenames,dvipsnames]{xcolor}
\usepackage{todonotes}\usepackage{caption}
\usepackage{subcaption}
\usepackage{float}
\usepackage{url}
\usepackage{paralist}
\usepackage{nicefrac}
\usepackage{eqnarray}
\usepackage[margin=1.5in]{geometry}

\newcommand{\EDP}{EDP\xspace}	
\newcommand{\EDPlong}{Economic Dispatch Problem\xspace}	
\newcommand{\net}{\ensuremath{\mathrm{net}}}
\newcommand{\myremark}[4]{\textcolor{blue}{\textsc{#1 #2:}} \textcolor{#4}{\textsf{#3}}}
\newcommand{\plotscale}{0.8}
\newcommand{\plotscaleOne}{0.45}
\begin{document}
\author[1]{Thomas Leibfried}
\author[2]{Tamara Mchedlidze}
\author[1]{Nico Meyer-H\"ubner}
\author[2]{\mbox{Martin N\"ollenburg}}
\author[2]{Ignaz Rutter}
\author[2]{Peter Sanders}
\author[2]{\authorcr Dorothea Wagner}
\author[2]{Franziska Wegner}

\affil[1]{Institute of Energy Systems and High Voltage Technology}
\affil[2]{Institute of Theoretical Informatics\authorcr \vspace{1ex} Karlsruhe Institute of Technology, Germany}



\title{Operating Power Grids with Few Flow Control Buses} 
\date{}
\maketitle
\begin{abstract}
Future power grids will offer enhanced controllability due to the increased availability of power flow control units (FACTS). As the installation of control units in the grid is an expensive investment, we are interested in using few controllers to achieve high controllability. In particular, two questions arise: How many flow control buses are necessary to obtain globally optimal power flows? And if fewer flow control buses are available, what can we achieve with them?

Using steady state IEEE benchmark data sets, we explore experimentally that already a small number of controllers placed at certain grid buses suffices to achieve globally optimal power flows. We present a graph-theoretic explanation for this behavior. To answer the second question we perform a set of experiments that explore the existence and costs of feasible power flow solutions at increased loads with respect to the number of flow control buses in the grid. We observe that adding a small number of flow control buses reduces the flow costs and extends the existence of feasible solutions at increased load.
\end{abstract}
\section{Introduction}
\label{sec:introduction}
The central task of any electrical power infrastructure is the reliable and cost-efficient supply of electrical energy to industry and population on a national or even continental scale. 
Future power grids and their usage are subject to fundamental changes due to the shift towards renewable distributed energy production and the installation of new power flow control units, which offer increased control, but make the grid operation more demanding.
Not only do these changes lead to a much larger number of independent power producers (IPP), which are highly distributed in the network, but they also cause very different patterns of energy flow. 
For example, regions with off-shore wind farms may sometimes produce enough energy to supply remote consumers, but at other times they are consumers themselves.
In particular, this may require long-distance energy transmission and frequent flow direction changes. Most of the existing power grids, however, were not designed for such transmission patterns. The current strategy to cope with these changes is to either extend the grid with additional transmission lines, or to install advanced control units to facilitate better utilization of the existing infrastructure.

In this paper, we consider the latter option and study the advantageous effects of making selected buses of a power grid to controllable, both in terms of the minimum number of controllable buses needed for achieving maximum flow control and in terms of the operation costs and the existence of feasible power flows at critical line capacities. 

In abstract terms, we assume that a \emph{flow-control bus} is able to flexibly distribute the entire power flow at this bus among the incident edges, as long as Kirchhoff's current law (or the \emph{flow-conservation property}) is satisfied, i.e., the in-flow to the bus equals its out-flow.
These flow control buses can be realized using power electronics devices known as \emph{flexible AC transmission systems} (FACTS), which are a class of power systems that have the capabilities to control various electrical bus parameters~\cite{Hingorani1993a,gh-ufact-00}. 
More specifically, since we are interested in controlling the real power flow on the branches incident to a particular bus, we can realize our flow control buses by installing on each (but one) incident branch a \emph{unified power flow controller} (UPFC), which is a FACTS that is able to control the voltage magnitude and angle and consequently has control of the real and reactive power flow on the particular branch~\cite{Noroozian1997,gh-ufact-00}.

One of the most important tasks in operating a power grid is to decide the energy production of each power generator such that supply and consumption are balanced and the resulting power flow does not exceed the thermal limits of the power lines. 
Among all solutions we are interested in one that minimizes the total energy production and transmission cost. 
This is called \emph{Economic Dispatch Problem} (EDP).
The main approach for solving this problem in power grids without FACTS is the optimal power flow (OPF) method, a numerical method that was introduced in 1962 by Carpentier~\cite{Carpentier62} and has subsequently been refined and generalized, see the recent surveys by Frank et al.~\cite{SurveyOPF1,SurveyOPF2}. 
However, OPF is not designed for hybrid power grids with flow control buses and cannot exploit the extended flow control possibilities to obtain globally optimal solutions. 

Hence, we propose in Section~\ref{sec:model} a new hybrid DC-based model for power flows in power grids that combine traditional grid buses with some flow-control buses.
In order to answer our questions on the effects of installing flow control buses, we solve the \EDP in our hybrid model using a linear programming (LP) formulation.
Our LP combines a standard graph-theoretical network flow model, which already includes Kirchhoff's current law at all buses, with additional constraints for Kirchhoff's voltage law in those parts of the grid that are not equipped with flow control buses. Thus we are able to obtain electrically feasible power flows that minimize, similarly to OPF, the overall flow costs in terms of generation and transmission costs.

Using the well-known IEEE power systems test cases, we performed simulation experiments related to two key questions, which take into account that the FACTS needed for realizing our flow control buses in reality constitute a significant and expensive investment and hence their number should be as small as possible. 
\begin{compactenum}
	\item How many flow control buses are necessary to obtain globally optimal power flows and which buses need to be controlled?
	\item If the number of available flow control buses is given, do we still see a positive effect on the flow costs and on the operability of the grid when approaching its capacity limits?
\end{compactenum}

In Section~\ref{sec:hybridmodel} we address the first question. 
In our experiments we determine the minimum number of flow control buses necessary to achieve the same solution quality as in a power grid in which each bus is controllable and which clearly admits an upper bound on what can be achieved with the network topology. 
Interestingly, it turns out that a relatively small number of flow control buses are sufficient for this.
In fact, we can prove a theorem stating a structural graph-theoretic property, which, if met by the placement of flow control buses, implies the optimality of the power flow and serves as a theoretical explanation of the observed behavior.
Section~\ref{sec:grid-control-when-approaching-capacity-limits} deals with the second question of operating a power grid close to its capacity limits, which becomes increasingly relevant as the consumption of electrical energy grows faster than the grid capacities.
Our experiments indicate that installing few flow control buses in a power grid is sufficient not only to achieve  lower costs compared to an OPF solution, but also allows to operate the grid at capacities for which no feasible OPF solution exists any more.
\section{Related Work}
\label{sec:related-work}
With the increasing availability and technological advancement of
FACTS researchers began to study the possible benefits of their
installation in power grids from different perspectives.

From an economic perspective, it is of interest to support investment
decisions in power grid expansion planning by considering alternative
investment strategies that either focus on new transmission lines or
allow mixed approaches including FACTS placement.  Blanco et
al. \cite{bogr-rovfi-11} present a least-squares Monte-Carlo method
for evaluating investment strategies and argue that FACTS allow for a
more flexible, mixed strategy that fares better under uncertainty.
Tee and Ilic present an optimal decision-making framework for
comparing investment decisions, including FACTS~\cite{ti-oidte-12}.

From the perspective of operating a power grid, the main question is
how many and where FACTS should be placed in order to optimize a
certain criterion.  Cai et al.~\cite{1397562} propose and
experimentally evaluate a genetic algorithm for allocating different
types of FACTS in a power grid in order to optimally support a
deregulated energy market.  Gerbex et al.~\cite{gcg-olmtf-01} and
Ongsakul and Jirapong~\cite{1465551} study the placement of FACTS with
the goal of increasing the amount of energy that can be transferred.
Gerbex et al.~\cite{gcg-olmtf-01} present a genetic algorithm that
optimizes simultaneously the energy generation costs, transmission
losses, line overload, and the acquisition costs for FACTS.  Ongsakul
and Jirapong~\cite{1465551} use evolutionary programming to place
FACTS such that the total amount of energy that can be transferred
from producers to consumers is maximized; in contrast to our setting,
they may also increase the demands of consumers arbitrarily.
In contrast to these heuristic approaches Lima et
al.~\cite{lgkm-psp-03} use mixed-integer linear programming to
optimally increase the loadability of a system by placing FACTS
subject to limits on their number or cost.  Similar to our approach,
they do not distinguish different types of FACTS but rather assume
``ideal'' FACTS that can control all transmission parameters of a
branch.  In contrast to our work, they focus only on loadability and
do not consider generation costs and line losses.

All related work mentioned so far considers the DC model for
electrical networks as an approximation to the AC model and aims at
providing a preliminary step in an actual planning process, where this
approximation is sufficient.  There are also a few attempts to solve
the placement problem for FACTS in the more realistic but also more
complicated AC model.  
Sharma et al.~\cite{sgv-nps-03} develop an
evaluation whether transmission lines are critical and propose to
place FACTS at critical lines in order to improve voltage stability in
the grid.  Ippolito and Siano~\cite{is-sonl-04} present a genetic
algorithm for FACTS placement in AC networks and experimentally
evaluate it in a case study.
In contrast to these heuristic approaches, Farivar and Low~\cite{6507352} 
observe exact OPF evaluation in a relaxed AC-model. In this context, they 
place phase shifters to exploit structural characteristics that are similar to our approach.
\section{Preliminaries}
\label{sec:preliminaries}
In this section we recall some basic notions from graph theory.
Although, for technical reasons, the graphs we use for modeling power
grids are directed, when considering the topology of the network, we
always consider the underlying undirected graph.  Thus, in the
following let  be an undirected graph.

The graph  is \emph{connected} if it contains a path between any
two vertices.  A \emph{connected component} of  is a maximal
connected subgraph of  (maximal with respect to inclusion).  A
\emph{cactus} is a graph where every edge is contained in at most one
cycle.  A \emph{forest} is a graph that does not contain a cycle.

A \emph{cutvertex} is a vertex of a graph whose removal increases the
number of connected components.  A \emph{biconnected component} is a
maximal subgraph that does not have a cutvertex.  Note that a
biconnected component of a forest is either \emph{trivial} in the
sense that it consists of a single vertex, or it consists of a single
edge.  Similarly, a biconnected component of a cactus is trivial, a
single edge, or a cycle.

A \emph{feedback set} of  with respect to a class of graphs
 is a set of vertices  such that .  We will only be interested in feedback sets with respect
to forests and cacti.  The former is also called \emph{feedback vertex
  set}.  Naturally, one is interested in finding a set  that is as
small as possible.
\section{Model}
\label{sec:model}
In this section we introduce three graph-theoretic flow models for optimal power flows.
Our models are based on the DC power grid model~\cite{Hammerstrom2007, Zimmerman2011a,sja-dcpfr-09}, which is commonly used as an approximation of AC grids~\cite{Purchala2005,ocs-acdc-04}.
We model a power grid as a graph , where  is the set of vertices and  is the set of edges. The vertices represent the buses, some of which may be special generator and consumer buses, and the edges represent the branches, which may be transmission lines between the incident buses or transformers.
There is a subset  of the vertices that represents generator buses.
Each generator  has a maximum supply  and is equipped with a convex cost function  that is assumed to be piecewise linear with

where  is the set of all piecewise linear functions of  and . 
Further, there is a subset  of consumer buses.
Each consumer  has a power demand .

Each branch  has a thermal limit, which is modeled as a capacity function  restricting the real power. 
Further, each branch causes a certain loss of power depending on the physical branch parameters and the actual power flow on the branch. 
These losses are again approximated as a convex, piecewise linear function  for each edge  with

where  is the set of all piecewise linear functions of  and .


A \emph{flow}  in the power grid  is a function  with the property that 

For every vertex  in , we define its \emph{net
  out-flow}  
For a flow , we further define two types of costs, the \emph{generator
  costs}  and the
\emph{line losses}  To
obtain the overall cost for the flow , we weight these two terms as

where .  Our goal is to minimize this objective
function in several different power flow models.
\subsection{Power Flow Models}
\label{sec:power-flow-models}
The most basic model is the \emph{flow model}, where  has to
satisfy the following constraints.

We call a flow satisfying these constraints \emph{feasible}.
Equation~(\ref{eq:capacity}) models the thermal limits or real power capacities of all branches and is called \emph{capacity constraint}. 
Equation~(\ref{eq:conservation}) models that vertices that are neither generators nor consumers have zero net out-flow and is called \emph{flow conservation constraint}. 
Equation~(\ref{eq:consumer}) models that all consumer demands are satisfied and is called \emph{consumer constraint}.
Finally, Equation~(\ref{eq:generator}) models that all generators respect their production limits and is called \emph{generator constraint}.


The flow model neglects some physical properties of electrical flows,
in particular Kirchhoff's voltage law.  Thus, the computed power
flows can only be applied to power grids where every vertex is
a control vertex.  In contrast, the \emph{electrical flow
  model}, e.g., according to Zimmerman et al.~\cite{Zimmerman2011a}, models the
power flow via the same set of constraints as the flow model, but additionally requires
the existence of a suitable voltage angle assignment  such that for each branch  the following equation
holds 

Here  is the \emph{susceptance} of the branch .  This is
equivalent to restricting the model to feasible flows that also satisfy
Kirchhoff's voltage law, or, in other words, no flow control buses are used.
This yields a model that matches the situation in the traditional power grids existing today.
We call a feasible flow  \emph{electrically feasible} if
there exists a voltage angle assignment 
satisfying~(\ref{eq:electricalflowintro}).


Recall from the introduction that flow control buses can be technically realized by \mbox{UPFCs}, which is a FACTS. Ideal FACTS as introduced by Griffin et al.~\cite{julieGriffin} are often used to simplify the modeling of FACTS by using a linear model and assuming a complete and independent control of the real and reactive power. Our flow control buses are ideal FACTS that control the power flow to all incident edges. 
The flow model---in contrast to the electrical model---assumes flow control buses at each vertex, whereas the
electrical model assumes no immediate control of the power flow.  
Instead, the grid is balanced by changing
the generator outputs only.  In the following we propose a
\emph{hybrid model} that combines the flow model and the electrical flow model in order to handle power grids with flow control buses at a subset of selected vertices.

Let  be a subset of vertices of .  We denote by
 the power network obtained from  by considering all vertices in
 as flow control buses.  We call any subgraph~ induced by
a subset  of the vertices without controllers a \emph{native power grid} of .  A flow of  is
\emph{electrically feasible} for a native power grid 
if there exists a voltage angle assignment 
such that every edge in  satisfies
Equation~(\ref{eq:electricalflowintro}).  In this case we call
 \emph{feasible (voltage) angle assignment} for .

A feasible flow  is \emph{electrically feasible for } if and
only if  is electrically feasible for the \emph{maximal native
  power grid} .  Intuitively, this models the
fact that a power flow in  must be a feasible flow and that it
satisfies the second Kirchhoff law in the maximum native power grid.

Obviously, if  and  is an electrically feasible
flow for , then  is also electrically feasible for .
Hence the minimum value of the cost  does not increase when adding
more flow control buses.

We note that each of the models can easily be expressed as a linear
program (LP), and thus in all three models an optimal solution can be
computed efficiently~\cite{Bazaraa:2004:LPN:1062374}; see Appendix~\ref{app:lp}. 
However, the flow model can be reduced to a special minimum cost network flow 
problem, for which efficient exact optimization algorithms exist~\cite{Goldberg19971}.  We 
describe this reduction in the following.
\begin{table}[tb!]
\centering
\begin{tabular}{lrrrr}
  \toprule
  \multicolumn{1}{c}{case} & \multicolumn{1}{c}{} & \multicolumn{1}{c}{} & \multicolumn{1}{c}{} & \multicolumn{1}{c}{} \\ 
  \midrule
  \texttt{case6} &   6 &  11 &   3 & 210.00 \\ 
  \texttt{case9} &   9 &   9 &   3 & 315.00 \\ 
  \texttt{case14} &  14 &  20 &   5 & 259.00 \\ 
  \texttt{case30} &  30 &  41 &   6 & 189.20 \\ 
  \texttt{case39} &  39 &  46 &  10 & 6254.23 \\ 
  \texttt{case57} &  57 &  78 &   7 & 1250.80 \\ 
  \texttt{case118} & 118 & 179 &  54 & 4242.00 \\ 
   \bottomrule
\end{tabular}
\caption{IEEE benchmark set with , ,  and  representing number of buses, number of transmission lines, number of generators and total power demand, respectively.} 
\label{tab:examples}
\end{table}
\subsection{Reduction to MinCostFlow}
\label{sec:model-mincost-flow}
Let   be an \emph{- flow network}
consisting of a directed \mbox{(multi-)} graph , two dedicated source and sink vertices , edge capacities , and edge costs . 
A \emph{flow}  in  is a function  and it is called \emph{feasible} if it satisfies the capacity constraint~(\ref{eq:capacity}) and a flow conservation constraint similar to~(\ref{eq:conservation}):

The \emph{value}  of a flow  is the total flow from  to , i.e., . A feasible flow  with maximum value is called a \emph{maximum flow} in .
For a given flow value  the \emph{min-cost - flow problem} is to find a feasible flow  of value  such that the cost  is minimized.

In order to transform the graph  of a power grid into an - flow network , we first add a new source vertex  and a new sink vertex  to . 
Each generator  is connected by a directed edge  with capacity  to the source . 
Each consumer  is connected by a directed edge  with capacity  to the sink . 
Further, we replace each original undirected edge  by two directed copies  and , whose capacities  are given by their common thermal limit . 

Next, we define the edge costs. 
It is well known that a convex, piecewise linear edge cost function  can easily be modeled in a flow network by replacing the respective edge  with as many copies as the linear pieces of the cost function. 
The edge capacities are defined by the differences between consecutive breakpoints of  and sum up to ; the individual costs correspond to the costs as defined by the linear pieces between the breakpoints. 
Thus for ease of presentation we refrain from explicitly modeling convex piecewise linear cost functions in . 
We rather assume that the flow cost  is given for each edge  (, ) by the weighted loss function , where  is the weight parameter of Equation~(\ref{eq:objective}). 
The edges  from the source  to a generator  have cost  and the edges incident to the sink  have cost . 
Then the objective function to be minimized is .
Finally, we set the target flow value  to the total demand  of all consumers. 
By construction, every feasible minimum-cost flow in  is a feasible minimum-cost flow in the underlying power grid  and vice versa.
\section{Placing Flow Control Buses} 
\label{sec:hybridmodel}
In this section we seek to answer the question how many flow control buses
are necessary to obtain a globally optimal solution.  
Recall that the flow model is a relaxation of the physical model and uses fewer 
constraints. Therefore, optimal solutions in the flow model are at least as good as
in the physical model.

Given a power grid , we say that making the vertices in  flow control buses achieves \emph{full control} if the objective value of an
optimal energy flow for the grid  is the same as the objective
value of an optimal solution in the flow model (or equivalently in the
hybrid network , where every vertex is a flow control bus).  Our experiments indicate that in the IEEE instances often a
small fraction of the vertices is sufficient to achieve full control.
Afterwards we give a graph-theoretical explanation of this behavior.
\subsection{Experiments}
\label{sub:experiments-control-units}
\begin{figure}[tb!]\centering
  \begin{subfigure}[t]{.492\textwidth}
  	\centering
    	\includegraphics[width=\plotscale\linewidth, page=4,trim=0cm 0cm 0cm 0cm]{figures/plotCostsVsLosses.pdf}
	\caption{Total costs and losses for the IEEE benchmark data with 30 buses, where the square cross marks the solution computed by OPF.}
	\label{fig:plot-costs-losses}
\end{subfigure}
\hfill
  \begin{subfigure}[t]{.492\textwidth}
  	\centering
\includegraphics[width=\plotscale\linewidth, page=1,trim=0cm 0cm 0cm 0cm]{figures/plotCostsVsLossesNormalized.pdf}
	\caption{Relative costs and losses for the IEEE benchmark data sets.}
	\label{fig:plot-costs-losses-normalized}
\end{subfigure}
\caption{Trade-off of generator costs and losses
          normalized to the maximum generator cost () and
          the maximum loss ( as  varies
          from  to .}
\end{figure}

For our evaluation we use the IEEE benchmark data sets\footnote{data
  sources \url{http://www.pserc.cornell.edu/matpower/} and
  \url{http://www.ee.washington.edu/research/pstca/}} shown in
Table~\ref{tab:examples}. There each case is named according to the
number of buses .  The number of generators and the number of
edges are denoted  and , respectively.

 To obtain piece-wise linear functions for generator costs and line
 losses, we simply sample the cost functions using a specified number
 of sampling points.  Note further that our approach requires convex
 cost functions, but this is fine in practice~\cite{wood1996power}; in
 particular the functions are convex for the IEEE benchmark instances.

We performed our experiments on an AMD Opteron processor 6172 running
 openSUSE 12.2. Our implementation is written in Python 2.7.3 and uses
 PYPOWER\footnote{\url{https://pypi.python.org/pypi/PYPOWER/4.0.0}}, a
 Python port of MATPOWER~\cite{Zimmerman2009,Zimmerman2011a}, for
 computing OPF solutions.  For computing solutions and minimizing the
 number of control buses in our hybrid model we use the (integer)
 linear programming solver Gurobi
 6.0.0\footnote{\url{www.gurobi.com}}.

 First, we observe that the value of , which controls the
 weighting of costs and losses in the objective value has a
 significant effect on the objective values of generator costs and
 line losses.  
 Figure~\ref{fig:plot-costs-losses} shows the trade-off for the IEEE
 instance \texttt{case30} (the plots for the other instances can be
 found in Appendix~\ref{app:hybridmodel}).  The OPF solution, which
 ignores losses, is typically at the far end of the spectrum with high
 losses and is comparable to our solution with .  As can
 be seen in Figure~\ref{fig:plot-costs-losses-normalized}, where the
 costs and losses are normalized to the maximum cost and the maximum
 loss per instance, the same trade-off behavior is present in all
 instances.  It thus makes sense to allow the operator of a power grid
 to choose the value of  in order to model the true operation
 costs.

On the other hand, it may then be the case that the number of flow control buses to achieve full control of the network varies depending on the
choice of~.  Figure~\ref{fig:plot-controller-weight} shows
for different values of~ the relative number of control
vertices necessary to achieve full control in each of the instances.
In most cases less than 15\% of all buses need to be controllers to
achieve full control.  For the cases with 6 buses and 14 buses this
percentage is slightly bigger, which is mainly an artifact stemming
from the small total size.  As can be seen, the required number of
units is relatively stable but drops to zero for~,
i.e., when only the generator costs are considered. This is due to the fact that all IEEE instances have basically unlimited line capacities and thus do not restrict the possible flows.

\begin{figure}[tb!]\centering
\includegraphics[width=\plotscaleOne\linewidth, trim=0cm 0cm 0cm 0cm]{figures/plotControllerVsWeight.pdf}
	\caption{Relative number of controllers for achieving full
          control in the IEEE instances as  varies from  to
          .}\label{fig:plot-controller-weight}\end{figure}

In order to make a useful prediction on the number of vertices
required for full control that applies to all choices of~, in
the following we take for each instance the maximum of the smallest
possible number of vertices to achieve full control over all values 
of~ and refer to this as the number of vertices for achieving
full control of the instance.  This conservative choice ensures that
the numbers we compute are certainly an upper bound for achieving full
control, independent of the actual choice of~.
\subsection{Structure of Optimal Solutions}
\label{sub:hybridtheory}
As we have seen in our experimental evaluation, often a small number
of flow control buses is sufficient to ensure that solutions in the hybrid
model are the same as in the flow model.  In the following we provide
a theoretical explanation of this property and link it to structural
properties of power grids. Farivar and Low~\cite{6507352} give similar structural 
results on spanning trees, but using a different model.

A first observation is that flow control buses influence all
incident edges.  Thus, if every edge is incident to a flow control bus, i.e., the set  is a \emph{vertex cover} of , no
edge in the network is affected by
constraint~(\ref{eq:electricalflowintro}).  Then the flow model and
the hybrid model are equivalent and full control is achieved.
However, it is generally not true that power grids admit small vertex
covers; as shown in Figure~\ref{fig:barchart-cases-controller}, all
instances require more than 40\% of their vertices for a vertex cover.
In the following we show a much stronger result, namely that it
suffices for becoming independent of 
Equation~(\ref{eq:electricalflowintro}) that the native power grid
 is an acyclic network.  Moreoever, if , (line
losses are neglected) and edge capacities are ignored, it even
suffices that  is a so-called \emph{cactus} graph, in which every
edge is part of at most one cycle.
\begin{figure}[tb!]
  	\centering
\includegraphics[width=\plotscaleOne\linewidth, trim = 0cm 0cm 0cm 0cm]{figures/plotBarchartCasesVsController.pdf}
    \caption{Comparison of the number of vertices which need to be
      removed from the network to get a Tree (Feedback Vertex Set) or
      a cactus, with the worst number of controller to have full
      control in the network.}
	\label{fig:barchart-cases-controller}
\end{figure}
\begin{lemma}
  \label{lem:decompose-powergrid-cutvertex}
  Let  be a native power grid and let  be a vertex whose
  removal disconnects  into connected components with vertex sets
  .  Then a flow  is electrically feasible for 
  if and only if it is electrically feasible for  for .
\end{lemma}
\begin{proof}
  Clearly, if  is a feasible voltage angle assignment for , then its
  restriction to  is a feasible angle assignment for .
  Conversely, assume that  is a feasible angle assignment for
  .  Define .  
  Since for
  every edge in  the voltage angles of the endpoints are changed by the same value,
    is a feasible voltage angle assignment for .
  Further,  for every , which means that the function , where  for  is well-defined.
  Note that the restriction of  to any of the  coincides
  with .  Since every edge of  belongs to exactly one of
  the , it follows that  is a feasible voltage angle assignment for .
\end{proof}
Iteratively applying Lemma~\ref{lem:decompose-powergrid-cutvertex}
yields the following.
\begin{corollary}
  \label{cor:electrical-feasible-blocks}
  A flow in a native power grid is electrically feasible if and only
  if it is electrically feasible for each biconnected component of the
  power grid.
\end{corollary}

We observe that if  is a forest, then each biconnected component
 consists of a single edge .  Then  and  are feasible voltage angles for any flow 
in . Thus we conclude with the following
\begin{theorem}
  \label{thm:fvs}
  Let  be a native power grid that is a forest.  Then every flow
   is electrically feasible on .
\end{theorem}
Thus, when  is a \emph{feedback vertex set} of , i.e.,  is
a forest, then every flow on  is electrically feasible for ,
and thus any feasible flow for  is electrically feasible for
.  It follows that the flow model and the hybrid model are
equivalent in this case.  In particular, whenever  is a feedback
vertex set, instead of solving the LP for the hybrid model, we can
rather assume the flow model and compute an optimal solution using a,
potentially more efficient, flow algorithm.  It follows from
Theorem~\ref{thm:fvs} that this solution is optimal also in the hybrid
model.

Figure~\ref{fig:barchart-cases-controller} shows for each of our
instances the relative number of vertices necessary to obtain a vertex
cover, a feedback vertex set with respect to forests, and the number
of vertices necessary to obtain full control.  In all instances a
vertex cover is two to three times larger than a feedback vertex set
(for forests) and the vertex set necessary for full control.
Comparing the relative number of controllers for full control with the
size of a feedback vertex sets shows that the number to get an optimal
placement is in many cases smaller than the size of a feedback vertex
set.  Thus, in the optimal solutions, the native power grid does not
always represent a forest, but can also include cycles.  A closer
inspection showed that this is in particular the case for instances
that are operated far from their capacity limits.

We now consider what happens when cycles exist in a native power
grid.  To this end, we start with the simplest case of a power grid
that consists of a single cycle .  We say that two flows  and
 on a network  are \emph{equivalent} if for each vertex
 we have .
\begin{lemma}
  \label{lem:cycle-equivalent-flow}
  Let  be a native power grid that is a cycle.  For every
  flow  there exists a unique equivalent flow  that is
  electrically feasible for .
\end{lemma}
\begin{proof}
  Let  be the vertices of  as they occur along the
  cycle, i.e.,  unless  and  are neighbors on the cycle.
Assume we wish to change the amount of flow
  from  to  by a fixed amount  and obtain an
  equivalent flow.  The net out-flow conservation at the vertices then
  uniquely determines the change of flow along the remaining edges.
  Hence, every flow  equivalent to  is obtained from  by
  choosing some amount  and setting  and , where .

  Now the existence of a suitable offset  and the associated
  feasible voltage angles can be expressed as a linear system of equations.
  Namely, for edge ,  (again using
  ), we have the equation 
   
\iffalse
  \begin{figure*}[t]
    \centering
    
  \end{figure*}
\fi
It is readily seen that the  equations are linearly independent,
and hence a solution exists.  Moreover, dividing each of the equations
by  and summing them up yields , which shows
  that the value  is uniquely determined.
\end{proof}
Note however, that the equivalent flow  whose existence is
guaranteed by Lemma~\ref{lem:cycle-equivalent-flow} does not
necessarily satisfy the capacity constraints. Also the evaluation of
 in terms of line losses may change.  If neither of these is a
limiting factor, e.g., if  and line capacities are
sufficiently large, we can show a stronger version of
Theorem~\ref{thm:fvs}.  Recall that a cactus is a graph where every edge belongs
to at most one cycle.
\begin{theorem}
  \label{thm:cactus}
  Let  be a power grid with flow control buses at the vertices in  such
  that the maximum native power grid  is a cactus  and every edge
  of  that lies on a cycle has infinite capacity. For any feasible flow  
  there exists an equivalent feasible flow 
  that is electrically feasible for .
\end{theorem}
\begin{proof}
  We first construct an equivalent flow  as follows.  For each
  biconnected component  of  that is a cycle, we consider the
  restriction  of  to .  By
  Lemma~\ref{lem:cycle-equivalent-flow}, there exists a unique
   flow  equivalent to  that is electrically
  feasible for .  We now define 
Note that changing in  the flow along the edges of a cycle  to
the values determined by  preserves the net out-flow at every
vertex, and hence  is a flow equivalent to .  We claim that
 is electrically feasible.  To see this, observe that each block
of  is either a single edge or a cycle .  In the former case,
 is trivially feasible on the block.  In the latter, we have that
 coincides on  with , which is electrically feasible.  By
Corollary~\ref{cor:electrical-feasible-blocks}  is electrically
feasible.
\end{proof}
Let  be the edges of a cycle in  and  be a flow on an edge  in cycle . 
We abbreviate the susceptance  on an edge in a cycle by . The maximum susceptance is denoted by  with  for all . 
The minimum susceptance  is defined analogously.
In practice, the requirement for infinite capacity in Theorem~\ref{thm:cactus} is unnecessary. In fact, we 
can bound the sufficient large capacities of Theorem~\ref{thm:cactus} 
by rearrange the equation of the proof of Lemma~\ref{lem:cycle-equivalent-flow} 
such that the change of flow is bounded by the ratio of maximum to minimum susceptance times the average flow in the cycle  that is
 

We refer back to Figure~\ref{fig:barchart-cases-controller}, which in
addition to the previously mentioned parameters also shows the size of
a minimum feedback vertex set with respect to cacti.  In all cases the
number of vertices for full control is between the size of feedback
vertex sets with respect to forests and cacti.  For the cases 14, 57
and 118, the minimum number of controllers for achieving full control
indeed results in a native power grid that forms a cactus, although
they do not necessarily achieve the smallest feedback number due to
some influence of line capacities.
\section{Grid Operation Under Increasing Loads}	
\label{sec:grid-control-when-approaching-capacity-limits}
In the previous section we have seen that typically selecting a small
fraction of the buses as flow control buses suffices to achieve full
control in the network.  In this section we study what happens when
even fewer flow control buses are available and whether few flow control buses
allow a better utilization of the existing infra-structure in the
presence of increasing loads.

To measure the controllability in the presence of very few flow
control buses, we simulate a load increase by a factor~ in the
power grid by decreasing all line capacities by the factor .
This has the effect that the overall demand remains constant and thus
any change of costs is due to flow redirections.  It is then expected
that, once the load increases, the network without flow control buses
will require significantly higher operating costs, since the main
criterion for determining the generator outputs becomes the overall
feasibility of the flow rather than the cost-efficient generation of
the energy.  At some point, the load increases to a level where, by
means of changing only the generator outputs, a feasible energy flow
cannot be found.  We compare the operation costs to solutions in power
grids with a small number of flow control buses.  Specifically, our
plots show two things.  First, the operation costs for various small
numbers of flow control buses and, second, the operation costs and the
number of flow control buses for achieving full control in the network
with respect to the load increase factor~.

Of course these operation costs again vary depending on the value of
.  Since most related work ignores line losses, we consider
only the case , i.e., only generation costs are taken
into account.  Varying  changes the objective value, but it
does not influence the existence of solutions with a certain number of
flow control buses.  Recall from the plot in
Figure~\ref{fig:plot-controller-weight} that, if the load
increase~ is small, full control can be achieved without flow
control buses for .
\begin{figure}[tb!]
  	\centering
    	\includegraphics[width=\plotscaleOne\linewidth, page=7]{figures/plotCapacityReductionVsCostsController.pdf}
	\caption{Operation costs of \texttt{case57} for OPF and the
          hybrid model with  and  control buses with respect to
          the load factor~.}
	\label{fig:plot-capacity-cost-controller}
\end{figure}
In the IEEE instances all lines have very large capacities, often much
larger than even the total demand in the network, e.g., 9900 MW in
\texttt{case14} and \texttt{case57}.  To better highlight the
interesting parts, similar to the work by Lima et
al.~\cite{lgkm-psp-03}, we first scale all line capacities such that
the smallest capacity is equal to the total demand of the consumers as
given in Table~\ref{tab:examples}.  This changes neither the existence
nor the cost of solutions.  We increase the load until the flow model
becomes infeasible; at this point a feasible solution cannot be
achieved by adding flow control buses and adding additional lines to
the network becomes unavoidable.

Figure~\ref{fig:plot-capacity-cost-controller} shows the results of
our experiment for the power grid \texttt{case57}.  To improve
readability, all costs have been rescaled by the total demand in the
network, and thus give the cost per MWh.  The black curve shows the
operation cost with sufficient control buses for full control.  The
dotted staircase curve shows the number of flow control buses that are
necessary to achieve full control.  Moreover, for each number of flow
control buses from~1 up to the number required at the point when
further load increase makes the instance infeasible, we show the
optimal operation costs with this number of flow control buses.
Finally, the bold gray curve shows the operation cost with OPF, i.e.,
without any control buses.  The plots for the other IEEE
instances can be found in
Appendix~\ref{app:grid-control-when-approaching-capacity-limits}.

As expected, increasing loads result in increasing operation costs.
Interestingly, very few control buses suffice for extending the
maximal feasible operation point.  This is emphasized by the curve for
two control buses in Figure~\ref{fig:plot-capacity-cost-controller},
which continues to a load increase of factor~23.09, whereas OPF works
only for up to an increase of roughly 17.27 and exhibits a significant
increase in operation costs at higher loads.  In contrast, when using
flow control buses, the costs start increasing much later and more
moderately.  Interestingly, the solution with one control bus remains roughly
equivalent to the solution with two control buses until shortly before
the end of its feasibility range.  This example shows that control buses
indeed extend the feasible operation point and also decrease the corresponding
operation costs even if there are only very few controllers available.
\section{Conclusion}	
\label{sec:conclusion}
Assuming the existence of special buses that control the flow on all
their incident transmission lines, we have presented a hybrid model
for including some flow control buses.  In this model, we have shown
that relatively few control buses suffice for achieving full control.
Further, we scaled the load of the network and showed that even fewer
flow control buses improve the loadability and have a lower cost
increase compared to OPF.

Our work shows the benefits of augmenting power grids with flow
control devices.  Using our theoretical model, we were able to explain
our empirical observations on controller placement with
graph-theoretical means.  While this also explains previous
observations of Gerbex et al.~\cite{gcg-olmtf-01}, the main drawback
is that the model is based on several strong, simplifying assumptions.

Future work should consider more realistic power grid models both in
terms of the control units, which are placed on transmission lines
rather than buses, and using the AC power grid model.
\bibliographystyle{abbrv}
\bibliography{bibliography/books,bibliography/article,bibliography/internet} 
\clearpage
\appendix
\section{Problem Formulation} \label{app:lp}
In this appendix, we present the problem formulation from Section~\ref{sec:model} as an integer linear program (LP) formulation. In the LP below, we minimize the generation costs  and losses  shown in Equation~\ref{eq:app:objective} under flow and electrical constraints. The main flow constraints comprise the conservation of flow, demand and generation constraints, and capacity constraints shown in Equations~\ref{eq:app:conservation},~\ref{eq:app:demand},~\ref{eq:app:generator} and~\ref{eq:app:capacity}, respectively. Whereas the electrical constraints describe the electrical feasibility shown in Equation~\ref{eq:app:electricalfeasible}. Recall that each consumer  has a power demand  and  is the set of flow control buses.
\begin{figure*}[b!]
\centering

\end{figure*}
\section{Placing Flow Control Buses} \label{app:hybridmodel}
\begin{figure}[H]\begin{subfigure}[t]{.45\textwidth}
  	\centering
    	\includegraphics[width=0.95\linewidth, page=1,trim=0cm 0cm 0cm
        0cm]{figures/plotCostsVsLosses.pdf}
	\label{fig:plot-costs-losses-case6}  
  \end{subfigure}
\hfill
  \begin{subfigure}[t]{.45\textwidth}
  	\centering
    	\includegraphics[width=0.95\linewidth, page=2,trim=0cm 0cm 0cm
        0cm]{figures/plotCostsVsLosses.pdf}
	\label{fig:plot-costs-losses-case9}
\end{subfigure}

\vspace{0.3cm}
\begin{subfigure}[t]{.45\textwidth}
  	\centering
    	\includegraphics[width=0.95\linewidth, page=3,trim=0cm 0cm 0cm
        0cm]{figures/plotCostsVsLosses.pdf}
\end{subfigure}
\hfill
\begin{subfigure}[t]{.45\textwidth}
  	\centering
    	\includegraphics[width=0.95\linewidth, page=5,trim=0cm 0cm 0cm 0cm]{figures/plotCostsVsLosses.pdf}
	\label{fig:plot-costs-losses-case39}
\end{subfigure}

\vspace{0.3cm}
\begin{subfigure}[t]{.45\textwidth}
  	\centering
    	\includegraphics[width=0.95\linewidth, page=6,trim=0cm 0cm 0cm 0cm]{figures/plotCostsVsLosses.pdf}
	\label{fig:plot-costs-losses-case57}
\end{subfigure}
\hfill
\begin{subfigure}[b]{.45\textwidth}
  	\centering
    	\includegraphics[width=0.95\linewidth, page=7,trim=0cm 0cm 0cm 0cm]{figures/plotCostsVsLosses.pdf}
	\label{fig:plot-costs-losses-case118}
\end{subfigure}
\vspace{0cm}
\caption{Trade-off of generator costs and costs of the losses
          depending as  varies from  to .   The square cross marks the solution computed by OPF.}
\end{figure}
\section{Grid Operation Under Increasing Loads}
\label{app:grid-control-when-approaching-capacity-limits}
\begin{figure}[H]
\vspace{-0.4cm}
  \begin{subfigure}[t]{.45\textwidth}
  	\centering
    	\includegraphics[width=0.95\linewidth, page=3]{figures/plotCapacityReductionVsCostsController.pdf}
\label{fig:plot-capacity-cost-controller-case6}
\end{subfigure}
\hfill
\begin{subfigure}[t]{.45\textwidth}
  	\centering
    	\includegraphics[width=0.95\linewidth,
        page=4]{figures/plotCapacityReductionVsCostsController.pdf}
\label{fig:plot-capacity-cost-controller-case9}
\end{subfigure}

\vspace{0.5cm}
\begin{subfigure}[t]{.45\textwidth}
  	\centering
    	\includegraphics[width=0.95\linewidth, page=5]{figures/plotCapacityReductionVsCostsController.pdf}
\label{fig:plot-capacity-cost-controller-case14}
\end{subfigure}
\hfill
\begin{subfigure}[t]{.45\textwidth}
  	\centering
    	\includegraphics[width=0.95\linewidth, page=1]{figures/plotCapacityReductionVsCostsController.pdf}
\label{fig:plot-capacity-cost-controller-case30}
\end{subfigure}

\vspace{0.5cm}
\begin{subfigure}[t]{.45\textwidth}
  	\centering
    	\includegraphics[width=0.95\linewidth, page=2]{figures/plotCapacityReductionVsCostsController.pdf}
\label{fig:plot-capacity-cost-controller-case39}
\end{subfigure}
\hfill
\begin{subfigure}[t]{.45\textwidth}
  	\centering
    	\includegraphics[width=0.95\linewidth, page=6]{figures/plotCapacityReductionVsCostsController.pdf}
	\label{fig:plot-capacity-cost-controller-case118}
\end{subfigure}
\vspace{0cm}
	\caption{Operation costs of \texttt{case6} to \texttt{case118} for OPF and the
          hybrid model with their control buses with respect to
          the load factor~.}
\end{figure}
\end{document}
