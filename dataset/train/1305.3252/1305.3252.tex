
\documentclass[letterpaper, 10 pt, conference]{ieeeconf} 
\IEEEoverridecommandlockouts 


\usepackage{amsmath} \usepackage{amssymb}  \usepackage{color}
\usepackage{enumerate}
\usepackage{graphicx}

\newcommand{\Rn}{\mathbb{R}^n}
\newcommand{\Rp}{\mathbb{R}^p}
\newcommand{\Rq}{\mathbb{R}^q}
\newcommand{\Rmm}{\mathbb{R}^{m\times m}}
\newcommand{\Rm}{\mathbb{R}^{m}}
\newcommand{\Rnn}{\mathbb{R}^{n\times n}}
\newcommand{\Rnm}{\mathbb{R}^{n\times m}}
\newcommand{\C}{\mathbb{C}}
\newcommand{\Hset}{\mathcal{H}}
\newcommand{\Zeta}{\mathcal{Z}}
\newcommand{\dfn}{:=}
\newcommand{\cl}{\textsc{cl}}
\newcommand{\ob}{\textsc{o}}
\newcommand{\va}{{VA}}
\newcommand{\ie}{\textit{i.e.}}
\newtheorem{thm}{Theorem}
\newtheorem{defn}{Definition}
\newtheorem{lem}{Lemma}
\newtheorem{assump}{Assumption}
\newtheorem{alg}{Algorithm}
 
\title{\LARGE \bf Fault-tolerant control under controller-driven
  sampling\\ using virtual actuator strategy*}


\author{Esteban N. Osella, Hernan Haimovich, and Mar\'{\i}a M. Seron\thanks{This work was partially supported by grant PICT 2010-0783, FONCYT-ANPCYT, Argentina.}\thanks{ CIFASIS-CONICET and Departamento de Control, Esc. de Ing. Electr\'onica, FCEIA, Universidad Nacional de Rosario, Argentina. {\tt\small \{osella.esteban,h.haimovich\}@gmail.com}}\thanks{ Centre for Complex Dynamic Systems and Control, The University of Newcastle, Australia.
 {\tt\small maria.seron@newcastle.edu.au}}}

\begin{document}

\maketitle \thispagestyle{empty} \pagestyle{empty}


\begin{abstract}
  We present a new output feedback fault tolerant control strategy for
  continuous-time linear systems. The strategy combines a digital
  nominal controller under controller-driven (varying) sampling with
  virtual-actuator (VA)-based controller reconfiguration to compensate
  for actuator faults.  In the proposed scheme, the controller
  controls both the plant and the sampling period, and performs
  controller reconfiguration by engaging in the loop the VA adapted to
  the diagnosed fault. The VA also operates under controller-driven
  sampling.  Two independent objectives are considered: (a)
  closed-loop stability with setpoint tracking and (b) controller
  reconfiguration under faults. Our main contribution is to extend an
  existing VA-based controller reconfiguration strategy to systems
  under controller-driven sampling in such a way that if objective (a)
  is possible under controller-driven sampling (without VA) and
  objective (b) is possible under uniform sampling (without
  controller-driven sampling), then closed-loop stability and setpoint
  tracking will be preserved under both healthy and faulty operation
  for all possible sampling rate evolutions that may be selected by
  the controller.
\end{abstract}


\section{Introduction}
\label{sec:intro}

Active Fault-Tolerant Control (FTC) systems aim to maintain control
performance levels under a number of fault scenarios, by means of a
controller reconfiguration mechanism. An interesting approach to
controller reconfiguration for FTC is the one based on the concept of
\textit{virtual actuators} (VA) (a complete reference on VA and its
applications and details can be found in
\cite{steffen_controlReconfigurations,lunze_tac06,RiL09,richter_Auto11}). The
main advantage of the VA approach is that it allows the engineer to
design the controller for the nominal (\textit{``healthy''}) plant,
without considering the possible faults. More specifically, the method uses a single nominal controller, designed for the
“healthy” system, which is always present in the
closed-loop system, and a virtual actuator, which introduces an interface
between the plant and the controller taking different
actions according to the evaluated fault situation of the plant. 
In healthy operation the virtual actuator is inactive and the whole
control action is provided by the nominal controller. In faulty
operation the virtual actuator generates additional signals that
combine with the existing signals in specific ways in order to cancel
or mitigate the effect of the fault in the closed-loop system. The
advantage of this approach is that any existing nominal controller
which has been designed to satisfy the desired specifications for the
fault-free plant, can be kept in the loop at all times.
In addition, the design of the virtual actuator (which has to adapt to
each type of detected fault) is independent of the controller and is
aimed at preserving specific closed-loop properties in the presence of
faults as, for example, stability and setpoint tracking.


Currently, many control systems involve some kind of shared network
environment with limited bandwidth. Such systems are usually referred
to as Networked Control Systems (NCS) (see the special issues
\cite{antbal_tac04,antbai_pieee07}). Since the network may be shared
among processes, then sampling and acting over the system while
keeping a constant rate may be difficult because it introduces a
trade-off between requiring too much bandwidth and hence restricting
other processes from accessing the network (sampling at a high rate)
or too little bandwidth and hence reducing control performance
(sampling at a low rate). Thus, much research effort has focused on
designing control strategies for systems under varying sampling rate
(VSR).

In the present paper, we consider a type of VSR where a central
controller may be in charge not only of computing feedback but also of
administering access to the shared network. In this setting, the
controller may perform on-line variations of the sampling rate in
order to accommodate for the bandwidth requirements of the different
processes being controlled. This setting is akin to that described in
\cite{cereke_rts02} and has been addressed in previous work by some of
the authors \cite{haimoose_nahs12, haimo_ifac2011,osehaimo_rpic2011,
  osehaimo_aadeca2012}. In the current work, we combine this specific type of VSR with an extension of the VA-based controller reconfiguration strategy of \cite{seron_bankVA_ifac11} to the VSR setting, yielding a control scheme as illustrated in Figure~\ref{fig:scheme}. In the proposed scheme, the VSR controller is designed for the nominal or fault-free plant, and hence knowledge of the fault scenario is not needed at the control design stage. The fault tolerance mechanism is responsible for achieving correct closed-loop control under faults. This mechanism requires knowledge of the sampling period command ( in Figure~\ref{fig:scheme}) issued by the controller but does not modify the sampling and hold operations. The fault tolerance mechanism considered involves a bank of VAs and a fault detection and isolation (FDI) strategy. Correct closed-loop control under faults is achieved by engaging in the loop the VA from the bank of VAs that is adapted to
the fault diagnosed by the FDI unit. In this paper, we focus on the design and properties of the scheme of Figure~\ref{fig:scheme} to achieve correct setpoint tracking and stability under both nominal and faulty operation, assuming that some FDI strategy is able to correctly diagnose faults. We thus concentrate on controller reconfiguration under faults and leave the integration of an FDI unit as a topic for future work. 
We extend the existing VA-based controller reconfiguration strategy of \cite{seron_bankVA_ifac11} to the VSR case considered, ensuring closed-loop stability and setpoint tracking under nominal and faulty operation regardless of how the VSR controller performs on-line variations of the sampling rate. In this context, our main contribution is to show that the difficulties in this combined scheme are not greater as those for VSR control or uniform-sampling VA-based reconfiguration taken independently.

The proposed scheme can be particularly interesting in circumstances
in which a system with input redundancy is such that its performance
objectives can still be reached under the total loss of some actuators
using a VA technique, and where the tasks related to control and
sampling period selection can be driven by a central controller. 
\begin{figure}[htb]
  \begin{center}
    \begin{picture}(0,0)\includegraphics{schemevavsr.pdf}\end{picture}\setlength{\unitlength}{4144sp}\begingroup\makeatletter\ifx\SetFigFont\undefined \gdef\SetFigFont#1#2#3#4#5{\reset@font\fontsize{#1}{#2pt}\fontfamily{#3}\fontseries{#4}\fontshape{#5}\selectfont}\fi\endgroup \begin{picture}(3357,2859)(169,-2188)
\put(1711,344){\makebox(0,0)[b]{\smash{{\SetFigFont{8}{9.6}{\rmdefault}{\mddefault}{\updefault}{\color[rgb]{0,0,0}Plant}}}}}
\put(1801,-1006){\makebox(0,0)[b]{\smash{{\SetFigFont{8}{9.6}{\rmdefault}{\mddefault}{\updefault}{\color[rgb]{0,0,0}Mechanism}}}}}
\put(1801,-826){\makebox(0,0)[b]{\smash{{\SetFigFont{8}{9.6}{\rmdefault}{\mddefault}{\updefault}{\color[rgb]{0,0,0}Fault tolerance}}}}}
\put(316,-376){\makebox(0,0)[b]{\smash{{\SetFigFont{8}{9.6}{\rmdefault}{\mddefault}{\updefault}{\color[rgb]{0,0,0}}}}}}
\put(2926,-151){\makebox(0,0)[b]{\smash{{\SetFigFont{8}{9.6}{\rmdefault}{\mddefault}{\updefault}{\color[rgb]{0,0,0}}}}}}
\put(1801,-1996){\makebox(0,0)[b]{\smash{{\SetFigFont{8}{9.6}{\rmdefault}{\mddefault}{\updefault}{\color[rgb]{0,0,0}Controller}}}}}
\put(541,-1591){\makebox(0,0)[b]{\smash{{\SetFigFont{8}{9.6}{\rmdefault}{\mddefault}{\updefault}{\color[rgb]{0,0,0}}}}}}
\put(3511,-376){\makebox(0,0)[b]{\smash{{\SetFigFont{8}{9.6}{\rmdefault}{\mddefault}{\updefault}{\color[rgb]{0,0,0}}}}}}
\put(3421,-1591){\makebox(0,0)[b]{\smash{{\SetFigFont{8}{9.6}{\rmdefault}{\mddefault}{\updefault}{\color[rgb]{0,0,0}}}}}}
\put(766,344){\makebox(0,0)[b]{\smash{{\SetFigFont{8}{9.6}{\rmdefault}{\mddefault}{\updefault}{\color[rgb]{0,0,0}Hold}}}}}
\put(901,-151){\makebox(0,0)[b]{\smash{{\SetFigFont{8}{9.6}{\rmdefault}{\mddefault}{\updefault}{\color[rgb]{0,0,0}}}}}}
\put(1981,-1591){\makebox(0,0)[b]{\smash{{\SetFigFont{8}{9.6}{\rmdefault}{\mddefault}{\updefault}{\color[rgb]{0,0,0}}}}}}
\end{picture}     \caption{Considered scheme: a central controller controls both the
    process and the next sampling instant.}
    \label{fig:scheme}
  \end{center}
\end{figure}

The remainder of the paper is organised as follows. In Section \ref{sec:probform}, we more precisely explain and define the problem. In Section \ref{sec:VA}, we show how the controller and virtual actuators must be designed. In Section~\ref{sec:cl-props}, we provide results that establish correct closed-loop operation. A simulation example illustrating successful operation is provided in Section~\ref{sec:example} and conclusions in Section~\ref{sec:conclusions}.


\section{Problem formulation}
\label{sec:probform}
We consider actuator-fault-tolerant output-feedback control of a
continuous-time plant by means of a discrete-time controller, bank of
virtual actuators, and fault detection and isolation (FDI) unit. The
discrete-time controller is designed for the fault-free (healthy)
situation and hence knowledge of the fault scenario is not necessary
at the controller design stage. In addition to computing the control
action assuming fault-free operation, this fault-ignorant controller
is in charge of performing on-line variations of the sampling rate. In
the sequel, we explain the different components of the feedback
control system considered.

\subsection{Continuous-time plant}
\label{sec:ct-plant}

The plant model that we employ is the following:

where ,  is the control input,  is the
plant measured output, and  is a performance output. As in
\cite{seron_bankVA_ifac11} we represent the operability situation of
the  actuators by the matrix , taking values from a
finite set

Under healthy operation, the matrix  in (\ref{eq:ctstates}) takes
the value , so that  in \eqref{eq:ctstates} represents the
``healthy'' plant input matrix. The matrix , ,
models the total loss of the -th actuator. Hence,  is obtained
by setting to  the -th diagonal entry of .  We assume that the pairs  are stabilisable for ,  is detectable, and  is invertible.

The performance output  in (\ref{eq:ctperformance}) and the
different fault situations in (\ref{eq:faults}) must be such that for
every desired constant value  of the performance output and
every fault , there exists a constant input value  so
that the equilibrium state  that corresponds to the constant
input  under fault  is such that , i.e. there exist ,  such that

for all . Condition~\eqref{eq:sstrack} means
that the plant has sufficient levels of redundancy to admit setpoint
tracking in each fault scenario. 
Note that if for a given  and specific fault , no  exists satisfying (\ref{eq:sstrack}), then the performance output
will not converge to  under fault , no matter how
sophisticated the fault tolerance mechanism may be. On the other hand,
the VA fault tolerance mechanism has to be designed so that the
required equilibrium values satisfying~(\ref{eq:sstrack}) are achieved
under all possible fault situations; this will be addressed in detail
in Section~\ref{sec:va-design}.



\subsection{Fault-ignorant varying-sampling-rate controller}
\label{sec:fault-ign-contr}

As previously explained, knowledge of the fault scenario is not needed
at the controller design stage. Consequently, controller design is
independent of virtual actuator design. We consider a
healthy-plant-model-based reference-tracking sampled-data controller
given by

where  represents the controller-computed plant input signal,
 is the plant output signal supplied to the controller,
 are state and input constant reference signals,
respectively, and ,  are the current and successor
states of the observer~\eqref{eq:internalmod}.
The matrices  and  are the discrete-time
equivalents of  and  in (\ref{eq:ctstates}), corresponding to a sampling period ,

The controller may perform on-line variations of the sampling period
, under the constraint that all possible sampling periods are taken
from a finite set:

where every  should be non-pathological (see \cite{ChF95}
for further details on pathological sampling). The feedback and
observer gains  and  employed by the controller may depend
on the sampling period selected. The computation of these gains will
be explained in Section~\ref{sec:contr-des}. If no fault tolerance
mechanism were present, the plant input  would equal the
controller-computed plant input  and the plant output supplied to
the controller, , would equal the true plant output, , at all
sampling instants. In the presence of the fault tolerance mechanism
discussed in the current paper, the equalities  and 
will be true only under nominal (healthy) conditions and provided the
fault tolerance mechanism accurately detects that the plant is under
healthy operation. 
\subsection{Nominal plant-controller feedback loop}
\label{sec:nom-plant-contr}

As explained previously, in the considered scenario the controller
does not only apply control, but also determines the sampling instants
(based, for example, on the states of the processes and/or
restrictions over the network). Under nominal conditions, at instant
 the controller receives the sample  and processes it in
order to compute the required feedback action. To do so, it also
determines the instant , with , at which it will take the next sample and control
action. The plant dynamics at the sampling instants can be written as

where  and  are defined in~\eqref{eq:aibi}, ,
, and  (the \textit{successor} state).

We observe that if constant reference signals  and 
satisfy condition \eqref{eq:reference} for the continuous-time plant, then the same  and  satisfy

for all . 
To see this, premultiply  in \eqref{eq:aibi} by , producing

Since  is invertible and commutes with , then for every

  
Next, we write

from which (\ref{eq:dtnomss}) is obtained. 

Since the controller may perform on-line variations of the sampling period, the discrete-time system (\ref{eq:dtsys}), obtained by looking at the continuous-time plant only at the sampling instants can be regarded as a \emph{Discrete-Time Switched System}
(DTSS). Since the sequence of sampling periods selected by the controller is
arbitrary (that is, we do not require a priori knowledge on rules for
this selection), we are interested in establishing closed-loop properties (such as stability and setpoint tracking) that hold irrespective of such sequence. In switched systems terminology, we are interested in establishing closed-loop properties that hold under \emph{arbitrary switching} (see, e.g. \cite{showir_siamrev07,lin09:_stabil}). System design in order to achieve the required closed-loop properties under arbitrary switching will be addressed in Section~\ref{sec:VA}.



\subsection{Bank of virtual actuators}
\label{sec:bank-va}

As in \cite{seron_bankVA_ifac11}, we consider a bank of VAs where each of the VAs in the bank is designed to compensate for a specific actuator fault.
The VA corresponding to the -th fault situation  is given by

The variable  represents the -th VA internal state, 
is the -th VA plant input signal and  the -th VA output to
be supplied to the controller. How  and  relate to the true
plant input  and the true output supplied to the controller 
is explained in Section~\ref{sec:sw-logic}. The 0-th VA corresponds to
nominal operating conditions (healthy or fault-free) and has

for all sampling periods . For , the VAs' internal
matrices  and  may depend on the sampling period 
selected by the controller. The design of  and  is
explained in Section~\ref{sec:va-design}. For future reference, note
that substitution of (\ref{eq:ui}) into (\ref{eq:vadyn}) yields

that is, the dynamics of each VA is driven by the controller-computed
plant input signal, .


\subsection{FDI and controller reconfiguration mechanism} \label{sec:sw-logic}

Controller reconfiguration is achieved through a selector that, in
response to the diagnosed fault situation, interconnects the
appropriate virtual actuator from the bank of virtual actuators with
the controller and the plant.

When an FDI mechanism (not described here) detects that the -th
fault has occurred, the -th virtual actuator is interconnected with
the controller and plant by making  and . Hence,
whenever the FDI diagnoses that the plant is under healthy operation,
the selector will set  and . The reconfiguration also
resets the 0-th virtual actuator state  to zero whenever
healthy operation is detected.

Under the above considerations, we next show that if the plant is
under healthy operation and if the FDI mechanism successfully assesses
the plant's healthy condition, then the plant and controller feedback
loop will operate as if the bank of virtual actuators and
reconfiguration mechanism were not present. From (\ref{eq:ui}) and
(\ref{eq:mn0}), then . Therefore, if at time  the FDI
mechanism detects that healthy operation is restored, then  according to the virtual actuator state reset condition, 
from (\ref{eq:ytheta}), and it follows that  and
 at time . If the plant continues under healthy
operation and the FDI mechanism continues to successfully assess the
plant's healthy condition, then from (\ref{eq:vadyn}) it follows that
 and  and  will continue to
hold for time instants  until either a fault occurs or the
FDI mechanism ceases to successfully diagnose the plant's condition.


\section{Controller and virtual actuator design}
\label{sec:VA}

The controller and bank of virtual actuators must be designed so that
the performance output  [see (\ref{eq:ctperformance})] is able to
track a constant reference in closed loop, even if faults occur, and
so that all closed-loop variables remain bounded.

\subsection{Controller design}
\label{sec:contr-des}


Controller design involves the appropriate selection of the matrices
 and  in (\ref{eq:unominal})--(\ref{eq:internalmod}). In
order for the desired closed-loop properties to hold irrespective of
the sampling period sequence selected by the VSR controller, the
matrices  and  should be selected so that the closed-loop
matrices

make the sets  and  stable under arbitrary switching. Stability under
arbitrary switching is equivalent to the existence of a Lyapunov
function common to every matrix in the corresponding sets (see,
e.g. \cite{showir_siamrev07,lin09:_stabil}). In general, this common
Lyapunov function may be not quadratic.


If  and  exist so that the closed-loop matrices (\ref{eq:ahcl}) on the one hand, and (\ref{eq:aho}) on the other, share a common \emph{quadratic} Lyapunov function (CQLF) for all , then  and  can be computed via linear matrix inequalities (LMIs) (see, e.g. \cite{daafouz02_stabil,sala05_vsrlmi}). 


In some cases,  and  can be found so that not only CQLFs
exist, but also additional properties hold for the closed-loop
matrices (\ref{eq:ahcl}) and (\ref{eq:aho}). One such case is when
invertible  and  exist so that  and  are upper triangular for all
 (solvable Lie algebra case). Several works address the
computation of  (and ) so that this simultaneous
triangularization is achieved for  (and ) for
general switched linear systems
\cite{haibra_cdc09,haibra_tac10,haimobras_2010} and specifically for
cases as the current one, where  and  arise from sampling a
single continuous-time systems at different rates
\cite{haimo_ifac2011,osehaimo_rpic2011,haimoose_nahs12,osehaimo_aadeca2012}. Several
facts make this apparently more restrictive design criterion appealing
in the current context because the chances of successful computation
of  and  increase when either:
\begin{itemize}
\item the DTSS arises from sampling a single continuous-time system at
  different rates
  \cite{haimo_ifac2011,osehaimo_rpic2011,haimoose_nahs12,osehaimo_aadeca2012},
\item the system has many inputs \cite{haibra_aucc11,haibra_rpic11,HB_TAC2013}.
\end{itemize}
Note that both these situations occur in the current case, the second
one because input redundancy is required for successful trajectory
tracking in the presence of total actuator loss, as explained in
Section~\ref{sec:ct-plant}.









\subsection{Virtual actuator features and design}
\label{sec:va-design}

The bank of VAs, as defined in (\ref{eq:vadyn})--(\ref{eq:ytheta}),
jointly with the controller reconfiguration mechanism endow the
feedback loop with specific features when the plant's fault situation
has been correctly diagnosed. One of these features is known as
``fault hiding'' because the controller variables  and  are
related in such a way as if a plant under nominal conditions were
connected to the controller.  In order to see this feature, define

and write, using \eqref{eq:vadyn} and \eqref{eq:dtsys},

When the plant fault situation is correctly diagnosed, we have
,  and . From the latter equalities,
(\ref{eq:ctoutput}), (\ref{eq:ytheta}) and (\ref{eq:xidyn}), it
follows that

Eqs.~(\ref{eq:ximatched})--(\ref{eq:yc}) show that the controller
effectively sees a nominal plant, whose state is  instead of
.

A second feature of the bank of VAs and switching mechanism is that
the desired setpoint  for the performance output  defined
in~\eqref{eq:ctperformance} should be preserved for all fault
situations and sampling period variations, provided the plant fault
situation is correctly diagnosed. In closed loop, the boundedness of
all variables and the tracking of the desired setpoint  are
achieved by ensuring the following:
\begin{enumerate}[a)]
\item the controller-computed plant input  converges to the
  steady state value , \label{item:ucuref}
\item the VA state vector  converges to a constant
  steady-state value , \label{item:xthetass}
\item Under fault , the plant state  and input  both converge to steady-state values  and  (independent of ) and satisfy  (\ref{eq:sstrack}).\label{item:uibar}
\end{enumerate}
In Section~\ref{sec:cl-props} we will show that
items~\ref{item:ucuref})--\ref{item:uibar}) above will be true if we
select the matrices  and  as explained next.

The matrices  should be selected so that for every , the matrices in the set ,
with  as in (\ref{eq:Aih}), are stable under arbitrary
switching. The latter can be achieved using, for example, LMI- or
Lie-algebraic-solvability-based methods, as mentioned in
Section~\ref{sec:contr-des}, and implies that every  is Schur.


Once the  are designed, select one sampling period 
and compute

where  denotes the Moore-Penrose generalised inverse. For
every other sampling period , select the corresponding
 as follows:

The following result concerning the expression for  above will
be required in Section~\ref{sec:cl-props}.
\begin{lem}
  \label{lem:imAihBh}
  Let  and . Then,
  
\end{lem}
\begin{proof}
  Using \eqref{eq:Aih} and \eqref{eq:idahbh}, it follows that

  whence (\ref{eq:IdAihBh}) follows.
\end{proof}

In the next section, we show that if the  and  are
selected as previously explained, then items
\ref{item:ucuref})--\ref{item:uibar}) above will be ensured and the
closed-loop system will successfully track the desired setpoint
 under both nominal and faulty conditions, even when the VSR
controller performs on-line variations of the sampling period.

\section{Closed-loop properties under VSR}
\label{sec:cl-props}
In this section, we present the main results of the paper. These results are given below as Theorems~\ref{thm:ucbar}, \ref{thm:VAstateconv} and \ref{thm:1}. Each theorem establishes the validity of one of the items~\ref{item:ucuref})--\ref{item:uibar}) detailed in Section~\ref{sec:va-design}, under the design conditions and assumptions explained in Sections~\ref{sec:probform} and~\ref{sec:VA}. These
results ensure the appropriate operation of the VA for the considered
VSR case, by ensuring the boundedness of all closed-loop variables and the convergence of the performance output to the desired reference value under persistent faults.

\subsection{Control-computed plant input convergence}
\label{sec:convergence}
To proceed with our first main result, let us define the following
observer and tracking errors

with  as in (\ref{eq:xidef}), and express the
controller-computed plant input  in (\ref{eq:unominal}) as

We next establish item~\ref{item:ucuref}) of
Section ~\ref{sec:va-design}. This is done in the following Theorem.
\begin{thm}
  \label{thm:ucbar}
  Consider the continuous-time plant
  (\ref{eq:ctstates})--(\ref{eq:ctoutput}) with VSR controller
  (\ref{eq:unominal})--(\ref{eq:reference}) and bank of VAs
  (\ref{eq:vadyn})--(\ref{eq:mn0}). Suppose that there exist feedback
  matrices  and observer-gain matrices  as requested in
  \ref{sec:contr-des}. If the plant's fault
  condition is persistent and successfully diagnosed by the FDI unit, then
  \begin{enumerate}[i)]
  \item the combined plant-VA state  in (\ref{eq:tildexi}),
    where  identifies the plant's fault condition, converges to the
    steady-state value , and so does the observer
    state .\label{item:xitzetaconv}
  \item the controller-computed plant input  converges to the
    steady-state value .\label{item:ucconv}
  \end{enumerate}
\end{thm}
\begin{proof}
  The equality (\ref{eq:ucthetazeta}) is valid for all
  .  Using
  \eqref{eq:unominal}--\eqref{eq:internalmod},
  \eqref{eq:xrefurefrelation}, \eqref{eq:xidef}, and \eqref{eq:yc}, we
  obtain
  
  By hypothesis, the FDI unit correctly diagnoses the plant's fault
  condition and hence interconnects the -th VA with the controller and plant (, , ). The error dynamics 
  \eqref{eq:ximod}--\eqref{eq:zetamod} hence become
  
  Since both  and  are stable under arbitrary
  switching, then
  
  which establishes \ref{item:xitzetaconv}). From
  \eqref{eq:ucthetazeta}, then
  
  which establishes \ref{item:ucconv}). Note that both \eqref{eq:lim0}
  and \eqref{eq:ucbaruref} are true for every possible evolution of
  the sampling periods  (even when varied on-line).
\end{proof}

\subsection{VA state convergence}
\label{sec:const-ss-vsr}
The convergence of the VA state, as per item~\ref{item:xthetass}) of
Section~\ref{sec:va-design}, is established in
Theorem~\ref{thm:VAstateconv} below. We require the following
auxiliary result.
\begin{lem}
  \label{lem:nihprops}
  Consider the matrices  as defined in \eqref{eq:Xih}. Suppose
  that the continuous-time system matrices ,  are such that
   are stabilisable for , and for each
  fault matrix  there exist constant values  and  satisfying (\ref{eq:sstrack}). Then, .
\end{lem}
\begin{proof} The existence of constant values  and  satisfying~\eqref{eq:sstrack} is equivalent to the condition
  that the matrix  has rank .  Under non-pathological sampling  the latter rank condition implies (see, e.g., the
  proof of Lemma~IV.3 in~\cite{jemdav_tac03})\footnote{For clarity, in
    this proof we use a subindex to indicate the dimensions of the
    identity matrices, that is,  denotes the  identity
    matrix.}
  
  Correct design of  (recall Section~\ref{sec:va-design})
  implies that  defined in~\eqref{eq:Aih} is Schur; then
   is invertible and we can write
  
  where  is defined in
  \eqref{eq:Xih}.  Since the first and third matrices on the left hand
  side (LHS) of \eqref{eq:2} are invertible, it follows (using
  Sylvester's inequality and properties of the matrix rank) that the
  rank of the second matrix on the LHS is equal to the rank of the
  matrix on the right hand side of \eqref{eq:2}.  Using~\eqref{eq:1}
  we then have , that is,  has full
  row rank.  Thus, its Moore-Penrose generalised inverse
   exists
  and satisfies . The result
  then follows.
\end{proof}
\vspace{5mm} 

We are now ready to establish item~\ref{item:xthetass})
of Section \ref{sec:va-design}.
\begin{thm}
  \label{thm:VAstateconv}
    Under the hypotheses of Theorem~\ref{thm:ucbar}, consider the
    performance output \eqref{eq:ctperformance}, and
suppose that for each fault matrix , , there
    exist constant values  and  satisfying
    \eqref{eq:sstrack}, and matrices  so that , with  as in \eqref{eq:Aih}, is stable under
    arbitrary switching. If  are selected as explained in
    Section~\ref{sec:va-design} and if the plant's fault condition is
    persistent and successfully diagnosed by the FDI unit, then
    
\end{thm}
\begin{proof}
  From Theorem~\ref{thm:ucbar}-\ref{item:ucconv}), we know that . Let  denote the equilibrium value of
  the VA state  if a constant sampling period  were kept
  by the controller. Solving from (\ref{eq:vadynsub}) and using
  (\ref{eq:Pi}), we can write
  
  We next show that  is independent of .  Let 
  be the sampling period selected for the computation of  as
  in (\ref{eq:firstnih}). Using \eqref{eq:Pi} and
  Lemma~\ref{lem:imAihBh}, we can write
  
  for all . Replacing  by the expression
  \eqref{eq:Nselect}, adding  inside the square
  brackets, and operating, yields
  A+BF_iM_i^{h'})P_i^{h'}\big].
  
     P_i^{h} = -(A+BF_iM_i^{h})^{-1} [- (A+BF_i M_i^{h})P_i^{h'}] = P_i^{h'},
  
    \label{eq:deltatheta}
     \Delta \theta_i &:=  \theta_i - \bar\theta_i \\
     \Delta u_c &:= u_c - \bar u_c = u_c - u_{ref}.
  
    \Delta\theta_i^+ = A_i^h \Delta\theta_i + B^h (I-F_i N_i^h) \Delta u,
  
    C_v P_i = C_v P_i^{h'} = \left(I - X_i^h \big[X_i^h\big]^\dagger \right) C_v (I-A_i^h)^{-1} B^h.
  
   \lim_{k\to\infty} x = \bar x_i \quad\text{and}\quad
   \lim_{k\to\infty} v = v_{ref}.
 
    \lim_{k\to\infty} v = C_v \bar x_i = C_v x_{ref} - C_v \bar
    \theta_i = v_{ref},
  
  \dot{x} &= Ax+BFu\\
  y &= x, \quad  v = C_vx

  A\dfn 
  \begin{pmatrix}
    -0.25 & 0\\0.25 & -0.25
  \end{pmatrix},\quad & B \dfn
  \begin{pmatrix}
    1 & -0.5\\0& 0.5
  \end{pmatrix}\\
  C_v \dfn&
  \begin{pmatrix}
    0 & 1
  \end{pmatrix}

  F\in\mathcal{F} \dfn \left\{
  \begin{pmatrix}
    1 & 0\\ 0 & 1
  \end{pmatrix},\:   \begin{pmatrix}
    1 & 0\\ 0 & 0
  \end{pmatrix} \right\}.

  \mathcal{H} \dfn \{ 0.1, \:0.05,\: 0.025\}.

  K^{h_1} = 
  \left(\begin{smallmatrix}  
    9.99  &  9.75\\
    -6.14\times 10^{-2} &  -5.99\times 10^{-2}
  \end{smallmatrix} \right),\\
 K^{h_2} =\left(
\begin{smallmatrix}
  19.99 &  19.75\\
  -6.19\times 10^{-2} &  -6.12\times 10^{-2}
\end{smallmatrix} \right)\\
K^{h_3} =\left(
\begin{smallmatrix}
  39.99  & 39.75\\
  -6.21\times 10^{-2}  & -6.18\times 10^{-2}
\end{smallmatrix} \right)

M_2^{h_1} =-\left(
\begin{smallmatrix}
   11.23&  107.99\\
         0&         0
\end{smallmatrix} \right),& \quad
M_2^{h_2} =-\left(
\begin{smallmatrix}
   21.34 & 233.18\\
         0 &        0
\end{smallmatrix} \right)\\
M_2^{h_3} &=-\left(
\begin{smallmatrix}
   41.39 &485.57\\
    0& 0\end{smallmatrix} \right).

    N_2^{h_1} &=\left(
\begin{smallmatrix}
    1.00  & 22.46\\
    0       &  0
\end{smallmatrix} \right)\\
    N_2^{h_2}  &=\left(
\begin{smallmatrix}
    1.00&    2.25\\
    0     &    0\end{smallmatrix} \right)\\
    N_2^{h_3}  &=\left(
\begin{smallmatrix}
    1.00&  -37.86\\
    0   &      0\end{smallmatrix} \right)
  
  Since , we can choose .

  In order to test the reference tracking properties, we change the
  reference from  to , and while the
  plant is reaching the new setpoint, we simulate the considered
  actuator fault; after a second setpoint change for  from 0.05
  to 0, we simulate the actuator restitution to the healthy
  situation. The resulting responses are shown in Figure
  \ref{fig:example}. Observe that, in both situations the controller
  always tracks the reference provided the VA matches the fault. Also
  observe that, since during the fault the only active actuator is the
  pump, then the only way to keep the level of the second tank at 0.05
  is by increasing , the level in the first tank, as shown by the
  blue curve in the top plot of Figure \ref{fig:example}. The fault
  index and the selected sampling period index variation are shown in
  the bottom plot of Figure \ref{fig:example}. We used \cite[Algorithm
    1]{haimobras_2010} setting a closed loop eigenvalue at zero, and
  hence, the response may be aggressive and differ from the one in
  \cite{steffen_controlReconfigurations}.
\begin{figure}[htb]
  \begin{center}
    \begin{picture}(0,0)\includegraphics{ex_compossed.pdf}\end{picture}\setlength{\unitlength}{4144sp}\begingroup\makeatletter\ifx\SetFigFont\undefined \gdef\SetFigFont#1#2#3#4#5{\reset@font\fontsize{#1}{#2pt}\fontfamily{#3}\fontseries{#4}\fontshape{#5}\selectfont}\fi\endgroup \begin{picture}(3555,3600)(46,-2761)
\put(1801,-871){\makebox(0,0)[lb]{\smash{{\SetFigFont{8}{9.6}{\rmdefault}{\mddefault}{\updefault}{\color[rgb]{0,0,0}time [s]}}}}}
\put(1801,-2581){\makebox(0,0)[lb]{\smash{{\SetFigFont{8}{9.6}{\rmdefault}{\mddefault}{\updefault}{\color[rgb]{0,0,0}time [s]}}}}}
\put(361,-106){\rotatebox{90.0}{\makebox(0,0)[b]{\smash{{\SetFigFont{8}{9.6}{\rmdefault}{\mddefault}{\updefault}{\color[rgb]{0,0,0}level [m]}}}}}}
\put(361,-1726){\rotatebox{90.0}{\makebox(0,0)[b]{\smash{{\SetFigFont{8}{9.6}{\rmdefault}{\mddefault}{\updefault}{\color[rgb]{0,0,0}Index}}}}}}
\put(811,-2131){\makebox(0,0)[lb]{\smash{{\SetFigFont{8}{9.6}{\rmdefault}{\mddefault}{\updefault}{\color[rgb]{0,0,0}Fault}}}}}
\put(811,-2041){\makebox(0,0)[lb]{\smash{{\SetFigFont{8}{9.6}{\rmdefault}{\mddefault}{\updefault}{\color[rgb]{0,0,0}}}}}}
\put(1621,-601){\makebox(0,0)[lb]{\smash{{\SetFigFont{8}{9.6}{\rmdefault}{\mddefault}{\updefault}{\color[rgb]{0,0,0}Fault}}}}}
\put(2476,389){\makebox(0,0)[lb]{\smash{{\SetFigFont{8}{9.6}{\rmdefault}{\mddefault}{\updefault}{\color[rgb]{0,0,0}Restitution}}}}}
\put(766,-331){\makebox(0,0)[lb]{\smash{{\SetFigFont{8}{9.6}{\rmdefault}{\mddefault}{\updefault}{\color[rgb]{0,0,0}}}}}}
\put(766,-421){\makebox(0,0)[lb]{\smash{{\SetFigFont{8}{9.6}{\rmdefault}{\mddefault}{\updefault}{\color[rgb]{0,0,0}}}}}}
\put(766,-241){\makebox(0,0)[lb]{\smash{{\SetFigFont{8}{9.6}{\rmdefault}{\mddefault}{\updefault}{\color[rgb]{0,0,0}}}}}}
\end{picture}     \caption{Tank levels with a fault in the second actuator occurring
      while the states track a setpoint change, and restitution to the
      healthy situation while the setpoint change is reversed (top
      plot). Sequence of active sampling period index and fault
      indexes (bottom plot).}
    \label{fig:example}
  \end{center}
\end{figure}

\section{Conclusions}
\label{sec:conclusions}
In this paper we have presented a new approach for the virtual
actuator technique under varying sampling rate control systems.  In
this approach, the controller is in charge of both providing the
control action and administering the sampling periods, taken from a
finite set. The considered fault scenario consists of abrupt actuator
outages and we have assumed that correct fault detection and isolation
is provided externally.
The main results of this paper show that in steady state, the control
input will achieve its desired constant reference value, the VA states
will converge to a constant value (irrespective of the sampling period
used, and the variations on it), and the desired constant setpoint
tracking objective is ensured for the performance variable.
The considered approach can be of particular interest for plants with
input redundancy controlled using a NCS. Future work will focus on the
design of an automatic fault detection and isolation method for the
current approach.


\bibliographystyle{plain} 
\begin{thebibliography}{10}

\bibitem{antbal_tac04}
P.~Antsaklis and J.~Baillieul.
\newblock {Guest Eds.} {S}pecial issue on networked control systems.
\newblock {\em IEEE Trans. on Automatic Control}, 49(9), 2004.

\bibitem{antbai_pieee07}
P.~Antsaklis and J.~Baillieul.
\newblock {Guest Eds.} {S}pecial issue on technology of networked control
  systems.
\newblock {\em Proc. of the IEEE}, 95(1), 2007.

\bibitem{cereke_rts02}
A.~Cervin, J.~Eker, B.~Bernhardsson, and K.-E. Arz\'en.
\newblock Feedback-feedforward scheduling of control tasks.
\newblock {\em Real-Time Systems}, 23:25--53, 2002.

\bibitem{ChF95}
T.~Chen and B.A. Francis.
\newblock {\em Optimal sampled-data control systems}.
\newblock Springer-Verlag, 1995.

\bibitem{daafouz02_stabil}
J.~Daafouz, P.~Riedinger, and C.~Iung.
\newblock Stability analysis and control synthesis for switched systems: A
  switched {Lyapunov} function approach.
\newblock {\em IEEE Trans. on Automatic Control}, 47 No. 11:1883--1887, 2002.

\bibitem{haimobras_2010}
H.~Haimovich and J.H. Braslavsky.
\newblock Feedback stabilization of switched systems via iterative approximate
  eigenvector assignment.
\newblock In {\em 49th IEEE Conf. on Dec. and Control, Atlanta, GA, USA}, pages
  1269--1274, 2010.
\newblock Available at \texttt{arxiv.org}, doi arXiv:1009.2032.

\bibitem{haibra_aucc11}
H.~Haimovich and J.H. Braslavsky.
\newblock Conditions for the genericity of feedback stabilisability of
  discrete-time switching systems based on {L}ie-algebraic solvability.
\newblock In {\em Australian Control Conf., Melbourne, Australia}, 2011.

\bibitem{haibra_rpic11}
H.~Haimovich and J.H. Braslavsky.
\newblock Sufficient conditions for the genericity of feedback stabilisability
  of switching systems via {Lie}-algebraic solvability.
\newblock In {\em XIV Reuni\'on de Trabajo en Procesamiento de la Informaci\'on
  y Control (RPIC), Oro Verde, Entre R\'{\i}os, Argentina}, pages 346--351,
  2011.
\newblock Extended version available as arxiv.org:1109.3070v1{[cs.SY]}.

\bibitem{HB_TAC2013}
H.~Haimovich and J.H. Braslavsky.
\newblock Sufficient conditions for generic feedback stabilizability of
  switching systems via {L}ie-algebraic solvability.
\newblock {\em IEEE Trans. on Automatic Control}, 58(3):814--820, 2013.

\bibitem{haibra_cdc09}
H.~Haimovich, J.H. Braslavsky, and F.~Felicioni.
\newblock On feedback stabilisation of switched discrete-time systems via
  {L}ie-algebraic techniques.
\newblock In {\em 48th IEEE Conf. on Dec. and Control, Shanghai, China}, pages
  1118 -- 1123, 2009.

\bibitem{haibra_tac10}
H.~Haimovich, J.H. Braslavsky, and F.~Felicioni.
\newblock Feedback stabilisation of switching discrete-time systems via
  {L}ie-algebraic techniques.
\newblock {\em IEEE Trans. on Automatic Control}, 56(5):1129--1135, 2011.

\bibitem{haimoose_nahs12}
H.~Haimovich and E.~Osella.
\newblock On controller-driven varying-sampling-rate stabilization via
  {Lie}-algebraic solvability.
\newblock {\em Nonlinear Analysis: Hybrid Systems - available at
  {http://dx.doi.org/10.1016/j.nahs.2012.04.001}}, 2012.

\bibitem{haimo_ifac2011}
H.~Haimovich, E.~N. Osella, and J.~H. Braslavsky.
\newblock On {Lie}-algebraic-solvability-based feedback stabilization of
  systems with controller-driven sampling.
\newblock In {\em IFAC World Congress, Milano, Italy}, pages 8731--8736, 2011.

\bibitem{jemdav_tac03}
L.B. Jemaa and E.J. Davison.
\newblock Performance limitations in the robust servomechanism problem for
  discrete-time {LTI} systems.
\newblock {\em IEEE Trans. on Automatic Control}, 48(8):1299--1311, 2003.

\bibitem{lin09:_stabil}
H.~Lin and P.~J. Antsaklis.
\newblock Stability and stabilisability of switched linear systems: a survey of
  recent results.
\newblock {\em IEEE Trans. on Automatic Control}, 54(2):308--322, February
  2009.

\bibitem{lunze_tac06}
J.a Lunze and T~Steffen.
\newblock Control reconfiguration after actuator failures using disturbance
  decoupling methods.
\newblock {\em IEEE Transactions on Automatic Control}, 51(10):1590--1601,
  2006.

\bibitem{osehaimo_rpic2011}
E.~Osella and H.~Haimovich.
\newblock Sufficient {Lie-algebraic-solvability-based} conditions for
  stabilization of {VSR-DTSSs} with two unstable eigenvalues.
\newblock In {\em XIV Reuni\'on de Trabajo en Procesamiento de la Informaci\'on
  y Control - Oro Verde, Argentina}, pages 863--868, 2011.

\bibitem{osehaimo_aadeca2012}
E.~Osella and H.~Haimovich.
\newblock An output feedback stabilization method for systems with
  controller-driven sampling.
\newblock In {\em 23º Congreso Argentino de Control {Automático} (AADECA),
  Buenos Aires, Argentina}, 2012.

\bibitem{RiL09}
J.H. Richter and J.~Lunze.
\newblock {-based } virtual actuator synthesis for optimal trajectory
  recovery.
\newblock In {\em Preprints of the 7th IFAC Symposium on Fault Detection,
  Supervision and Safety of Technical Processes (SafeProcess'09)}, Barcelona,
  Spain, 2009.

\bibitem{richter_Auto11}
J.H.a Richter, W.P.M.H.b Heemels, N.b Van De~Wouw, and J.c Lunze.
\newblock Reconfigurable control of piecewise affine systems with actuator and
  sensor faults: Stability and tracking.
\newblock {\em Automatica}, 47(4):678--691, 2011.

\bibitem{sala05_vsrlmi}
A.~Sala.
\newblock Computer control under time-varying sampling period: an {LMI}
  gridding approach.
\newblock {\em Automatica}, 41(12):2077--2082, 2005.

\bibitem{seron_bankVA_ifac11}
M.~M. Seron, J.~{De Don\'a}, and Jan~H. Richter.
\newblock Bank of virtual actuators for fault tolerant control.
\newblock In {\em 18th IFAC World Congress Milano (Italy) August 28 - September
  2}, 2011.

\bibitem{showir_siamrev07}
R.~Shorten, F.~Wirth, O.~Mason, K.~Wulff, and C.~King.
\newblock Stability criteria for switched and hybrid systems.
\newblock {\em SIAM Review}, 49(4):545--592, 2007.

\bibitem{steffen_controlReconfigurations}
Thomas Steffen.
\newblock {\em Control Reconfiguration of Dynamical Systems}.
\newblock Springer Berlin Heidelberg, 2005.

\end{thebibliography}


\end{document}
