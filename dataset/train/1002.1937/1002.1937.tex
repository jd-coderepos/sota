In this section, we present the results from one example.  Although the results
from one example cannot be generalized, we are able to capture the different
behaviors of the homotopy under the four topologies (square, sphere, torus, and 
Klein bottle).  In the subsequent examples, $\M$ is a square closed region of 
$\R^2.$    The functions  $f$ and $g$ are approximated by a $101 \times 101$ 
mesh.  We obtain the function values from two gray-scale images of a bird and 
a flower respectively, as shown in \figref{fig:htpyImages}.  The difference 
$u_0=g-f$ is computed.  From here, we will find a homotopy from $u_0$ to the 
zero function.  We note that this homotopy differs from the one previously
defined, since we do not add $f$ to the heat equation solution.
In practice, we found that this homotopy more clearly displays the behavior of the
heat equation.
\begin{figure}[ht] \centering
	\subfigure[Bird]{
	\includegraphics[height=1in]{figures/matlab/bird.eps}
	\label{fig:bird}
	}
	\subfigure[Flower]{
	\includegraphics[height=1in]{figures/matlab/flower.eps}
	\label{fig:flower}
	}
	\subfigure[Difference]{
	\includegraphics[height=1in]{figures/matlab/diff.eps}
	\label{fig:diff}
	}
	\caption[Images of the Homotopy]{The homotopy acts on the difference
                between the image of the bird and the image of the flower.
                The grayscale values of the image of the difference represent
                the values of the height functionã€€\ $u_0$.  In the images,
                the dark pixels correspond to the low values and the light
                pixels correspond to the high values.
                }\label{fig:htpyImages}
\end{figure}
\begin{figure}[hbt] \vspace*{0.1in}
 \centering
 \centerline{\epsfig{figure=figures/matlab/persistenceDgms/diff.eps,height=2.5in}}
 \caption{The persistence diagram of the difference function.  This is the diagram
          at Step $0$ of the heat equation under the square topology.  The
          possible values are the integers in ~$[-255,255]$.  The blue
          star drawn at height $300$ represents the essential homology class.}
 \label{fig-01:Sumi}
\end{figure}

\begin{figure}[ht]
	\centering
	\subfigure[Step 1]{
	\includegraphics[width=.3\textwidth]{figures/matlab/persistenceDgms/square-step1.eps}
	\label{fig:dgm-square-step1}
	}
	\subfigure[Step 10]{
	\includegraphics[width=.3\textwidth]{figures/matlab/persistenceDgms/square-step10.eps}
	\label{fig:dgm-square-step10}
	}
	\subfigure[Step 100]{
	\includegraphics[width=.3\textwidth]{figures/matlab/persistenceDgms/square-step100.eps}
	\label{fig:dgm-square-step100}
        }
	\caption[Torus Boundary]{Persistence diagrams for the heat equation using
                 square topology.
                }\label{fig:dgm-square}
\end{figure}
\begin{figure}[ht]
	\centering
	\subfigure[Step 1]{
	\includegraphics[width=.3\textwidth]{figures/matlab/persistenceDgms/torus-step1.eps}
	\label{fig:dgm-torus-step1}
	}
	\subfigure[Step 10]{
	\includegraphics[width=.3\textwidth]{figures/matlab/persistenceDgms/torus-step10.eps}
	\label{fig:dgm-torus-step10}
	}
	\subfigure[Step 100]{
	\includegraphics[width=.3\textwidth]{figures/matlab/persistenceDgms/torus-step100.eps}
	\label{fig:dgm-torus-step100}
        }
	\caption[Torus Boundary]{Persistence diagrams for the heat equation using
                 torus topology.
                }\label{fig:dgm-torus}
\end{figure}
\begin{figure}[ht]
	\centering
	\subfigure[Step 1]{
	\includegraphics[width=.3\textwidth]{figures/matlab/persistenceDgms/klein-step1.eps}
	\label{fig:dgm-kb-step1}
	}
	\subfigure[Step 10]{
	\includegraphics[width=.3\textwidth]{figures/matlab/persistenceDgms/klein-step10.eps}
	\label{fig:dgm-kb-step10}
	}
	\subfigure[Step 100]{
	\includegraphics[width=.3\textwidth]{figures/matlab/persistenceDgms/klein-step100.eps}
	\label{fig:dgm-kb-step100}
        }
	\caption[KB Boundary]{Persistence diagrams for the heat equation using
                 Klein bottle topology.
                }\label{fig:dgm-kb}
\end{figure}
\begin{figure}[ht]
	\centering
	\subfigure[Step 1]{
	\includegraphics[width=.3\textwidth]{figures/matlab/persistenceDgms/sphere-step1.eps}
	\label{fig:dgm-sph-step1}
	}
	\subfigure[Step 10]{
	\includegraphics[width=.3\textwidth]{figures/matlab/persistenceDgms/sphere-step10.eps}
	\label{fig:dgm-sph-step10}
	}
	\subfigure[Step 100]{
	\includegraphics[width=.3\textwidth]{figures/matlab/persistenceDgms/sphere-step100.eps}
	\label{fig:dgm-sph-step100}
        }
	\caption[Sphere Boundary]{Persistence diagrams for the heat equation using
                 spherical topology.
                }\label{fig:dgm-sph}
\end{figure}
In Figures \ref{fig-01:Sumi}-\ref{fig:dgm-sph}, we see several stages of the
heat equation homotopy using various topologies of the square.  The persistence 
diagrams shown are combined diagrams for all dimensions. 
\begin{figure}[hbt]
	\centering
	\subfigure[Klein Bottle, Dimension 0]{
	\includegraphics[width=.45\textwidth]{figures/matlab/persistenceDgms/klein-step1-dim0.eps}
	}
	\subfigure[Klein Bottle, Dimension 1]{
	\includegraphics[width=.45\textwidth]{figures/matlab/persistenceDgms/klein-step1-dim1.eps}
	}
        \subfigure[Sphere, Dimension 0]{
	\includegraphics[width=.45\textwidth]{figures/matlab/persistenceDgms/sphere-step1-dim0.eps}
	}
	\subfigure[Sphere, Dimension 1]{
	\includegraphics[width=.45\textwidth]{figures/matlab/persistenceDgms/sphere-step1-dim1.eps}
	}
 \caption{In these figures, we separate the persistence diagrams from step one of the homotopy
          using the Klein bottle and the sphere topologies.  The diagrams for combined dimensions are
          \figref{fig:dgm-kb}(a) and \figref{fig:dgm-sph}(a).}
 \label{fig:splitDimensions}
\end{figure}
In \figref{fig:splitDimensions}, we look at the diagram for the first step
of the homotopy, separated for dimensions $p=0$ and 
$p=1$, under the Klein bottle and sphere topologies.  We note that the points
with the highest persistence appear in the dimension one persistence diagram.
This is a property that remains true as the homotopy progresses.

\subsection{Analyzing Different Topologies}
\begin{figure}[ht]
 \vspace*{0.1in}
 \centering
 \centerline{\epsfig{figure=figures/matlab/triangle/tri-step0.eps, height=1in}}
 \caption[Triangle on Boundary]{
                 A square with a high-valued (light-colored)
                 region on the boundary.
                }\label{fig:tri-bdry}
\end{figure}
In the topologies without a boundary (torus, Klein bottle, and sphere), a new
feature is created with a relatively high persistence.  For example, if we 
start with a triangular region of high values against a border, as in 
\figref{fig:tri-bdry}, then there exists a $1$-cycle in the sublevel sets. 
Note, however, that there is not a $1-$cycle in any sublevel set of the square
topology.  Since we have created the four different topologies by gluing the 
edges of the square together in various ways, different behaviors along these
edges can be expected. We keep this difference in mind as we continue to look 
for commonalities and other differences caused by the adopted topology.

The persistence diagrams for the torus and the Klein
bottle topologies behave similarly.  In most of the graphs in this section, the
curves of the torus and the Klein bottle are usually parallel.  This is an 
indication that orientability has little effect on the heat equation homotopy.  
This does not come as a not a surprise, as we did not
use the orientation when computing the heat equation.

\subsection{Duration of Vines}
\begin{figure}[hbt]
 \vspace*{0.1in}
 \centering
 \centerline{\epsfig{figure=figures/matlab/vine_lengths_by25.eps,height=2.5in}}
 \caption{The distribution of the length of vines in the vineyard for Dgm$_0(u_t)$
          under the square topology.}
 \label{fig:vine_lengths}
\end{figure}
\begin{table}[h!b!p!]
\caption{Vine Length Statistics for Dgm$_0(u_t)$}
\begin{center} \begin{tabular}{ |l | l | l | l | l | }
    \hline
          & mean & median & mode  & s.d.   \\ \hline\hline
   square & 63.2 & 15     & 6     & 132.8  \\ \hline
   sphere & 69.4 & 25     & 6     & 143.8  \\ \hline
   torus  & 79.8 & 26     & 500   & 105.1  \\ \hline
   Klein  & 72.5 & 21     & 500   & 101.4  \\ 
    \hline
  \end{tabular}
\end{center}\label{table:dgm0}
\end{table}
\begin{table}[h!b!p!]
\caption{Vine Length Statistics for Dgm$_1(u_t)$}
\begin{center} \begin{tabular}{ |l | l | l | l | l | }
    \hline
          & mean  & median & mode & s.d.  \\ \hline\hline
   square & 119.6 & 65     & 6    & 97.7  \\ \hline
   sphere & 122.5 & 56     & 6    & 94.2  \\ \hline
   torus  & 122.5 & 70     & 6    & 137.1 \\ \hline
   Klein  & 126.2 & 58     & 6    & 151.3 \\ 
    \hline
  \end{tabular}
\end{center}\label{table:dgm1}
\end{table}
In \figref{fig:vine_lengths}, we see the distribution of the vine lengths in 
the vineyard Dgm$_0(u_t)$.  The histogram is skewed right, since the mean is 
greater than the median.  Table \ref{table:dgm0} confirms this observation.  
The same pattern is in fact observed under different topologies.  When 
comparing the vine lengths of any two topologies, the Kolmogorov-Smirnov test 
for statistical difference with $\alpha=.05$ fails to reject the null 
hypothesis that the distributions are the same.  On the other hand, if we 
remove the short-lived vines, then we start to see that comparing the Klein
bottle and sphere topologies results in the rejection of the null hypothesis.   
However, this is not a strong enough indication that these distributions are 
different.  The details of this statistical method are out of the scope of 
this paper, but can be found in ~\cite{massey1951kolmogorov}.

From these observations we can conclude that all topologies display a similar
distribution of the length of vines, with many of the vines being short-lived.  
In addition, under the torus and Klein bottle topologies, a large number
of vines span the entire vineyard.

\subsection{Monitoring Total Persistence}
The degree $q$ total persistence is the sum  of the $q^{th}$ powers of 
persistence over all points in the persistence diagram.
\begin{figure}[hbt]
 \vspace*{0.1in}
 \centering
 \centerline{\epsfig{figure=figures/matlab/totalPersistence.eps,height=2.5in}}
 \caption{Total persistence of degree one.}
 \label{fig:totalPersis}
\end{figure}
\begin{figure}[hbt]
	\centering
	\subfigure[Degree 2]{
	\includegraphics[width=.45\textwidth]{figures/matlab/totalPersistence2.eps}
	}
	\subfigure[Degree 3]{
	\includegraphics[width=.45\textwidth]{figures/matlab/totalPersistence3.eps}
	}
 \caption{The declining total persistence of degrees two and three.  In the graph for
          the total persistence of degree three, we omit the sphere topology.  Relative
          to the other topologies, the values were very high.}
 \label{fig:totalPersis23}
\end{figure}
In \figref{fig:totalPersis}, we have the graph of the degree one total persistence
versus the iteration.  Although the total persistence rapidly 
deteriorates initially, the decay slows down around iteration $100$.
-
-
We notice here that the Klein bottle and the
torus have an end behavior different than that of the sphere and the square,
in that we do not see the total persistence approaching zero
after $500$ steps of the heat equation.  
-
In these figures, the sphere behaves
radically different than the other three topologies.

\subsection{Mean Absolute Change}
\begin{figure}[hbt]
 \vspace*{0.1in}
 \centering
 \centerline{\epsfig{figure=figures/matlab/stepSizes.eps,height=2.5in}}
 \caption{The mean absolute change between steps of the heat equation homotopy.}
 \label{fig:meanChange}
\end{figure}
\figref{fig:meanChange} shows that the mean absolute value of the change 
between steps
of the homotopy decreases rapidly at first, then slowly.  Recall that the values of the 
mesh points range from $-255$ to $255$.  At the first step, the mean
absolute change is between $10$ and $15$ (not shown in \figref{fig:meanChange}), 
which is only a $2\%-3\%$ initial change.  The value, 
however, remains above $0.1$ in all cases except for the square
topology.  Given the nature of the heat equation,
we expect the values to decrease with respect to time.
The small values for mean absolute change are in part due to the initial values of
$u_0$.  The values of one vertex does not differ by a large amount from the values
of its neighbors.  
We know
that the iterative method chosen is slow to converge; however, this
graph allows us to gauge how little change is occurring at each step of the
homotopy.

\subsection{Counting Transpositions}
The total number transpositions between steps of the heat equation versus 
time is shown in \figref{fig:numTrans}(a).  All four topologies follow a 
decreasing pattern that levels off, with the Klein bottle and the torus behaving
distinctively different from the square and the sphere.  

We remark on several notable observations from these diagrams.  
The total number of transpositions is 
still significant when the heat equation algorithm reaches
the halting condition.  At the last step, the square topology makes over
400,000 total transpositions.  The other three topologies make even more
transpositions.

\begin{figure}[hbt]
	\centering
	\subfigure[Total]{
	\includegraphics[width=.45\textwidth]{figures/matlab/graph_ntrans.eps}
	\label{fig:a}
	}
	\subfigure[Type 1 Pair Swap]{
	\includegraphics[width=.45\textwidth]{figures/matlab/transpose_112.eps}
	\label{fig:b}
	}
	\subfigure[Type 2 Pair Swap]{
	\includegraphics[width=.45\textwidth]{figures/matlab/transpose_212.eps}
	\label{fig:ax}
	}
	\subfigure[Type 3 Pair Swap]{
	\includegraphics[width=.45\textwidth]{figures/matlab/transpose_31.eps}
	\label{fig:bx}
	}
 \caption{The number of transpositions between steps of the heat equation
          homotopy.  The top left shows the total number of transpositions and
          the remaining three figures are restricted to the three types of
          transpositions that result in pairing swaps.}
 \label{fig:numTrans}
\end{figure}
In \figref{fig:numTrans} (b),(c), and (d) to see a different pattern for 
the number of the switches resulting from the transpositions.
Under the square topology, the number of pair swaps of types 1,
2, and 3 is down to the double digits after $500$ iterations of the heat 
equation.
We notice that Figures (b) and (c) are almost identical.  This is not a 
surprising observation, since pairing swaps 1 and 2 (described in 
\secref{ss:transpose}) are symmetric cases of two births of the same dimension
or two deaths of the same dimension being transposed, resulting in a pair swap
in the diagram.

Three other patterns are worth noting in the graphs of \figref{fig:numTrans}.  
First, we see that
the number of transpositions (of all kinds) rapidly decreases until 
iteration ~$25$.  At this point, the four topologies show different behaviors.
Second, after iteration ~$200$, the torus and the Klein bottle topologies have
both leveled off to a constant function.
Finally, we notice that adding graphs (b), (c), and (d) does not result
in a graph that looks like (a).  Thus, a significant number of the
transpositions made are those that do not result in a pairing swap.
Proportionally, this occurs more often in the torus and Klein bottle topologies
than in the square and the sphere topologies.

\begin{figure}[hbt]
 \vspace*{0.1in}
 \centering
 \centerline{\epsfig{figure=figures/matlab/vertexTranspositions.eps,height=2.5in}}
 \caption{The number of transpositions between vertices versus the iteration
          of the heat equation.}
 \label{fig:vertexTranspositions}
\end{figure}
In \figref{fig:vertexTranspositions}, we restrict our counts to the number 
transpositions of vertices only.  The
values at the vertices dictates the values of the edges and the faces.  The
pattern that this graph follows is similar to 
\figref{fig:numTrans}(a), the graph for the number of transpositions 
generated from all of the simplices  Thus, is seems that the behavior of the vertex-vertex 
transpositions is proportional to the behavior of simplex-simplex 
transpositions.
