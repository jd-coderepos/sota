\def\year{2019}\relax
\documentclass[letterpaper]{article} \usepackage{aaai19}  \usepackage{times}  \usepackage{helvet}  \usepackage{courier}  \usepackage{url}  \usepackage{graphicx}  \frenchspacing  \setlength{\pdfpagewidth}{8.5in}  \setlength{\pdfpageheight}{11in}  \usepackage{amsmath}
\usepackage{amssymb}
\usepackage{makecell}
\usepackage{array}
\usepackage{multirow}
\usepackage{amsmath}
\DeclareMathOperator*{\argmax}{arg\,max}
\DeclareMathOperator{\E}{\mathbb{E}}
\usepackage{xspace}
\usepackage{booktabs}
\usepackage[font=normalsize]{subfig}
\usepackage{arydshln}
\pdfinfo{
/Title (2019 Formatting Instructions for Authors Using LaTeX)
/Author (AAAI Press Staff)}
\setcounter{secnumdepth}{0}  
 \begin{document}
\title{Neural Machine Translation with Adequacy-Oriented Learning}
\author{Xiang Kong \\ Carnegie Mellon University \\ {\tt xiangk@andrew.cmu.edu} \And
       Zhaopeng Tu\thanks{~~~Zhaopeng Tu is the corresponding author. Work was mainly done when Xiang Kong was interning at Tencent AI Lab.} \\ Tencent AI Lab \\ {\tt zptu@tencent.com} \AND
       Shuming Shi \\ Tencent AI Lab \\ {\tt shumingshi@tencent.com} \And
       Eduard Hovy \\ Carnegie Mellon University \\ {\tt hovy@cs.cmu.edu} \And
       Tong Zhang \\ Tencent AI Lab \\ {\tt bradymzhang@tencent.com}}


\maketitle
\begin{abstract}
Although Neural Machine Translation (NMT) models have advanced state-of-the-art performance in machine translation, they face problems like the inadequate translation. 
We attribute this to that the standard Maximum Likelihood Estimation (MLE) cannot judge the real translation quality due to its several limitations. 
In this work, we propose an adequacy-oriented learning mechanism for NMT by casting translation as a stochastic policy in Reinforcement Learning (RL), where the reward is estimated by explicitly measuring translation adequacy.
Benefiting from the sequence-level training of RL strategy and a more accurate reward designed specifically for translation, our model outperforms multiple strong baselines, including (1) standard and coverage-augmented attention models with MLE-based training, and (2) advanced reinforcement and adversarial training strategies with rewards based on both word-level BLEU and character-level \textsc{chrF3}.
Quantitative and qualitative analyses on different language pairs and NMT architectures demonstrate the effectiveness and universality of the proposed approach.

\end{abstract}

\section{Introduction}




During the past several years, rapid progress has been made in the field of Neural Machine Translation (NMT)~\cite{kalchbrenner2013recurrent,sutskever2014sequence,bahdanau2014neural,gehring2017convolutional,Wu:2016:arXiv,vaswani2017attention}. 

Although NMT models have advanced the community, they still face inadequate translation problems: one or multiple parts of the input sentence are not translated~\cite{tu2016modeling}. We attribute this problem to the lack of the mechanism to guarantee the generated translation being as sufficient as human translation. 
NMT models are generally trained in an end-to-end manner to maximize the likelihood of the output sentence.
Maximum Likelihood Estimation (MLE), however, could not judge the real quality of generated translation due to its several limitationsï¼š \begin{enumerate}
    \item {\em Exposure bias}~\cite{Ranzato:2016:ICLR}: The models are trained on the groundtruth data distribution, but at test time are used to generate target words based on previous model predictions, which can be erroneous;
    \item {\em Word-level loss}~\cite{Shen:2016:ACL}: Likelihood is defined at word-level, which might hardly correlate well with sequence-level evaluation metrics like BLEU. \item {\em Focusing more on fluency than adequacy}~\cite{Tu:2017:AAAI}: Likelihood does not measure how well the complete source information is transformed to the target side, thus does not correlate well with translation adequacy. Adequacy metric is regularly employed to assess the translation quality in practice. 
\end{enumerate}


Some recent work partially alleviates one or two of the above problems with advanced training strategies.
For example, the first two problems are tackled by sequence level training using the REINFORCE algorithm~\cite{Ranzato:2016:ICLR,bahdanau2016actor}, minimum risk training~\cite{Shen:2016:ACL}, beam search optimization~\cite{Wiseman:2016:EMNLP} or adversarial learning~\cite{wu2017adversarial,Yang:2018:NAACL}. The last problem can be alleviated by introducing an auxiliary reconstruction-based training objective to measure translation adequacy~\cite{Tu:2017:AAAI}. 


In this work, we aim to fully solve all the three problems in a unified framework. Specifically, we model the translation as a stochastic policy in Reinforcement Learning (RL) and directly perform gradient policy update.~The RL reward is estimated on a complete sequence produced by the NMT model, which is able to correlate well with a sequence-level task-specific metric. To explicitly measure translation adequacy, we propose a novel metric called {\em Coverage Difference Ratio} (\textsc{Cdr}) which is calculated by counting how many source words are under-translated via directly comparing generated translation with human translation.
Benefiting from the sequence-level training of RL strategy and a more accurate reward designed specifically for translation, the proposed approach is able to alleviate all the aforementioned limitations of MLE-based training.

We conduct experiments on ChineseEnglish and GermanEnglish translation tasks, using both the RNN-based NMT model~\cite{bahdanau2014neural} and the recently proposed \textsc{Transformer}~\cite{vaswani2017attention}. The consistent improvements across language pairs and NMT architectures demonstrate the effectiveness and universality of the proposed approach. 
The proposed adequacy-oriented learning improves translation performance not only over a standard attention model, but also over a coverage-augmented attention model~\cite{tu2016modeling} that alleviates the inadequate translation problem at the word-level. In addition, the proposed metric -- \textsc{Cdr} score, consistently outperforms the commonly-used word-level BLEU~\cite{papineni2002bleu} and character-level \textsc{chrF3}~\cite{popovic2015chrf} scores in both the reinforcement learning and adversarial learning frameworks, indicating the superiority and necessity of an adequacy-oriented metric in training effective NMT models.

\section{Background}

Neural Machine Translation (NMT) is an end-to-end structure which could directly model the translation probability between a source sentence  and a target sentence  word by word:

where  is the partial translation before decoding step  and  is parameters of the NMT. The probability of generating the -th word  is calculated by

where  is the -th hidden state of the decoder and  is a non-linear activation function of the decoder state.  is a distinct source representation for time , calculated as a weighted sum of the source annotations: ,
where  is the annotation of  from a encoder, and its weight  is computed by

where  is an \emph{attention model} that scores how well  and  (\emph{i.e.,}\xspace ) match. The encoder and decoder can be implemented as Recurrent Neural Network (RNN)~\cite{bahdanau2014neural}, Convolutional Neural Network (CNN)~\cite{gehring2017convolutional}, or Self-Attention Network (SAN)~\cite{vaswani2017attention}.


The parameters of the NMT  are trained to maximize the likelihood of training instances :

Although likelihood is a widely-used training objective for its simpleness and effectiveness, it has several aforementioned limitations including {\em exposure bias}~\cite{Ranzato:2016:ICLR,Wiseman:2016:EMNLP}, {\em word-level estimation}~\cite{Shen:2016:ACL}, and {\em focusing more on fluency than adequacy}~\cite{Tu:2017:AAAI}.

\section{Approach}



\subsection{Intuition}




\noindent In this work, we try to solve the three problems mentioned above in a unified framework.
Our objective is three-fold:
\begin{enumerate}
    \item We solve the exposure bias problem by modeling the translation as a stochastic policy in reinforcement learning (RL) and directly performing policy gradient update.
    \item The RL reward is estimated on a complete sequence, which correlates well with either sequence-level BLEU or a more adequacy-oriented metric, as described below.
    \item We design a sequence-level metric -- {\em Coverage Difference Ratio} (\textsc{Cdr}) -- to explicitly measure translation adequacy which focuses on the commonly-cited  weaknesses of NMT models: producing fluent yet inadequate translations. We expect that the model can benefit from linguistic insights that correlate well with human intuitions.
\end{enumerate}



\begin{figure}[t]
\centering
\subfloat[\small Example of human (\textsc{Ref}) and generated (\textsc{Nmt}) translations.]{
\includegraphics[width=0.48\textwidth]{figures/cdr_example.pdf}
}
\\
\subfloat[\small Examples of covered source words (i.e. shadow boxes).]{
\includegraphics[width=0.48\textwidth]{figures/coverage-bad.pdf}
}
\caption{An example to illustrate coverage difference ratio.}
\label{fig-example}

\end{figure}


\paragraph{Coverage Difference Ratio (\textsc{Cdr})}
We measure translation adequacy by the number of under-translated words via comparing generated translation with human translation.
We take an example to illustrate how to measure translation adequacy in terms of coverage difference ratio. Figure~\ref{fig-example}(a) shows one inadequate translation.
Following~\cite{luong2015effective,tu2016modeling}, we extract only one-to-one alignments (hard alignments) by selecting the source word with the highest alignment for each target word from the word alignments produced by NMT models.\footnote{For generated translations, we directly use the attention probability distributions from decoding procedure; for human translations, we obtain attention distributions by force decoding the target sentences with the same NMT model.} 
A source word is considered to be translated when it is covered by the hard alignments, as shown in Figure~\ref{fig-example}(b). 
Comparing source words covered by generated translation with those covered by human translation, we can find that the two sets are very different for inadequate translation. Specifically, the difference generally lies in the untranslated source words that cause inadequate translation problem, indicating that coverage difference ratio is a good way to measure the adequacy of generated translation.


Formally, we calculate the \textsc{Cdr} score of a given generated translation  by

where  and  is the set of source words covered by human translation and generated translation, respectively.  denotes the covered source words in  but not in . We use  as the reference coverage to eliminate the effect of null-aligned source words~which are not aligned to any target word. As seen,  is a number between 0 and 1, where 1 means ``completely adequate translation'' and 0 means ``completely inadequate translation''. Taking Figure~\ref{fig-example}(b) as an example, the \textsc{Cdr} score is .




\subsection{\textbf{Architecture}}

\begin{figure}[t]
 \centering
 \includegraphics[width=0.4\textwidth]{figures/architecture-compact.pdf}
 \caption{Architecture of adequacy-oriented NMT. The newly added orientator {\bf \em O} reads coverages of generated and human translations to generate  a \textsc{Cdr} score for each generated translation, which guides the discriminator {\bf \em D} to differentiate good generated translations from bad ones.}
 \label{figure-architecture}
 
\end{figure}


As shown in Figure~\ref{figure-architecture}, the proposed model consists of a {\em generator}, a {\em discriminator}, and an {\em orientator}.

\paragraph{Generator} The generator {\bf \em G} generates the translation  conditioned on the input sentence . Because we need word alignments to calculate adequacy  scores in terms of \textsc{Cdr}, an attention-based NMT model is employed as the generator.


\paragraph{Orientator} The orientator {\bf \em O} reads the word alignments produced by NMT attention model when generating (or force decoding) the two translations and outputs an adequacy score for the generated translation in terms of the aforementioned \textsc{Cdr} score. Then, the orientator is used to guide the discriminator to distinguish adequate translation from inadequate ones. Accordingly, adequate translations with higher \textsc{Cdr} scores would contribute more to parameter tuning, as described in the following section.

\paragraph{Discriminator} We employ a RNN-based discriminator to differentiate generated translation from human translation, given the input sentence. The discriminator reads the input sentence  and its translation (either  or ), and use two RNNs to summarize the two sentences individually. The concatenation of the two summarized representation vectors is fed into a fully-connected neural network.












\subsection{Adequacy-Oriented Training}

In order to train the system efficiently and effectively, we employ a periodical training strategy, which is commonly used in adversarial training~\cite{goodfellow2014generative,wu2017adversarial}. Specifically, we optimize two networks with two objective functions and periodically freeze the parameters of each network during training.


\paragraph{Train Generator and Freeze Discriminator}
Following~\citeauthor{wu2017adversarial}~\shortcite{wu2017adversarial}, we use the REINFORCE algorithm~\cite{williams1992simple} to back-propagate the error signals from {\bf \em D} to {\bf \em G}, given the discretely generated  from {\bf \em G}. The objective of the generator is to maximize the expected reward:

whose gradient is
 
The gradient is approximated by a sample from {\bf \em G} using the REINFORCE algorithm~\cite{williams1992simple}:

where  is the standard NMT gradient which is calculated by the maximum likelihood estimation.
Therefore, the final update function for the generator is:

where the  is the learning rate.
Based on the update function, when the  is large (\emph{i.e.,}\xspace ideally, the generated translation  has a high adequacy score) , the larger reward the NMT model will get, and thus parameters are updated more based on the adequate training instance .




\paragraph{Train Discriminator {\em Oriented by Adequacy} and Freeze Generator}
Ideally, a good translation  should be assigned a high adequacy score  and thus contribute more to updating the generator.
Therefore, we expect the discriminator to not only differentiate generated translations from human translations but also distinguish bad generated translations from good ones. 
Therefore, a new objective of discriminator is to assign a precise score for each generated translation, which is consistent with their adequacy score:

where  is the coverage difference ratio of . As seen, a well trained discriminator would assign a distinct score to each generated translation, which can better measure its adequacy.
\section{Related Work}



This work is related to modeling translation as policy gradient and adequacy modeling. For the former, we take minimum risk training, reinforcement learning and adversarial learning as representative strategies. 


\paragraph{Minimum Risk Training}
In response to the exposure bias and word-level loss problems of MLE training,~\citeauthor{Shen:2016:ACL}~\shortcite{Shen:2016:ACL} minimize the expected loss in terms of evaluation metrics on the training data. 
Our simplified model is analogous to their MRT model, if we directly use \textsc{Cdr} as the reward to update parameters:

The simplified model differs in that (1) we use adequacy-oriented metric (\emph{i.e.,}\xspace \textsc{Cdr}) while they use sequence-level BLEU, and (2) we only need to sample one candidate to calculate reinforcement reward while they generate multiple samples to calculate the expected risk.
In addition, our discriminator gives a smoother and dynamically-updated objective compared with directly using the adequacy-oriented metric, because the latter is highly sensitive to the slight coverage difference~\cite{koehn2017six}. 


\paragraph{Reinforcement Learning}
Recent work shows that maximum likelihood training could be sub-optimal due to the different conditions between training and test modes~\cite{bengio2015scheduled,Ranzato:2016:ICLR}. In order to address the exposure bias and the loss which does not operate at the sequence level, \citeauthor{Ranzato:2016:ICLR}~\shortcite{Ranzato:2016:ICLR} employ the REINFORCE algorithm~\cite{williams1992simple} to decide whether or not tokens from a sampled prediction could contribute to a high task-specific score (\emph{e.g.,}\xspace BLEU). \citeauthor{bahdanau2016actor}~\shortcite{bahdanau2016actor} use the actor-critic method from reinforcement learning to directly optimize a task-specific score. 




\paragraph{Adversarial Learning}
Recently, adversarial learning~\cite{goodfellow2014generative} has been successfully applied to neural machine translation~\cite{wu2017adversarial,Yang:2018:NAACL,Cheng:2018:ACL}.
In the adversarial framework, NMT models generally serve as the generator which defines the policy to generate the target sentence {\bf y} given the source sentence {\bf x}.
A discriminator tries to distinguish the translation result  from the human-generated one , given the source sentence .



If we remove the orientator {\bf \em O}, our model is roll-backed to the adversarial NMT, and the training objective of the discriminator {\bf \em D} is rewritten as

The goal of the discriminator is try to maximize the likelihood of human translation  to 1 and minimize that of generated translation  to 0.


As seen, the discriminator uses a binary classification by uniformly treating all generated translations as negative examples (\emph{i.e.,}\xspace labeling ``0'') and all human translations as positive examples (\emph{i.e.,}\xspace labeling ``1''), regardless of the quality of the generated translations. However, intuitively, high-quality translations and low-quality translations should be treated differently by the discriminator, otherwise, inaccurate reward signals would be propagated back to the generator. In our proposed architecture, this problem can be alleviated by replacing the simple binary outputs with the more informative adequacy-oriented metric \textsc{Cdr}, which is calculated by directly comparing generated and human translations.





\paragraph{Adequacy Modeling}
Inadequate translation problem is a commonly-cited weakness of NMT models~\cite{tu2016modeling}. A number of recent efforts have explored ways to alleviate this problem. For example,~\citeauthor{tu2016modeling}~\shortcite{tu2016modeling} and~\citeauthor{Mi:2016:EMNLP}~\shortcite{Mi:2016:EMNLP} employ coverage vector as a lexical-level indicator to indicate whether a source word is translated or not.~\citeauthor{Zheng:2018:TACL}~\shortcite{Zheng:2018:TACL} and ~\citeauthor{Meng:2018:IJCAI}~\shortcite{Meng:2018:IJCAI} move one step further and directly model translated and untranslated source contents by operating on the attention context vector.~\citeauthor{He:2017:NIPS}~\shortcite{He:2017:NIPS} use a prediction network to estimate the future cost of translating the uncovered source words.
Our approach is complementary to theirs since they model the adequacy learning at the word-level inside the generator (i.e., NMT models), while we model it at the sequence-level outside the generator.
We take the representative coverage mechanism~\cite{tu2016modeling} as another stronger baseline model for its simplicity and efficiency, and experimental results show that our model can further improve performance.

In the context of adequacy-oriented training,~\citeauthor{Tu:2017:AAAI}~\shortcite{Tu:2017:AAAI} introduce an auxiliary objective to measure the adequacy of translation candidates, which is calculated by reconstructing generated translations back to the original inputs. Benefiting from the flexible framework of reinforcement training, we are able to directly compare generated translations with human translations and define a more straightforward metric, \emph{i.e.,}\xspace \textsc{Cdr} to measure adequacy of generated sentences.


\begin{table*}[t]
  \centering
  
\begin{tabular}{c|l||r r||cccc|l}\bf \#  &   \bf Model &\bf \# Para. & \bf Speed &  \bf  MT03 & \bf MT04 & \bf MT05 & \bf MT06 &  \bf All \\\hline
    1   &   \textsc{RNNSearch} & 86.7M & 1.4K  & 36.00 & 38.26 &35.88 & 35.98 & 36.76   \\ 2 & ~~~ + MRT & +0M & 0.3K & 37.32 & 39.41 & 36.78 & 37.22 & 37.92  \\
    \hline
    3   &   ~~~ + {\bf \em D}	& +0.23M & 1.0K &  37.11 & 38.84 & 35.97&37.36 &37.54 \\ 4   &   ~~~ + {\bf \em D}	& +0.17M & 1.2K &36.96 & 38.92 & 36.13 & 37.54 & 37.59  \\ \hline
    5   &   ~~~ + {\bf \em O} & +0M & 1.1K& 37.02&38.49&36.62&36.21& 37.44 \\
    6   &   ~~~ + {\bf \em O} & +0M & 1.1K& 37.91&39.80&36.57&35.95& 37.75 \\
    7   &   ~~~ + {\bf \em O} & +0M & 1.0K	& 37.42&39.52&36.86&37.34& 38.02\\ \hline
8   &   ~~~ + {\bf \em D} + {\bf \em O} & +0.17M & 0.8K & 37.61&40.05&37.58&36.87 &  38.42\\\hline \hline
    9   &   \textsc{RNNSearch-Coverage} &  +1.03M   & 1.2K  &   38.04   & 41.09 &   38.73 &   36.52   & 39.13  \\
    10   &   ~~~ + {\bf \em D} + {\bf \em O}  &  +1.20M   &  0.7K & 38.62   &   41.98   &   39.39   &   37.42   & 39.81\\
    
\end{tabular}
  \caption{Evaluation of translation performance on ZhEn translation. ``{\bf \em D}'' denotes discriminator and ``{\bf \em O}'' denotes orientator. ``{MRT}'' indicates minimum risk training~\cite{Shen:2016:ACL}, and ``{\bf \em D}'' indicates adversarial training with a CNN-based discriminator~\cite{wu2017adversarial}.
``\# Para.'' denotes the number of parameters, and ``Speed'' denotes the training speed (words/second). ``'' and ``'' indicate statistically significant difference ( and  respectively) from the corresponding baseline.} \label{tab:res} 
\end{table*}





\section{Experiments}

\subsection{Setup}

We conduct experiments on the widely-used Chinese (Zh) English (En) and German (De) English (En) translation tasks. For ZhEn translation, the training corpus contains 1.25M sentence pairs extracted from LDC corpora. NIST 2002 (MT02) dataset is the validation set and the test data consists of NIST 2003 (MT03), NIST2004 (MT04), NIST 2005 (MT05) and NIST 2006(MT06). 
For DeEn translation, to compare with the results reported by previous work~\cite{Shen:2016:ACL,bahdanau2016actor,wu2017adversarial,vaswani2017attention}, we use both the IWSLT 2014 and WMT 2014 data. The former contains 153K sentence pairs and the latter consists of 4.56M sentence pairs.
The 4-gram NIST BLEU score \cite{papineni2002bleu} is used as the evaluation metric and sign-test~\cite{collins2005clause} is employed to test statistical significance. 




For training all neural models, we set the vocabulary size to 30K for ZhEn, for IWSLT 2014 DeEn, we follow the preprocessing procedure as used in ~\citeauthor{Ranzato:2016:ICLR}~\shortcite{Ranzato:2016:ICLR} and for WMT 2014 EnDe, preprocessing method described in~\citeauthor{vaswani2017attention}~\shortcite{vaswani2017attention} is borrowed. We pre-train the discriminator on translation samples produced by the pre-trained generator. After that, the discriminator and the generator are trained together, and the generator is updated by the REINFORCE algorithm mentioned above. We also follow the training tips  mentioned in ~\citeauthor{Shen:2016:ACL}~\shortcite{Shen:2016:ACL} and ~\citeauthor{wu2017adversarial}~\shortcite{wu2017adversarial}. The hyper-parameter  which could control the sharpness of the generator distribution in our system is , which could also be regarded as a baseline to reduce the variance of the REINFORCE algorithm. We also randomly choose 50\% minibatches trained with our objective function and the other with the MLE principle.
In MRT training strategy~\cite{Shen:2016:ACL}, the sample size is 25, the hyper-parameter  is  and the loss function is negative smoothed sentence-level BLEU.

We validate our models on two representative model architectures, namely \textsc{RNNSearch} and \textsc{Transformer}.
For the \textsc{RNNSearch} model, mini-batch size is 80, the word-embedding dimension is 620, and the hidden layer size is 1000. We use a neural coverage model for \textsc{RNNSearch-Coverage} and the dimensionality of coverage vector is 100. The baseline models are trained for 15 epochs, which are used as the initial generator in the proposed framework.
For the \textsc{Transformer} model, we implement our proposed approach on top of an open source toolkit THMUT~\cite{zhang2017thumt}. Configurations in~\citeauthor{vaswani2017attention}~\shortcite{vaswani2017attention} are used to train the baseline models.



\begin{table*}[t]
\centering
\begin{tabular}{l|l|l}
{\bf System} &  {\bf Model}  &   {\bf DeEn}     \\
\hline
\hline
\multicolumn{3}{c}{\em Existing end-to-end NMT systems} \\
\hline
\cite{Ranzato:2016:ICLR}    &   CNN encoder + Sequence level objective  &   20.73 \\
\cite{bahdanau2016actor}    &   CNN encoder + Actor-critic &   22.45    \\
\cite{Wiseman:2016:EMNLP}   &   \textsc{RNNSearch} + Beam search optimization   &   25.48   \\
\cite{wu2017adversarial} & \textsc{RNNSearch} + Adversarial objective &   26.98  \\
\hline
\hline
\multicolumn{3}{c}{\em Our end-to-end NMT systems} \\
\hline
\multirow{5}{*}{\em this work}  &   \textsc{RNNSearch}    &   26.51 \\
                                &    ~~~~ + MRT & 27.29  \\
                                &   ~~~~~+ {\bf \em D} &  27.24  \\
                                &   ~~~~~+ {\bf \em O} & 27.31   \\
                                &   ~~~~~+ {\bf \em D} + {\bf \em O} &   27.79  \\
\end{tabular}
\caption{Comparing with previous works of applying reinforcement learning for NMT on IWSLT 2014 DeEn translation task. ``'' and ``'' indicate statistically significant difference ( and  respectively)  from the  \textsc{RNNSearch} model. }
\label{tab:res-iwslt-en-de} 
\end{table*}







\begin{table}[t]
\centering
\small
\begin{tabular}{l|l}
\hline
{\bf Model}  &   {\bf BLEU}    \\
\hline
GNMT + RL \cite{Wu:2016:arXiv}  &  26.30 \\
ConvS2S \cite{gehring2017convolutional}  & 26.43\\
Transformer (Base) \cite{vaswani2017attention}  & 27.3 \\
Transformer (Big) \cite{vaswani2017attention} & 28.4 \\
\hline
  \textsc{Transformer-Base}    &   27.30 \\
~~~~~+ {\bf \em O} & 27.80 \\
 ~~~~~+ {\bf \em D} + {\bf \em O} & 28.01  \\\cline{1-2}
\textsc{Transformer-Big}    &   28.35 \\
~~~~~+ {\bf \em O} & 28.63 \\
~~~~~+ {\bf \em D} + {\bf \em O} & 28.99  \\
\hline
\end{tabular}
\caption{BLEU scores on WMT 2014 EnDe testset using the state-of-the-art \textsc{Transformer} model. `'' indicates statistically significant difference ()  from the corresponding \textsc{Transformer} baseline model.}
\label{tab:res-wmt-att-en-de} 

\end{table}



\subsection{Chinese-English Translation Task}

Table~\ref{tab:res} lists the results of various translation models on ZhEn corpus. As seen, all advanced systems significantly outperform the baseline system (\emph{i.e.,}\xspace \textsc{RNNSearch}), although there are still considerable differences among different variants.

\paragraph{\bf Architectures of Discriminator} (Rows 3-4)
We evaluate two architectures for the discriminator. The CNN-based discriminator is composed of two convolution layers with  window, two max-pooling layers with  window and one softmax layer. The feature map size is 10 and the feed-forward hidden size is 20. The RNN-based discriminator consists of two two-layer RNN encoders with 32 LSTM units and a fully-connected neural network with 32 units.
We find that the RNN discriminator achieves similar performance with its CNN counterpart (37.59 vs. 37.54), while has a faster training speed (1.2K vs. 1.0K words/second). 
The main reason is that the CNN-based discriminator requires high computation and space cost to utilize multiple layers with convolution and pooling from a large input matrix. 

\paragraph{\bf Adequacy Metrics for Orientator} (Rows 5-7)
As aforementioned, the \textsc{Cdr} score can be directly used as a reward to update the parameters, which is in analogy to the MRT~\cite{Shen:2016:ACL} except that we use 1-best sample while they use n-best samples. For comparison, we also used the word-level BLEU score (Row 5) and character-level \textsc{chrF3} score~\cite{popovic2015chrf} (Row 6) as the rewards.

As seen, this strategy consistently improves translation performance, without introducing any new parameters. The extra computation cost is mainly from generating translation sentence and force decoding the human translation with the NMT model.
We find that \textsc{Cdr} not only outperforms its 1-best counterpart ``{\bf \em O}'' and ``{\bf \em O}'', but also surpasses ``MRT'' using 25 samples. 
We attribute this to the fact that \textsc{Cdr} can better estimate the adequacy of the translation, which is the key problem of NMT models, and go beyond the  the simple low-level n-gram matching measured by BLEU and \textsc{chrF3}.


\paragraph{\bf Combining Them Together} (Row 8)
By combining advantages of both reinforcement learning and adequacy-oriented objective, our model achieves the best performance, which is 1.66 BLEU points better than the baseline ``\textsc{RNNSearch}'',  up to 0.98 BLEU points better than using single component and significantly improve the performance of ``MRT'' model.
One more observation can be made. ``+D+O'' outperforms its ``+O'' counterpart (\emph{e.g.,}\xspace 8 vs. 7), which confirms our claim that the discriminator gives a smoother and dynamically-updated score than directly using the calculated one.

\paragraph{\bf Working with Coverage Model} (Rows 11-12)
\citeauthor{tu2016modeling}~\shortcite{tu2016modeling} propose a coverage model to indicate whether a source word is translated or not, which alleviates the inadequate translation problem of NMT models. We argue that our model is complementary to theirs, because we model the adequacy learning outside the generator by using an additional adequacy-oriented discriminator, while they model it inside the generator.
Experimental results validate our hypothesis: the proposed approach further improves performance by 0.58 BLEU points over the coverage-augmented model \textsc{RNNSearch-Coverage}.



\subsection{English-German Translation Tasks}

To compare with previous work of applying reinforcement learning for NMT~\cite{Ranzato:2016:ICLR,bahdanau2016actor,Wiseman:2016:EMNLP,wu2017adversarial}, we first conduct experiments on IWSLT 2014 DeEn translation task. As listed in Table~\ref{tab:res-iwslt-en-de}, we reproduce the results of adversarial training reported by~\citeauthor{wu2017adversarial}~\shortcite{wu2017adversarial} (27.24 vs. 26.98). Furthermore, the proposed approach consistently outperforms previous works, demonstrating the effectiveness of our models.


We also evaluate our model on the recently proposed \textsc{Transformer} model~\cite{vaswani2017attention} on WMT 2014 EnDe corpus. As shown in Table~\ref{tab:res-wmt-att-en-de}, our models significantly improve performances in all cases.
Combining with previous results, our model consistently improve translation performance across various language pairs and NMT architectures, demonstrating the effectiveness and universality of the proposed approach.



\iffalse
the WMT14 benchmarks for both German-English and English-German.
As shown in Table \ref{tab:res-wmt-en-de}, our model (\emph{i.e.,}\xspace ``{+{\bf \em D}+{\bf \em O}}'') improves performances in all cases,
demonstrating the efficiency and universality of the proposed approach across language pairs.
In addition, \textsc{Cdr} score consistently outperforms \textsc{Bleu} score even the latter uses 25 samples, proving the superiority of the proposed metric.
The best performance we achieve is also comparable with the reported results on the same data. 

Table~\ref{tab:res-iwslt-en-de} lists the result on the IWSLT data. We reproduced the result reported in~\cite{wu2017adversarial} (27.24 vs. 26.98). The proposed adequacy learning approach consistently outperforms previously reported results.
\fi



\subsection{Analysis}

To better understand our models, we conduct extensive analyses on the ZhEn translation task. 

\iffalse
\begin{table*}[t]
\centering
\begin{tabular}{l|cr|cr|cr|cr} 
  \bf Model & \bf \textsc{Cdr}    &   \bf  &  \bf \textsc{Man}   &  \bf    &  \bf \textsc{Man}   & \bf    & \bf \textsc{Man} \\
   \hline
  \textsc{\small RNNSearch}         & 0.68  &   --   &   3.50   &   --     &      3.13   & -- & 3.31  .070 \\
  ~~~+ {\bf \em D}                  & 0.71  &  4.4\% &   3.71   &   6.0\%  &   3.43      & 9.6\% & 3.57  0.61\\
  ~~~+ {\bf \em O}                  & 0.75  & 10.3\% &   3.81   &  8.9\%   &    3.58     & 14.4\% & 3.69  0.48\\
  ~~~+ {\bf \em D} + {\bf \em O}    & 0.80  &17.6\%  &   3.87   &   10.6\% &   3.72      & 18.8\%  & 3.79  0.47\\
\end{tabular}
 \caption{Adequacy scores on randomly selected 100 sentences on ZhEn task, which are measured by \textsc{Cdr} and human evaluation (``\textsc{Man}'').}
   \label{tab:subject-eval}
\end{table*}
\fi


\begin{table}[t]
\centering
\begin{tabular}{l|cr|cr} 
  \bf Model     &  \bf \textsc{Man}   &   \bf  & \bf \textsc{Cdr}    &   \bf  \\
   \hline
  \textsc{\small RNNSearch}         &   3.31     &   --    & 0.68  &   --   \\
  ~~~+ {\bf \em D}                  &   3.57     &   7.9\% & 0.71  &   4.4\% \\
  ~~~+ {\bf \em O}                  &   3.69     &   11.5\%    & 0.75  &   10.3\% \\
  ~~~+ {\bf \em D} + {\bf \em O}    &   3.79    &   14.5\%     & 0.80  &   17.6\%  \\
\end{tabular}
 \caption{Adequacy scores on randomly selected 100 sentences on ZhEn task, which are measured by \textsc{Cdr} and human evaluation (``\textsc{Man}'').}

   \label{tab:subject-eval}
\end{table}

\paragraph{Adequacy Evaluation}
To better evaluate the adequacy, we randomly choose 100 sentences from the test set, and ask two human evaluators to judge the quality of generated translations. Five scales have been set up, i.e., , where ``'' means that it is irrelevant between the source sentence and the translation sentence, and ``'' means that from semantic and syntactic aspect, the translation sentence and the source sentence is completely equivalent.

Table~\ref{tab:subject-eval} lists the results of human evaluation and the proposed \textsc{Cdr} score. First, our models consistently improve the translation adequacy under both human evaluation and the \textsc{Cdr} score, indicating that the proposed approaches indeed alleviate the inadequate translation problem. Second, the relative improvement on \textsc{Cdr} is consistent with that on subjective evaluation. The Pearson Correlation Coefficient between \textsc{Cdr} and manual evaluation score is 0.64, indicating that the proposed \textsc{Cdr} is a reasonable metric to measure translation adequacy.





\paragraph{Length Analysis}

We group sentences of similar lengths and compute both the BLEU score and \textsc{Cdr} score for each group, as shown in Figure~\ref{figure-sentence-len}. 
The four length spans contain 1386, 2284, 1285, and 498 sentences, respectively.
From the perspective of the BLEU score, the proposed model (\emph{i.e.,}\xspace ``+D+O'') outperforms \textsc{RNNSearch} in all length segments. 
In contrast, using discriminator only (\emph{i.e.,}\xspace ``+D'') outperforms \textsc{RNNSearch} in most cases, except long sentences (\emph{i.e.,}\xspace ). One possible reason is that it is difficult for the discriminator to differentiate generated translations from human translations for long source sentences, thus the generator cannot learn well about these instances due to the ``mistaken'' rewards from the discriminator. 
Accordingly, using the \textsc{Cdr} score (\emph{i.e.,}\xspace ``+O'') alleviates this problem by providing a sequence-level score, which better estimates the adequacy of the translations.
The final model combines the advantages of both a smoother and dynamically-updated objective from the discriminator (``+D''), and a more accurate objective specifically designed for the translation task from the orientator (``+O''). 

\iffalse
\begin{figure}[t]
\centering
    \subfloat[BLEU Score]{\includegraphics[width=0.3\textwidth]{figures/len-bleu.pdf}} \\
    \subfloat[\textsc{Cdr} Score]{\includegraphics[width=0.3\textwidth]{figures/len-cdr.pdf}}
    \caption{BLEU and \textsc{Cdr} scores of the translations with respect to the input lengths. }\label{figure-sentence-len}
\end{figure}
\fi

\begin{figure}[t]
\centering
    \includegraphics[width=0.30\textwidth]{figures/len-bleu-cdr.png}
    \caption{BLEU and \textsc{Cdr} scores of the translations with respect to the input lengths.}
    \label{figure-sentence-len}
\end{figure}

The \textsc{Cdr} scores for all models degrade when the length of source sentence increases. This is mainly due to that inadequate translation problem is more serious on longer sentences for NMT models~\cite{tu2016modeling}. The adversarial model (\emph{i.e.,}\xspace ``+{\bf \em D}'') improves \textsc{Cdr} scores while the improvement degrades faster with the increase of sentence length. However, our proposed approach consistently improves \textsc{Cdr} performance in all length segments.


\paragraph{Effect of the Discriminator}
\citeauthor{koehn2017six}~\shortcite{koehn2017six} point out that the attention model does not always correspond to word alignment and may considerably diverge. Accordingly, the attention matrix-based \textsc{Cdr} score  may not always correctly reflect the adequacy of generation sentences. However, our discriminator is able to give a smoother and dynamically-updated objective, and thus could provide more accurate adequacy scores of generation sentences. From the above quantitative and qualitative results, the discriminator indeed leads to better performance (\emph{i.e.,}\xspace ``+D+O'' vs. ``+O'').


\begin{figure}[t]
    \centering
    \includegraphics[width=0.4\textwidth]{figures/chen_case.pdf}
    \caption{Example translations on ZhEn test set.}
    \label{tab:case}
\end{figure}


\paragraph{Case Study}
To better understand the advantage of our proposed model, we show a translation case in Figure~\ref{tab:case}. Specially, we provide a ZhEn example with two translation results from the RNNSearch and Adequacy-NMT models respectively, as well as the corresponding \textsc{Cdr} and BLEU scores. We emphasize on their different parts with bold fonts which lead to different translation quality.
As seen, the latter part of the source sentence is not translated by the RNNSearch model while our proposed model correct this mistake. Accordingly, our model improves both \textsc{Cdr} and BLEU scores.

\section{Conclusion}

In this work, we propose a novel learning approach for RL-based NMT models, which integrates into the policy gradient with an adequacy-oriented reward designed specifically for translation. 
The proposed approach combines the advantages of both sequence-level training of reinforcement learning, as well as a more accurately estimated reward by considering the translation adequacy in terms of coverage difference ratio (\textsc{Cdr}).
Experimental results on different language pairs show that our proposed approach not only significantly outperforms standard NMT models, but also further improves performance over those using the policy gradient and the adequacy-oriented reward individually. In addition, the proposed approach is also complementary to the coverage models~\cite{tu2016modeling}, because the two models aim to alleviate the inadequate translation problem from two different perspectives (\emph{i.e.,}\xspace sequence-level vs. word-level).

Future directions include validating our approach on other architectures such as CNN-based NMT models~\cite{gehring2017convolutional} and improved \textsc{Transformer} models~\cite{shaw2018self,Shen:2018:AAAI}, as well as combining with other advanced techniques in reinforcement learning and adversarial learning~\cite{bahdanau2016actor,Yu:2017:AAAI,Yang:2018:NAACL}.



\bibliography{mybib}
\bibliographystyle{aaai}
\end{document}
