\begin{filecontents*}{example.eps}
gsave
newpath
  20 20 moveto
  20 220 lineto
  220 220 lineto
  220 20 lineto
closepath
2 setlinewidth
gsave
  .4 setgray fill
grestore
stroke
grestore
\end{filecontents*}
\RequirePackage{fix-cm}
\documentclass[smallextended]{svjour3}       \smartqed  \usepackage{graphicx}
\usepackage{times}
\usepackage{epsfig}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{multirow}
\usepackage{color}
\usepackage{url}
\begin{document}

\newcommand{\tabincell}[2]{
\begin{tabular}{@{}#1@{}}#2\end{tabular}
}

\title{Center and Scale Prediction: A Box-free Approach\\ for Pedestrian and Face Detection}




\author{Wei Liu \and
        Irtiza Hasan\thanks{Shengcai Liao is the corresponding author.} \and
        Shengcai Liao
}



\institute{Wei Liu \at
              ATR, College of Electronic Science, National University of Defense Technology, Changsha, China \\
              \email{liuwei16@nudt.edu.cn}           \and
            Irtiza Hasan \at
              Inception Institute of Artificial Intelligence (IIAI), Abu Dhabi, UAE \\
              \email{irtiza.hasan@inceptioniai.org}
              \and
           Shengcai Liao \at
              Inception Institute of Artificial Intelligence (IIAI), Abu Dhabi, UAE \\
              \email{scliao@ieee.org}
}

\date{Received: date / Accepted: date}


\maketitle

\begin{abstract}
Object detection generally requires sliding-window classifiers in tradition or anchor box based predictions in modern deep learning approaches. However, either of these approaches requires tedious configurations in boxes. In this paper, we provide a new perspective where detecting objects is motivated as a high-level semantic feature detection task. Like edges, corners, blobs and other feature detectors, the proposed detector scans for feature points all over the image, for which the convolution is naturally suited. However, unlike these traditional low-level features, the proposed detector goes for a higher-level abstraction, that is, we are looking for central points where there are objects, and modern deep models are already capable of such a high-level semantic abstraction. Besides, like blob detection, we also predict the scales of the central points, which is also a straightforward convolution. Therefore, in this paper, pedestrian and face detection is simplified as a straightforward center and scale prediction task through convolutions. This way, the proposed method enjoys a box-free setting. Though structurally simple, it presents competitive accuracy on several challenging benchmarks, including pedestrian detection and face detection. Furthermore, a cross-dataset evaluation is performed, demonstrating a superior generalization ability of the proposed method.
\keywords{Object detection \and Convolutional neural networks \and Feature detection \and Box-free \and Anchor-free}
\end{abstract}

\section{Introduction}
\label{intro}
Feature detection\footnote{} is one of the most fundamental problems in computer vision. It is usually viewed as a low-level technique, with typical tasks including edge detection (e.g. Canny \cite{canny1986computational}, Sobel \cite{sobel1972camera}), corner (or interest point) detection (e.g. SUSAN \cite{smith1997susan}, FAST \cite{rosten2006machine}), and blob (or region of interest point) detection (e.g. LoG \cite{lindeberg2013scale}, DoG \cite{lowe2004distinctive}, MSER \cite{matas2004robust}). Feature detection is of vital importance to a variety of computer vision tasks ranging from image representation, image matching to 3D scene reconstruction, to name a few.

Generally speaking, a feature is defined as an ``interesting part'' of an image, and so feature detection aims to compute abstractions of image information and make local decisions at every image point whether there is an image feature of a given type at that point or not. Regarding abstraction of image information, with the rapid development for computer vision tasks, deep convolutional neural networks (CNN) are believed to be of very good capability to learn high-level image abstractions. Therefore, it has also been applied for feature detection, and demonstrates attractive successes even in low-level feature detections. For example, there is a recent trend of using CNN to perform edge detection \cite{shen2015deepcontour,xie2017holistically,bertasius2015deepedge,liu2017richer}, which has substantially advanced this field. It shows that clean and continuous edges can be obtained by deep convolutions, which indicates that CNN has a stronger capability to learn higher-level abstraction of natural images than traditional methods. This capability may not be limited to low-level feature detection; it may open up many other possibilities of high-level feature detection.

Therefore, in this paper, we provide a new perspective where detecting objects is motivated as a high-level semantic feature detection task. Like edges, corners, blobs and other feature detectors, the proposed detector scans for feature points all over the image, for which the convolution is naturally suited. However, unlike these traditional low-level feature detectors, the proposed detector goes for a higher-level abstraction, that is, we are looking for central points where there are objects. Besides, similar to the blob detection, we also predict the scales of the central points. However, instead of processing an image pyramid to determine the scale as in traditional blob detection, we predict object scale with also a straightforward convolution in one pass upon a fully convolution network (FCN) \cite{long2015fully}, considering its strong capability. As a result, pedestrian and face detection is simply formulated as a straightforward center and scale prediction task via convolution. The overall pipeline of the proposed method, denoted as \textbf{C}enter and \textbf{S}cale \textbf{P}rediction (\textbf{CSP}) based detector, is illustrated in Fig. \ref{fig:pipeline}.

\begin{figure}[t]
\begin{center}
\includegraphics[width=0.8\linewidth]{1.png}
\end{center}
   \caption{The overall pipeline of the proposed CSP detector. The final convolutions have two channels, one is a heatmap indicating the locations of the centers (red dots), and the other serves to predict the scales (yellow dotted lines) for each detected center.}
\label{fig:pipeline}
\end{figure}

As for general object detection, starting from the pioneer work of the Viola-Jones detector \cite{viola2004robust}, it generally requires sliding-window classifiers in tradition or anchor box based predictions in CNN-based methods. These detectors are essentially local classifiers used to judge the pre-defined boxes (windows or anchor boxes) as being objects or not. However, either of these approaches requires tedious configurations in boxes. Several (but not all) of these configurations include the number of scales, the sizes of anchors, the aspect ratios, and the overlap thresholds with ground truth boxes to define positive and negative for training, etc. All of these are task-oriented and difficult to figure out which combination is the optimal one. Generally speaking, object detection is to tell where the object is, and how big it is. Traditional methods combines the "where" and "how" subproblems into a single one through the overall judgement of various scales of boxes. In contrast, the proposed CSP detector separates the "where" and "how" subproblems into two different convolutions. This makes detection a more natural way, and enjoys a box-free (short for window-free or anchor-box-free) setting, considerably reducing the difficulty in training configuration and hyper-parameter optimization.

There is another line of research which inspires us a lot. Previously, FCN has already been applied to and made a success in multi-person pose estimation \cite{cao2016realtime,newell2017associative}, where several keypoints are firstly detected merely through responses of full convolutions, and then they are further grouped into complete poses of individual persons. In view of this, recently two inspirational works, CornerNet \cite{Law_2018_ECCV} and TLL \cite{Song_2018_ECCV}, successfully go free from windows and anchor boxes, which perform object detection as convolutional keypoint detections and their associations. Though the keypoint association require additional computations, sometimes complex as in TLL, the keypoint prediction by FCN inspires us to go a step further, achieving center and scale prediction based pedestrian and face detection in full convolutions.

In summary, the main contributions of this work are as follows: (i) We show a new possibility that pedestrian and face detection can be simplified as a straightforward center and scale prediction task through convolutions, which bypasses the limitations of anchor box based detectors and gets rid of the complex post-processing of recent keypoint pairing based detectors. (ii) The proposed CSP detector achieves the new state-of-the-art performance on two challenging pedestrian detection benchmarks, CityPersons \cite{zhang2017citypersons} and Caltech \cite{dollar2012pedestrian}, it also achieves competitive performance on one of the most popular face detection benchmark--WiderFace \cite{yang2016wider}.
(iii) The proposed CSP detector presents good generalization ability when cross-dataset evaluation is performed.

This work is built upon our preliminary work recently accepted by the IEEE Conference on Computer Vision and Pattern Recognition (CVPR) 2019. The major new content is additional experiments on face detection to demonstrate CSP's capability in detecting objects with various aspect ratios. Besides, we also conduct comparative experiments and analysis to demonstrate the generalization ability of the proposed detector. In summary, main changes contained in this paper are as follows:
\begin{itemize}
\item  We evaluate the proposed method for face detection on one of the most popular face detection benchmarks, i.e. WiderFace \cite{yang2016wider}. The model is trained on the official training subset and evaluated on both the validation and test subsets. Comparable performance to other state-of-the-art face detectors on this benchmark are reported and thus demonstrates the proposed method's capability and competitiveness on face detection.
\item  To further evaluate the generalization ability of the proposed CSP detector, we also conduct two cross-dataset evaluation experiments. For pedestrian detection, we compare the proposed CSP detector with the state-of-the-art anchor box based pedestrian detector (ALFNet \cite{Liu_2018_ECCV}). Both of the two detectors are trained on the CityPersons \cite{zhang2017citypersons} training set and then are directly tested on Caltech \cite{dollar2012pedestrian}.
    For face detection, we compare the proposed CSP detector with the state-of-the-art anchor box based face detector (DSFD \cite{li2018dsfd}). Both of the two detectors are trained on the WiderFace \cite{yang2016wider} training set and then are directly tested on FDDB \cite{fddbTech}, UCCS \cite{uccs} and DarkFace \cite{wei2018deep}. Experimental results show that the proposed CSP detector has a superior generalization ability than the compared methods.
\end{itemize}

\section{Related Works}
\subsection{Anchor box based object detection}
One key component of anchor box based detectors is the anchor boxes of pre-defined scales and aspect ratios. In this way, detection is performed by classifying and regressing these anchor boxes. Faster R-CNN \cite{ren2015faster} is known as a two-stage detector, which generates objectness proposals and further classifies and refines these proposals in a single framework. In contrast, singe-stage detectors, popularized by SSD \cite{liu2016ssd}, remove the proposal generation step and achieve comparable accuracy while are more efficient than two-stage detectors.

In terms of pedestrian detection, Faster R-CNN has become the predominant framework. For example, RPN+BF \cite{zhang2016faster} adapts the RPN and re-scores these proposals via boosted forests. MS-CNN \cite{cai2016unified} also applies the Faster R-CNN framework but generates proposals on multi-scale feature maps. Zhang \emph{et al.} \cite{zhang2017citypersons} contribute five strategies to adapt the plain Faster R-CNN for pedestrian detection. RepLoss \cite{wang2017repulsion} and OR-CNN \cite{Zhang_2018_ECCV} design two novel regression losses to tackle the occluded pedestrian detection in crowded scenes. Bi-Box \cite{Zhou_2018_ECCV} proposes an auxiliary sub-network to predict the visible part of a pedestrian instance. Most recently, single-stage detectors also present competitive performance. For example, ALFNet \cite{Liu_2018_ECCV} proposes the asymptotic localization fitting strategy to evolve the default anchor boxes step by step into precise detection results, and \cite{Lin_2018_ECCV} focuses on the discriminative feature learning based on the original SSD architecture.

For face detection, it is dominated by the single-stage framework in recent years. Most of the advanced face detectors focus on the anchor box design and matching strategies, because faces in the wild exhibits a large variation in size. For example, FaceBoxes \cite{zhang2017faceboxes} introduces an anchor box densification strategy to ensure anchor boxes of different sizes have the same density on an image, and in \cite{zhang2017s3fd,zhu2018seeing}, the authors propose different anchor box matching threshold to ensure a certain number of training examples for tiny faces, further DSFD \cite{li2018dsfd} proposes an improved anchor box matching strategy to provide better initialization for the regressor. In SSH \cite{najibi2017ssh}, anchor boxes with two neighboring sizes share the same detection feature map. PyramidBox \cite{Tang_2018_ECCV} designs novel PyramidAnchors to help contextual feature learning.

\subsection{Box-free object detection}
Box-free detectors bypass the requirement of anchor boxes and detect objects directly from an image. DeNet \cite{tychsen2017denet} proposes to generate proposals by predict the confidence of each location belonging to four corners of objects. Following the two-stage pipeline, DeNet also appends another sub-network to re-score these proposals. Within the single-stage framework, YOLO \cite{redmon2016you} appends fully-connected layers to parse the final feature maps of a network into class confidence scores and box coordinates. Densebox \cite{huang2015densebox} devises a unified FCN that directly regresses the classification scores and distances to the boundary of a ground truth box on all pixels, and demonstrates improved performance with landmark localization via multi-task learning. However, DenseBox resizes objects to a single scale during training, thus requiring image pyramids to detect objects of various sizes by multiple network passes during inference. Besides, Densebox defines the central area for each object and thus requires four parameters to measure the distances of each pixel in the central area to the object's boundaries. In contrast, the proposed CSP detector defines a single central point for each object, therefore two parameters measuring the object's scale are enough to get a bounding box, and sometimes one scale parameter is enough given uniform aspect ratio in the task of pedestrian detection.
Most recently, CornerNet \cite{Law_2018_ECCV} also applies a FCN but to predict objects' top-left and bottom-right corners and then group them via associative embedding \cite{newell2017associative}. Enhanced by the novel corner pooling layer, CornerNet achieves superior performance on MS COCO object detection benchmark \cite{lin2014microsoft}. Similarly, TLL \cite{Song_2018_ECCV} proposes to detect an object by predicting the top and bottom vertexes. To group these paired keypoints into individual instances, it also predicts the link edge between them and employs a post-processing scheme based on Markov Random Field. Applying on pedestrian detection, TLL achieves significant improvement on Caltech \cite{dollar2012pedestrian}, especially for small-scale pedestrians.

Our work also falls in the box-free object detection, but with significant differences to all above methods. We try to answer \textbf{to what extent a single FCN can be simplified for pedestrian and face detection}, and demonstrate that a single center point is feasible for object localization. Along with the scale prediction, CSP is able to generate bounding boxes in a single pass of FCN without any requirements of extra post-processing schemes except the Non-Maximum Suppression (NMS).

\subsection{Feature detection}
Feature detection is a long-standing problem in computer vision with extensive literatures. Generally speaking, it mainly includes edge detection \cite{canny1986computational,sobel1972camera}, corner detection \cite{rosten2006machine,rosten2010faster}, blob detection \cite{matas2004robust,deng2007principal} and so on.
Traditional leading methods \cite{canny1986computational,sobel1972camera} mainly focus on the utilization of local cues, such as brightness, colors, gradients and textures. With the development of CNN, a series of CNN-based method are proposed that significantly push forward the state of the arts in the task of feature detection. For example, there is a recent trend of using CNN to perform edge detection \cite{shen2015deepcontour,xie2017holistically,bertasius2015deepedge,liu2017richer}, which have substantially advanced this field.
However, different from these low-level feature points like edge, corners and blobs, the proposed method goes for a higher-level abstraction task, that is, we focus on detecting central points where there are pedestrians, for which modern deep models are already capable of.

\section{Proposed Method}
\subsection{Preliminary}
The CNN-based object detectors often rely on a backbone network (e.g. ResNet \cite{he2016deep}). Taking an image  as input, the network may generate several feature maps with different resolutions, which can be defined as follows:

where  represents feature maps output by the th layer. These feature maps decrease in size progressively and are generated by , which may be a combination of convolution or pooling, etc. Given a network with  layers, all the generated feature maps can be denoted as , which is further utilized by detection heads.

Generally speaking, the CNN-based object detectors differ in how to utilize . We denote these feature maps that are responsible for detection as . In RPN \cite{ren2015faster}, only the final feature map  is used to perform detection, thus the final set of feature maps for detection is . While in SSD \cite{liu2016ssd}, the detection feature maps can be represented as , where . Further, in order to enrich the semantic information of shallower layers for detecting small-scale objects, FPN \cite{lin2016feature} and DSSD \cite{fu2017dssd} utilize the lateral connection to combine feature maps of different resolutions, resulting in , where  is a combination of .

Besides , in anchor box based detectors, another key component is called anchor boxes (denoted as ). Given  and  in hand, detection can be formulated as:

where  is pre-defined according to the corresponding set of feature maps , and  represents the detection head. Generally,  contains two elements, namely  which predicts the classification scores, and  which predicts the scaling and offsets of the anchor boxes.

While in box-free detectors, detection is performed merely on the set of feature maps , that is,


\begin{figure*}
\begin{center}
\includegraphics[width=1.0\linewidth]{Irtiza_arch_letest.png}
\end{center}
   \caption{Overall architecture of CSP, which mainly comprises two components, i.e. the feature extraction module and the detection head. The feature extraction module concatenates feature maps of different resolutions into a single one. The detection head merely contains a 3x3 convolutional layer, followed by three prediction layers, for the offset prediction, center location and the the corresponding scale.}
\label{fig:arc}
\end{figure*}

\subsection{Overall architecture}\label{sec:arc}
The overall architecture of the proposed CSP detector is illustrated in Fig. \ref{fig:arc}. The backbone network are truncated from a standard network pretrained on ImageNet \cite{deng2009imagenet} (e.g. ResNet-50 \cite{he2016deep} and MobileNet \cite{howard2017mobilenets}).

\textbf{Feature Extraction}.
Taking ResNet-50 as an example, its \emph{Conv} layers can be divided into five stages, in which the output feature maps are downsampled by 2, 4, 8, 16, 32 w.r.t. the input image. As a common practice \cite{wang2017repulsion,Song_2018_ECCV}, the dilated convolutions are adopted in \emph{stage 5} to keep its output as 1/16 of the input image size. We denote the output of \emph{stage 2, 3, 4 and 5} as , ,  and , in which the shallower feature maps can provide more precise localization information, while the coarser ones contain more semantic information with increasing the sizes of receptive fields. Therefore, we fuse these multi-scale feature maps from each stage into a single one in a simple way, that is, a deconvolution layer is adopted to make multi-scale feature maps with the same resolution before concatenation. Since the feature
maps from each stage have different scales, we use L2-normalization to rescale their norms to 10, which is similar to \cite{Lin_2018_ECCV}. To investigate the optimal combination from these multi-scale feature maps, we conduct an ablative experiment in Sec. \ref{sec:abl} and demonstrate that  is the best choice. Given an input image of size , the size of final concatenated feature maps is , where  is the downsampling factor. Similarly to \cite{Song_2018_ECCV},  gives the best performance as demonstrated in our experiments, because a larger  means coarser feature maps which struggle on accurate localization, while a smaller  brings more computational burdens.
Note that more complicated feature fusion strategies like \cite{lin2016feature,Kim_2018_ECCV,Kong_2018_ECCV} can be explored to further improve the detection performance, but it is not in the scope of this work.

\textbf{Detection Head}.
Upon the concatenated feature maps , a detection head is appended to parse it into detection results. As stated in \cite{rfbnet}, the detection head plays a significant role in top performance, which has been extensively explored in the literature \cite{fu2017dssd,rfbnet,li2017light,li2018dsfd}. In this work, we firstly attach a single 3x3 \emph{Conv} layer on  to reduce its channel dimensions to 256, and then three sibling 1x1\emph{Conv} layers are appended to produce the offset prediction, scale map and center heatmap, respectively. Also, we do this for simplicity and any improvement of the detection head  \cite{fu2017dssd,rfbnet,li2017light,li2018dsfd} can be flexibly incorporate into this work to be a better detector.

A drawback from the downsampled feature maps is the problem of poor localization. Optionally, to slightly adjust the center location, an extra offset prediction branch can be appended in parallel with the above two branches. This extra offset branch resolves mismatching of centers that occurs due to downsampled feature maps by learning the shifted offset.

\begin{figure}[t]
\begin{center}
\includegraphics[width=0.9\linewidth]{3.png}
\end{center}
   \caption{(a) is the bounding box annotations commonly adopted by anchor box based detectors. (b) is the center and scale ground truth generated automatically from (a). Locations of all objects' center points are assigned as positives, and negatives otherwise. Each pixel is assigned a scale value of the corresponding object if it is a positive point, or 0 otherwise. We only show the height information of the two positives for clarity. (c) is the overall Gaussian mask map  defined in Eq.\ref{eq4} to reduce the ambiguity of these negatives surrounding the positives.}
\label{fig:gt}
\end{figure}
\subsection{Training}
\textbf{Ground Truth}.
The predicted heatmaps are with the same size as the concatenated feature maps (i.e.  ). Given the bounding box annotations, we can generate the center and scale ground truth automatically. Taking pedestrian detection as an example, an illustration example is depicted in Fig. \ref{fig:gt} (b). For the center ground truth, the location where an object's center point falls is assigned as positive while all others are negatives.

Scale can be defined as the height and/or width of objects.
Towards high-quality ground truth for pedestrian detection, line annotation is first proposed in \cite{zhang2018towards,zhang2017citypersons}, where tight bounding boxes are automatically generated with a uniform aspect ratio of 0.41. In accordance to this annotation, we can merely predict the height of each pedestrian instance and generate the bounding box with the predetermined aspect ratio. For the scale ground truth, the th positive location is assigned with the value of  corresponding to the th object. To reduce the ambiguity,  is also assigned to the negatives within a radius 2 of the positives, while all other locations are assigned as zeros.
Alternatively, we can also predict the width or height+width but with slightly poor performance for pedestrian detection as demonstrated in our experiments (Sec. \ref{sec:abl}). However, both height and width prediction is required for face detection, because face objects in the wild exhibit a large variation in aspect ratios.

When the offset prediction branch is appended, the ground truth for the offsets of those centers can be defined as .

\textbf{Loss Function.}
For the center prediction branch, we formulate it as a classification task via the cross-entropy loss. Note that it is difficult to decide an 'exact' center point, thus the hard-designation of positives and negatives brings more difficulties for training. In order to reduce the ambiguity of these negatives surrounding the positives, we also apply a 2D Gaussian mask  centered at the location of each positive, which is similar in \cite{Law_2018_ECCV,Song_2018_ECCV}. An illustration example of the overall mask map  is depicted in Fig. \ref{fig:gt} (c). Formally, it is formulated as:

where  is the number of objects in an image,  is the center coordinates, width and height of the th object, and the variances  of the Gaussian mask are proportional to the height and width of individual objects. If these masks have overlaps, we choose the maximum values for the overlapped locations.
To combat the extreme positive-negative imbalance problem, the focal weights \cite{lin2017focal} on hard examples are also adopted.
Thus, the classification loss can be formulated as:

where



In the above,  is the network's estimated probability indicating whether there is an object's center or not in the location , and  specifies the ground truth label, where  represents the positive location.  and  are the focusing hyper-parameters, we experimentally set  as suggested in \cite{lin2017focal}. To reduce the ambiguity from those negatives surrounding the positives, the  according to the Gaussian mask  is applied to reduce their contributions to the total loss, in which the hyper-parameter  controls the penalty. Experimentally,  gives the best performance, which is similar to the one in \cite{Law_2018_ECCV}. For positives,  is set as 1.

For scale prediction, we formulate it as a regression task via the smooth L1 loss \cite{girshick2015fast}:


where  and  represents the network's prediction and the ground truth of each positive, respectively.

If the offset prediction branch is appended, the similar smooth L1 loss in Eq. \ref{eq:sml1} is adopted (denoted as ).

To sum up, the full optimization objective is:

where ,  and  are the weights for center classification, scale regression and offset regression losses, which are experimentally set as 0.01, 1 and 0.1, respectively.

\subsection{Inference}
During testing, CSP simply involves a single forward of FCN with several predictions. Specifically, locations with confidence score above 0.01 in the center heatmap are kept, along with their corresponding scale in the scale map. Then bounding boxes are generated automatically and remapped to the original image size, followed by NMS. If the offset prediction branch is appended, the centers are adjusted accordingly before remapping.

\section{Experiments}
\subsection{Experiment settings}
\subsubsection{Datasets}
To demonstrate the effectiveness of the proposed method, we evaluate it on several challenging benchmarks, including pedestrian detection and face detection.

For pedestrian detection, we choose two of the largest pedestrian detection benchmarks, i.e. Caltech \cite{dollar2012pedestrian} and CityPersons \cite{zhang2017citypersons}.
Caltech comprises approximately 2.5 hours of autodriving
video with extensively labelled bounding boxes.
 Following \cite{zhang2017citypersons,mao2017can,wang2017repulsion,Liu_2018_ECCV,Zhang_2018_ECCV}, we use the training data augmented by 10 folds (42782 frames) and test on the 4024 frames in the standard test set, all experiments are conducted on the new annotations provided by \cite{zhang2016far}.
CityPersons is a more challenging large-scale pedestrian detection dataset with various occlusion levels. We train the models on the official training set with 2975 images and test on the validation set with 500 images.
One reason we choose these two datasets lies in that they provide bounding boxes via central body line annotation and normalized aspect ratio, this annotation procedure is helpful to ensure the boxes align well with the centers of pedestrians.
Evaluation follows the standard Caltech evaluation metric \cite{dollar2012pedestrian}, that is log-average Miss Rate over False Positive Per Image (FPPI) ranging in [, ] (denoted as ). Tests are only applied on the original image size without enlarging for speed consideration.

For face detection, we choose one of the most challenging face detection benchmark, i.e. WiderFace \cite{yang2016wider}, which contains 32203 images and 393703 annotated face bounding boxes with variations in pose, scale, aspect ratio, occlusion and illumination conditions. The main reason we choose this dataset is due to its large variability of aspect ratios and occlusions. The dataset is split into 40\%, 10\% and 50\% for training, validation and testing, respectively, and defines three levels of difficulty by the detection rate of EdgeBox \cite{zitnick2014edge}: Easy, Medium and Hard. Similar to other state-of-the-art face detectors, the proposed CSP is only trained on the training subset while tested on both validation and testing subsets.
Evaluation follows the official evaluation metric that is the Average Precision (AP).

We conduct the ablative study on the Caltech dataset, and compare the proposed CSP detector with the state of the arts on all the above benchmarks.


\subsubsection{Training details}
We implement the proposed method in Keras\footnote{https://github.com/fchollet/keras}.
The backbone is ResNet-50 \cite{he2016deep} pretrained on ImageNet \cite{deng2009imagenet} unless otherwise stated. Adam \cite{kingma2014adam} is applied to optimize the network. We also apply the strategy of moving average weights proposed in \cite{tarvainen2017mean} to achieve more stable training.
To increase the diversity of the training data, we adopt standard data augmentation techniques including random color distortion, random horizontal flip, random scaling and random crop, finally, the input resolutions of the network during training are 336x448, 640x1280 and 704x704 pixels for Caltech, CityPersons and WiderFace, respectively.

For Caltech, a mini-batch contains 16 images with one GPU (GTX 1080Ti), the learning rate is set as  and training is stopped after 15K iterations. Following\cite{zhang2017citypersons,wang2017repulsion,Liu_2018_ECCV,Zhang_2018_ECCV}, we also include experiments with the model initialized from CityPersons \cite{zhang2017citypersons}, which is trained with the learning rate of .
For CityPersons, we optimize the network on 4 GPUs with 2 images per GPU for a mini-batch, the learning rate is set as  and training is stopped after 37.5K iterations.
For WiderFace, we optimize the network on 8 GPUs with 2 images per GPU for a mini-batch, the learning rate is set as  and training is stopped after 99.5K iterations. We also adopt the similar data-augmentation strategy in PyramidBox \cite{Tang_2018_ECCV} to increase the proportion of small faces during training.

\subsection{Ablation Study}\label{sec:abl}
In this section, an ablative analysis of the proposed CSP detector is conducted on the Caltech dataset, evaluations are based on the new annotations provided by \cite{zhang2016far}.

\textbf{Why is the Center Point?}
As a kind of high-level feature point, the center point is capable of locating an individual object. A question comes in that how about other high-level feature points. To answer this, we choose two other high-level feature points as adopted in \cite{Song_2018_ECCV}, i.e. the top and bottom vertexes. Comparisons are reported in Table. \ref{table:point}. It is shown that both the two vertexes can succeed in detection but underperform the center point by approximately 2\%-3\% under IoU=0.5, and the performance gap is even larger under the stricter IoU=0.75. This is probably because the center point is advantageous to perceive the full body information and thus is easier for training.

\textbf{How important is the Scale Prediction?}
Scale prediction is another indespensible component for bounding box generation. In practice, we merely predict the height for each detected center in accordance to the line annotation in \cite{zhang2018towards,zhang2017citypersons}. To demonstrate the generality of CSP, we have also tried to predict Width or Height+Width for comparison. For Height+Width, the only difference in network architecture lies in that the scale prediction branch has two channels responsible for the height and width respectively. It can be observed in Table \ref{table:scale} that Width and Height+Width prediction can also achieve comparable but suboptimal results to Height prediction. This result may be attributed to the line annotation adopted in \cite{zhang2018towards,zhang2017citypersons} which provides accurate height information with less noise during training. Besides, the ground truth for width is automatically generated by the annotated height information, thus is not able to provide additional information for training.
With the comparable performance from Height +Width prediction, it makes CSP potentially feasible for other object detection tasks requiring both height and width, which will be demonstrated in the following experiments for face detection.
\begin{table}[t]
\begin{center}
\begin{tabular}{c|c|c}
\hline
\multirow{2}{*}{\tabincell{c}{Point\\Prediction}} & \multicolumn{2}{|c}{(\%)}\\
\cline{2-3} {} & IoU=0.5 & IoU=0.75\\
\hline
\hline
Center point & \textbf{4.62}& \textbf{36.47} \\
\hline
Top vertex & 7.75& 44.70 \\
\hline
Bottom vertex & 6.52& 40.25 \\
\hline
\end{tabular}
\end{center}
\caption{Comparisons of different high-level feature points. Bold number indicates the best result.}
\label{table:point}
\end{table}

\begin{table}
\begin{center}
\begin{tabular}{c|c|c}
\hline
\multirow{2}{*}{\tabincell{c}{Scale\\Prediction}} & \multicolumn{2}{|c}{(\%)}\\
\cline{2-3} {} & IoU=0.5 & IoU=0.75\\
\hline
\hline
Height & \textbf{4.62}& \textbf{36.47}\\
\hline
Width & 5.31& 53.06 \\
\hline
Height+Width & 4.73& 41.09\\
\hline
\end{tabular}
\end{center}
\caption{Comparisons of different definitions for scale prediction. Bold number indicates the best result.}
\label{table:scale}
\end{table}

\begin{table*}
\begin{center}
\begin{tabular}{c |c|c|c|c|c|c}
\hline
\multirow{2}{*}{\tabincell{c}{Feature for\\Detection}} & \multirow{2}{*}{+Offset} & \multirow{2}{*}{\tabincell{c}{Test Time\ms/img)}} & \multicolumn{2}{|c|}{(\%)}&\multicolumn{2}{|c}{(\%)}\\
\cline{4-7} {} & {} & {} & IoU=0.5 & IoU=0.75 & IoU=0.5 & IoU=0.75\\
\hline
\hline
 & {} & 69.8 & 5.32 & 30.08 & - & - \\
\hline
\multirow{2}{*}{} & {} & 58.2 & 4.62& 36.47 & \multirow{2}{*}{+0.08} &\multirow{2}{*}{+7.67}\\
\cline{2-5} {} &  & 59.6 & \textbf{4.54}& \textbf{28.80} & {} & {}\\
\hline
\multirow{2}{*}{} & {} & 49.2 & 7.00& 54.25 & \multirow{2}{*}{+0.92} &\multirow{2}{*}{+21.32}\\
\cline{2-5} {} &  & 50.4 & 6.08& 32.93 & {} & {}\\
\hline
\multirow{2}{*}{} & {} & 42.0 & 20.27 & 75.17 & \multirow{2}{*}{\textbf{+12.86}} &\multirow{2}{*}{\textbf{+41.30}}\\
\cline{2-5} {} &  & 42.7 & 7.41 & 33.87 & {} & {}\\
\hline
\end{tabular}
\end{center}
\caption{Comparisons of different downsampling factors of the feature maps, which are denoted as  downsampled by  w.r.t the input image. Test time is evaluated on the image with size of 480x640 pixels.  means the improvement from the utilization of the offset prediction. Bold numbers indicate the best result.}
\label{table:down}
\end{table*}

\begin{table*}
\begin{center}
 \resizebox{.999\textwidth}{!}{
\begin{tabular}{c c c c|c c c|c c c}
\hline
\multicolumn{4}{c|}{Feature Maps} & \multicolumn{3}{|c|}{ResNet-50\cite{he2016deep}} &\multicolumn{3}{|c}{MobileNetV1\cite{howard2017mobilenets}} \\
\hline
 &  &  &  & \# Parameters & Test Time & (\%) & \# Parameters & Test Time & (\%) \\
\hline
\hline
 &  & {} & {} & 4.7MB & 36.2ms/img & 9.96 & 2.1MB & 27.3ms/img & 34.96\\
{} &  &  & {} & 16.1MB & 44.5ms/img & 5.68 & 6.0MB & 32.3ms/img & \textbf{8.33}\\
{} & {} &  &  & 37.4MB & 54.4ms/img & 5.84 & 10.7MB & 34.5ms/img & 10.03\\
 &  &  & {} & 16.7MB & 46.0ms/img & 6.34 & 6.3MB & 33.3ms/img & 8.43\\
{} &  &  &  & 40.0MB & 58.2ms/img & \textbf{4.62}& 12.3MB & 38.2ms/img & 9.59\\
 &  &  &  & 40.6MB & 61.1ms/img & 4.99& 12.6MB & 40.5ms/img & 9.05\\
\hline
\end{tabular}
}
\end{center}

\caption{Comparisons of different combinations of multi-scale feature representations defined in Sec. \ref{sec:arc}. , ,  and  represent the output of \emph{stage 2, 3, 4 and 5} of a backbone network, respectively.  Bold numbers indicate the best results.}
\label{table:featcom}

\end{table*}

\textbf{How important is the Feature Resolution?}
In the proposed method, the final set of feature maps (denoted as ) is downsampled by  w.r.t the input image. To explore the influence from , we train the models with  respectively. For ,  are up-sampled from  by deconvolution. To remedy the issue of poor localization from downsampling, the offset prediction branch is alternatively appended for  to adjust the center location.
Evaluations under IoU=0.75 are included to verify the effectiveness of additional offset prediction when stricter localization quality is required.
As can be seen from Table. \ref{table:down}, without offset prediction,  presents the best result under IoU=0.5, but performs poorly under IoU=0.75 when compared with , which indicates that finer feature maps are beneficial for precise localization. Though  performs the best under IoU=0.75, it does not bring performance gain under IoU=0.5 though with more computational burdens. Not surprisingly, a larger  witnesses a significant performance drop, which is mainly due to that coarser feature maps lead to poor localization. In this case, the offset prediction plays a significant role. Notably, additional offset prediction can substantially improve the detector upon  by 12.86\% and 41.30\% under the IoU threshold of 0.5 and 0.75, respectively. It can also achieve an improvement of 7.67\% under IoU=0.75 for the detector upon , even though the performance gain is saturating under IoU=0.5. It is worth noting that the extra computation cost from the offset prediction is negligible, with approximately 1ms per image of 480x640 pixels.

\textbf{How important is the Feature Combination?}
It has been revealed in \cite{Song_2018_ECCV} that multi-scale representation is vital for pedestrian detection of various scales. In this part, we conduct an ablative experiment to study which combination of the multi-scale feature maps from the backbone is the optimal one. As the much lower layer has limited discriminant information, in practice we choose the output of stage 2 () as a start point and the downsampling factor  is fixed as 4. In spite of the ResNet-50~\cite{he2016deep} with \emph{stronger} feature representation, we also choose a light-weight network like MobileNetV1~\cite{howard2017mobilenets} as the backbone. The results in Table \ref{table:featcom} illustrate that the much shallower feature maps like  result in poorer accuracy, while deeper feature maps like  and  are of great importance for superior performance, and the middle-level feature maps  are indispensable to achieve the best results. For ResNet-50, the best performance comes from the combination of , while  is the optimal one for MobileNetV1.


\begin{figure*}[t]
\begin{center}
\includegraphics[width=1.0\linewidth]{4.jpg}
\end{center}
   \caption{Comparisons with the state of the arts on Caltech using new annotations.}
\label{fig:cal}
\end{figure*}

\begin{table*}
\begin{center}
\resizebox{.999\textwidth}{!}{
\begin{tabular}{c|c|c|c c c|c c c|c}
\hline
Method & Backbone & Reasonable & Heavy & Partial & Bare & Small & Medium & Large & Test Time\\
\hline
\hline
FRCNN\cite{zhang2017citypersons} & VGG-16 & 15.4 & - & - & - & 25.6 & 7.2 & 7.9 & -\\
\hline
Retina Net \cite{lin2017focal}  & ResNet-50 & 15.6 & 49.98 & - & - & - & - & - & -\\
\hline
CornerNet \cite{Law_2018_ECCV} & Hourglass-54 & 21.0 & 56.0 & - & - & - & - & - & -\\
\hline
FRCNN+Seg\cite{zhang2017citypersons} & VGG-16 & 14.8 & - & - & - & 22.6 & 6.7 & 8.0 & -\\
\hline
OR-CNN\cite{Zhang_2018_ECCV} & VGG-16 & 12.8 & 55.7 & 15.3 & \color{red}{6.7} & - & - & - & -\\
\hline
RepLoss\cite{wang2017repulsion} & ResNet-50 & 13.2 & 56.9 & 16.8 & 7.6 & - & - & -& -\\
\hline
TLL\cite{Song_2018_ECCV} & ResNet-50 & 15.5 & 53.6 & 17.2 & 10.0 & - & - & -& -\\
\hline
TLL+MRF\cite{Song_2018_ECCV} & ResNet-50 & 14.4 & 52.0 & 15.9 & 9.2 & - & - & -& -\\
\hline
ALFNet\cite{Liu_2018_ECCV} & ResNet-50 & 12.0 & 51.9 & 11.4 & 8.4 & 19.0 & 5.7 & 6.6 & 0.27s/img\\
\hline
CSP(w/o offset) & ResNet-50 & \color{green}{11.4} & \color{green}{49.9} & \color{green}{10.8} & 8.1 & \color{green}{18.2} & \color{green}{3.9} & \color{red}{6.0}& 0.33s/img\\
\hline
CSP(with offset) & ResNet-50 & \color{red}{11.0} & \color{red}{49.3} & \color{red}{10.4} & \color{green}{7.3} & \color{red}{16.0} & \color{red}{3.7} & \color{green}{6.5}& 0.33s/img\\
\hline
\end{tabular}
}
\end{center}
\caption{Comparison with the state of the arts on CityPersons\cite{zhang2017citypersons}. Results test on the original image size (1024x2048 pixels) are reported. {\color{red}{Red}} and {\color{green}{green}} indicate the best and second best performance.}
\label{table:cityval}
\end{table*}

\subsection{Comparison with the State of the Arts}
\subsubsection{Pedestrian Detection}
\textbf{Caltech.}
We compared extensively our proposed approach with other methods on three settings: Reasonable, All and Heavy Occlusion.
As shown in Fig. \ref{fig:cal}, CSP achieves  of 4.5\% on the Reasonable setting, which outperforms the best competitor (5.0 of RepLoss \cite{wang2017repulsion}) by 0.4\%. When the model is initialized from CityPersons\cite{zhang2017citypersons}, CSP also achieves a new state of the art of 3.8\%, compared to 4.0\% of RepLoss \cite{wang2017repulsion}, 4.1\% of OR-CNN \cite{Zhang_2018_ECCV}, and 4.5\% of ALFNet \cite{Liu_2018_ECCV}. It presents the superiority on detecting pedestrians of various scales and occlusion levels as demonstrated in Fig . \ref{fig:cal} (b). Moreover, Fig. \ref{fig:cal} (c) shows that CSP also performs very well for heavily occluded pedestrians, outperforming RepLoss \cite{wang2017repulsion} and OR-CNN \cite{Zhang_2018_ECCV} which are explicitly designed for occlusion cases.

\textbf{CityPersons.}
Table \ref{table:cityval} shows the comparison with previous state of the arts on CityPersons.
Besides the reasonable subset, following \cite{wang2017repulsion}, we also evaluate on three subsets with different occlusion levels, and following \cite{zhang2017citypersons}, results on three subsets with various scale ranges are also included. It can be observed that CSP beats the competitors and performs fairly well on occlusion cases even without any specific occlusion-handling strategies \cite{wang2017repulsion,Zhang_2018_ECCV}.
On the Reasonable subset, CSP with offset prediction achieves the best performance, with a gain of 1.0\%  upon the closest competitor (ALFNet \cite{Liu_2018_ECCV}), while the speed is comparable on the same running environment with 0.33 second per image of 1024x2048 pixels. Additionally, we also compare against state of the art (Retina Net \cite{lin2017focal} and CornerNet \cite{Law_2018_ECCV}) in generic object detection. With results presented in Table \ref{table:cityval}, it is clear that CSP performs best in pedestrian detection.

\begin{figure*}[t]
\begin{center}
\includegraphics[width=1.0\linewidth]{5.jpg}
\end{center}
   \caption{Precision-recall curves on WIDER FACE validation and testing subsets.}
\label{fig:wider}
\end{figure*}

\subsubsection{Face Detection}
\textbf{WiderFace}.
The model trained on the training subset of WiderFace are evaluated on both the validation and test subsets, and the multi-scale testing is also performed in a similar way as in \cite{Tang_2018_ECCV}. Comparisons with the state-of-the-art face detectors on WiderFace are shown in Fig. \ref{fig:wider}. It can be seen that the proposed CSP detector achieves competitive performance among the state-of-the-art face detectors across the three subsets, i.e. 90.7\% (Hard), 95.2\% (Medium) and 96.1\% (Easy) on validation subset, and 89.9\% (Hard), 94.4\% (Medium) and 94.9\% (Easy) on test subset. Note that most of these face detectors are anchor box based. Therefore, the results indicate a superiority of the proposed CSP detector when complex default anchor box design and anchor box matching strategies are abandoned.

\subsection{Generalization ability of the proposed method}
To further demonstrate the generalization ability of the proposed CSP detector, we perform cross-dataset evaluation on two tasks, i.e. pedestrian detection and face detection. Specifically, models trained on the source dataset are directly tested on the target dataset without further finetuning. Furthermore, unlike humans, faces occur in different scale and aspect ratio, as shown in Table \ref{table:arcomp}. In Table \ref{table:arcomp}, we illustrate that in order to achieve high localization accuracy for faces, CSP needs to predict both height and width jointly, as oppose to simply predicting height (as in pedestrian detection).

\subsubsection{Cross-dataset evalutaion for Pedestrian Detection}
For pedestrian detection, we compare the proposed CSP detector with the state-of-the-art anchor box based pedestrian detector (ALFNet \cite{Liu_2018_ECCV}). Both of the two detectors are trained on the CityPersons \cite{zhang2017citypersons} training subset and then are directly tested on the Caltech \cite{dollar2012pedestrian} test subset. For ALFNet \cite{Liu_2018_ECCV}, we use the source code and models provided by the authors\footnote{https://github.com/liuwei16/ALFNet}.
Results shown in Table \ref{table:1} are based on the reasonable setting, and the evaluation metric is Miss Rate (MR). It can be seen that the gap between the two detectors on the source dataset (CityPersons) is merely 1\%, but the gap on the target dataset (Caltech) increases to 5.9\%, which gives the evidence that the proposed CSP detector generalizes better to another dataset than the anchor box based competitor, i.e. ALFNet \cite{Liu_2018_ECCV}.

\begin{table}
\begin{center}
\begin{tabular}{c|c|c}
\hline
Methods & CityPersons  CityPersons & CityPersons  Caltech\\
\hline
\hline
ALFNet\cite{Liu_2018_ECCV} & 12.0 & 17.8\\
\hline
CSP[ours] & \textbf{11.0} & \textbf{11.9}\\
\hline
\end{tabular}
\end{center}
\caption{Comparisons of the generalization ability for pedestrian detection (Evaluation metric: Miss Rate; the lower, the better).}
\label{table:1}
\end{table}

\begin{table}
\begin{center}
\begin{tabular}{c|c|c|c}
\hline
Dataset & FDDB \cite{fddbTech} & UCCS \cite{uccs} & DarkFace \cite{wei2018deep}\\
\hline
\hline
Num. of images & 2485 & 5232 & 6000\\
\hline
Num. of faces & 5171 & 11109 & 43849\\
\hline
Mean face size & 95x141 & 225x407 & 16x17\\
\hline
Mean image size & 377x399 & 5184x3456 & 1080x720\\
\hline
\end{tabular}
\end{center}
\caption{Statistics of three face detection datasets for cross-dataset evaluation.}
\label{table:2}
\end{table}

\begin{figure*}[t]
\begin{center}
\includegraphics[width=1.0\linewidth]{6_n.jpg}
\end{center}
   \caption{Comparisons of ROC results on the FDDB dataset.}
\label{fig:fddb}
\end{figure*}

\subsubsection{Cross-dataset evalutation for Face Detection}
For face detection, models trained on the WiderFace \cite{yang2016wider} training subset are directly tested on three other face detection datasets, i.e. FDDB \cite{fddbTech}, UCCS \cite{uccs} and DarkFace \cite{wei2018deep}. Detailed statistics about these three datasets for testing are listed in Table \ref{table:2}. It can be seen that these three datasets exhibit a large difference in the mean size of face objects.

FDDB \cite{fddbTech} is also a widely adopted face detection benchmark. Comparisons with other advanced face detectors on this benchmark are reported in Fig. \ref{fig:fddb}, results of other face detectors are from FDDB's official website\footnote{http://vis-www.cs.umass.edu/fddb/results.html}. As shown in Fig. \ref{fig:fddb}, the proposed CSP detector achieves competitive results on both discontinuous and continuous ROC curves, with the true positive rate of 99.2\% and 86.0\% when the number of false positives equals to 1000, while the results of the most recent anchor box based face detector (DSFD \cite{li2018dsfd}) are 99.1\% and 86.2\%, respectively. Since face images of both FDDB and WiderFace are obtained from the Internet, they are basically similar. Therefore, both CSP and DSFD detectors trained on WiderFace perform quite good on FDDB, and there is little performance difference between them.

However, when evaluated on the other two quite different face datasets, UCCS \cite{uccs} and DarkFace \cite{wei2018deep}, it is interesting to see some difference.
UCCS \cite{uccs}, with the full name of UnConstrained College Students (UCCS), is a recently published dataset collected by a long-range high-resolution surveillance camera. The significant difference between UCCS \cite{uccs} and other face detection datasets is that the data are collected unconstrainedly in surveillance scenes. People walking on the sidewalk did not aware that they were being recorded. As the annotations of the test subset is publicly unavailable, results on the validation subset are reported.

DarkFace \cite{wei2018deep} is a recently published face detection dataset collected during nighttime, which exhibits an extreme light condition compared to other face detection datasets. The average size of the face objects in this dataset is merely 16x17 pixels. In the official website\footnote{https://flyywh.github.io/CVPRW2019LowLight/}, it totally released 6000 images, on which we test both models and report the results.

For UCCS \cite{uccs} and DarkFace \cite{wei2018deep}, we compare the proposed CSP with the state-of-the-art anchor box based face detector (DSFD \cite{li2018dsfd}). For DSFD, we use the source code and models provided by the authors\footnote{https://github.com/TencentYoutuResearch/FaceDetection-DSFD}.
Results are given in Table \ref{table:3}, and the evaluation metric is the Average Precision (AP). As can be seen from Table \ref{table:3}, though the proposed CSP slightly underperforms DSFD on the WiderFace test subset, it achieves a significant gain over DSFD on these two cross-dataset evaluations, with 3.7\% and 2.1\% on UCCS \cite{uccs} and DarkFace \cite{wei2018deep}, respectively. Due to the substantial domain gaps between UCCS, DarkFace and WiderFace, both models trained on WiderFace perform unsurprisingly poor on UCCS and DarkFace, but the proposed CSP detector still outperforms the anchor box based DSFD, which gives the evidence that CSP generalizes better to unknown domains than the anchor box based competitor. It is possible that the default configurations of anchor boxes in anchor-based detectors can not adapt to new scenes especially when the scales and aspect ratios of objects have a large difference as shown in Table \ref{table:2}. In contrast, the proposed detector simply predicts the centers and scales of objects without any considerations of priors of the objects in the dataset, thus shows a better generalization ability.

\begin{table}
\begin{center}
\begin{tabular}{c|c|c|c|c|c}
\hline
\multirow{2}{*}{Methods} & \multicolumn{3}{c|}{WiderFace  WiderFace} & \multirow{2}{*}{WiderFace  UCCS} & \multirow{2}{*}{WiderFace  DarkFace}\\
\cline{2-4} {} & Hard & Medium & Easy & {} & {}\\
\hline
\hline
DSFD \cite{li2018dsfd} & \textbf{90.0} & \textbf{95.3} & \textbf{96.0} & 7.6 & 25.9\\
\hline
CSP[ours] & 89.9 & 94.4 & 94.9 & \textbf{11.3} & \textbf{28.0}\\
\hline
\end{tabular}
\end{center}
\caption{Comparisons on generalization ability of face detectors (Evaluation metric: Average Precision (AP); the higher, the better).}
\label{table:3}
\end{table}

\begin{table}
\begin{center}
\begin{tabular}{c|c|c}
\hline
Disturbance (pixels) &  & \\
\hline
\hline
0 & 4.62 & -\\
\hline
[0, 4] & 5.68& \\
\hline
[0, 8] & 8.59& \\
\hline
\end{tabular}
\end{center}
\caption{Performance drop with disturbances of the centers.}
\label{table:disturb}
\end{table}


\begin{table}
\begin{center}
\begin{tabular}{c|c|c}
\hline
Method & CSP H + W & CSP H \\
\hline
\hline
Easy & 0.961 & 0.903\\
\hline
Medium & 0.952 & 0.898\\
\hline
Hard & 0.907 & 0.840 \\
\hline
\end{tabular}
\end{center}
\caption{Table 1: CSP with H+W vs. CSP with H only.}
\label{table:arcomp}
\end{table}


\subsection{Discussions}
Note that CSP only requires object centers and scales for training, though generating them from bounding box or central line annotations is more feasible since centers are not always easy to annotate. Besides, the model may be puzzled on ambiguous centers during training. To demonstrate this, we also conduct an ablative experiment on Caltech, in which object centers are randomly disturbed in the range of [0,4] and [0,8] pixels during training. From the results shown in Table \ref{table:disturb}, it can be seen that performance drops with increasing annotation noise. For Caltech, we also apply the original annotations but with inferior performance to TLL \cite{Song_2018_ECCV}, which is also box-free. A possible reason is that TLL includes a series of post-processing strategies in keypoint pairing. For evaluation with tight annotations based on central lines, as results of TLL on Caltech are not reported in \cite{Song_2018_ECCV}, comparison to TLL is given in Table \ref{table:cityval} on the CityPersons, which shows the superiority of CSP. Therefore, the proposed method may be limited for annotations with ambiguous centers, e.g. the traditional pedestrian bounding box annotations affected by limbs. In view of this, it may also be not straightforward to apply CSP to generic object detection without further improvement or new annotations.

When compared with anchor box based methods, the advantage of CSP lies in two aspects. Firstly, CSP does not require tedious configurations on anchor boxes specifically for each dataset. Secondly, anchor box based methods detect objects by overall classifications of each anchor box where background information and occlusions are also included and will confuse the detector's training. However, CSP overcomes this drawback by scanning for pedestrian centers instead of boxes in an image, thus is more robust to occluded objects.


\section{Conclusion}
Inspired from the traditional feature detection task, we provide a new perspective where pedestrian detection is motivated as a high-level semantic feature detection task through straightforward convolutions for center and scale predictions. This way, the proposed method enjoys box-free settings and is also free from complex post-processing strategies as in recent keypoint-pairing based detectors. As a result, the proposed CSP detector achieves the new state-of-the-art performance on two challenging pedestrian detection benchmarks, namely CityPersons and Caltech.
Due to the general structure of the CSP detector, we further evaluate it for face detection on the most popular face detection benchmark, i.e. WiderFace. The comparable performance to other advanced anchor box based face detectors also shows the proposed CSP detector's competitiveness. Besides, experiments on cross-dataset evaluation for both pedestrian detection and face detection further demonstrate CSP's superior generalization ability over anchor box based detectors. For future possibilities, it is interesting to further explore CSP's capability in general object detection. Given its superiority on cross-dataset evaluation, it is also interesting to see CSP's potential when domain adaptation techniques are further explored.

\begin{acknowledgements}
This work was partly supported by the National Key Research and Development Plan (Grant No.2016YFC0801003), the NSFC Project \#61672521, the NLPR Independent Research Project \#Z-2018008, and the IIAI financial support.
\end{acknowledgements}

\bibliographystyle{spmpsci}      \bibliography{csp}   



\end{document}
