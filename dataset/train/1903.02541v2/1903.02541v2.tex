\ifdefined\COMPLETE
\else
\documentclass[12pt]{article}
\newtheorem{thm}{Theorem}[section]
\usepackage{thmtools}
\usepackage{thm-restate}
\usepackage{hyperref}
\usepackage{wrapfig}
\usepackage{mathtools}
\usepackage[normalem]{ulem}
\usepackage{url}
\usepackage{multirow}
\usepackage{xspace}
\usepackage{amsmath}
\usepackage{cleveref}
\usepackage{amsthm}
\usepackage{textcomp}
\usepackage{amssymb}
\usepackage{amsfonts}\usepackage[final]{graphicx}
\usepackage{threeparttable}
\usepackage{enumitem}
\usepackage{parskip}
\usepackage{mathrsfs}
\usepackage{booktabs}
\usepackage{caption}
\usepackage{tcolorbox}
\usepackage{times}
\usepackage{graphicx}
\usepackage{bbm}
\usepackage{bm}
\usepackage{color}
\usepackage{colortbl}
\usepackage{bbold}


\usepackage{listings}

\usepackage{tikz}
\usepackage{tkz-graph}
\usetikzlibrary{positioning,matrix,calc,patterns}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{booktabs}
\usepackage{makecell}
\usepackage{rotating}
\usepackage{pdflscape}
\usepackage{csquotes}
\usepackage{ulem}

\lstset{
basicstyle=\small\ttfamily,
columns=flexible,
breaklines=true
}






 


\newcommand{\myparagraph}[1]{{\noindent  \bf #1.}}

\newcommand{\bruno}[1]{{\color{blue}#1}}
\newcommand{\ryan}[1]{{\color{olive}#1}}
\newcommand{\vinayak}[1]{{\color{red}(VR:#1)}}
\newcommand{\bala}[1]{{\color{purple}(BS:#1)}} 



\newcommand{\Xv}{\mX^{(v)}}
\newcommand{\Xe}{\tX^{(e)}}
\newcommand{\eXv}{\emX^{(v)}}
\newcommand{\eXe}{\etX^{(e)}}

\newcommand{\GCN}{GCN\xspace}
\newcommand{\GCNs}{GCNs\xspace}
\newcommand{\deepWL}{deep-WL\xspace}
\newcommand{\deepWLs}{deep-WLs\xspace}
\newcommand{\AH}{Relational\xspace}
\newcommand{\ah}{relational\xspace}
\newcommand{\graphsage}{GraphSAGE\xspace}

\newcommand{\Aggregate}{\text{Aggregate}}





\newcommand{\NA}{--}
\newcommand{\numLayers}{L}
\newcommand{\aLayer}{l}
\newcommand{\skipLength}{K}
\newcommand{\trad}{p_{\mathrm{trad}}}
\newcommand{\tradn}[1]{p_{\mathrm{trad}, n}}
\newcommand{\pgraph}{\mathcal{H}}  \newcommand{\scale}{\mathrm{scale_{n}}}  \newcommand{\range}{$\mathrm{range}$\xspace} 

\newcommand{\numPermutations}{T}
\newcommand{\aPerm}{t}

\newcommand{\ftheta}{\boldsymbol{\theta}^{(f)}}
\newcommand{\rhoTheta}{\boldsymbol{\theta}^{(\rho)}}
\newcommand{\htheta}{\boldsymbol{\theta}^{(h)}}
\newcommand{\Jloss}{J}
\newcommand{\set}{variable-length multiset\xspace}
\newcommand{\sets}{variable-length multisets\xspace}
\newcommand{\Set}{Variable-length multiset\xspace}
\newcommand{\Sets}{Variable-length multisets\xspace}
\newcommand{\setleft}{ [  }
\newcommand{\setright}{  ]   }
\newcommand{\specScale}{(1)\xspace}
\newcommand{\specNoCard}{(2)\xspace}
\newcommand{\specHomog}{(3)\xspace}

\newcommand{\Appendix}{Supplementary Material\xspace}
\newcommand{\stageTwo}{\eta}
\newcommand{\transpose}{^{\text{T}}}  \newcommand{\circleGraph}[2]{\mathcal{C}_{#1, #2}}

\newcommand{\pj}[1]{\downarrow_{#1}\!\!}
\newcommand*\dbar[1]{\overline{\overline{\lower0.2ex\hbox{$#1$}}}}
    
\newcommand{\harrow}[1]{\mathstrut\mkern2.5mu#1\mkern-11mu\raise1.6ex\hbox{$\scriptscriptstyle\rightharpoonup$}}

\newcommand{\harrowStable}[1]{\overset{\rightharpoonup}{#1}}

\newcommand{\kcard}{|\vhid|}

\newcommand{\sData}{\sX}
\newcommand{\sHid}{\sH}

\newcommand{\evdata}{\evx}
\newcommand{\vdata}{\vx}
\newcommand{\evhid}{\evh}
\newcommand{\vhid}{\vh}
\newcommand{\thetaToF}{\vtheta^{(f)}}
\newcommand{\thetaToRho}{\vtheta^{(\rho)}}
\newcommand{\thetaToH}{\vtheta^{(f)}}



\colorlet{darkgreen}{green!50!black}
\newcommand*{\littleGraphOne}{{\scriptsize
\tikz[scale=0.1]{
\draw[thin] (0,2) -- (1,0);
\draw[fill=black,draw=black] (1,0) circle (12pt);
\draw[fill=black,draw=black] (0,2) circle (12pt);
\draw[fill=black,draw=black] (2,2) circle (12pt);
}
}}

\newcommand*{\littleGraphTwo}{{\scriptsize
\tikz[scale=0.1]{
\draw[thin] (0,2) -- (2,2) -- (1,0) -- (0,2);
\draw[fill=black,draw=black] (1,0) circle (12pt);
\draw[fill=black,draw=black] (0,2) circle (12pt);
\draw[fill=black,draw=black] (2,2) circle (12pt);
}
}}



\newcommand{\cH}{\mathcal{H}}
\newcommand{\cF}{\mathcal{F}}
\newcommand{\cC}{\mathcal{C}}
\newcommand{\cU}{\mathcal{U}}
\newcommand{\cX}{\mathcal{X}}
\newcommand{\cD}{\mathcal{D}}
\newcommand{\cT}{\mathcal{T}}
\newcommand{\cP}{\mathcal{P}}
\newcommand{\cZ}{\mathcal{Z}}
\newcommand{\cY}{\mathcal{Y}}
\newcommand{\cS}{\mathcal{S}}
\newcommand{\cE}{\mathcal{E}}
\newcommand{\cM}{\mathcal{M}}
\newcommand{\cL}{\mathcal{L}}
\newcommand{\bA}{{\bf A}}
\newcommand{\bW}{{\bf W}}
\newcommand{\bM}{{\bf M}}
\newcommand{\bX}{{\bf X}}
\newcommand{\bH}{{\bf H}}
\newcommand{\bx}{{\bf x}}
\newcommand{\by}{{\bf y}}
\newcommand{\bU}{{\bf U}}
\newcommand{\bV}{{\bf V}}
\newcommand{\bP}{{\bf P}}
\newcommand{\bh}{{\bf h}}
\newcommand{\bb}{{\bf b}}

\newcommand{\bzero}{\boldsymbol{0}}
\newcommand{\bone}{\mathbbm{1}}
\newcommand{\btheta}{\boldsymbol{\theta}}



\newtheorem{theorem}{Theorem}[section]
\newtheorem*{theorem*}{Theorem}
\newtheorem{conjecture}{Conjecture}[section]
\newtheorem{proposition}{Proposition}[section]
\newtheorem*{proposition*}{Proposition}
\newtheorem{lemma}{Lemma}[section]
\newtheorem*{lemma*}{Lemma}

\newenvironment{restat}
{\restatable{theorem}{staircase}}
{\endrestatable}

\newenvironment{restatProp}
{\restatable{proposition}{pisgd}}
{\endrestatable}


\newtheorem{corollary}{Corollary}[section]
\newtheorem{remark}{Remark}[section]

\newtheorem{definition}{Definition}[section]
\renewenvironment{definition}{\refstepcounter{definition}\par\noindent\textit{Definition~\thedefinition:}\xspace}{\nobreak\hfill$\Diamond$\par}

\newtheorem{example}{Example}[section]




\newcommand{\indep}{\mathbin{\rotatebox[origin=c]{90}{$\models$}}}

\newcommand*{\nindep}{\mathbin{\mathpalette{\not}{\!\!\indep}}}
\def\Prob{{\mbbs{P}}\xspace}


 

\newcommand{\figleft}{{\em (Left)}}
\newcommand{\figcenter}{{\em (Center)}}
\newcommand{\figright}{{\em (Right)}}
\newcommand{\figtop}{{\em (Top)}}
\newcommand{\figbottom}{{\em (Bottom)}}
\newcommand{\captiona}{{\em (a)}}
\newcommand{\captionb}{{\em (b)}}
\newcommand{\captionc}{{\em (c)}}
\newcommand{\captiond}{{\em (d)}}

\newcommand{\newterm}[1]{{\bf #1}}


\def\figref#1{figure~\ref{#1}}
\def\Figref#1{Figure~\ref{#1}}
\def\twofigref#1#2{figures \ref{#1} and \ref{#2}}
\def\quadfigref#1#2#3#4{figures \ref{#1}, \ref{#2}, \ref{#3} and \ref{#4}}
\def\secref#1{section~\ref{#1}}
\def\Secref#1{Section~\ref{#1}}
\def\twosecrefs#1#2{sections \ref{#1} and \ref{#2}}
\def\secrefs#1#2#3{sections \ref{#1}, \ref{#2} and \ref{#3}}
\def\eqref#1{equation~\ref{#1}}
\def\Eqref#1{Equation~\ref{#1}}
\def\plaineqref#1{\ref{#1}}
\def\chapref#1{chapter~\ref{#1}}
\def\Chapref#1{Chapter~\ref{#1}}
\def\rangechapref#1#2{chapters\ref{#1}--\ref{#2}}
\def\algref#1{algorithm~\ref{#1}}
\def\Algref#1{Algorithm~\ref{#1}}
\def\twoalgref#1#2{algorithms \ref{#1} and \ref{#2}}
\def\Twoalgref#1#2{Algorithms \ref{#1} and \ref{#2}}
\def\partref#1{part~\ref{#1}}
\def\Partref#1{Part~\ref{#1}}
\def\twopartref#1#2{parts \ref{#1} and \ref{#2}}

\def\ceil#1{\lceil #1 \rceil}
\def\floor#1{\lfloor #1 \rfloor}
\def\1{\bm{1}}
\newcommand{\train}{\mathcal{D}}
\newcommand{\valid}{\mathcal{D_{\mathrm{valid}}}}
\newcommand{\test}{\mathcal{D_{\mathrm{test}}}}

\def\eps{{\epsilon}}


\def\reta{{\textnormal{$\eta$}}}
\def\ra{{\textnormal{a}}}
\def\rb{{\textnormal{b}}}
\def\rc{{\textnormal{c}}}
\def\rd{{\textnormal{d}}}
\def\re{{\textnormal{e}}}
\def\rf{{\textnormal{f}}}
\def\rg{{\textnormal{g}}}
\def\rh{{\textnormal{h}}}
\def\ri{{\textnormal{i}}}
\def\rj{{\textnormal{j}}}
\def\rk{{\textnormal{k}}}
\def\rl{{\textnormal{l}}}
\def\rn{{\textnormal{n}}}
\def\ro{{\textnormal{o}}}
\def\rp{{\textnormal{p}}}
\def\rq{{\textnormal{q}}}
\def\rr{{\textnormal{r}}}
\def\rs{{\textnormal{s}}}
\def\rt{{\textnormal{t}}}
\def\ru{{\textnormal{u}}}
\def\rv{{\textnormal{v}}}
\def\rw{{\textnormal{w}}}
\def\rx{{\textnormal{x}}}
\def\ry{{\textnormal{y}}}
\def\rz{{\textnormal{z}}}

\def\rvepsilon{{\mathbf{\epsilon}}}
\def\rvtheta{{\mathbf{\theta}}}
\def\rva{{\mathbf{a}}}
\def\rvb{{\mathbf{b}}}
\def\rvc{{\mathbf{c}}}
\def\rvd{{\mathbf{d}}}
\def\rve{{\mathbf{e}}}
\def\rvf{{\mathbf{f}}}
\def\rvg{{\mathbf{g}}}
\def\rvh{{\mathbf{h}}}
\def\rvu{{\mathbf{i}}}
\def\rvj{{\mathbf{j}}}
\def\rvk{{\mathbf{k}}}
\def\rvl{{\mathbf{l}}}
\def\rvm{{\mathbf{m}}}
\def\rvn{{\mathbf{n}}}
\def\rvo{{\mathbf{o}}}
\def\rvp{{\mathbf{p}}}
\def\rvq{{\mathbf{q}}}
\def\rvr{{\mathbf{r}}}
\def\rvs{{\mathbf{s}}}
\def\rvt{{\mathbf{t}}}
\def\rvu{{\mathbf{u}}}
\def\rvv{{\mathbf{v}}}
\def\rvw{{\mathbf{w}}}
\def\rvx{{\mathbf{x}}}
\def\rvy{{\mathbf{y}}}
\def\rvz{{\mathbf{z}}}

\def\erva{{\textnormal{a}}}
\def\ervb{{\textnormal{b}}}
\def\ervc{{\textnormal{c}}}
\def\ervd{{\textnormal{d}}}
\def\erve{{\textnormal{e}}}
\def\ervf{{\textnormal{f}}}
\def\ervg{{\textnormal{g}}}
\def\ervh{{\textnormal{h}}}
\def\ervi{{\textnormal{i}}}
\def\ervj{{\textnormal{j}}}
\def\ervk{{\textnormal{k}}}
\def\ervl{{\textnormal{l}}}
\def\ervm{{\textnormal{m}}}
\def\ervn{{\textnormal{n}}}
\def\ervo{{\textnormal{o}}}
\def\ervp{{\textnormal{p}}}
\def\ervq{{\textnormal{q}}}
\def\ervr{{\textnormal{r}}}
\def\ervs{{\textnormal{s}}}
\def\ervt{{\textnormal{t}}}
\def\ervu{{\textnormal{u}}}
\def\ervv{{\textnormal{v}}}
\def\ervw{{\textnormal{w}}}
\def\ervx{{\textnormal{x}}}
\def\ervy{{\textnormal{y}}}
\def\ervz{{\textnormal{z}}}

\def\rmA{{\mathbf{A}}}
\def\rmB{{\mathbf{B}}}
\def\rmC{{\mathbf{C}}}
\def\rmD{{\mathbf{D}}}
\def\rmE{{\mathbf{E}}}
\def\rmF{{\mathbf{F}}}
\def\rmG{{\mathbf{G}}}
\def\rmH{{\mathbf{H}}}
\def\rmI{{\mathbf{I}}}
\def\rmJ{{\mathbf{J}}}
\def\rmK{{\mathbf{K}}}
\def\rmL{{\mathbf{L}}}
\def\rmM{{\mathbf{M}}}
\def\rmN{{\mathbf{N}}}
\def\rmO{{\mathbf{O}}}
\def\rmP{{\mathbf{P}}}
\def\rmQ{{\mathbf{Q}}}
\def\rmR{{\mathbf{R}}}
\def\rmS{{\mathbf{S}}}
\def\rmT{{\mathbf{T}}}
\def\rmU{{\mathbf{U}}}
\def\rmV{{\mathbf{V}}}
\def\rmW{{\mathbf{W}}}
\def\rmX{{\mathbf{X}}}
\def\rmY{{\mathbf{Y}}}
\def\rmZ{{\mathbf{Z}}}

\def\ermA{{\textnormal{A}}}
\def\ermB{{\textnormal{B}}}
\def\ermC{{\textnormal{C}}}
\def\ermD{{\textnormal{D}}}
\def\ermE{{\textnormal{E}}}
\def\ermF{{\textnormal{F}}}
\def\ermG{{\textnormal{G}}}
\def\ermH{{\textnormal{H}}}
\def\ermI{{\textnormal{I}}}
\def\ermJ{{\textnormal{J}}}
\def\ermK{{\textnormal{K}}}
\def\ermL{{\textnormal{L}}}
\def\ermM{{\textnormal{M}}}
\def\ermN{{\textnormal{N}}}
\def\ermO{{\textnormal{O}}}
\def\ermP{{\textnormal{P}}}
\def\ermQ{{\textnormal{Q}}}
\def\ermR{{\textnormal{R}}}
\def\ermS{{\textnormal{S}}}
\def\ermT{{\textnormal{T}}}
\def\ermU{{\textnormal{U}}}
\def\ermV{{\textnormal{V}}}
\def\ermW{{\textnormal{W}}}
\def\ermX{{\textnormal{X}}}
\def\ermY{{\textnormal{Y}}}
\def\ermZ{{\textnormal{Z}}}

\def\vzero{{\bm{0}}}
\def\vone{{\bm{1}}}
\def\vmu{{\bm{\mu}}}
\def\vtheta{{\bm{\theta}}}
\def\va{{\bm{a}}}
\def\vb{{\bm{b}}}
\def\vc{{\bm{c}}}
\def\vd{{\bm{d}}}
\def\ve{{\bm{e}}}
\def\vf{{\bm{f}}}
\def\vg{{\bm{g}}}
\def\vh{{\bm{h}}}
\def\vi{{\bm{i}}}
\def\vj{{\bm{j}}}
\def\vk{{\bm{k}}}
\def\vl{{\bm{l}}}
\def\vm{{\bm{m}}}
\def\vn{{\bm{n}}}
\def\vo{{\bm{o}}}
\def\vp{{\bm{p}}}
\def\vq{{\bm{q}}}
\def\vr{{\bm{r}}}
\def\vs{{\bm{s}}}
\def\vt{{\bm{t}}}
\def\vu{{\bm{u}}}
\def\vv{{\bm{v}}}
\def\vw{{\bm{w}}}
\def\vx{{\bm{x}}}
\def\vy{{\bm{y}}}
\def\vz{{\bm{z}}}

\def\evalpha{{\alpha}}
\def\evbeta{{\beta}}
\def\evepsilon{{\epsilon}}
\def\evlambda{{\lambda}}
\def\evomega{{\omega}}
\def\evmu{{\mu}}
\def\evpsi{{\psi}}
\def\evsigma{{\sigma}}
\def\evtheta{{\theta}}
\def\eva{{a}}
\def\evb{{b}}
\def\evc{{c}}
\def\evd{{d}}
\def\eve{{e}}
\def\evf{{f}}
\def\evg{{g}}
\def\evh{{h}}
\def\evi{{i}}
\def\evj{{j}}
\def\evk{{k}}
\def\evl{{l}}
\def\evm{{m}}
\def\evn{{n}}
\def\evo{{o}}
\def\evp{{p}}
\def\evq{{q}}
\def\evr{{r}}
\def\evs{{s}}
\def\evt{{t}}
\def\evu{{u}}
\def\evv{{v}}
\def\evw{{w}}
\def\evx{{x}}
\def\evy{{y}}
\def\evz{{z}}

\def\mA{{\bm{A}}}
\def\mB{{\bm{B}}}
\def\mC{{\bm{C}}}
\def\mD{{\bm{D}}}
\def\mE{{\bm{E}}}
\def\mF{{\bm{F}}}
\def\mG{{\bm{G}}}
\def\mH{{\bm{H}}}
\def\mI{{\bm{I}}}
\def\mJ{{\bm{J}}}
\def\mK{{\bm{K}}}
\def\mL{{\bm{L}}}
\def\mM{{\bm{M}}}
\def\mN{{\bm{N}}}
\def\mO{{\bm{O}}}
\def\mP{{\bm{P}}}
\def\mQ{{\bm{Q}}}
\def\mR{{\bm{R}}}
\def\mS{{\bm{S}}}
\def\mT{{\bm{T}}}
\def\mU{{\bm{U}}}
\def\mV{{\bm{V}}}
\def\mW{{\bm{W}}}
\def\mX{{\bm{X}}}
\def\mY{{\bm{Y}}}
\def\mZ{{\bm{Z}}}
\def\mBeta{{\bm{\beta}}}
\def\mPhi{{\bm{\Phi}}}
\def\mLambda{{\bm{\Lambda}}}
\def\mSigma{{\bm{\Sigma}}}

\DeclareMathAlphabet{\mathsfit}{\encodingdefault}{\sfdefault}{m}{sl}
\SetMathAlphabet{\mathsfit}{bold}{\encodingdefault}{\sfdefault}{bx}{n}
\newcommand{\tens}[1]{\bm{\mathsfit{#1}}}
\def\tA{{\tens{A}}}
\def\tB{{\tens{B}}}
\def\tC{{\tens{C}}}
\def\tD{{\tens{D}}}
\def\tE{{\tens{E}}}
\def\tF{{\tens{F}}}
\def\tG{{\tens{G}}}
\def\tH{{\tens{H}}}
\def\tI{{\tens{I}}}
\def\tJ{{\tens{J}}}
\def\tK{{\tens{K}}}
\def\tL{{\tens{L}}}
\def\tM{{\tens{M}}}
\def\tN{{\tens{N}}}
\def\tO{{\tens{O}}}
\def\tP{{\tens{P}}}
\def\tQ{{\tens{Q}}}
\def\tR{{\tens{R}}}
\def\tS{{\tens{S}}}
\def\tT{{\tens{T}}}
\def\tU{{\tens{U}}}
\def\tV{{\tens{V}}}
\def\tW{{\tens{W}}}
\def\tX{{\tens{X}}}
\def\tY{{\tens{Y}}}
\def\tZ{{\tens{Z}}}


\def\gA{{\mathcal{A}}}
\def\gB{{\mathcal{B}}}
\def\gC{{\mathcal{C}}}
\def\gD{{\mathcal{D}}}
\def\gE{{\mathcal{E}}}
\def\gF{{\mathcal{F}}}
\def\gG{{\mathcal{G}}}
\def\gH{{\mathcal{H}}}
\def\gI{{\mathcal{I}}}
\def\gJ{{\mathcal{J}}}
\def\gK{{\mathcal{K}}}
\def\gL{{\mathcal{L}}}
\def\gM{{\mathcal{M}}}
\def\gN{{\mathcal{N}}}
\def\gO{{\mathcal{O}}}
\def\gP{{\mathcal{P}}}
\def\gQ{{\mathcal{Q}}}
\def\gR{{\mathcal{R}}}
\def\gS{{\mathcal{S}}}
\def\gT{{\mathcal{T}}}
\def\gU{{\mathcal{U}}}
\def\gV{{\mathcal{V}}}
\def\gW{{\mathcal{W}}}
\def\gX{{\mathcal{X}}}
\def\gY{{\mathcal{Y}}}
\def\gZ{{\mathcal{Z}}}

\def\sA{{\mathbb{A}}}
\def\sB{{\mathbb{B}}}
\def\sC{{\mathbb{C}}}
\def\sD{{\mathbb{D}}}
\def\sF{{\mathbb{F}}}
\def\sG{{\mathbb{G}}}
\def\sH{{\mathbb{H}}}
\def\sI{{\mathbb{I}}}
\def\sJ{{\mathbb{J}}}
\def\sK{{\mathbb{K}}}
\def\sL{{\mathbb{L}}}
\def\sM{{\mathbb{M}}}
\def\sN{{\mathbb{N}}}
\def\sO{{\mathbb{O}}}
\def\sP{{\mathbb{P}}}
\def\sQ{{\mathbb{Q}}}
\def\sR{{\mathbb{R}}}
\def\sS{{\mathbb{S}}}
\def\sT{{\mathbb{T}}}
\def\sU{{\mathbb{U}}}
\def\sV{{\mathbb{V}}}
\def\sW{{\mathbb{W}}}
\def\sX{{\mathbb{X}}}
\def\sY{{\mathbb{Y}}}
\def\sZ{{\mathbb{Z}}}

\def\emLambda{{\Lambda}}
\def\emA{{A}}
\def\emB{{B}}
\def\emC{{C}}
\def\emD{{D}}
\def\emE{{E}}
\def\emF{{F}}
\def\emG{{G}}
\def\emH{{H}}
\def\emI{{I}}
\def\emJ{{J}}
\def\emK{{K}}
\def\emL{{L}}
\def\emM{{M}}
\def\emN{{N}}
\def\emO{{O}}
\def\emP{{P}}
\def\emQ{{Q}}
\def\emR{{R}}
\def\emS{{S}}
\def\emT{{T}}
\def\emU{{U}}
\def\emV{{V}}
\def\emW{{W}}
\def\emX{{X}}
\def\emY{{Y}}
\def\emZ{{Z}}
\def\emSigma{{\Sigma}}

\newcommand{\etens}[1]{\mathsfit{#1}}
\def\etLambda{{\etens{\Lambda}}}
\def\etA{{\etens{A}}}
\def\etB{{\etens{B}}}
\def\etC{{\etens{C}}}
\def\etD{{\etens{D}}}
\def\etE{{\etens{E}}}
\def\etF{{\etens{F}}}
\def\etG{{\etens{G}}}
\def\etH{{\etens{H}}}
\def\etI{{\etens{I}}}
\def\etJ{{\etens{J}}}
\def\etK{{\etens{K}}}
\def\etL{{\etens{L}}}
\def\etM{{\etens{M}}}
\def\etN{{\etens{N}}}
\def\etO{{\etens{O}}}
\def\etP{{\etens{P}}}
\def\etQ{{\etens{Q}}}
\def\etR{{\etens{R}}}
\def\etS{{\etens{S}}}
\def\etT{{\etens{T}}}
\def\etU{{\etens{U}}}
\def\etV{{\etens{V}}}
\def\etW{{\etens{W}}}
\def\etX{{\etens{X}}}
\def\etY{{\etens{Y}}}
\def\etZ{{\etens{Z}}}

\newcommand{\pdata}{p_{\rm{data}}}
\newcommand{\ptrain}{\hat{p}_{\rm{data}}}
\newcommand{\Ptrain}{\hat{P}_{\rm{data}}}
\newcommand{\pmodel}{p_{\rm{model}}}
\newcommand{\Pmodel}{P_{\rm{model}}}
\newcommand{\ptildemodel}{\tilde{p}_{\rm{model}}}
\newcommand{\pencode}{p_{\rm{encoder}}}
\newcommand{\pdecode}{p_{\rm{decoder}}}
\newcommand{\precons}{p_{\rm{reconstruct}}}

\newcommand{\laplace}{\mathrm{Laplace}} 

\newcommand{\E}{\mathbb{E}}
\newcommand{\Ls}{\mathcal{L}}
\newcommand{\R}{\mathbb{R}}
\newcommand{\emp}{\tilde{p}}
\newcommand{\lr}{\alpha}
\newcommand{\reg}{\lambda}
\newcommand{\rect}{\mathrm{rectifier}}
\newcommand{\softmax}{\mathrm{softmax}}
\newcommand{\sigmoid}{\sigma}
\newcommand{\softplus}{\zeta}
\newcommand{\KL}{D_{\mathrm{KL}}}
\newcommand{\Var}{\mathrm{Var}}
\newcommand{\standarderror}{\mathrm{SE}}
\newcommand{\Cov}{\mathrm{Cov}}
\newcommand{\normlzero}{L^0}
\newcommand{\normlone}{L^1}
\newcommand{\normltwo}{L^2}
\newcommand{\normlp}{L^p}
\newcommand{\normmax}{L^\infty}

\newcommand{\parents}{Pa} 

\DeclareMathOperator*{\argmax}{arg\,max}
\DeclareMathOperator*{\argmin}{arg\,min}

\DeclareMathOperator{\sign}{sign}
\DeclareMathOperator{\Tr}{Tr}
\let\ab\allowbreak
 \newcommand{\vadim}{d_{v}}
\newcommand{\eadim}{d_{e}}
\newcommand{\embdim}{d_{h}}

\newcommand{\indicator}[1]{\mathbb{1}_{#1}}

\newcommand{\expected}{E}

\newcommand{\nhood}[1]{\mathcal{N}(#1)}
\newcommand{\selfLoopEntry}{2}

\newcommand{\graphVec}{\mathrm{vec}}
\newcommand{\skipNumVert}{M}
\newcommand{\skipLen}{R}
\newcommand{\skipGraph}{\mathcal{G}_{\text{skip}}}

\newcommand{\mlp}{\harrow{g}}
\newcommand{\Identity}{I}
\newcommand{\PermutationMatrix}{P}


\newcommand{\numWL}{L}

\newcommand{\svdots}{\raisebox{3pt}{$\scalebox{.75}{\vdots}$}} \newcommand{\sddots}{\raisebox{3pt}{$\scalebox{.75}{$\ddots$}$}} \newcommand{\maxID}{m}
\newcommand{\powerGnn}{\alpha}
\newcommand{\idMatrix}{I_{|V|}}
\newcommand{\parensi}{(i)}
\newcommand{\binconcat}[2]{\left[#1 \Join #2\right]}

\newcommand{\inlinePath}[3]{{\scriptsize
		\tikz[scale=0.28]{
\draw (0,0) circle (0cm);
\draw[thin] (-.85,0.0) -- (-.4,0.0);
			\draw[thin] (.4,0.0) -- (.85,0.0);
\draw[draw=black] (-1.25,0.0) circle (12pt) node {#1};
			\draw[draw=black] (0,0.0) circle (12pt) 
			node {#2};
			\draw[draw=black] (1.25,0.0) circle (12pt) node {#3};
		}
	}}

\newcommand{\inlineTriangle}[3]{{\scriptsize
                \tikz[scale=0.3]{
\draw (0,0) circle (0cm);
\draw[thin] (-.85,0.0) -- (-.4,0.0);
                        \draw[thin] (.4,0.0) -- (.85,0.0);
			\draw[thin] (-.85,0.0) to[out=90,in=90] (.85,0.0);
\draw[draw=black] (-1.25,0.0) circle (12pt) node {#1};
                        \draw[draw=black] (0,0.0) circle (12pt)
                        node {#2};
                        \draw[draw=black] (1.25,0.0) circle (12pt) node {#3};
                }
        }}


\newcommand{\sglist}{\mathscr{L}} \newcommand{\sgListKay}{\sglist_{k-1}(G_{k})}  \newcommand{\sgListKpo}{\sglist_{k-1}(G_{k+1})}  

\newcommand{\conList}{\mathscr{C}}
\newcommand{\conListKay}{\conList_{k-1}(G_{k})}
\newcommand{\conListKpo}{\conList_{k-1}(G_{k+1})}
\newcommand{\conListR}{\conList_{k-1}(G_{\skipLen})}


\newcommand{\conListKayZero}{\conList_{k-1}^{\{0\}}(G_{k})}
\newcommand{\conListKpoZero}{\conList_{k-1}^{\{0\}}(G_{k+1})}
\newcommand{\conListRZero}{\conList_{k-1}^{\{0\}}(G_{\skipLen})}

 
\begin{document}
\begin{figure}
\fi 

\begin{subfigure}[b]{.5\linewidth}
\quad 
\begin{tikzpicture}[every node/.style={anchor=north,fill=white,minimum width=1cm,minimum height=1mm,scale=.93}]
\scriptsize
\centering
\matrix (mB) [draw,matrix of math nodes]
{
|[draw,fill=red!20]|A_{(3,  3,   2)} & |[draw,fill=red!20]|A_{(3,  4,  2)} & |[draw,fill=red!20]|A_{(3,  1,  2)} & A_{(3,   2, 2)}& A_{(3,   5, 2)}\\
|[draw,fill=red!20]|A_{(4,  3,   2)} & |[draw,fill=red!20]|A_{(4,  4,  2)} & |[draw,fill=red!20]|A_{(4,  1,  2)} & A_{(4,  2, 2)} & A_{(4,  5, 2)}\\
|[draw,fill=red!20]|A_{(1,  3,   2)} & |[draw,fill=red!20]|A_{(1,  4,  2)} & |[draw,fill=red!20]|A_{(1,  1,  2)} & A_{(1,  2, 2)} & A_{(1,  5, 2)}\\
A_{(2,  3,   2)} & A_{(2, 4,  2)}& A_{(2, 1,  2)} & A_{(2, 2,  2)}& A_{(2,5, 2)}\\
A_{(5,3,   2)}& A_{(5,4,  2)} & A_{(5,1,  2)} & A_{(5,2, 2)} & A_{(5,5, 2)}\\
};
\matrix (mA) [draw,matrix of math nodes] at ($(mB.south west)+(2.5, 1.5)$)
{
|[draw,fill=red!20]|A_{(3,  3,   1)} & |[draw,fill=red!20]|A_{(3,  4,  1)} & |[draw,fill=red!20]|A_{(3,  1,  1)} & A_{(3,   2, 1)}& A_{(3,   5, 1)}\\
|[draw,fill=red!20]|A_{(4,  3,   1)} & |[draw,fill=red!20]|A_{(4,  4,  1)} & |[draw,fill=red!20]|A_{(4,  1,  1)} & A_{(4,  2, 1)} & A_{(4,  5, 1)}\\
|[draw,fill=red!20]|A_{(1,  3,   1)} & |[draw,fill=red!20]|A_{(1,  4,  1)} & |[draw,fill=red!20]|A_{(1,  1,  1)} & A_{(1,  2, 1)} & A_{(1,  5, 1)}\\
A_{(2,  3,   1)} & A_{(2, 4,  1)}& A_{(2, 1,  1)} & A_{(2, 2,  1)}& A_{(2,5, 1)}\\
A_{(5,3,   1)}& A_{(5,4,  1)} & A_{(5,1,  1)} & A_{(5,2, 1)} & A_{(5,5, 1)}\\
};

\draw[solid](mA.north east)--(mB.north east);
\draw[solid](mA.north west)--(mB.north west);
\draw[solid](mA.south east)--(mB.south east);


\end{tikzpicture}
\caption*{Adjacency tensor $\tA_{\pi^{\dagger},\pi^{\dagger}}$ where  $\pi^{\dagger}(1, 2, 3, 4, 5)= (3,4,1,2,5)$ (elementwise): the top-left $3 \times 3 \times 2$ subtensor is passed to $\harrow{f}^{(3)}$.}
\end{subfigure}
\quad \quad
\begin{subfigure}[b]{.44\linewidth}
\quad \quad\quad \quad\quad \quad
\begin{tikzpicture}[auto,node distance=3cm, thick, main node/.style={circle,draw,font=\sffamily\bfseries},scale=0.7] 
\draw (7,-1) circle (0cm); 

		   \node[pattern=dots, main node][preaction={fill=red!20}] (ONE) at (0,2) {1};
		   \node[main node] (TWO) at (0,0) {2};
		   \node[pattern=dots, main node][preaction={fill=red!20}] (THREE) at (2,2) {3};
		   \node[pattern=dots, main node][preaction={fill=red!20}] (FOUR) at (2,0) {4};
		   \node[main node] (FIVE) at (3,1) {5};
		   \path (ONE) edge node{} (TWO);
		   \path[line width=1mm] (ONE) edge node{} (THREE);
		   \path(TWO) edge node{} (THREE);
  		   \path[line width=1mm] (THREE) edge node{} (FOUR);
   		   \path (FOUR) edge node{} (FIVE);
   		   \path (THREE) edge node{} (FIVE);


\end{tikzpicture}
\caption*{An example five-node graph encoded by $\tA$. We select a 3-node induced subgraph, corresponding to the top-left of $\tA_{\pi^{\dagger}, \pi^{\dagger}}$ indicated by shaded nodes and thickened edges. }
\end{subfigure}




\iffalse

\begin{subfigure}[b]{.5\linewidth}
\begin{tikzpicture}[every node/.style={anchor=north ,fill=white,minimum width=1cm,minimum height=1mm}]
\small
\centering
\matrix (mB) [draw,matrix of math nodes]
{
|[draw,fill=red!20]|A_{(1,1, 2)} & |[draw,fill=red!20]|A_{(1,2, 2)} & |[draw,fill=red!20]|A_{(1,3, 2)} & A_{(1, 4, 2)}& A_{(1, 5, 2)}\\
|[draw,fill=red!20]|A_{(2, 1, 2)} & |[draw,fill=red!20]|A_{(2, 2, 2)} & |[draw,fill=red!20]|A_{(2, 3, 2)} & A_{(2, 4, 2)} & A_{(2, 5, 2)}\\
|[draw,fill=red!20]|A_{(3, 1, 2)} & |[draw,fill=red!20]|A_{(3, 2, 2)} & |[draw,fill=red!20]|A_{(3, 3, 2)} & A_{(3, 4, 2)} & A_{(3, 5, 2)}\\
A_{(4, 1, 2)} & A_{(4,2, 2)}& A_{(4,3, 2)} & A_{(4,4, 2)}& A_{(4,5, 2)}\\
A_{(5,1, 2)}& A_{(5,2, 2)} & A_{(5,3, 2)} & A_{(5,4, 2)} & A_{(5,5, 2)}\\
};

\matrix (mA) [draw,matrix of math nodes] at ($(mB.south west)+(2.5, 1)$)
{
|[draw,fill=red!20]|A_{(1,1, 1)} & |[draw,fill=red!20]|A_{(1,2, 1)} & |[draw,fill=red!20]|A_{(1,3, 1)} & A_{(1, 4, 1)}& A_{(1, 5, 1)}\\
|[draw,fill=red!20]|A_{(2, 1, 1)} & |[draw,fill=red!20]|A_{(2, 2, 1)} & |[draw,fill=red!20]|A_{(2, 3, 1)} & A_{(2, 4, 1)} & A_{(2, 5, 1)}\\
|[draw,fill=red!20]|A_{(3, 1, 1)} & |[draw,fill=red!20]|A_{(3, 2, 1)} & |[draw,fill=red!20]|A_{(3, 3, 1)} & A_{(3, 4, 1)} & A_{(3, 5, 1)}\\
A_{(4, 1, 1)} & A_{(4,2, 1)}& A_{(4,3, 1)} & A_{(4,4, 1)}& A_{(4,5, 1)}\\
A_{(5,1, 1)}& A_{(5,2, 1)} & A_{(5,3, 1)} & A_{(5,4, 1)} & A_{(5,5, 1)}\\
};

\draw[solid](mA.north east)--(mB.north east);
\draw[solid](mA.north west)--(mB.north west);
\draw[solid](mA.south east)--(mB.south east);
\end{tikzpicture}
\caption*{Adjacency tensor $\tA$. The top-left $3 \times 3 \times 2$ subtensor is vectorized and passed to $\harrow{f}$.}
\label{subfig:TensSubOne}
\end{subfigure}
\begin{subfigure}[b]{.47\linewidth}
\centering
\begin{tikzpicture}[auto,node distance=3cm, thick, main node/.style={circle,draw,font=\sffamily\bfseries}] 
\draw (7,-1) circle (0cm); 

		   \node[fill=red!20, main node] (ONE) at (0,2) {1};
		   \node[fill=red!20, main node] (TWO) at (0,0) {2};
		   \node[fill=red!20, main node] (THREE) at (2,2) {3};
		   \node[main node] (FOUR) at (2,0) {4};
		   \node[main node] (FIVE) at (3,1) {5};
		   \path[draw=red!20, line width=2mm] (ONE) edge node{} (TWO);
		   \path[draw=red!20, line width=2mm] (ONE) edge node{} (THREE);
		   \path[draw=red!20, line width=2mm] (TWO) edge node{} (THREE);
  		   \path (THREE) edge node{} (FOUR);
   		   \path (FOUR) edge node{} (FIVE);
   		   \path (THREE) edge node{} (FIVE);


\end{tikzpicture}
\caption*{An example five-node graph encoded by $\tA$.  A three-node subgraph is selected, as indicated by shaded nodes and thickened edges.  Edge attributes are also sent to $\harrow{f}$ (not shown).}
\end{subfigure}
\begin{subfigure}[b]{.5\linewidth}


\begin{tikzpicture}[every node/.style={anchor=north,fill=white,minimum width=1cm,minimum height=1mm}]
\small
\centering
\matrix (mB) [draw,matrix of math nodes]
{
|[draw,fill=red!20]|A_{(3,  3,   2)} & |[draw,fill=red!20]|A_{(3,  4,  2)} & |[draw,fill=red!20]|A_{(3,  1,  2)} & A_{(3,   2, 2)}& A_{(3,   5, 2)}\\
|[draw,fill=red!20]|A_{(4,  3,   2)} & |[draw,fill=red!20]|A_{(4,  4,  2)} & |[draw,fill=red!20]|A_{(4,  1,  2)} & A_{(4,  2, 2)} & A_{(4,  5, 2)}\\
|[draw,fill=red!20]|A_{(1,  3,   2)} & |[draw,fill=red!20]|A_{(1,  4,  2)} & |[draw,fill=red!20]|A_{(1,  1,  2)} & A_{(1,  2, 2)} & A_{(1,  5, 2)}\\
A_{(2,  3,   2)} & A_{(2, 4,  2)}& A_{(2, 1,  2)} & A_{(2, 2,  2)}& A_{(2,5, 2)}\\
A_{(5,3,   2)}& A_{(5,4,  2)} & A_{(5,1,  2)} & A_{(5,2, 2)} & A_{(5,5, 2)}\\
};
\matrix (mA) [draw,matrix of math nodes] at ($(mB.south west)+(2.5, 1)$)
{
|[draw,fill=red!20]|A_{(3,  3,   1)} & |[draw,fill=red!20]|A_{(3,  4,  1)} & |[draw,fill=red!20]|A_{(3,  1,  1)} & A_{(3,   2, 1)}& A_{(3,   5, 1)}\\
|[draw,fill=red!20]|A_{(4,  3,   1)} & |[draw,fill=red!20]|A_{(4,  4,  1)} & |[draw,fill=red!20]|A_{(4,  1,  1)} & A_{(4,  2, 1)} & A_{(4,  5, 1)}\\
|[draw,fill=red!20]|A_{(1,  3,   1)} & |[draw,fill=red!20]|A_{(1,  4,  1)} & |[draw,fill=red!20]|A_{(1,  1,  1)} & A_{(1,  2, 1)} & A_{(1,  5, 1)}\\
A_{(2,  3,   1)} & A_{(2, 4,  1)}& A_{(2, 1,  1)} & A_{(2, 2,  1)}& A_{(2,5, 1)}\\
A_{(5,3,   1)}& A_{(5,4,  1)} & A_{(5,1,  1)} & A_{(5,2, 1)} & A_{(5,5, 1)}\\
};

\draw[solid](mA.north east)--(mB.north east);
\draw[solid](mA.north west)--(mB.north west);
\draw[solid](mA.south east)--(mB.south east);


\end{tikzpicture}
\caption*{Adjacency tensor $\tA_{\pi^{\dagger},\pi^{\dagger}}$ where  $\pi^{\dagger}(1, 2, 3, 4, 5)= (3,4,1,2,5)$ (elementwise) and the top-left is again selected.}
\end{subfigure}
\quad \quad
\begin{subfigure}[b]{.44\linewidth}
\centering
\begin{tikzpicture}[auto,node distance=3cm, thick, main node/.style={circle,draw,font=\sffamily\bfseries}] 
\draw (7,-1) circle (0cm); 

		   \node[fill=red!20, main node] (ONE) at (0,2) {1};
		   \node[main node] (TWO) at (0,0) {2};
		   \node[fill=red!20, main node] (THREE) at (2,2) {3};
		   \node[fill=red!20, main node] (FOUR) at (2,0) {4};
		   \node[main node] (FIVE) at (3,1) {5};
		   \path (ONE) edge node{} (TWO);
		   \path[draw=red!20, line width=2mm] (ONE) edge node{} (THREE);
		   \path(TWO) edge node{} (THREE);
  		   \path[draw=red!20, line width=2mm] (THREE) edge node{} (FOUR);
   		   \path (FOUR) edge node{} (FIVE);
   		   \path (THREE) edge node{} (FIVE);


\end{tikzpicture}
\caption*{A different three-node subgraph is selected, corresponding to the top-left of $\tA_{\pi^{\dagger}, \pi^{\dagger}}$ indicated by shaded nodes and thickened edges.}
\end{subfigure}
\fi

\ifdefined\COMPLETE

\else
\end{figure}
\end{document}
