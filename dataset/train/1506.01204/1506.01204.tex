




\documentclass[conference]{IEEEtran}




\usepackage{cite}      
\usepackage{graphicx}  






\usepackage{amsmath}   



\usepackage{array}














\hyphenation{op-tical net-works semi-conduc-tor IEEEtran}


\begin{document}


\title{Distributed Optimal Quantization and Power Allocation for  Sensor Detection\\ Via Consensus}






\author{\IEEEauthorblockN{Edmond Nurellari,  Des McLernon,  Mounir Ghogho and Syed Ali Raza Zaidi}
\IEEEauthorblockA{University of Leeds, UK \\ 
International University of Rabbat, Morocco\\ elen@leeds.ac.uk, d.c.mclernon@leeds.ac.uk, m.ghogho@ieee.org, elsarz@leeds.ac.uk }
}

\def\x{{\mathbf x}}
\def\L{{\cal L}}


\maketitle

\begin{abstract}
We address the optimal transmit power allocation problem (from the sensor nodes (SNs) to the fusion center (FC)) for the decentralized detection of an unknown deterministic spatially uncorrelated  signal which is being observed by a distributed wireless sensor network.  We propose a novel fully distributed algorithm, in order to calculate the optimal transmit power allocation for each sensor node (SN) and the optimal number of quantization bits for the test statistic in order to match the channel capacity. The SNs send their  quantized information over orthogonal uncorrelated channels to the FC which linearly combines them and makes a final decision. What makes this scheme attractive is that the SNs share with their neighbours just their individual transmit powers at the current states. As a result, the SN processing complexity is further reduced.
\end{abstract}
\begin{IEEEkeywords}
Distributed detection, distributed  processing, soft decision, wireless sensor networks.
\end{IEEEkeywords}




\section{Introduction}
\label{sec:intro}
Wireless sensor networks (WSNs) are spatially deployed over a field to monitor certain physical or environmental phenomena. Generally, the sensing process is orientated towards estimating various parameters of interest which can be employed to arrive at a certain decision. This decision can then be relayed in a pre-specified manner or can be employed for on-field actuation. We note that the reliable and continued operation of a WSN over many years is often desirable. This is due to the operational environment in which post-deployment access to a sensor node (SN) is at best very limited. Unfortunately, SNs suffer from constrained bandwidth and limited available on-board power. Moreover, due to the locality of the observed process, cooperation amongst SNs is often required to derive an inference. However, such a cooperation comes at the expense of high bandwidth requirements and signalizing overhead. For instance, a WSN formed by  sensor nodes would require transmission of  message  exchanges to attain full cooperation. Consequently, designing distributed detection algorithms that efficiently utilize the scarce bandwidth and cope with the impairments in a wireless channel is very important. \\
\indent This work investigates the detection performance of the SN over flat fading wireless transmission links. A centralized solution (taken at the fusion center (FC)) is proposed in \cite{les82} where the deterministic signal () to be detected is assumed to be known a-priori. We relax this constraint by deriving a scheme that detects an unknown deterministic signal () by employing a linear fusion rule at the FC and adopting the modified deflection coefficient as the detection performance criterion. We also propose a fully distributed algorithm where we allocate the SN transmit power for each individual SN using only local information.   \\
\indent The problem of decentralized detection (and estimation) in a WSN has been extensively tackled in \cite{les82}-\hspace{-0.005cm}\cite{les94}, to name but just a few. Recent publications\cite{Bertrand}-\hspace{-0.005cm}\cite{Lorenzo} propose a distributed algorithm for in-network estimation of algebraic connectivity. Interestingly, \cite{Lorenzo} uses an estimation strategy to adapt the SN transmit power in order to maximize the connectivity of the network, while in this paper we take advantage of the objective function structure and develop a novel distributed algorithm to allocate the SN to FC transmit power. The algorithm is very efficient in terms of convergence and data exchange, also accurate and simple to implement.\\
\indent Section \ref{sec:format} describes the system model and we derive an approach that utilizes the SN to FC channel capacity. An optimum linear combining rule is adopted at the FC with the combining weights optimized in Section \ref{Decentralized optimum weight combining and power allocation}. Section \ref{Decentralized optimum weight combining and power allocation} presents the derivation of the decentralized optimum SN transmit power allocation and our proposed algorithm. Finally, simulation results are given in Section \ref{SIMULATION RESULTS} and conclusions in Section \ref{CONCLUSION}.
\section{System Model and Quantized decision combining}
\label{sec:format}
Consider the problem of detecting the presence of a deterministic signal  by a sensor network consisting of  SNs. The  SN collects  samples of the observed signal (), and so the detection problem can be formulated as a binary hypothesis test as follows: 

where  is AWGN and  is the observation of (), both at the  node. The  SN then estimates the energy:

which for large  can be approximated by a Gaussian distribution \cite{les98} under both hypothesis. So is not difficult to derive (\ref{eq1124})
\begin{figure*}[h!tb]
\normalsize

\hrulefill
\vspace*{-12pt}
\end{figure*}
where  which can be considered as effective observed SNR. Now linear soft decision combining at the FC has superior performance to the hard decision approach, but it entails additional complexity. In addition soft decision combining puts additional demands on both the limited power resources of the SNs and the effective utilization of the SN to FC channel capacity. So here we propose a scheme, where each individual SN has to quantize its observed test statistic () to  bits. The number of quantization bits at the  SN must satisfy the channel capacity constraint:

where  denotes the transmit power of sensor ,  is the flat fading gain between SN  and the FC, and  is the  variance of the AWGN at the FC.
The quantized test statistic () at the  SN can be modeled (with  bits) as 

where  is quantization noise (variance, ) independent of  in ((1) and (2)). Assuming quantization noise with a uniform distribution and , then

Linearly combining  at the FC gives

where the weights  will be optimized in Section \ref{Decentralized optimum weight combining and power allocation}. Again, for large ,  will be approximately Gaussian and so we can derive (\ref{eq1122}) and (\ref{eq11}) . We now define  and for a fixed  (probability of false alarm) we can write \cite{les96}:
\begin{figure*}[h!tb]

\vspace*{-0.4cm}

\hrulefill
\vspace*{-12pt}
\end{figure*}


where  is the probability of detection.
So using (\ref{eq5}), (\ref{eq8}), (8), (\ref{eq1122}) and (\ref{eq11}) in (\ref{eq14}) we get 

The formula in () imposes a relationship between the probability of detection, the power allocated to each transmission link (SN to the FC) and the weight ( in (\ref{eq10})) for each individual link. 
\section{Decentralized optimum weight combining and power allocation}
\label{Decentralized optimum weight combining and power allocation}
We would now like to find the optimum weighting vector () and the optimum power allocation vector () that achieves the best possible  (see definitions later), under the constraint of a maximum transmit power budget (). However, maximizing  (\ref{eq114}) w.r.t.  and  is difficult and no closed form solution can be found. From (\ref{eq114}) it is straightforward to observe that the  is a monotonically increasing function of the deflection coefficient. Moreover, . Employing these two facts, it is intuitive to approximate the optimization problem of (\ref{eq114}) by maximization of the deflection coefficient which is given as:

where \\ \\
\hspace{-0.1cm} \quad \\  \\
,  \\ \\
   \\ \\
Note that the dependence of  on the transmit power vector  enters (\ref{eq17}) through the  terms via (\ref{eq5}) and (\ref{eq8}). 
Now, our optimization problem is:

The straightforward solution to (P1) is to obtain it in a centralized manner (i.e., at a FC), where the FC  has full knowledge of the channel gains () which might change over time and need to be updated. The dependence of  on the flat fading channel coefficients  enters through . In this paper we propose a distributed solution, where the SNs are limited to use local information to be able to decide if they should transmit any information to the FC or stay in sleeping mode. 
\subsection{Optimisation through Decentralized Weight Combining}
\label{sssec:subhead}
Letting  in (\ref{eq17}), then we have
\label{eq3.111}
\boldsymbol \alpha^o\hspace{-0.01cm}=\hspace{-0.01cm}\left[\hspace{-0.01cm}
       \begin{matrix}
         \frac{N \sigma_1^{2} \xi_1}{2N\sigma_1^{4}\left(1+2\xi_1\right)+\sigma^{2}_{v_1}}, 
\cdots, 
\frac{N \sigma_M^{2} \xi_M}{2N\sigma_M^{4}\left(1+2\xi_M\right)+\sigma^{2}_{v_M}}\vspace{0.09cm} 
        \end{matrix}
    \hspace{-0.01cm}\right]
\label{eq202}
\begin{aligned}
& \underset{\boldsymbol p}{\text{\hspace{-0.3cm}maximize}}
& &\hspace{-0.4cm}\left(\hspace{-0.1cm}\sum \limits_{i=1}^M\frac{ N^2 \sigma_i^{4}\xi_i ^{2}}{ {   2N  \sigma_i^{4} \left(1+2\xi_i \right) +\frac{U^{2}}{3\left(1+\frac{p_ih_i^{2}}{\zeta_i}\right)}}}\hspace{-0.1cm}\right) \\ \quad
& \text{\hspace{-0.25cm}subject to} 
& & \sum \limits_{i=1}^M p_i \leq P_t, \ p_i\geq0, \ i = 1, \ldots, M.
\end{aligned}
\tag{{P2}}

   f(\boldsymbol p, \lambda_0, \mu)={ \sum \limits_{i=1}^M \frac{ N^2 \sigma_i^{4}\xi_i ^{2}}{ 2N  \sigma_i^{4} \left(1+2\xi_i \right) +\frac{U^{2}}{3\left(1+\frac{p_ih_i^{2}}{\zeta_i}\right)}} } \hspace{1.5cm}\\ -\lambda_0 \left(\sum \limits_{i=1}^M p_i- P_t\right)+\sum \limits_{i=1}^M \mu_i p_i 
\label{eq21}
 0\in\frac{ N^2 \sigma_i^{4}\xi_i ^{2}}{ \left(\hspace{-0.14cm}2N  \sigma_i^{4} \left(1+2\xi_i \right) +\frac{U^{2}}{3\left(1+\frac{p_ih_i^{2}}{\zeta_i}\right)}\hspace{-0.1cm}\right)^{\hspace{-0.22cm}2}  }\hspace{-0.07cm}\times\hspace{-0.07cm} \frac{U^{2}\times \frac{h_i^{2}}{\zeta_i}}{3\left(1+\frac{p_ih_i^{2}}{\zeta_i}\right)^{\hspace{-0.1cm}2}} \hspace{-0.05cm}-\hspace{-0.05cm}\lambda_0 \hspace{-0.05cm}+\hspace{-0.05cm}\mu_i 
\tag{22}
\label{eq22}
\lambda_0 \left(\sum \limits_{i=1}^M p_i- P_t\right)=0 \hspace{-0.8cm}\\
\sum \limits_{i=1}^M p_i- P_t \leq0 \hspace{-0.8cm}\\
\lambda_0\geq 0 , \ \mu_i p_i=0,  \ i = 1, 2, \ldots, M \hspace{-0.6cm} \\
\mu_i\geq0, \  p_i\geq0,  \ i = 1, 2, \ldots, M. \hspace{-0.6cm}
\tag{23}

{\sum \limits_{i=1}^M ( {\frac{ N^2 \sigma_i^{4}\xi_i ^{2}}{ {   2N  \sigma_i^{4} \left(1+2\xi_i \right) +\frac{U^{2}}{3\left(1+\frac{p_ih_i^{2}}{\zeta_i}\right)}}}\hspace{-0.1cm}}  -\lambda_0 p_i+ \frac{\lambda_0}{M} P_t)}.
\label{eq30}
\vspace{-0.1cm}
\begin{aligned}
\hspace{-3cm}p_i\left[k+1\right]=\underset{\hspace{0.6cm} p_i}{\text{arg \ min}}\hspace{0.1cm}f_i(p_i, \lambda_0\left[k\right]) \\ 
\end{aligned}
\tag{{a1}}
\vspace{-0.1cm}
\label{eq30}
\begin{aligned}
 &\lambda_0\left[k+1\right]=\lambda_0\left[k\right]+\epsilon\left[k\right]\left(\sum \limits_{i=1}^M p_i\left[k+1\right]-P_t\right).
\end{aligned}
\tag{{a2}}
\label{eq24}
p^o_{i}\hspace{-0.1cm}=\hspace{-0.1cm}\Biggl[\hspace{-0.1cm}\frac{1}{\sqrt{\lambda_0}}\Biggl(\frac{\xi_i U\sqrt{3}}{6\sigma_i^{2}\left(1\hspace{-0.07cm}+\hspace{-0.07cm}2\xi_i\right)\sqrt{\frac{h_i^{2}}{\zeta_i}}}\Biggl)- \frac{U^2}{6N\sigma_i^{4}\left(1\hspace{-0.07cm}+\hspace{-0.07cm}2\xi_i\right)\frac{h_i^{2}}{\zeta_i}} -\frac{\zeta_i}{h_i^{2}}\hspace{-0.05cm}\Biggr]^{+} 
\tag{24}
\label{eq2254}
[x]^+=\left\{
\begin{aligned}
 x, \ \ \ \  \ \mathrm{ if} \ x\geq0 \ \quad \\
  0, \ \ \ \  \ \mathrm{ if} \ x<0 .\quad \end{aligned}
\right. 

As mentioned before, the centralized solution at the FC requires full knowledge of the channel gains () which might be time-varying and need to be  always updated. It also requires the variance of AWGN () and each of the local SNRs (). Moreover, the FC has to broadcast back to each individual SN the allocated SN transmit power which might be decoded with error due to fading. Furthermore, when the FC is battery operated, the centralized solution (at the FC) becomes inefficient and not scalable as the number of SNs increases. On the other hand, the proposed distributed algorithm () is fully scalable in terms of data exchange and SN processing complexity. As is shown in the simulation result it is also very accurate.
We now define  to be the positive user defined step size and .
\begin{table}[htp!] 
\small
\centering \begin{tabular}{l r} \hline\hline  Optimizing the sensor transmit power \\ [0.6ex] 
\hline STEP 1:  Set ,  equal to a small positive value  \\  \hspace{1.2cm} and initialize , ;\\  \\ STEP 2:  Compute  ,   using (a1);\\  \\
STEP 3:  Run consensus over  to get \\ \\ 
STEP 4:  Compute  using (a2);\\ \\
STEP 5:  Set ;\\ \\
STEP 6:  Repeat until convergence  \\ \\  \hspace{-2.4cm}\\ \\ Run consensus over  until convergence \\ \\ \hspace{0.6cm}  \\ \\ Set , if convergence criterion is satisfied stop, \\  otherwise go to step 6. \\ [0.5ex]  \hline \end{tabular} 
\label{tab:hresult} 
\end{table} 
The convergence criteria that we use in here is the relative absolute difference: , where  is a positive small constant and  is the vector of the SN transmit power at the  iteration.\\
 \indent It is also possible to exchange among the SNs the , , , and  quantities  where each SN will store them  in the corresponding vectors , , , and  together with their corresponding SN index. When all the quantities will be available at each SN they can be used to allocate the SN transmit power through (\ref{eq24}) and  can be calculated through the constraint in (P2). 
\section{Simulation results}
\label{SIMULATION RESULTS}
In this section, the proposed algorithm is evaluated numerically and compared to its centralized counterpart. Also, we choose , ,  and . We let all the   terms at each SN be different, such that  -4 dB, unless otherwise stated. In addition we let  . We compare the results with the matched filter detector\footnote{The test statistic is taken as: . The global test statistic () at the FC has the same structure as (8) with  The optimum weights have been derived through the Likelihood Ratio Test (LRT).} (MFD) and use this as a benchmark. We will also refer to ``equal linear combining" in (8) (i.e., ) and ``equal power allocation" in (5) (i.e., ).
\begin{figure}[!htp]
\centerline{\includegraphics[width=80mm ,height=70mm]{fig_1}}
\caption[Centralized and decentralized sensor transmit power and channel bit allocation for , ,  and ]{\label{fig:fig_1}
Centralized and decentralized sensor transmit power and channel bit allocation for , , ,  dB,  and .}
\vspace{0.22cm}
\end{figure}
\begin{figure}[htp!]
\centerline{\includegraphics[width=80mm ,height=70mm]{fig_4}}
\caption[Disagreement error versus time for  sensors.]{\label{fig:fig_4}
    Centralized and decentralized sensor transmit power and channel bit allocation for , , ,  dB,  and .}
\end{figure}
\begin{figure}[htp!]
\centerline{\includegraphics[width=80mm ,height=70mm]{fig_9}}
\caption[Disagreement error versus time for  sensors.]{\label{fig:fig_9}
    Total power budget () versus probability of mis-detection , with , ,  dB,  and .}
\end{figure}
\begin{figure}[htp!]
\centerline{\includegraphics[width=80mm ,height=70mm]{fig_10}}
\caption[Disagreement error versus time for  sensors.]{\label{fig:fig_10}
Probability of detection () versus probability of false alarm (), with ,  dB,  and .}
\end{figure}
\begin{figure}[htp!]
\centerline{\includegraphics[width=80mm ,height=70mm]{fig_11}}
\caption[Disagreement error versus time for  sensors.]{\label{fig:fig_11}
 Probability of detection () versus total power budget (), with ,  dB,  and .}
\end{figure}
Finally, we choose  with equality in (\ref{eq5}). In Fig. \ref{fig:fig_1}, the middle plot shows  the SN transmit power   for the  SN to the FC channel using two different approaches (i.e., distributed and centralized). The actual channel coefficients (randomly chosen) are in the upper plot in Fig. \ref{fig:fig_1}. Clearly, the performance of our proposed distributed method is very close to the centralized one. As expected, both centralized and decentralized methods  allocate more power to the best channels. In this way, the nodes that have very bad channels (i.e.,nodes that require very high power to transmit) will be censored (i.e., will not transmit even a single bit). 
In Fig. \ref{fig:fig_4}, we show that for large number of samples () the optimum power allocation scheme tends to a uniform power allocation as expected (see the definition of  in Section \ref{Decentralized optimum weight combining and power allocation}). Fig. \ref{fig:fig_9} shows the total power budget () against the mis-detection (1-) performance for 6 different schemes. The energy detector (ED) performance tends to converge to the matched filter detector for a low power budget (). Fig. \ref{fig:fig_10} shows the receiver operating characteristic against the sample number (). As expected, the matched filter detector outperforms the energy detector but it requires full knowledge of the useful signal. And in Fig. \ref{fig:fig_11}, we examine the probability of detection ()  performance against the total power budget (). As  increases, then  improves. 
\section{Conclusion}
\label{CONCLUSION}
We have shown how to perform distributed detection, via SNs transmitting a quantized version of the received energy test statistic to the FC. In addition we have derived the optimal linear combining weights at the FC and proposed a novel distributed algorithm to calculate the optimal transmit power for each SN in order to maximize . In this way, the SN can allocate its own transmit power by exchanging information with its own neighbours. What makes this scheme very useful and attractive is that the only value that they should exchange among neighbours is their own transmit power at the current state. The algorithm is robust and easy implementable.
\begin{thebibliography}{80}

\bibitem{les82} S. Barbarossa, S. Sardellitti, and P. Di Lorenzo, ``\emph{Distributed Detection and Estimation in Wireless Sensor Networks}," In Rama Chellappa and Sergios Theodoridis eds., Academic Press Library in Signal Processing, Vol. 2, Communications and Radar Signal Processing, pp. 329-408, 2014.

\bibitem{les997} J. F. Chamberland and V. V. Veeravalli, ``Asymptotic results for decentralized detection in power constrained wireless sensor networks,'' \emph{IEEE Journal on Selected Areas in Communications}, vol. 22, no. 6, pp. 1007- 1015, Aug. 2004.


\bibitem{Nurellari1} E.~Nurellari, D.~McLernon, M.~Ghogho and S.~Aldalahmeh, ``Optimal quantization and power allocation for energy-based distributed sensor detection," \emph{Proc. EUSIPCO}, Lisbon, Portugal, 1-5 Sept. 2014.

\bibitem{Nurellari2} E.~Nurellari, S.~Aldalahmeh, M.~Ghogho and D.~McLernon, ``Quantized Fusion Rules for Energy-Based Distributed Detection in Wireless Sensor Networks ," \emph{Proc. SSPD}, Edinburgh, Scotland, 8-9 Sept. 2014.

\bibitem{les91} A. Ribeiro and G. B. Giannakis, ``Bandwidth-constrained distributed estimation for wireless sensor networks, part I: Gaussian case," \emph{IEEE  Transactions on Signal Processing}, vol. 54, no.3, pp.1131-1143, 2006.


\bibitem{les998} X. Zhang, H. V. Poor, and M. Chiang, ``Optimal power allocation for distributed detection over MIMO channels in wireless sensor networks,"\emph{ IEEE Trans. Signal Process.}, vol. 56, no. 9, pp. 4124–4140, Sep. 2008.


\bibitem{les94} J. Li and G. Alregib, ``Rate-constrained distributed estimation in wireless sensor networks," \emph{IEEE  Transactions on Signal Processing}, vol. 55, pp.1634-1643,  May. 2007.

\bibitem{Bertrand} A. Bertrand and M. Moonen, ``Distributed computation of the Fiedler vector with application to topology inference in ad hoc networks," \emph{Signal Processing}, vol. 93, no. 5, pp. 1106-1117, 2013.

\bibitem{Lorenzo} P. Di Lorenzo and S. Barbarossa,``Distributed Estimation and Control of Algebraic Connectivity over Random Graphs," \emph{on second stage review in IEEE Transactions on Signal Processing}, April 2014.  


\bibitem{les98} H. Urkowitz, ``Energy detection of unknown deterministic signals, ” \emph{ Proc. IEEE }, vol. 55, pp. 523–531, Apr. 1967.

\bibitem{les96} S. M. Kay, \emph{Fundamentals of Statistical Signal Processing: Detection Theory }, Englewood Cliffs, NJ: Prentice-Hall PTR, 1993.

\bibitem{saber} R. O. Saber, J. A. Fax, R. M. Murray, ``Consensus and cooperation in networked multi-agent systems," \emph{Proc. of the IEEE}, 95(1), pp. 215-233, Jan. 2007.

\bibitem{Boyd} S. Boyd, N. Parikh, E. Chu, B. Peleato, and J. Eckstein, ``Distributed optimization and statistical learning via the alternating direction method of multipliers," vol. 3 of \emph{Foundations and Trends in Machine Learning}, Now Publishers Inc., 2011.

\bibitem{Boyd_2} S.Boyd and L. Vandenberghe, \emph{Convex Optimization,} Cambridge Univ. Press, 2003.

\end{thebibliography}

 























\ifCLASSOPTIONcaptionsoff
  \newpage
\fi

\end{document}
